<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>
<![CDATA[Hacker News - Small Sites - Score >= 10]]>
        </title>
        <description>
<![CDATA[Hacker News stories from domains that aren't in the top 1M and that have a score of at least 10. Updated nightly via https://github.com/awendland/hacker-news-small-sites]]>
        </description>
        <link>https://news.ycombinator.com</link>
        <generator>RSS for Node</generator>
        <lastBuildDate>Fri, 19 Feb 2021 04:34:34 GMT</lastBuildDate>
        <atom:link href="https://raw.githubusercontent.com/awendland/hacker-news-small-sites/generated/feeds/hn-small-sites-score-10.xml" rel="self" type="application/rss+xml"></atom:link>
        <pubDate>Fri, 19 Feb 2021 04:34:34 GMT</pubDate>
        <language>
<![CDATA[en-US]]>
        </language>
        <managingEditor>
<![CDATA[me@alexwendland.com (Alex Wendland)]]>
        </managingEditor>
        <ttl>240</ttl>
        <item>
            <title>
<![CDATA[Kill the Alarm Clock (2017)]]>
            </title>
            <description>
<![CDATA[
Score 39 | Comments 72 (<a href="https://news.ycombinator.com/item?id=26163691">thread link</a>) | @aminozuur
<br/>
February 16, 2021 | https://supermemo.guru/wiki/Kill_the_alarm_clock | <a href="https://web.archive.org/web/*/https://supermemo.guru/wiki/Kill_the_alarm_clock">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="mw-content-text" lang="en" dir="ltr"><p><small>This text is part of: "<i><a href="https://supermemo.guru/wiki/Science_of_sleep" title="Science of sleep">Science of sleep</a></i>" by <a href="https://supermemo.guru/wiki/Piotr_Wozniak" title="Piotr Wozniak">Piotr Wozniak</a> (2017)</small>
</p>


<h2><span id="Kill_the_alarm_clock.21">Kill the alarm clock!</span></h2>
<h3><span id="Alarm_clock_epidemic">Alarm clock epidemic</span></h3>
<p>Few upwardly mobile people in the modern rat-race society can live without an alarm clock. With a shot of strong coffee and round-the-clock stress, most people learn to live and survive with an alarm clock. Half of the population wakes up with an alarm, 9% are woken by a partner, 4% by pets, 3% by children, etc. That leaves a minority that wake up naturally. Increasingly, time becomes the most precious commodity in society where achievement is often associated with speed and perfect time-management. However, alarm clocks introduce harmful side effects: stress, sleep debt, and worst of all, disruption of the natural physiological sleep function. At worst, those factors will result in physical damage to the brain (e.g. such sensitive structures as the hippocampus, your memory switchboard, may literally <a href="https://supermemo.guru/wiki/If_you_do_not_sleep,_you_die!" title="If you do not sleep, you die!">lose neurons as a result of disrupted sleep</a>).
</p><p>The art of time-management makes it possible to live at a high speed with an alarm clock at your side, and still be free from <a href="https://supermemo.guru/wiki/Factors_that_affect_sleep#Stress" title="Factors that affect sleep">stress</a>. However, the societal damage inflicted by alarm clocks and <a href="https://supermemo.guru/wiki/Sleep_deprivation" title="Sleep deprivation">sleep deprivation</a> is unforgivable. An alarm clock that interrupts your sleep damages your memories, your ability to learn, your creativity, your mood and temper, your relationships with other people, your ability to focus, and your overall intellectual performance!
</p><p>Dr Robert Stickgold has shown that people who learn a skill during the day do not show significant improvement until they get 7-8 hours of good sleep<sup id="cite_ref-stickgold-2005_1-0"><a href="#cite_note-stickgold-2005-1">[1]</a></sup>. There was a noticeable correlation between the degree of improvement and the quality of sleep received. My own work with <a href="https://supermemo.guru/wiki/Sleep_habits#SleepChart_in_SuperMemo" title="Sleep habits">SleepChart</a> also shows that the <a href="https://supermemo.guru/wiki/Sleep_and_learning#Alarm_clock_vs._learning" title="Sleep and learning">use of alarm clocks can dramatically reduce memory recall and consolidation</a>. Forgetting is so painless that we rarely notice its effects. In a natural way, forgetting will proceed even if you get as much sleep as you need, and it is difficult to point to specific memories lost as a result of not sleeping enough. Moreover, <a href="https://supermemo.guru/wiki/Memory_optimization_in_sleep#Neural_optimization_in_sleep" title="Memory optimization in sleep">sleep deprivation may leave your memories intact while their storage will be sub-optimum</a>. The difference may be impossible to spot without measurement. We are more likely to notice sleepiness, reduced mental agility, or bad mood.
</p><p>Disrespect for sleep has reached biblical proportions. This is most noticeable in the US and other highly industrialized nations. <i>Men's Health's</i> Dan Vergano writing for <i>ABC News</i> in <i>"No More Rude Awakenings"</i> suggests a seven-day system for fighting sleepiness: <i>"The secret is to fuel that arousal system so it can <b>beat the pants off the sleep system</b>. By creating the kind of feel-good expectations that trigger hormones to wake the brain, you’ll override the need to sleep and be able to jump out of bed like a man on fire"</i>. The article suggests a "fresh" mind method that capitalizes on the fact that stress hormones help keep you alert. However, the only rational remedy for <i>"rude awakenings"</i> is simple: get enough sleep! Jumping <i>like a man on fire</i> is not likely to have a positive effect on your creative potential!
</p><p>You may often notice that waking up with an alarm clock gives you a jumpstart for the day. You may then come to believe that using the alarm clock might help you stay alert later in the day. This is not the case. The alarm signal simply scares your brain into wakefulness, disrupting the carefully planned process of <a href="https://supermemo.guru/wiki/Memory_optimization_in_sleep#Neural_optimization_in_sleep" title="Memory optimization in sleep">neural optimization</a> that occurs in sleep. As a result, you get an immediate injection of <a href="http://en.wikipedia.org/wiki/Adrenaline">adrenaline</a> and your levels of <a href="http://en.wikipedia.org/wiki/ACTH">ACTH</a> and <a href="http://en.wikipedia.org/wiki/Cortisol">cortisol</a> also increase. This is cortisol that peaks at awakening in natural sleeping rhythm that provides you with the fresh-mind impression. With passing time, this cheaply gained alertness will wear thin unless you continue abusing your physiology with more "remedies". You may use more scare tactics for keeping yourself alert, abuse caffeine, or even get a more profound effect with <a href="http://en.wikipedia.org/wiki/Modafinil">modafinil</a>, <a href="http://en.wikipedia.org/wiki/Cocaine">cocaine</a>, or <a href="http://en.wikipedia.org/wiki/Amphetamines">amphetamines</a>. Alertness should be achieved with the help of sufficient sleep, not despite the lack of sleep! Apart from your reduced ability to learn new things, all unnatural anti-drowsiness methods will produce a great deal of side effects that can be pretty damaging to your health in the long run.
</p><p>All efforts to overcome sleepiness by means other than sleep itself can be likened to a chase of the first high in the use of psychoactive substances. If you drink buckets of coffee, do pushups, pour cold water over your head, or slap your face, you only dip into the last reserves of your alertness hormones that only worsen the effects of deprivation after the effects of the stimulation wear off, which is usually a matter of minutes. Rarely can you get a boost lasting more than an hour, and the more you perk up, the lower you fall in the aftermath.
</p>
<h3><span id="Insomnia_trap">Insomnia trap</span></h3>
<p>If your life without an alarm clock may seem like an impossibility, you will probably need to use all methods in the book to be sure you get enough sleep and minimize the damage. If you need to wake up early at the cost of your brain, avoid the <b><a href="https://supermemo.guru/wiki/Insomnia" title="Insomnia">insomnia trap</a></b>! Insomnia trap is a vicious circle of:
</p>
<ol><li> going to sleep too early to get more sleep,</li>
<li> failing to fall asleep in time (or worse, waking up prematurely),</li>
<li> feeling even more tired on the next day, and</li>
<li> going to sleep even earlier on the next day to catch up with the lost sleep.</li></ol>
<p>It is better to go to sleep at a natural hour (i.e. a bit later), wake up early, suffer a degree of sleep deprivation, and hope for a phase reset that will make it possible to continue on the <a href="http://www.stevepavlina.com/blog/2005/05/how-to-become-an-early-riser/">designer schedule</a>. For a solution to the insomnia trap see: <a href="https://supermemo.guru/wiki/Curing_DSPS_and_insomnia" title="Curing DSPS and insomnia">Curing DSPS and insomnia</a>.
</p><p>If you cannot reset your phase and still feel tired when getting up early on a regular basis, consider choosing a job that is acceptable for your body, not the other way around. Your long-term health and well-being is at stake. If you absolutely cannot live without an alarm clock, you can at least start from changing your mindset about the importance of sleep and ensure you do not impose wrong habits on your children. Perhaps the young ones will be lucky enough to work in a flex-time system that will make it possible to get sufficient amount of undisturbed sleep. At least, do not set a bad example!
</p>
<h3><span id="Wake_up_the_President">Wake up the President</span></h3>
<p>President Bill Clinton was woken up twice by telephone during the night of April 22, 2000 before the infamous I.N.S. raid on the home of Miami relatives of the young Cuban exile Elian Gonzales. He was probably the most often disrupted and sleep deprived president in history. Only after a heart surgery did Clinton take diet, sleep and (real) exercise seriously. Those interrupted nights would definitely influence his performance and the quality of his decisions! Has anybody thought of a rule: <i>Do not wake up the president?</i> A rule that could only be revoked in a true national emergency? President G. W. Bush (b. 1946) was woken up when an American spy plane landed in China in 2001. He was also woken up after a suicide bombing in Jerusalem in 2002. George H. W. Bush (b. 1924) and Hilary Clinton made "waking up in the middle of the night" part of their presidential campaign and prowess. It seems that only Ronald Reagan had pretty strong rules for protecting his own sleep. He also famously napped during some cabinet meetings. He slept through a couple of international events without an apparent negative impact on his somewhat delayed decision-making. Critics would say he slept through the entire <a href="http://en.wikipedia.org/wiki/Iran%E2%80%93Contra_affair">Iran-Contra affair</a>. Was Reagan so protective of sleep because he understood the role of sleep better, or perhaps he was just a bit lazier than other presidents? I don't know. However, he sure set a good example.
</p>
<h3><span id="Alarm_clock_monsters">Alarm clock monsters</span></h3>
<p>Andrea K. wrote to me with skepticism: 
</p>
<blockquote><p><i>"Take the alarm clock away from a typical person and they won't just wake up on their own at their desired time and they will miss work, school, or whatever. An alarm clock can't be that bad for you because of the simple fact that most people use it and I never noticed any problem with them&nbsp;:) Everyone in my family has been using one since they were children, and no one suddenly went crazy or began to mutate into a monster (yet)!"</i></p></blockquote> 
<p>When you use an alarm early in the morning in order to get to work or to school, you cut off the later stages of sleep. If the intrusion into natural sleep is not large (e.g. from minutes to an hour), the damage may be limited and hard to notice. Alarm clock will do far more damage if it cuts deep into the middle of the night sleep. You can compare the use of alarm clocks to smoking or eating hot dogs. The harm is not great enough to be instantly noticeable. It took the public many years to largely accept that "smoking is bad" or "fast food is bad". It is hard to quantify the degree of damage. However, as we move to knowledge society where our intellectual performance becomes increasingly important, the effects of <a href="https://supermemo.guru/wiki/Sleep_deprivation" title="Sleep deprivation">sleep deprivation</a> will come under closer scrutiny and alarm clocks are bound to gradually fall out of favor. Unlike hot dogs, they are already universally hated by their users. Most people are able to somewhat adapt their sleep to their schedules if their routines are regular enough. When those people need to resort to the use of the alarm clock, they cut less of their sleep and the damage is proportionally smaller. Nevertheless, we should always strive at eliminating alarm clocks altogether. Most of all, we should protect our kids from suffering interrupted sleep!
</p>
<h2><span id="References">References</span></h2>
<ol>
<li id="cite_note-stickgold-2005-1"><span><a href="#cite_ref-stickgold-2005_1-0">↑</a></span> <span>Stickgold R., "<a href="http://www.nature.com/nature/journal/v437/n7063/full/nature04286.html">Sleep-dependent memory consolidation</a>," Nature / Volume 437 (October 27, 2005): 1272-1278</span>
</li>
</ol>

<!-- 
NewPP limit report
Cached time: 20210218073047
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.030 seconds
Real time usage: 0.055 seconds
Preprocessor visited node count: 56/1000000
Preprocessor generated node count: 158/1000000
Post‐expand include size: 1541/2097152 bytes
Template argument size: 438/2097152 bytes
Highest expansion depth: 4/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   36.199      1 - -total
 64.84%   23.472      1 - ArticleSleep
 11.30%    4.092      1 - Template:Excerpt
-->

<!-- Saved in parser cache with key supermem_kool_kids:pcache:idhash:1062-0!*!0!!en!*!* and timestamp 20210218073047 and revision id 14432
 -->
</div></div>]]>
            </description>
            <link>https://supermemo.guru/wiki/Kill_the_alarm_clock</link>
            <guid isPermaLink="false">hacker-news-small-sites-26163691</guid>
            <pubDate>Wed, 17 Feb 2021 07:28:17 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Database Inside Your Codebase]]>
            </title>
            <description>
<![CDATA[
Score 91 | Comments 60 (<a href="https://news.ycombinator.com/item?id=26160186">thread link</a>) | @todsacerdoti
<br/>
February 16, 2021 | https://feifan.blog/posts/the-database-inside-your-codebase | <a href="https://web.archive.org/web/*/https://feifan.blog/posts/the-database-inside-your-codebase">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div role="main">
<div>
  <article>
    
      <p><img src="https://files.tanagram.app/file/tanagram-data/prod-feifans-blog/joshua-sortino-LqKhnDzSF-8-unsplash.jpg">
      </p>
<p>
Navigating codebases of any meaningful size is difficult. Most of a programmer’s time is spent jumping through the codebase, reading or skimming to build a mental model of the constructs and conventions within it. These constructs — among them: the DSLs, interfaces, and taxonomy of types that exist — are arguably the most important precursor to understanding where and how to make changes. But these constructs only exist in programmers’ heads. It’s difficult or impossible to navigate most codebases through the lens of those constructs; programmers lack “code browsers” that present the underlying code independently of files and the filesystem hierarchy. Yet code browsers that can do so — and we’ll look at some examples below — would be incredibly useful. This is because instances of these constructs can be thought of as records in a database, albeit an ad-hoc, poorly-specified database that can only be queried through carefully-crafted regexes<a href="#fn:1" id="fnref:1" title="see footnote">1</a>.</p>
<p>
In simple cases, some constructs manifest as naming conventions: prefixes in a name may be a rudimentary way to namespace classes<a href="#fn:2" id="fnref:2" title="see footnote">2</a>, while suffixes may be a rudimentary way to group classes or identify their type<a href="#fn:3" id="fnref:3" title="see footnote">3</a>. But these are easy examples; many patterns are much more subtle.</p>
<h2>
“Where is this used?”</h2>
<p>
Imagine figuring out “where is this used?”, for various types of “this”:</p>
<p>
Most code editors (perhaps paired with a <a href="https://microsoft.github.io/language-server-protocol/">language server</a>) can show you where local variables are used. This usually also works for finding where methods are invoked — although perhaps less reliably in dynamic-dispatch languages, or languages without types.</p>
<p>
What if you want to find where instances of a particular model get created? There may be multiple ways to create a model, so this isn’t super simple. In Rails, for example, there’s two built-in ways to create a model: you can either call <code>.new</code> to create a new instance in memory followed by <code>.save</code> to persist it to the database, or call <code>.create</code> to automatically do both. Your particular codebase might have additional wrappers for doing this that you’re supposed to use. Even worse, imagine that sometimes you create a <code>.new</code> instance, then set some properties on it over the next few lines, then finally call <code>.save</code>. Something like this:</p>
<pre><code>user = User.new
user.email = '<a href="https://feifan.blog/cdn-cgi/l/email-protection" data-cfemail="bed6dbd2d2d1fedbc6dfd3ced2db90ddd1d3">[email&nbsp;protected]</a>' unless self.anonymous?
user.save</code></pre>
<p>
Conceptually, that’s still code that creates an instance of a particular model. But with the intervening syntax, this would be a difficult case to find with <code>grep</code>.</p>
<h2>
Static config</h2>
<p>
At <a href="https://stripe.com/">Stripe</a>, where I work, we have a lot of code for jobs that need to run at certain times each day. For example, we might need to move funds from one financial partner to another at noon UTC each day. Each of these jobs has configuration code describing when and how it should be run, implemented as a <a href="https://www.jetbrains.com/mps/concepts/domain-specific-languages/">DSL</a>. This config might look something like this:</p>
<pre><code>run_config RunConfig.new(
  job_name: 'partner-daily-funding',
  env_vars: self.config_env,
  cron: RunConfig::Cron.new(
    schedule: { hour: 12, minute: 0 }
  ),
  owning_team: Company::Team::Liquidity
)</code></pre>
<p>
In our codebase, we have hundreds of these jobs, each with their own <code>run_config</code>. If you look at this codebase as a database, you can imagine these jobs being rows in a <code>jobs</code> table, where the fields on each row correspond to the parameters provided to the <code>RunConfig</code> class. </p>
<p>
Wouldn’t it be great to be able to browse all these jobs in a table? Maybe you could perform some basic operations on this data: searching for specific jobs by name or owning team; sorting by the time-of-day they’re scheduled to run; filtering for jobs owned by your team that have errored in the past week. Maybe you could edit the <code>run_config</code> from that interface (like you might edit a spreadsheet) and have it automatically make the corresponding change in the source code (or open a PR). Maybe you could even compute some aggregations on this data — for example, if you’re introducing a new job that requires some expensive computation, maybe you’d like to know which hours have the fewest other jobs scheduled. And of course, this job browser should be bidirectional with respect to the codebase — there should be a button beside each entry that shows the code for the job inline or opens the corresponding code in your editor.</p>
<h2>
Diffused concepts</h2>
<p>
Codebases typically contain logical concepts that are implemented across multiple pieces of code. This is often the case when you need to create multiple files to implement a particular feature.</p>
<p>
For example, in Rails, a “resource” is collectively implemented across a line in the router, a model file, a controller file, and a bunch of view files. Rails even ships with a code generator to <a href="https://github.com/rails/rails/blob/5f3ff60084ab5d5921ca3499814e4697f8350ee7/railties/lib/rails/generators/rails/resource/USAGE">create some of these files</a> for you. But despite resources being a core concept when working with Rails, there’s no good way to browse the resources in your codebase<a href="#fn:4" id="fnref:4" title="see footnote">4</a>. There’s no good way to filter or query your codebase either — you can’t, for example, see which resources support JSON vs XML params. </p>
<p>
For another example, consider pubsub (aka emitter-consumer) pipelines. In web services, when you have processing that can happen “in the background”, one service will publish an event; another service subscribes to that event and will do the background processing on its own when it receives the event. Often, these will form event “pipelines” or trees where an event consumer will emit additional events that are consumed by yet other services. These pipelines are concepts that developers talk about (as in, the “account creation pipeline” or “funding reconciliation pipeline”), but in most codebases the pipeline itself isn’t declared or reified anywhere in the code.</p>
<p>
If you’re looking at code that emits an event, how do you find the consumers? If you’re lucky, the event has a unique, literal name and the consumer uses that name literally as well. But maybe some subscribers are using wildcard event names, or names generated by string concatenation, and that becomes a lot harder to grep for. Likewise, if you’re looking at a consumer of an event, how do you find the locations in the codebase that could emit that event<a href="#fn:5" id="fnref:5" title="see footnote">5</a>?</p>
<p>
Wouldn’t it be great to be able to browse those pipelines in a table or perhaps a directed graph<a href="#fn:6" id="fnref:6" title="see footnote">6</a>? Maybe that graph would support some basic operations on this data: searching for specific publishers or subscribers by class name or event name; filtering for pipelines that have run into errors; maybe even showing the flow of a particular event given an event ID<a href="#fn:7" id="fnref:7" title="see footnote">7</a>. And of course, this pipeline browser should be bidirectional with respect to the codebase — there should be a button beside each graph node that shows the code for the publisher or subscriber inline or opens the corresponding code in your editor.</p>
<p>
For a final example, consider code that has functionality inherited from elsewhere. Some environments let you see a <a href="https://www.jetbrains.com/help/idea/viewing-structure-of-a-source-file.html">list of inherited properties</a> or methods, but this isn’t possible for more specialized cases. At Stripe, we have code that implements shell scripts that can take command-line arguments and flags. These arguments are defined via a DSL in the implementing code, but these commands can be subclassed, and there’s no way to see what the available arguments are while working in the subclass.</p>
<h2>
Philosophy</h2>
<p>
I think it’s important to consider these problems not as disparate cases in need of bespoke tooling, but as a <em>class</em> of problems characterized by a lack of access to the data structures embedded within codebases. Just like SQL databases and spreadsheets provide a singular querying abstraction and a set of visualization primitives that can be applied to any kind of data, programming environments need a singular querying abstraction and set of visualization primitives that can be applied to the concepts lurking in codebases. Getting there does <em>not</em> mean using proprietary drag-and-drop visual programming interfaces where the introspection capabilities are limited to whatever the programming environment happens to have implemented. Just the opposite — you should still be able to do whatever you want with your code (including treating it as plain-text files), <em>and also</em> have access to more advanced introspection tools that can query and slice your code — tools that let you easily understand and navigate complex codebases to reduce the <em>incidental complexity</em> of building software.</p>
<h2>
Solutions</h2>
<p>
I don’t have a solution to sell you here (at least, not yet!). But <a href="https://twitter.com/hirday_g/status/1356657607381946369">by popular demand</a> I think it’s worthwhile to at least discuss principles that solutions should embody and directionally-related prior art. </p>
<p>
To start with a simple example, see <a href="https://ihp.digitallyinduced.com/">IHP</a>, a full-stack web framework similar to Rails. It comes with a web interface for manipulating your project’s codebase and database schema. <a href="https://youtu.be/UbDtS_mUMpI?t=102">One point in the introduction video</a> showed changes being made in the visual schema editor being automatically reflected in the SQL code that describes the database schema — and changes being made to the SQL code being bidirectionally reflected in the visual schema editor. </p>
<p>
For a more in-depth example, consider <a href="https://pharo.org/">Pharo</a>, a Smalltalk environment. “Environment” in this case means that it feels like you’re using a custom OS (including global menus, idioms, and keyboard and mouse conventions) designed specifically for browsing, writing, and debugging programs in the Smalltalk programming language<a href="#fn:8" id="fnref:8" title="see footnote">8</a>. The holistic integration of these tools is important. Unlike the programming environments we cobble for ourselves today — where the editor is agnostic of the language and runtime and other tools like debuggers, inspectors, and code browsers are tacked on (if they exist at all) — it’s worth thinking about what an entire computing experience <em>for</em> writing and building custom tools might look like<a href="#fn:9" id="fnref:9" title="see footnote">9</a>.</p>
<p>
Pharo is also interesting because of its Class Browser, which looks like this:</p>
<p>
  <img src="https://files.tanagram.app/file/tanagram-data/prod-feifans-blog/database-codebase-pharo-browser.png" alt="Pharo class browser">
</p>
<p>
This browser breaks free from the source code <em>file</em> as the atomic unit of browsing; instead, it allows the user to browse one method at a time. Making the “unit of browsing” …</p></article></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://feifan.blog/posts/the-database-inside-your-codebase">https://feifan.blog/posts/the-database-inside-your-codebase</a></em></p>]]>
            </description>
            <link>https://feifan.blog/posts/the-database-inside-your-codebase</link>
            <guid isPermaLink="false">hacker-news-small-sites-26160186</guid>
            <pubDate>Tue, 16 Feb 2021 23:27:28 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Clubhouse Bio Generator]]>
            </title>
            <description>
<![CDATA[
Score 191 | Comments 70 (<a href="https://news.ycombinator.com/item?id=26159405">thread link</a>) | @ChrisArchitect
<br/>
February 16, 2021 | https://perchance.org/owh9gelu4t | <a href="https://web.archive.org/web/*/https://perchance.org/owh9gelu4t">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to extract article]]>
            </description>
            <link>https://perchance.org/owh9gelu4t</link>
            <guid isPermaLink="false">hacker-news-small-sites-26159405</guid>
            <pubDate>Tue, 16 Feb 2021 22:11:24 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Simtel.net MS-DOS Collection]]>
            </title>
            <description>
<![CDATA[
Score 119 | Comments 36 (<a href="https://news.ycombinator.com/item?id=26157165">thread link</a>) | @todsacerdoti
<br/>
February 16, 2021 | http://www.lanet.lv/simtel.net/msdos/index-msdos.html | <a href="https://web.archive.org/web/*/http://www.lanet.lv/simtel.net/msdos/index-msdos.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><p><table>
<tbody><tr><th></th><th><a name="0"> - 0 - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/00_info.html">00_info</a></b></td><td>Simtel.Net MS-DOS documentation, indexes</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/00_start.html">00_start</a></b></td><td>Essential info and utilities for beginners</td></tr>
<tr><th></th><th><a name="4"> - 4 - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/4dos.html">4dos</a></b></td><td>4DOS shell - replacement for COMMAND.COM</td></tr>
<tr><th></th><th><a name="A"> - A - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/ada.html">ada</a></b></td><td>Ada programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/ai.html">ai</a></b></td><td>Artificial Intelligence programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/animate.html">animate</a></b></td><td>Animation programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/apl.html">apl</a></b></td><td>The APL mathematics programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/arcers.html">arcers</a></b></td><td>Archiving and compressing programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/arcutils.html">arcutils</a></b></td><td>Utilities for using archives</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/asm_mag.html">asm_mag</a></b></td><td>The Assembly Language 'magazine'</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/asmutl.html">asmutl</a></b></td><td>Assembly language utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/astronmy.html">astronmy</a></b></td><td>Astronomical programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/autocad.html">autocad</a></b></td><td>Programs for Auto-CAD</td></tr>
<tr><th></th><th><a name="B"> - B - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/basic.html">basic</a></b></td><td>BASIC programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/batchutl.html">batchutl</a></b></td><td>Batch utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/bbs.html">bbs</a></b></td><td>BBS systems and support programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/bbsdoors.html">bbsdoors</a></b></td><td>BBS 'door' interfaces</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/bbslists.html">bbslists</a></b></td><td>BBS lists</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/bible.html">bible</a></b></td><td>Bible and searching tools</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/binaryed.html">binaryed</a></b></td><td>Binary file editors</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/biology.html">biology</a></b></td><td>Biology programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/bootutil.html">bootutil</a></b></td><td>Controlling the booting process</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/borland.html">borland</a></b></td><td>Borland product support</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/business.html">business</a></b></td><td>Business-related Programs</td></tr>
<tr><th></th><th><a name="C"> - C - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/c.html">c</a></b></td><td>C programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/cad.html">cad</a></b></td><td>Computer Aided Design</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/calculte.html">calculte</a></b></td><td>Calculators for math, finance, etc.</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/catalog.html">catalog</a></b></td><td>Disk catalog utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/cdrom.html">cdrom</a></b></td><td>CD-ROM utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/chemstry.html">chemstry</a></b></td><td>Chemistry programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/clipper.html">clipper</a></b></td><td>Clipper programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/clocks.html">clocks</a></b></td><td>Computer time utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/commprog.html">commprog</a></b></td><td>Terminal and file transfer programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/compress.html">compress</a></b></td><td>Compression utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/cpluspls.html">cpluspls</a></b></td><td>C++ programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/crossasm.html">crossasm</a></b></td><td>Cross-Assemblers</td></tr>
<tr><th></th><th><a name="D"> - D - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/database.html">database</a></b></td><td>Databases and programs to create them</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/dayo.html">dayo</a></b></td><td>DAYO business and accounting software</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/decode.html">decode</a></b></td><td>Encode/decode binary files to/from text</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/deskaces.html">deskaces</a></b></td><td>Handy Desk-Top utilities and programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/deskpub.html">deskpub</a></b></td><td>Desktop publishing</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/desqview.html">desqview</a></b></td><td>DESQview utilities and programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/dirutl.html">dirutl</a></b></td><td>Directory utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/disasm.html">disasm</a></b></td><td>Disassemblers: Convert executables to ASM</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/diskutil.html">diskutil</a></b></td><td>Disk utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/dv_x.html">dv_x</a></b></td><td>Programs and utilities for DESQview-X</td></tr>
<tr><th></th><th><a name="E"> - E - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/editor.html">editor</a></b></td><td>Text editors</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/educate.html">educate</a></b></td><td>Programs for education</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/eel.html">eel</a></b></td><td>Epsilon editor EEL extensions</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/electrcl.html">electrcl</a></b></td><td>Electrical engineering programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/emulate.html">emulate</a></b></td><td>Emulators</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/engin.html">engin</a></b></td><td>Engineering Programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/envutil.html">envutil</a></b></td><td>Manipulating environment variables</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/execomp.html">execomp</a></b></td><td>Compress EXE and COM files to save disk space</td></tr>
<tr><th></th><th><a name="F"> - F - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/fileutil.html">fileutil</a></b></td><td>File management and conversion utils</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/finance.html">finance</a></b></td><td>Financial software</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/flowchrt.html">flowchrt</a></b></td><td>Flowchart Generators</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/foods.html">foods</a></b></td><td>Food recipes</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/forms.html">forms</a></b></td><td>Form Generators and Forms Entry Programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/forth.html">forth</a></b></td><td>Forth programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/fortran.html">fortran</a></b></td><td>FORTRAN programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/fossil.html">fossil</a></b></td><td>FOSSIL drivers and utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/freemacs.html">freemacs</a></b></td><td>Emacs-like editor (small)</td></tr>
<tr><th></th><th><a name="G"> - G - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/genealgy.html">genealgy</a></b></td><td>Genealogy programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/geogrphy.html">geogrphy</a></b></td><td>Geography programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/geology.html">geology</a></b></td><td>Geology programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/gif.html">gif</a></b></td><td>Programs to make/view/print/convert GIF files</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/graph.html">graph</a></b></td><td>Graphing programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/graphics.html">graphics</a></b></td><td>Graphics programs</td></tr>
<tr><th></th><th><a name="H"> - H - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/hamradio.html">hamradio</a></b></td><td>Ham Radio programs and information</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/handicap.html">handicap</a></b></td><td>Programs for the handicapped</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/health.html">health</a></b></td><td>Health, Fitness, and Medical</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/html.html">html</a></b></td><td>HTML Tools</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/hypertxt.html">hypertxt</a></b></td><td>Hyper-Text files and programs</td></tr>
<tr><th></th><th><a name="I"> - I - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/imail.html">imail</a></b></td><td>IMAIL FidoNet echomail processor</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/info.html">info</a></b></td><td>Information and documentation files</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/install.html">install</a></b></td><td>Program installation utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/internet.html">internet</a></b></td><td>Programs and utils for use on the Internet</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/io_utils.html">io_utils</a></b></td><td>I/O Utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/irit.html">irit</a></b></td><td>Polygonal solid modeler &amp; C++ source</td></tr>
<tr><th></th><th><a name="K"> - K - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/keyboard.html">keyboard</a></b></td><td>Keyboard utilities</td></tr>
<tr><th></th><th><a name="L"> - L - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/lan.html">lan</a></b></td><td>Programs for use on Local Area Networks</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/langtutr.html">langtutr</a></b></td><td>Tutorials on foreign languages</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/laser.html">laser</a></b></td><td>Laser printer utilities and fonts</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/legal.html">legal</a></b></td><td>Law-related programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/lingstcs.html">lingstcs</a></b></td><td>Linguistics</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/literatr.html">literatr</a></b></td><td>Teach/learn literature</td></tr>
<tr><th></th><th><a name="M"> - M - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/mailnews.html">mailnews</a></b></td><td>E-mail and Usenet News programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/mapping.html">mapping</a></b></td><td>Map programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/math.html">math</a></b></td><td>Mathematics programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/mcintosh.html">mcintosh</a></b></td><td>Convert Macintosh files to DOS format</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/memutil.html">memutil</a></b></td><td>Computer memory info and management utils</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/menu.html">menu</a></b></td><td>Creating and using menus</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/microsft.html">microsft</a></b></td><td>Microsoft product support</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/misclang.html">misclang</a></b></td><td>Misc. program languages</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/mmedia.html">mmedia</a></b></td><td>Multimedia Programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/mormon.html">mormon</a></b></td><td>The Book of Mormon</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/mouse.html">mouse</a></b></td><td>Utilities for the mouse</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/music.html">music</a></b></td><td>Programs for writing and playing music</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/muslum.html">muslum</a></b></td><td>The Holy Book of Muslum</td></tr>
<tr><th></th><th><a name="N"> - N - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/naplps.html">naplps</a></b></td><td>NAPLPS drawing program</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/ncsatlnt.html">ncsatlnt</a></b></td><td>NCSA Telnet TCP/IP package</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/nettamer.html">nettamer</a></b></td><td>Net-Tamer DOS PPP dial up access program</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/network.html">network</a></b></td><td>Utilities for computer networks</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/neurlnet.html">neurlnet</a></b></td><td>Neural Networks</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/nfs.html">nfs</a></b></td><td>Network File System utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/notabene.html">notabene</a></b></td><td>Notabene word processor utils</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/novell.html">novell</a></b></td><td>Novell LAN utilities</td></tr>
<tr><th></th><th><a name="P"> - P - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/packet.html">packet</a></b></td><td>Programs for Packet Radio</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/pascal.html">pascal</a></b></td><td>Pascal programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/pcboard.html">pcboard</a></b></td><td>PC Board BBS software</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/pcmag.html">pcmag</a></b></td><td>'PC Magazine' listings and utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/pctech.html">pctech</a></b></td><td>'PC Tech Journal' listings and utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/perl.html">perl</a></b></td><td>Perl programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/pgmtips.html">pgmtips</a></b></td><td>Programming Tips &amp; Tricks Magazine</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/pgmutl.html">pgmutl</a></b></td><td>Programming utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/pktdrvr.html">pktdrvr</a></b></td><td>TCP/IP/IPX/ODI packet drivers</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/plot.html">plot</a></b></td><td>Programs for plotters</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/postscrp.html">postscrp</a></b></td><td>PostScript view/print utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/printer.html">printer</a></b></td><td>Printer utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/progjorn.html">progjorn</a></b></td><td>Programmers Journal</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/projmgmt.html">projmgmt</a></b></td><td>Project Management programs</td></tr>
<tr><th></th><th><a name="Q"> - Q - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/qbasic.html">qbasic</a></b></td><td>Quick BASIC and QBasic programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/qmodem.html">qmodem</a></b></td><td>Qmodem comm program &amp; utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/qtrdeck.html">qtrdeck</a></b></td><td>Quarterdeck utilities and technical notes</td></tr>
<tr><th></th><th><a name="R"> - R - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/ramdisk.html">ramdisk</a></b></td><td>Memory resident disks</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/rbbs.html">rbbs</a></b></td><td>RBBS-PC BBS and support utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/recreatn.html">recreatn</a></b></td><td>Recreation and passtime-related programs</td></tr>
<tr><th></th><th><a name="S"> - S - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/satelite.html">satelite</a></b></td><td>Communication satellite programs and listings</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/schedule.html">schedule</a></b></td><td>Schedule automatic program runs (like cron)</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/science.html">science</a></b></td><td>Miscellaneous science related material</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/screen.html">screen</a></b></td><td>Video screen utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/security.html">security</a></b></td><td>Improve computer security</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/semware.html">semware</a></b></td><td>SemWare editors, utilities and support files</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/simulatn.html">simulatn</a></b></td><td>Simulation programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/sound.html">sound</a></b></td><td>Computer sound programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/sports.html">sports</a></b></td><td>Sports programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/spredsht.html">spredsht</a></b></td><td>Spreadsheet programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/statstcs.html">statstcs</a></b></td><td>Statistics programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/surfmodl.html">surfmodl</a></b></td><td>Surface modeling programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/swap.html">swap</a></b></td><td>Free working memory by swaping to high mem</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/sysinfo.html">sysinfo</a></b></td><td>Computer system information display programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/sysutl.html">sysutl</a></b></td><td>System utilities</td></tr>
<tr><th></th><th><a name="T"> - T - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/tcpip.html">tcpip</a></b></td><td>TCP/IP programs (ka9q, etc.)</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/teaching.html">teaching</a></b></td><td>Programs to assist teachers</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/telegard.html">telegard</a></b></td><td>Telegard BBS program &amp; utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/telix.html">telix</a></b></td><td>Telix communications program</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/termnate.html">termnate</a></b></td><td>Terminate Terminal/Communications program</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/tex.html">tex</a></b></td><td>TeX type setting program</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/tiff.html">tiff</a></b></td><td>TIFF graphics format programs and information</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/torah.html">torah</a></b></td><td>Torah-related programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/travel.html">travel</a></b></td><td>Travel planning and information</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/tsrutil.html">tsrutil</a></b></td><td>Terminate and stay resident utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/turbo_c.html">turbo_c</a></b></td><td>Borland Turbo C programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/turbobas.html">turbobas</a></b></td><td>Borland's Turbo Basic programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/turbopas.html">turbopas</a></b></td><td>Borland Turbo Pascal programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/turbovis.html">turbovis</a></b></td><td>Turbo Vision programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/txtutl.html">txtutl</a></b></td><td>Text utilities</td></tr>
<tr><th></th><th><a name="U"> - U - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/ubasic.html">ubasic</a></b></td><td>UBASIC: Ultra high-precision BASIC for math</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/uemacs.html">uemacs</a></b></td><td>MicroEmacs text editor</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/uucp.html">uucp</a></b></td><td>Unix to Unix Copy for MS-DOS</td></tr>
<tr><th></th><th><a name="V"> - V - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/vga.html">vga</a></b></td><td>VGA monitor utilities</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/virus.html">virus</a></b></td><td>Virus detection and removal programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/visbasic.html">visbasic</a></b></td><td>Visual Basic programming language</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/viscii.html">viscii</a></b></td><td>Vietnamese character programs</td></tr>
<tr><th></th><th><a name="W"> - W - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/waffle.html">waffle</a></b></td><td>Waffle bulletin board system</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/weather.html">weather</a></b></td><td>Weather forecasting</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/wordperf.html">wordperf</a></b></td><td>WordPerfect word processing</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/worldmap.html">worldmap</a></b></td><td>A digitized map of the world</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/wwiv.html">wwiv</a></b></td><td>WWIV BBS</td></tr>
<tr><th></th><th><a name="X"> - X - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/x_10.html">x_10</a></b></td><td>X-10 Powerhouse computer programs</td></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/xwindows.html">xwindows</a></b></td><td>X Windows Server and Support Programs</td></tr>
<tr><th></th><th><a name="Z"> - Z - </a></th></tr>
<tr><td><b><a href="http://www.lanet.lv/simtel.net/msdos/zmodem.html">zmodem</a></b></td><td>Zmodem file transfer protocol</td></tr>
</tbody></table></p></div>]]>
            </description>
            <link>http://www.lanet.lv/simtel.net/msdos/index-msdos.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-26157165</guid>
            <pubDate>Tue, 16 Feb 2021 18:36:59 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[AirPods as a Platform]]>
            </title>
            <description>
<![CDATA[
Score 121 | Comments 127 (<a href="https://news.ycombinator.com/item?id=26156881">thread link</a>) | @sc90
<br/>
February 16, 2021 | https://julian.digital/2020/04/19/airpods-as-a-platform/ | <a href="https://web.archive.org/web/*/https://julian.digital/2020/04/19/airpods-as-a-platform/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
 		
<p><span>01</span> Intro</p>



<p>One of the favorite activities of tech analysts, VCs and similar Twitter armchair experts is to predict what the next big technology platform might be.</p>



<p>The usual suspects that come up in these conversations are VR/AR, crypto, smart speakers and similar IoT devices. A new contestant that I’ve <a href="https://twitter.com/BrianNorgard/status/1108755070642880512">seen</a> <a href="https://www.aboveavalon.com/notes/2019/11/19/airpods-are-becoming-a-platform">come up</a> <a href="https://twitter.com/chrismessina/status/1177619897884368904">more</a> <a href="https://twitter.com/HarryStebbings/status/1215425809944543240">frequently</a> in these debates recently are Apple’s AirPods.</p>



<p>Calling AirPods “the next big platform” is interesting because at the moment, they are not even a small platform. They are no platform at all. They are just a piece of hardware. </p>



<p>But that doesn’t mean they can’t become platform.</p>



<p><img src="https://julian.digital/wp-content/uploads/2020/04/platform.png"></p><p><span>02</span> What is a platform?</p>



<p>Let’s first take a look at what a platform actually is.</p>



<p>At its core, a platform is something that others can build on top of. A classic example would be an operating system like iOS: By providing a set of APIs, Apple created a playground for developers to build and run applications on. In fact, new input capabilities such as the touch interface, gyroscope sensor and camera allowed developers to create unique applications that weren’t possible before. </p>



<p>Platforms are subject to network effects: More applications attract more users to the platform, while more users in turn attract more developers who build more apps. </p>



<p><img src="https://julian.digital/wp-content/uploads/2020/04/flywheel.png"></p><p>It’s a classic flywheel effect that creates powerful winner-takes-all dynamics. This explains why there are only two (meaningful) mobile operating systems – iOS and Android. </p>



<p>It also explains why everyone is so interested in upcoming platforms – and why Apple might be interested in making AirPods a platform.</p>



<p><span>03</span> Why AirPods aren’t a platform</p>



<p>In their current form, AirPods are not a platform. They don’t provide any unique input or output functionalities that developers could leverage. Active Noise Cancellation and Transparency Mode are neat but not new or Airpods-exclusive features – other headphones offer exactly the same. In either case, developers don’t have any control over them and thus can’t build applications that use these functionalities.</p>



<p>Some say that AirPods will give rise to more audio apps because they are “always in” which in turn will lead to more (and perhaps new forms of) audio content. That might be true – content providers are always looking for <a href="http://julian.digital/2020/01/26/newsletters-and-alternative-trade-routes/">alternative routes</a> to get consumers’ attention – but, again, it does not make AirPods a platform. You can use any other pair of headphones to use these audio apps as well.</p>



<p>If Apple wants to make AirPods a platform, it needs to open up some part of the AirPods experience to developers so that they can build new things on top of it.</p>



<p><span>04</span> On Siri &amp; Voice Platforms</p>



<p>The most obvious choice here is Siri, which is already integrated into every pair of AirPods.</p>



<p>In contrast to other voice assistants like Alexa and Google Assistant, Apple has never really opened up Siri for 3rd-party developers. If they did, it would create a new platform that could have its own ecosystem of apps and developers.</p>



<p>But I’m not convinced that this is Apple’s best option.<br>Let me explain why.</p>



<p>Opening up Siri wouldn’t make AirPods a platform, it would make Siri a platform. This might sound like a technicality, but I think it’s an important difference. As <a href="https://twitter.com/einkoenig">Jan König</a> <a href="https://context-first.com/alexa-please-send-this-to-my-screen-6f4839eb415a">brilliantly summarized in this article</a>, voice isn’t an interface for <em>one</em> device – it’s an interface <em>across</em> devices. It’s more of a meta-layer that should tie different products together to enable multi-device experiences.</p>



<p>This means Apple has little interest in making Siri an AirPods-exclusive. Voice-based computing works best when it’s everywhere. It’s about reach, not exclusivity. This is part of the reason why Google and Amazon excel at it.</p>



<p>At the moment, Siri’s capabilities are considerably behind those of Google Assistant and Alexa. Again, this isn’t overly surprising: Google’s and Amazon’s main job is finding the right answers to users’ questions. The required ML capabilities for a smart assistant are among the core competencies of these two companies.</p>



<p>But even Amazon and Google haven’t really figured out the platform part yet, as indicated by the lack of breakout 3rd-party voice applications. It seems like the two platforms are still looking for their product-market-fit beyond being just cheap speakers that you can also control with your voice.</p>



<p>This is partly because the above-mentioned use case of voice as a cross-device layer isn’t something developers can build with the current set of APIs. </p>



<p><img src="https://julian.digital/wp-content/uploads/2020/04/voiceonlyinterfaces-3.png"></p><p>The other big reason I see is that people are mistaking voice as a replacement for other interfaces. Movies like <a href="https://www.youtube.com/watch?v=ne6p6MfLBxc">Her</a> paint a future where human-computer-interaction primarily occurs via voice-powered smart assistants, but in reality, voice isn’t great as a primary or stand-alone interface. It works best as an *additional* input/output channel that augments whatever else you are doing.</p>



<p>Let me give you an example: Saying “Hey Google, turn up the volume” takes 10x longer than simply pressing the volume-up button on your phone. It only makes sense when your hands are busy doing other things (kitchen work, for example).</p>



<p>The most convincing voice app I have seen to date was at a hackathon where a team <a href="https://upsidelab.io/blog/design-voice-user-interface-starcraft/">used the StarCraft API to build voice-enabled game commands</a>. Not to replace your mouse and keyboard but to give you an additional input mechanism. Actual multitasking.</p>



<p><span>05</span> What Apple Should Build</p>



<p>I’m not against Apple opening Siri for developers. On the contrary, given that AirPods are meant to be worn all the time, a voice interface for situations that require multitasking is actually a very good idea. But voice input should remain the exceptional case. And it shouldn’t be what makes AirPods a platform.</p>



<p>Instead of voice, I’d love to see other input mechanisms that allow developers to build new ways for users to interact with the audio content they consume.</p>



<p>Most headsets currently on the market offer the following actions with one (or multiple) clicks of a physical button:</p>



<p><img src="https://julian.digital/wp-content/uploads/2020/04/earpodsremote-1.png"></p><p>These inputs were invented a long time ago and there has been almost zero innovation since. <strong>Why has no one thought about additional buttons or click mechanisms that allow users to interact with the actual content?</strong></p>



<p>For example, when listening to podcasts I often find myself wanting to bookmark things that are being talked about. It would be amazing if I could simply tap a button on my headphones which would add a timestamp to a bookmarks section of my podcast app. <span>(Or better even, a transcript of the ~15 seconds of content before I pressed the button, which are then also automatically added to my notes app via an Apple Shortcut.)</span></p>



<p>Yes, you could build the same with voice as the input mechanism, but as we discussed earlier, saying <em>“Hey Siri, please bookmark this!”</em> just doesn’t seem very convenient.</p>



<p>While podcast apps might use the additional button as a bookmarking feature, Spotify could make it a Like button to quickly add songs to your Favorites playlist. Other developers could build completely new applications: Think about interactive audiobooks or similar two-way audio experiences, for example. </p>



<p>This is the beauty of platforms: You just provide developers with a set of tools and they will come up with use cases you hadn’t even thought about. Crowdsourced value creation.</p>



<p><span>06</span> Closing Thoughts</p>



<p>(1) The input mechanism I describe doesn’t have to be a physical button. In fact, gesture-based inputs might be even more convenient. If AirPods had built-in accelerometers, users could interact with audio content by nodding or shaking their heads. Radar-based sensors like Google’s Motion Sense could also create an interesting new interaction language for audio content.</p>



<p>(2) You could also think about the Apple Watch as the main input device. In contrast to the AirPods, Apple opened the Watch for developers from the start, but it hasn’t really seen much success as a platform. Perhaps a combination of Watch and AirPods has a better chance of creating an ecosystem with its own unique applications?</p>



<p>(3) One thing to keep in mind is that Apple doesn’t really have an interest in making AirPods a standalone platform. The iPhone (or rather iOS) will always be the core platform that Apple cares about. Instead of separate iPhone, Watch and AirPods ecosystems, think about Apple’s strategy as more of a multi-platform bundle. Even as a platform, AirPods will remain more of an accessory that adds stickiness to the existing iPhone ecosystem.</p>



<p><img src="https://julian.digital/wp-content/uploads/2020/04/fullcycle.png"></p>



<p>Do you have thoughts or feedback on this post?<br>If so, <a href="https://twitter.com/lehrjulian/status/1251919017721421827">I’d love to hear it</a>!</p>



<p><span><i>Thanks to <a href="https://twitter.com/einkoenig">Jan König</a> for reading drafts of this post.</i></span>
 	</p></div></div>]]>
            </description>
            <link>https://julian.digital/2020/04/19/airpods-as-a-platform/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26156881</guid>
            <pubDate>Tue, 16 Feb 2021 18:11:08 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Bitcoin’s Overnight Collapse Probability Is About 50%]]>
            </title>
            <description>
<![CDATA[
Score 101 | Comments 209 (<a href="https://news.ycombinator.com/item?id=26155158">thread link</a>) | @dgellow
<br/>
February 16, 2021 | http://www.tr0lly.com/bitcoin/bitcoins-overnight-collapse-probability-is-about-50/ | <a href="https://web.archive.org/web/*/http://www.tr0lly.com/bitcoin/bitcoins-overnight-collapse-probability-is-about-50/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="content">

	<section id="primary">
		<main id="main">

			
<article id="post-1154">
	
	<div>
		
<p>If you ever had a look at <a href="https://www.cmegroup.com/trading/equity-index/us-index/bitcoin_quotes_globex.html">CME’s Bitcoin futures</a>, you might have noticed that there are multiple contracts – one for each month, and that they have different prices. Systematically, the futures contracts for months that are further away, are more expensive than those with closer expiration, and also cheaper than spot. When this happens for a commodity like oil, we’re talking about contango.</p>



<p>This is usually due to the fact that there’s a risk premium on the uncertainty of the future, and it costs a little bit to be sure of the price that you’ll pay for something three months from now. But for futures on financial products, it’s very rare. Currently, the premium for Bitcoin is a whopping 2% per month, and it’s a red warning sign.</p>



<h3>Term structure of Bitcoin futures</h3>



<p>The reason contango for commodities like oil is normal, is that you can’t arbitrage it. The way to arbitrage contango is to buy spot, short the future, wait till expiry, and collect the premium. But you can’t simply “wait” when you buy thousands of barrels of oil – you have to store those barrels somewhere, and it will cost you an arm and a leg. The storage costs will eat up your contango premium, plus some.</p>



<p>There were occurrences in the past where traders were able to arbitrage this premium, but the contango needed to be absolutely off-the-charts (“super-contango”). For instance, after the 2008 financial panic, the spread between spot and futures in the oil market was so big, <a href="https://doc.rero.ch/record/323428/files/TDIBM_Loris_Beltramello.pdf">traders would literally rent tankers and use them as storage facilities</a> for oil, waiting for their futures leg to mature.</p>



<p>The reason contango for financial products isn’t normal, is that you can arbitrage it very easily, as you don’t have storage costs. You buy Bitcoin spot, sell an April future for 4% more than spot, and simply wait two months.</p>



<figure><img src="http://www.tr0lly.com/wp-content/uploads/2021/02/Screen-Shot-2021-02-16-at-13.42.35.png" alt="" srcset="http://www.tr0lly.com/wp-content/uploads/2021/02/Screen-Shot-2021-02-16-at-13.42.35.png 952w, http://www.tr0lly.com/wp-content/uploads/2021/02/Screen-Shot-2021-02-16-at-13.42.35-300x79.png 300w, http://www.tr0lly.com/wp-content/uploads/2021/02/Screen-Shot-2021-02-16-at-13.42.35-768x203.png 768w" sizes="(max-width: 952px) 100vw, 952px"></figure>



<p>At expiry, you’ll sell your Bitcoin at a certain price, while the future will settle at the exact same price, and you’ll collect the premium. Your only cost is the carry, i.e. the interest you have forfeited on the cash you used to buy Bitcoin, but this is virtually zero today.</p>



<p>Why the premium, then? Why don’t hedge funds with hundreds of billions of dollars to spare don’t arbitrage the Bitcoin contango down to zero?</p>



<h3>Credit risk?</h3>



<p>One quick answer would be that you aren’t guaranteed to close your trade because of counterparty risk. This is what happened when Lehman went bust – all the hedge funds that had OTC derivatives positions with Lehman as one leg of a trade, suddenly saw the “Lehman leg” disappear, while the other leg was still there. Lehman going bust single handedly destroyed the convertible bonds market, as hedge funds who had bought convertible bonds and hedged their risks (credit, volatility, equity risks – you name it) with Lehman, suddenly were out of hedges, and had to sell their cash position (their convertible bonds) at literally any price.</p>



<p>But there is no counterparty risk here. You can’t lose your Bitcoins – you just keep them on chain, and no exchange going bust will affect your position. CME can’t go bust – it has margin calls, initial margin deposits, has a guarantee fund, and is almost explicitly guaranteed by the Fed because of its critical importance to financial markets.</p>



<p>So, again, why is nobody picking those hundred dollar bills lying on the street?</p>



<h3>Systemic risk</h3>



<p>There is one risk that you can’t edge – that of the world collapsing overnight, when there’s nobody left to pay you even if you win your bet. Imagine shorting USDT on Binance. What happens if you’re right and USDT goes to zero? Do you really think Binance will still be around to pay you?</p>



<p>You can always say, “bah, I’ll see it coming, the moment shit starts to hit the fan, I’ll close my positions”. But what if you don’t have the time to do so? What if a black swan event happens overnight?</p>



<p>This is the risk with Bitcoin. A whim from regulators, like passing the STABLE act, and all USDT exchanges go bust. What will happen to Bitcoin futures then? CME uses the “<a href="https://www.cmegroup.com/trading/cryptocurrency-indices.html">Bitcoin Reference Rate</a>” (BRR) to calculate the spot for its Bitcoin futures, which is a weighted average of the spots taken from multiple crypto exchanges, the list of which changes over time. What happens if the Bitcoin ecosystem collapses, the prices of Bitcoin on half of those exchanges go to 100,000 on paper because those exchanges become insolvent and people rush for the exits by buying Bitcoin to try and send it to their own wallets (as happened with MtGox)? Futures skyrocket because of a technicality, CME is slow to react, and you get wiped out on your “short futures” leg – while you can’t really sell the “long Bitcoin” leg either, because every exchange is on fire and nobody processes redemption requests.</p>



<h3>Implied probability of default</h3>



<p>This risk is rewarded handsomely – a big fat 2% per month. With interest rates at zero, we can borrow a formula from the Credit Default Swaps market to calculate the <a href="https://quant.stackexchange.com/questions/15986/how-to-compute-the-implied-probability-of-default-from-a-cds-spread#:~:text=Risk%2Dneutral%20default%20probability%20implied,R%20is%20the%20recovery%20rate.&amp;text=Hulls%20equation%20is%20a%20gross,works%20for%20all%20tenor%20points.">implied probability of default</a>, which we’ll <a href="http://nzz-files-prod.s3-website-eu-west-1.amazonaws.com/files/4/1/2/cds+deutsche+bank+161214_1.18446412.pdf">simplify to the extreme</a>:</p>



<p><strong>p = S/(1-R)</strong></p>



<p>Where p is the probability of default, S the annual “swap rate” that compensates for that probability, and R the recovery rate, i.e. how much you can expect to recoup from your investment if a default occurs.</p>



<p>In our case, S = 24% (12 months in a year, at 2% for each month), and R ≈ 50% based on what happened after MtGox collapsed. This means that we assume you’ll be able to cash out in the event of an apocalypse with an average 50% loss. Remember, this is assuming that you are hedged!</p>



<p>This gives us an implied probability of default p ≈ 50% over the next year. Again, that’s the probability of the whole Bitcoin ecosystem collapsing overnight, not giving you the time to close your positions, cutting you off from exchanges, and where CME futures no longer trade.</p>



<p>This is the risk as it’s being priced by the market, on relatively liquid financial instruments. So the next time someone tries to explain to you that “Bitcoin is a store of value”, when the chances of it getting utterly destroyed overnight before the year is over are around 50/50, try not to shoot coffee through your nose laughing.</p>
	</div><!-- .entry-content -->

	<!-- .entry-footer -->

			
</article><!-- #post-${ID} -->

	<nav role="navigation">
		<h2>Post navigation</h2>
		
	</nav>
<!-- #comments -->

		</main><!-- #main -->
	</section><!-- #primary -->


	</div></div>]]>
            </description>
            <link>http://www.tr0lly.com/bitcoin/bitcoins-overnight-collapse-probability-is-about-50/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26155158</guid>
            <pubDate>Tue, 16 Feb 2021 16:04:35 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Computers Aren't Fun Anymore (2020)]]>
            </title>
            <description>
<![CDATA[
Score 72 | Comments 71 (<a href="https://news.ycombinator.com/item?id=26154754">thread link</a>) | @hacksilver
<br/>
February 16, 2021 | https://feifan.blog/posts/computers-arent-fun-anymore | <a href="https://web.archive.org/web/*/https://feifan.blog/posts/computers-arent-fun-anymore">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div role="main">
<div>
  <article>
    
      <p><img src="https://files.tanagram.app/file/tanagram-data/prod-feifans-blog/penny-farthing.jpeg">
      </p>
<p>
Throughout <a href="https://www.amazon.com/Dream-Machine-M-Mitchell-Waldrop/dp/1732265119"><em>The Dream Machine</em></a>, a history of the early days of computing, tinkering and having fun was a recurring theme throughout the decades. I wasn’t around to experience the early days of computers myself, but they seemed to be genuinely exciting and rewarding. In the words of MIT sociologist Sherry Turkle: computers empowered their users, making them feel smart[er], “in control”, and “more fully participant in the future”. </p>
<p>
Those feel like odd descriptions for the modern computing experience. Using computers today doesn’t feel like￼ an empowering experience￼. Sometimes it’s mindless and distracting. Sometimes, when a redesign rolls out, or laptop doesn’t wake from sleep mode,￼ it’s downright hostile. The experience of using a computer in 2020 is a concoction of data silos, dinging notifications and reinvented wheels, presented in gratuitously bubble-wrapped UIs hyper-optimized by persnickety product managers and soulless A/B tests. </p>
<p>
For most people, the computing experience is <a href="https://feifan.blog/2020/06/22/no-one-cares-about-software-quality/">clicking around a lot</a>, typing into disparate apps in which your data is trapped except through narrowly-defined, bespoke integrations, and struggling to find <em>that thing you were just reading a few days ago</em> among all the silos. This doesn’t make anyone feel smarter or more in control. It’s simply frustrating.</p>
<p>
Software <em>development</em> is stuck in the doldrums too. A massive amount of cumulative engineering effort is spent rebuilding the same primitives<a href="#fn:1" id="fnref:1" title="see footnote">1</a> because the software engineering industry hasn’t convincingly developed platforms at higher levels of abstraction<a href="#fn:2" id="fnref:2" title="see footnote">2</a>. A significant portion of development effort goes to placating not-invented-here-ness, where companies feel the need to build their own version of every feature, each slightly different (user familiarity be damned). A lot of software is little more than looking up API documentation and plugging one into another. There’s a dearth of creativity, of joy and discovery, of inventing something interesting and new. </p>
<p>
To be fair, computers — both the desktop kind and various mobile kinds — enable<a href="#fn:3" id="fnref:3" title="see footnote">3</a> seemingly-impossible<a href="#fn:4" id="fnref:4" title="see footnote">4</a> things<a href="#fn:5" id="fnref:5" title="see footnote">5</a>. But it feels frustrating to see the pioneering spirit that originally led to the development of modern computers giving way to uninspired flat interfaces<a href="#fn:6" id="fnref:6" title="see footnote">6</a> and <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> SaaS apps. The things you can do are limited to bespokely-implemented features, dribbled out only as fast as a small team of designers and developers can think of and build them. Of course you have an extensive list of things you <em>wish</em> your phone/computer/most-used apps could do; everyone does. You know the majority of it will remain a wishlist; there’s almost no hope of the feature you really want being implemented<a href="#fn:7" id="fnref:7" title="see footnote">7</a>. This isn’t empowering. What’s more, new features tend to be one-off improvements and ungainly new ways for you to do more work<a href="#fn:8" id="fnref:8" title="see footnote">8</a> rather than adding or improving functionality in a generalized way so you can remix functionality and do things faster.</p>
<p>
For the people who’ve figured out the right incantations to type and buttons-buried-in-submenus to click, computers can automate administrivia, surface information, and make them feel “more fully participant in the future”. But getting there is an arduous journey, and many people get in a place where computers just make things harder. The experience of using computers is, in various ways, awkward and frustrating (and maybe even dangerous<a href="#fn:9" id="fnref:9" title="see footnote">9</a>) for everyone. Computers were supposed to be bicycles for the mind. So far we only have penny-farthings.</p>

  </article>
</div>
    </div></div>]]>
            </description>
            <link>https://feifan.blog/posts/computers-arent-fun-anymore</link>
            <guid isPermaLink="false">hacker-news-small-sites-26154754</guid>
            <pubDate>Tue, 16 Feb 2021 15:30:01 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Why Is Esbuild Fast?]]>
            </title>
            <description>
<![CDATA[
Score 294 | Comments 150 (<a href="https://news.ycombinator.com/item?id=26154509">thread link</a>) | @mef
<br/>
February 16, 2021 | https://esbuild.github.io/faq/#why-is-esbuild-fast | <a href="https://web.archive.org/web/*/https://esbuild.github.io/faq/#why-is-esbuild-fast">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
      
      <p>This is a collection of common questions about esbuild. You can also ask questions on the <a href="https://github.com/evanw/esbuild/issues">GitHub issue tracker</a>.</p>
      <ul>
        <li><a href="#why-is-esbuild-fast">Why is esbuild fast?</a></li>
        <li><a href="#benchmark-details">Benchmark details</a></li>
        <li><a href="#upcoming-roadmap">Upcoming roadmap</a></li>
        <li><a href="#production-readiness">Production readiness</a></li>
      </ul>
      <h2 id="why-is-esbuild-fast">
        <a href="#why-is-esbuild-fast">#</a>
        Why is esbuild fast?
      </h2>
      <p>Several reasons:</p>
      <ul><li><p> It's written in <a href="https://golang.org/">Go</a> and compiles to native code. </p> <p> Most other bundlers are written in JavaScript, but a command-line application is a worst-case performance situation for a JIT-compiled language. Every time you run your bundler, the JavaScript VM is seeing your bundler's code for the first time without any optimization hints. While esbuild is busy parsing your JavaScript, node is busy parsing your bundler's JavaScript. By the time node has finished parsing your bundler's code, esbuild might have already exited and your bundler hasn't even started bundling yet. </p> <p> In addition, Go is designed from the core for parallelism while JavaScript is not. Go has shared memory between threads while JavaScript has to serialize data between threads. Both Go and JavaScript have parallel garbage collectors, but Go's heap is shared between all threads while JavaScript has a separate heap per JavaScript thread. This seems to cut the amount of parallelism that's possible with JavaScript worker threads in half <a href="https://github.com/evanw/esbuild/issues/111#issuecomment-719910381">according to my testing</a>, presumably since half of your CPU cores are busy collecting garbage for the other half. </p></li><li><p> Parallelism is used heavily. </p> <p> The algorithms inside esbuild are carefully designed to fully saturate all available CPU cores when possible. There are roughly three phases: parsing, linking, and code generation. Parsing and code generation are most of the work and are fully parallelizable (linking is an inherently serial task for the most part). Since all threads share memory, work can easily be shared when bundling different entry points that import the same JavaScript libraries. Most modern computers have many cores so parallelism is a big win. </p></li><li><p> Everything in esbuild is written from scratch. </p> <p> There are a lot of performance benefits with writing everything yourself instead of using 3rd-party libraries. You can have performance in mind from the beginning, you can make sure everything uses consistent data structures to avoid expensive conversions, and you can make wide architectural changes whenever necessary. The drawback is of course that it's a lot of work. </p> <p> For example, many bundlers use the official TypeScript compiler as a parser. But it was built to serve the goals of the TypeScript compiler team and they do not have performance as a top priority. Their code makes pretty heavy use of <a href="https://mrale.ph/blog/2015/01/11/whats-up-with-monomorphism.html">megamorphic object shapes</a> and unnecessary <a href="https://github.com/microsoft/TypeScript/issues/39247">dynamic property accesses</a> (both well-known JavaScript speed bumps). And the TypeScript parser appears to still run the type checker even when type checking is disabled. None of these are an issue with esbuild's custom TypeScript parser. </p></li><li><p> Memory is used efficiently. </p> <p> Compilers are ideally mostly O(n) complexity in the length of the input. So if you are processing a lot of data, memory access speed is likely going to heavily affect performance. The fewer passes you have to make over your data (and also the fewer different representations you need to transform your data into), the faster your compiler will go. </p> <p> For example, esbuild only touches the whole JavaScript AST three times: </p> <ol> <li>A pass for lexing, parsing, scope setup, and declaring symbols</li> <li>A pass for binding symbols, minifying syntax, JSX/TS to JS, and ESNext-to-ES2015</li> <li>A pass for minifying identifiers, minifying whitespace, generating code, and generating source maps</li> </ol> <p> This maximizes reuse of AST data while it's still hot in the CPU cache. Other bundlers do these steps in separate passes instead of interleaving them. They may also convert between data representations to glue multiple libraries together (e.g. string→TS→JS→string, then string→JS→older JS→string, then string→JS→minified JS→string) which uses more memory and slows things down. </p> <p> Another benefit of Go is that it can store things as compactly in memory, which enables it to use less memory and fit more in the CPU cache. All object fields have types and fields are packed tightly together so e.g. several boolean flags only take one byte each. Go also has value semantics and can embed one object directly in another so it comes "for free" without another allocation. JavaScript doesn't have these features and also has other drawbacks such as JIT overhead (e.g. hidden class slots) and inefficient representations (e.g. non-integer numbers are heap-allocated with pointers). </p></li></ul>
      <p>Each one of these factors is only a somewhat significant speedup, but together they can result in a bundler that is multiple orders of magnitude faster than other bundlers commonly in use today.</p>
      <h2 id="benchmark-details">
        <a href="#benchmark-details">#</a>
        Benchmark details
      </h2>
      <p>Here are the details about each benchmark:</p>
      <figcaption>JavaScript benchmark</figcaption>
      <figure>
        <div>
          
          
          
          
          
          
          
          
          <p>0.37s</p>
          
          
          
          <p>1.54s</p>
          
          
          
          <p>36.00s</p>
          
          
          
          <p>41.91s</p>
          
          
          
          <p>54.50s</p>
          
          
          
          <p>56.71s</p>
          
          
          
          <p>118.51s</p>
          <p>0s</p>
          <p>30s</p>
          <p>60s</p>
          <p>90s</p>
          <p>120s</p>
        </div>
      </figure>
      <p>This benchmark approximates a large JavaScript codebase by duplicating the <a href="https://github.com/mrdoob/three.js">three.js</a> library 10 times and building a single bundle from scratch, without any caches. The benchmark can be run with <code>make bench-three</code> in the <a href="https://github.com/evanw/esbuild">esbuild repo</a>.</p>
      <table>
      <thead>
      <tr>
      <th>Bundler</th>
      <th>Time</th>
      <th>Relative slowdown</th>
      <th>Absolute speed</th>
      <th>Output size</th>
      </tr>
      </thead>
      <tbody>
      <tr>
      <td>esbuild</td>
      <td>0.37s</td>
      <td>1x</td>
      <td>1479.6 kloc/s</td>
      <td>5.80mb</td>
      </tr>
      <tr>
      <td>esbuild (1 thread)</td>
      <td>1.54s</td>
      <td>4x</td>
      <td>355.5 kloc/s</td>
      <td>5.80mb</td>
      </tr>
      <tr>
      <td>rollup + terser</td>
      <td>36.00s</td>
      <td>97x</td>
      <td>15.2 kloc/s</td>
      <td>5.81mb</td>
      </tr>
      <tr>
      <td>webpack 4</td>
      <td>41.91s</td>
      <td>113x</td>
      <td>13.1 kloc/s</td>
      <td>5.97mb</td>
      </tr>
      <tr>
      <td>webpack 5</td>
      <td>54.50s</td>
      <td>147x</td>
      <td>10.0 kloc/s</td>
      <td>5.84mb</td>
      </tr>
      <tr>
      <td>parcel 2</td>
      <td>56.71s</td>
      <td>153x</td>
      <td>9.7 kloc/s</td>
      <td>5.92mb</td>
      </tr>
      <tr>
      <td>parcel 1</td>
      <td>118.51s</td>
      <td>320x</td>
      <td>4.6 kloc/s</td>
      <td>5.89mb</td>
      </tr>
      </tbody>
      </table>
      <p>Each time reported is the best of three runs. I'm running esbuild with <code>--bundle <wbr>--minify <wbr>--sourcemap</code> (the single-threaded version uses <code>GOMAXPROCS=1</code>). I used the <code>rollup-<wbr>plugin-<wbr>terser</code> plugin because Rollup itself doesn't support minification. Webpack uses <code>--mode=<wbr>production <wbr>--devtool=<wbr>sourcemap</code>. Parcel uses the default options. Absolute speed is based on the total line count including comments and blank lines, which is currently 547,441. The tests were done on a 6-core 2019 MacBook Pro with 16gb of RAM.</p>
      <p>Caveats:</p>
      <ul><li>Parcel 1: The bundle crashes at run time with <code>TypeError: <wbr>Cannot <wbr>redefine <wbr>property: <wbr>dynamic</code></li></ul>
      <figcaption>TypeScript benchmark</figcaption>
      <figure>
        <div>
          
          
          
          
          
          
          
          
          <p>0.09s</p>
          
          
          
          <p>0.37s</p>
          
          
          
          <p>18.38s</p>
          
          
          
          <p>18.76s</p>
          
          
          
          <p>25.12s</p>
          
          
          
          <p>42.32s</p>
          <p>0s</p>
          <p>10s</p>
          <p>20s</p>
          <p>30s</p>
          <p>40s</p>
        </div>
      </figure>
      <p>This benchmark uses the <a href="https://github.com/facebookexperimental/rome">Rome</a> build tool to approximate a large TypeScript codebase. All code must be combined into a single minified bundle with source maps and the resulting bundle must work correctly. The benchmark can be run with <code>make bench-rome</code> in the <a href="https://github.com/evanw/esbuild">esbuild repo</a>.</p>
      <table>
      <thead>
      <tr>
      <th>Bundler</th>
      <th>Time</th>
      <th>Relative slowdown</th>
      <th>Absolute speed</th>
      <th>Output size</th>
      </tr>
      </thead>
      <tbody>
      <tr>
      <td>esbuild</td>
      <td>0.09s</td>
      <td>1x</td>
      <td>1464.8 kloc/s</td>
      <td>0.97mb</td>
      </tr>
      <tr>
      <td>esbuild (1 thread)</td>
      <td>0.37s</td>
      <td>4x</td>
      <td>356.3 kloc/s</td>
      <td>0.97mb</td>
      </tr>
      <tr>
      <td>webpack 4</td>
      <td>18.38s</td>
      <td>204x</td>
      <td>7.2 kloc/s</td>
      <td>1.26mb</td>
      </tr>
      <tr>
      <td>parcel 1</td>
      <td>18.76s</td>
      <td>208x</td>
      <td>7.0 kloc/s</td>
      <td>1.56mb</td>
      </tr>
      <tr>
      <td>webpack 5</td>
      <td>24.57s</td>
      <td>273x</td>
      <td>5.4 kloc/s</td>
      <td>1.26mb</td>
      </tr>
      <tr>
      <td>parcel 2</td>
      <td>42.32s</td>
      <td>470x</td>
      <td>3.1 kloc/s</td>
      <td>1.68mb</td>
      </tr>
      </tbody>
      </table>
      <p>Each time reported is the best of three runs. I'm running esbuild with <code>--bundle <wbr>--minify <wbr>--sourcemap <wbr>--platform=<wbr>node</code> (the single-threaded version uses <code>GOMAXPROCS=1</code>). Webpack uses <code>ts-loader</code> with <code>transpileOnly: <wbr>true</code> and <code>--mode=<wbr>production <wbr>--devtool=<wbr>sourcemap</code>. Parcel 1 uses <code>--target <wbr>node --bundle-<wbr>node-<wbr>modules</code>. Parcel 2 uses <code>"engines": <wbr>"node"</code> in <code>package.json</code> and needs the <code>@parcel/<wbr>transformer-<wbr>typescript-<wbr>tsc</code> transformer to be able to handle the TypeScript code used in the benchmark. Absolute speed is based on the total line count including comments and blank lines, which is currently 131,836. The tests were done on a 6-core 2019 MacBook Pro with 16gb of RAM.</p>
      <p>The results don't include Rollup because I couldn't get it to work. I tried <code>rollup-<wbr>plugin-<wbr>typescript</code>, <code>@rollup/<wbr>plugin-<wbr>typescript</code>, and <code>@rollup/<wbr>plugin-<wbr>sucrase</code> and they all didn't work for different reasons relating to TypeScript compilation.</p>
      <h2 id="upcoming-roadmap">
        <a href="#upcoming-roadmap">#</a>
        Upcoming roadmap
      </h2>
      <p>These features are already in progress and are first priority:</p>
      <ul><li>Code splitting (<a href="https://github.com/evanw/esbuild/issues/16">#16</a>, <a href="https://esbuild.github.io/api/#splitting">docs</a>)</li><li>CSS content type (<a href="https://github.com/evanw/esbuild/issues/20">#20</a>, <a href="https://esbuild.github.io/content-types/#css">docs</a>)</li><li>Plugin API (<a href="https://github.com/evanw/esbuild/issues/111">#111</a>)</li></ul>
      <p>These are potential future features but may not happen or may happen to a more limited extent:</p>
      <ul><li>HTML content type (<a href="https://github.com/evanw/esbuild/issues/31">#31</a>)</li><li>Lowering to ES5 (<a href="https://github.com/evanw/esbuild/issues/297">#297</a>)</li><li>Bundling top-level await (<a href="https://github.com/evanw/esbuild/issues/253">#253</a>)</li></ul>
      <p>After that point, I will consider esbuild to be relatively complete. I'm planning for esbuild to reach a mostly stable state and then stop accumulating more features. This will involve saying "no" to requests for adding major features to esbuild itself. I don't think esbuild should become an all-in-one solution for all frontend needs. In particular, I want to avoid the pain and problems of the "webpack config" model where the underlying tool is too flexible and usability suffers.</p>
      <p>For example, I am <em>not</em> planning to include these features in esbuild's core itself:</p>
      <ul><li>Support for other frontend languages (e.g. <a href="https://elm-lang.org/">Elm</a>, <a href="https://svelte.dev/">Svelte</a>, <a href="https://vuejs.org/">Vue</a>, <a href="https://angular.io/">Angular</a>)</li><li>TypeScript type checking (just run <code>tsc</code> separately)</li><li>An API for custom AST manipulation</li><li>Hot-module reloading</li><li>Module federation</li></ul>
      <p>I hope that the extensibility points I'm adding to esbuild (<a href="https://esbuild.github.io/plugins/">plugins</a> and the <a href="https://esbuild.github.io/api/">API</a>) will make esbuild useful to include as part of more customized build workflows, but I'm not intending or expecting these extensibility points to cover all use cases. If you have very custom requirements then you should be using …</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://esbuild.github.io/faq/#why-is-esbuild-fast">https://esbuild.github.io/faq/#why-is-esbuild-fast</a></em></p>]]>
            </description>
            <link>https://esbuild.github.io/faq/#why-is-esbuild-fast</link>
            <guid isPermaLink="false">hacker-news-small-sites-26154509</guid>
            <pubDate>Tue, 16 Feb 2021 15:07:50 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[How to instrument JVM bytecode for fuzzing (open-source)]]>
            </title>
            <description>
<![CDATA[
Score 14 | Comments 1 (<a href="https://news.ycombinator.com/item?id=26154490">thread link</a>) | @fhenneke
<br/>
February 16, 2021 | https://blog.code-intelligence.com/engineering-jazzer | <a href="https://web.archive.org/web/*/https://blog.code-intelligence.com/engineering-jazzer">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
    <div>
      
      <div>
        <div>
          <p><span id="hs_cos_wrapper_post_body" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><article id="grip-content">
<p>Jazzer is a coverage-guided fuzzer for the Java Virtual Machine (JVM). It works on the bytecode level and can thus not only be applied directly to compiled Java applications, but also to targets in other JVM-based languages such as Kotlin or Scala.</p>
<!--more-->
<p>Jazzer consists of two main components:</p>
<ul>
<li>The <strong>Jazzer driver</strong> is a native binary that links in <a href="https://llvm.org/docs/LibFuzzer.html" rel="nofollow">libFuzzer</a> and runs a Java fuzz target through the Java Native Interface (JNI).</li>
<li>The <strong>Jazzer agent</strong> is a <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/instrument/package-summary.html" rel="nofollow">Java agent</a> that runs in the same JVM as the fuzz target and applies instrumentation at runtime. The information obtained through this instrumentation is fed back to libFuzzer <span>just as it would be for a compile-time instrumented native binary.&nbsp;</span></li>
</ul>
<p>Taken together, the driver and the agent make it seem to libFuzzer as if it were fuzzing an ordinary native binary. Our goal is to make all of libFuzzer's features work with Jazzer <span>out of the box</span>. In the following, we want to highlight some of the most interesting aspects of the engineering effort required to achieve this goal.</p>
<h2>Instrumenting JVM bytecode for fuzzing</h2>
<p>The JVM bytecode of a compiled Java class is much more higher-level than the machine code of an equivalent C/C++ binary. This makes it possible to instrument a JVM application at runtime rather than at build-time, which means that neither the code nor the build script requires any changes. The Jazzer agent, which is written in Kotlin, instruments the classes right as <span>they are being loaded</span> by the JVM.</p>
<p>To obtain coverage information from the JVM fuzz target, the Jazzer agent inserts bytecode instructions together with a unique ID at the beginning of every basic block. When we enter a block, the previous basic block’s shifted ID is XORed with the current ID to obtain an identifier for the control flow edge between the two blocks.&nbsp;This idea to obtain edge-level coverage information from basic block instrumentation originated in <a href="https://lcamtuf.coredump.cx/afl/technical_details.txt" rel="nofollow">AFL</a> and has already featured in the early AFL-based Java fuzzer <a href="https://github.com/isstac/kelinci">Kelinci</a>. By relying on memory shared directly between the JVM and the Jazzer driver through a <a href="https://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html" rel="nofollow">direct <code>ByteBuffer</code></a> as well as implementing a branch-free saturating counter increment, we found this approach to coverage instrumentation to be very efficient in practice (take a look at <a href="https://github.com/CodeIntelligenceTesting/jazzer/blob/v0.9/agent/src/main/java/com/code_intelligence/jazzer/instrumentor/AFLCoverageMapInstrumentor.kt">AFLCoverageMapInstrumentor.kt</a> if you want to know how this is done).</p>
<p>Since coverage is not the only type of information that is used by libFuzzer to guide its exploration of the fuzz target, Jazzer also instruments other JVM constructs (see <a href="https://github.com/CodeIntelligenceTesting/jazzer/blob/v0.9/agent/src/main/java/com/code_intelligence/jazzer/instrumentor/TraceDataFlowInstrumentor.kt">TraceDataFlowInstrumentor.kt</a>):</p>
<ul>
<li>bytecode-level compares, such as the <span><code>lcmp</code></span>, <span><code>if_*</code></span>, and <span><code>if*</code></span> opcodes</li>
<li>higher-level method-based compares, such as <span><code>String#equal</code></span> or <span><code>Arrays#compare</code></span></li>
<li><code><span>switch</span></code> statements (corresponding to the <span><code>lookupswitch</code></span> and <span><code>tableswitch</code></span> opcodes)</li>
<li>integer divisions (corresponding to the <span><code>idiv</code></span> and <span><code>ldiv</code></span> opcodes and the <span><code>divideUnsigned</code></span> methods)</li>
<li>constant array indices (corresponding to the <span><code>*aload</code></span> opcodes and <span><code>get*</code></span> methods on array-like objects)</li>
</ul>
<p>In all these cases, interesting observed values are forwarded to libFuzzer callbacks such as <span><code>__sanitizer_cov_trace_cmp4</code></span> (for comparisons of 32-bit integral types) and <span><code>__sanitizer_weak_hook_strcmp</code></span> (for string comparisons). The values populate libFuzzer's table of recent compares and will be incorporated into the fuzzer input bytes via random mutations.</p>
<h2>Value profile support</h2>
<p>The table of recent compares is usually quite effective at letting the fuzzer progress through simple compares in which the required input can be obtained directly by inserting bytes reported via the compare hooks. But real-world fuzz targets are rarely that simple. For example, a function might encode the input into Base64 or apply a simple, non-cryptographic checksum function, followed by a comparison. In these cases, the relation between the input required to explore the fuzz target further and the bytes reported via callbacks is highly non-trivial.</p>
<p>libFuzzer's <a href="https://llvm.org/docs/LibFuzzer.html#id33" rel="nofollow">value profile</a>, which can be enabled with the runtime flag <span><code>-use_value_profile=1</code></span>, can be very helpful in this situation. In this mode, for every comparison between two values<span></span>, an extra set of coverage counters will be incremented for every matching bit position in <span><code>A</code></span> and <code><span>B</span></code>. This allows the fuzzer to track its partial progress in getting <span><code>A</code></span> and <span><code>B</code></span> to match, thereby simplifying the problem from brute force (exponential time) to a linear search (linear time).</p>
<p>Since Jazzer builds on libFuzzer and reports string comparisons using <span><code>__sanitizer_weak_hook_strcmp</code></span>, basic value profile support is automatic.&nbsp;Allowing the value profile to track comparisons between integral types is a more difficult task as the relevant fuzzer hooks such as <span><code>__sanitizer_cov_trace_cmp4</code></span> do not take the address of the compare instruction as an argument. Instead, these hooks retrieve the return address from the stack via the <span><code>__builtin_return_address</code></span> compiler intrinsic.</p>
<p>While this is a very natural approach for instrumented native binaries, our calls to the callbacks all go through the JNI and will thus have the same native return address somewhere in the JNI dispatcher. This would mean that the fuzzer would not be able to distinguish between different compare instructions, which would render the value profile <span>largely useless for non-string types</span>. We initially considered submitting a patch to LLVM that would add variants of the compare callbacks that take a call site address as an additional argument, but then found a way to provide full value profile support even without upstream changes.</p>
<p>A small piece of inline assembly in the Jazzer driver implements a "trampoline" that can invoke any of the libFuzzer callbacks with an arbitray fake return address <span><code>addr</code></span>, e.g., a unique ID assigned to a bytecode instruction (see <a href="https://github.com/CodeIntelligenceTesting/jazzer/blob/v0.9/driver/sanitizer_hooks_with_pc.cpp">sanitizer_hooks_with_pc.cpp</a> for the implementation). The trampoline first pushes an address pointing to the <span><code>addr &amp; 0xFFF</code></span>-th entry in a "sled" of <span><code>0xFFF + 1=4096</code></span>&nbsp;ASM <span><code>ret</code> </span>instructions to the (native) stack and then performs a direct jump (also called a "tail call") to the sanitizer callback.&nbsp;The callback will see the address of the <code>ret</code> corresponding to the lower 12 bits of the synthetic address <span><code>addr</code> </span>as the return address via <span><code>__builtin_return_address</code> </span>and associate the bit-wise progress made in the comparison with it in the value profile map.&nbsp;Since libFuzzer only uses the lower 12 bits of an address for the purpose of the value profile, this allows for fast and complete value profile support also for integral types.</p>
<h2>FuzzedDataProvider</h2>
<p>Both libFuzzer and Google’s Python fuzzer <a href="https://github.com/google/atheris" rel="noopener">Atheris</a> provide convenience functions that transform the raw byte input received from the fuzzer into useful primitive types, such as strings, integers, and arrays. While working on Jazzer's analogue of such a <span><code>FuzzedDataProvider</code></span>, we found the two prior implementations to differ in <span>quite a few relevant ways</span>. Adding our own experience with building fuzzers to the mix, we arrived at the following design decisions:</p>
<ul>
<li>Jazzer's <span><code>FuzzedDataProvider</code> </span>turns raw fuzzer input bytes into valid JVM strings by carefully applying the least number of bit changes required to turn the input bytes into valid UTF-8. This differs from the approach taken by Atheris, which randomly chooses between ASCII, UTF-16 and UTF-32. We found the fuzzing to be more stable if a consistent, ASCII-compatible encoding is used throughout the <span><code>FuzzedDataProvider</code> </span>and the libFuzzer callbacks. This however comes at the cost of added complexity in the implementation of the string generation functions: The JNI internally uses an encoding that historically predates UTF-8 and is best described as "UTF-16 code points encoded using UTF-8, with special handling of zero bytes". <span>We found this additional complexity</span> to be worth it based on the increased fuzzing efficiency.</li>
<li>The provider distinguishes between "data byte" and "choice bytes". More complex data which is likely to be parsed by the fuzz target, such as strings or arrays of primitive types, is consumed from the beginning of the fuzzer input. Small primitive types such as single integers, floats, and booleans, which are more likely to guide control-flow, are consumed from the end of the fuzzer input. This idea goes back to libFuzzer's <span><code>FuzzedDataProvider</code> </span>and has two key benefits: It makes the consumed fuzzed data more stable under the typical mutations applied by libFuzzer<span>and also ensures</span> that corpus entries preserve the structure of valid input files (e.g., JSON, PDF, or JPEG files) as much as possible.</li>
<li>Reproducing crashes in fuzz targets using a <span><code>FuzzedDataProvider</code></span> would be challenging if it always required running the crashing input through the driver. For this reason Jazzer, in addition to the crashing input dumped by libFuzzer, creates a Java-only reproducer for every crash. This reproducer contains all values consumed from the <span><code>FuzzedDataProvider</code> </span>in serialized form and can be run like any other Java program without any native dependencies.</li>
</ul>
<h2>Custom method hooks</h2>
<p><a href="https://alexgaynor.net/2020/may/27/science-on-memory-unsafety-and-security/" rel="nofollow">Experience shows</a> that roughly 65% of all serious security bugs found in projects using languages without memory-safety guarantees stem from incorrect memory handling. For the most part this high percentage is likely explained by how difficult memory handling can get if memory-safety is not built into the language from the ground up. However, there is another part to this story: With the likes of AddressSanitizer, MemorySanitizer, and UndefinedBehaviorSanitizer, there is excellent tooling available to detect such bugs with fuzzing.</p>
<p>While there is no need to detect violations of memory-safety for Java applications (at least those without native libraries), <span>other vulnerabilities </span>such as SQL injections, path traversals, or infinite loops occur in JVM-based languages just as often as they do in C/C++. One of the core ideas behind Jazzer is that the higher-level structure of JVM bytecode compared to native binaries coupled with suitable "sanitizers" should make these bugs detectable via fuzzing. For this purpose, Jazzer includes a flexible <a href="https://codeintelligencetesting.github.io/jazzer-api/com/code_intelligence/jazzer/api/MethodHook.html" rel="nofollow">annotation-based mechanism to hook methods</a>, regardless of …</p></article></span></p></div></div></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://blog.code-intelligence.com/engineering-jazzer">https://blog.code-intelligence.com/engineering-jazzer</a></em></p>]]>
            </description>
            <link>https://blog.code-intelligence.com/engineering-jazzer</link>
            <guid isPermaLink="false">hacker-news-small-sites-26154490</guid>
            <pubDate>Tue, 16 Feb 2021 15:06:23 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[What Makes Building Safe AI So Hard?]]>
            </title>
            <description>
<![CDATA[
Score 13 | Comments 0 (<a href="https://news.ycombinator.com/item?id=26154312">thread link</a>) | @dh00608000
<br/>
February 16, 2021 | https://david-haber.github.io/posts/ai-challenges/ | <a href="https://web.archive.org/web/*/https://david-haber.github.io/posts/ai-challenges/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>

    

    
      

    

    <p>Creating a traditional computer program involves a fixed sequence of steps. First, we need to understand the problem and translate it into formal logic. Then, we implement that in code. Often surprisingly, the implementation of a program’s logic is comparatively easy. The challenging part is understanding and translating the problem.</p>
<p>The more complex systems become, the more brainpower we spend to understand them. It becomes necessary to distill the problem and its logic into components, which are easier to work with. Given an input to a component, we know which output to expect. Even before writing a single line of code, we formalize these expectations in <em>contracts</em>. These contracts describe how various components interact with each other. And ultimately, how the overall system interacts with the real world. Once the software is written, we can ensure that the contracts hold. This process makes the concept of failure transparent and clearly defined.</p>
<p>This way, we have managed to build <em>extremely</em> safe software systems that can operate in real-world environments. For example, software autopilots for airplanes, which have been in use for half a century<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup>, don’t fail even once in a billion flight hours. To put this in perspective, think about flying a Boeing 747 around Earth 22 million times<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup>. We don’t expect it to fail once in that time! Flying is the safest mode of transport<sup id="fnref:3"><a href="#fn:3" role="doc-noteref">3</a></sup> for a good reason. It is designed with failure in mind.</p>
<h2 id="the-new-era-of-machine-learning">The New Era of Machine Learning</h2>
<p>But things have changed over the past decade. More recently, the idea of letting a computer learn program behavior with data has heralded a new era of <em>machine learning</em>. It is now one of the most powerful tools of our age.</p>
<p>Machine learning can leverage statistical dependencies in data to learn complex input-output mappings. The program behavior is deduced from data. Therefore, we no longer need to distill the logic and implement it in code. Instead, the computer does so from data. We no longer have to translate the problem into formal logic. Instead, the computer does so from data. To some extent, we don’t even have to understand the problem anymore – or at least we are fooled into believing that we don’t.</p>
<p>Through machine learning, a computer can learn behaviors that are much more complex than anything humans can describe with hand-written rules. On well-designed datasets, or sometimes even in well-controlled environments, we can now do things that we couldn’t even imagine with traditional software.</p>
<figure>
    <img src="https://david-haber.github.io/images/aisafetyreqs.png" alt="AI systems have all of the developmental and operational problems of traditional code, plus a vast additional set of AI-specific issues. AI software typically operates with more uncertainty, and it is challenging to demonstrate its safety and compliance."> <figcaption>
            <p>AI systems have all of the developmental and operational problems of traditional code, plus a vast additional set of AI-specific issues. AI software typically operates with more uncertainty, and it is challenging to demonstrate its safety and compliance.</p>
        </figcaption>
</figure>

<p>Traditionally, we left the difficult parts – like understanding and translating the problem – to humans. We explicitly defined the behavior of traditional programs. Now machine learning solves this for us. It automatically distills the problem and its assumptions into a model. As a result, we can learn much more complicated program behaviors. But, at the same time, the understanding and behavioral guarantees of traditional software are lost. The contracts, which we previously relied on, no longer exist. This makes it much more difficult to analyze AI behavior, let alone to demonstrate its safety.</p>
<h2 id="a-new-mindset-for-ai-development">A New Mindset for AI Development</h2>
<p>AI systems have the same developmental and operational problems as traditional software, plus a vast set of AI-specific issues. As a result, <a href="https://david-haber.github.io/posts/ai-discipline/" target="_blank">companies can create impressive demos but fail to translate them into real products</a>. Or even worse, they operate AI software with a lot more uncertainty. This has already led to catastrophic consequences.</p>
<p>Regulatory organizations, industry-specific working groups, and researchers are investigating how existing safety standards can be extended to cover the additional challenges of AI software. With decades of experience certifying traditional software, they know that safety <em>follows</em> from adopting a system-level view. Moreover, it requires a mindset that holds all stages of the development process accountable, from requirements collection to end-user interaction.</p>
<p>AI development teams must adopt a similar top-down approach. Crucially, this means a development workflow that looks beyond the model. We need to systematically combine the best practices from traditional software with the tools specific to AI. Only then can we reestablish the contracts that traditional software relies on, reduce the uncertainty around AI applications, and achieve the failure rates that mission-critical applications require.</p>
<p>With quickly evolving regulatory standards and improving machine learning tools, we now have a chance to get this right. Both sides of the table, regulators and industry, need to work together to create frameworks that support innovation, not stifle it.</p>
<p><em>Thanks to <a href="https://www.linkedin.com/in/matthias-kraft-5b1229a1/" target="_blank">Matthias</a>, <a href="https://www.linkedin.com/in/mateor/" target="_blank">Mateo</a>, <a href="https://ruieduardo.com/" target="_blank">Rui</a>, <a href="https://www.linkedin.com/in/annalipkina10/" target="_blank">Anna</a>, <a href="https://www.linkedin.com/in/alex-garcia-01/" target="_blank">Alex</a> and Ina for reading and commenting on drafts of this article.</em></p>
<section role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a target="_blank" href="https://ntrs.nasa.gov/api/citations/19960016374/downloads/19960016374.pdf">Human-Centered Aviation
Automation: Principles and Guidelines (Charles E. Billings, February 1996)</a> <a href="#fnref:1" role="doc-backlink">↩︎</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>Assuming that planet Earth has a circumference of roughly 40km, and a Boeing 747 has a cruise speed of around 900km/h, it takes us 45 hours to get around once, and so we need to repeat that roughly 22 million times to be airborne for a billion hours. <a href="#fnref:2" role="doc-backlink">↩︎</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p><a target="_blank" href="https://www.iata.org/en/iata-repository/publications/economic-reports/flying-is-by-far-the-safest-form-of-transport/">IATA Economics' Chart of the Week (IATA, 23 February 2018)</a> <a href="#fnref:3" role="doc-backlink">↩︎</a></p>
</li>
</ol>
</section>


</article></div>]]>
            </description>
            <link>https://david-haber.github.io/posts/ai-challenges/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26154312</guid>
            <pubDate>Tue, 16 Feb 2021 14:50:03 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[FreeBSD and I2C]]>
            </title>
            <description>
<![CDATA[
Score 12 | Comments 0 (<a href="https://news.ycombinator.com/item?id=26153811">thread link</a>) | @todsacerdoti
<br/>
February 16, 2021 | https://blog.tyk.nu/blog/freebsd-and-i2c/ | <a href="https://web.archive.org/web/*/https://blog.tyk.nu/blog/freebsd-and-i2c/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
                    

                    <!-- Author -->
                    <p>
                        by <a href="https://blog.tyk.nu/about/">Tykling</a>
                    </p>
                    <hr>
                    
                    <!-- Date/Time -->
                    <p><span></span> 06. feb 2021 15:54 UTC</p>

                    <hr>

                    <!-- Post Content -->
                    <p><code>I2C</code> is a communication protocol which was originally designed and used for inter-board communications between peripherals, like the processor talking to an EEPROM in a system. These days it is also used for short distance communication with sensors - not what it was designed for, but it works anyway. Wikipedia has this to say about <code>I2C</code>:</p>

<p><i>I2C (Inter-Integrated Circuit), pronounced I-squared-C, is a synchronous, multi-master, multi-slave, packet switched, single-ended, serial communication bus invented in 1982 by Philips Semiconductor (now NXP Semiconductors). It is widely used for attaching lower-speed peripheral ICs to processors and microcontrollers in short-distance, intra-board communication. Alternatively, I2C is spelled I2C (pronounced I-two-C) or IIC (pronounced I-I-C).</i> (thanks <a href="https://en.wikipedia.org/wiki/I%C2%B2C">Wikipedia</a>!)</p>


<p>I've been playing around with some <code>I2C</code> based sensors from SparkFun. They have <a href="https://www.sparkfun.com/qwiic">QWIIC</a> connectors making it easy to speak to them from SparkFuns <a href="https://www.sparkfun.com/products/16832">OpenLog Artemis</a>. The OpenLog Artemis can log sensor data to SD card and also presents itself as a serial device where it streams data from the sensors in a CSV-like format. It works great and I can highly recommend the whole <code>QWIIC</code> ecosystem.</p>

<p>Occationally I need to use one of the <code>QWIIC</code> sensors from some FreeBSD based system, without the <code>OpenLog Artemis</code>. In this case I am using a <code>Raspberry PI Zero</code> with FreeBSD a 13-CURRENT from December. This is easy because the <code>QWIIC</code> system is just plain <code>I2C</code> underneath, so it is easy to hook a sensor up directly to the <code>GPIO</code> pins of the RPI with <a href="https://www.sparkfun.com/products/14988">one of these</a>.</p>

<p>In FreeBSD land we have <a href="https://www.freebsd.org/cgi/man.cgi?query=i2c&amp;sektion=8">i2c(8)</a> which is a userspace utility for reading and writing to <code>I2C</code> devices. I will start by going over basic usage before diving deeper into the actual sensors I am playing with in this learning session.</p>

<p>My test rig for this blogpost looks like this:</p>

<p><a href="https://people.bornhack.org/tyk/i2c/IMG_20210206_201331.jpg"><img src="https://people.bornhack.org/tyk/i2c/IMG_20210206_201331.jpg" width="500"></a></p>

<h3>Basic I2C on FreeBSD</h3>
<p>First things first, I need some hardware with an <code>I2C</code> bus which is exposed to FreeBSD. I am using a <code>Raspberry PI Zero</code> and the <code>I2C</code> bus looks like this in <code>dmesg</code>:</p>

<pre>[root@pizero1 ~]# grep I2C /var/run/dmesg.boot 
iicbus0: &lt;OFW I2C bus&gt; on iichb0
iic0: &lt;I2C generic I/O&gt; on iicbus0
[root@pizero1 ~]# 
</pre>

<p>The first sensor I've hooked up is a SparkFun <code>TMP117</code> temperature sensor. According to the <a href="https://learn.sparkfun.com/tutorials/qwiic-tmp117-high-precision-digital-temperature-sensor-hookup-guide">hookup guide</a> the default <code>I2C</code> address of this sensor is <code>0x48</code> which matches what I am seeing after hooking up the hardware and running <code>i2c(8)</code> with the <code>-s</code> flag to make it scan the <code>I2C</code> bus for devices:</p>

<pre>[root@pizero1 ~]# i2c -s
Hardware may not support START/STOP scanning; trying less-reliable read method.
Scanning I2C devices on /dev/iic0: 48 
[root@pizero1 ~]# 
</pre>

<p>After connecting an additional sensor which has a default <code>I2C</code> address of <code>0x60</code> the bus scan can see that device too:</p>

<pre>[root@pizero1 ~]# i2c -sv
dev: /dev/iic0, addr: 0x0, r/w: r, offset: 0x00, width: 8, count: 1
Hardware may not support START/STOP scanning; trying less-reliable read method.
Scanning I2C devices on /dev/iic0: 48 60 
[root@pizero1 ~]# 
</pre>

<h3>Reading From I2C Devices</h3>
<p>Reading from the sensor is straightforward. I specify that I want to read with <code>-d r</code> (meaning <code>read</code>), the length of data to get with <code>-c 2</code> (meaning 2 bytes) and the address of the device to read from with <code>-a 48</code>:</p>

<pre>[root@pizero1 ~]# i2c -a 48 -d r -c 2 -m tr
0d 67 
[root@pizero1 ~]# while true; do date; i2c -a 48 -d r -c 2 -m tr; sleep 1; done
Sun Dec 20 00:51:45 UTC 2020
0d 67 
Sun Dec 20 00:51:46 UTC 2020
0d 67 
Sun Dec 20 00:51:48 UTC 2020
0d 66 
Sun Dec 20 00:51:49 UTC 2020
0d 66 
^C
[root@pizero1 ~]# 
</pre>

<p>After some trial and error I also add <code>-m tr</code> to set the <code>addressing mode</code> to <code>complete-transfer</code> which is needed on this I2C bus to make everything work.</p>

<p>The reading shown is a hex value, exactly two bytes as requested with <code>-c 2</code>.</p>

<p>When reading temperature from this sensor I don't need to add <code>-o</code> to the <code>i2c(8)</code> command to specify an offset, since the temperature is stored in the first register in the device. If I wanted to read from the next register (which for the <code>TMP117</code> is where the configuration is stored) I would use <code>-o 1</code>:

</p><pre>[root@pizero1 ~]# i2c -a 48 -d r -c 2 -m tr -o 1
22 20 
[root@pizero1 ~]# 
</pre>

<p>All the registers in the <code>TMP117</code> are 16 bits (or two bytes), but the <code>I2C</code> command can read or write any number of bytes, just specify the width with <code>-c</code>.</p>

<p>Trying to read more data than the register size just results in FF bytes being returned:</p>

<pre>[root@pizero1 ~]# i2c -a 48 -d r -c 2 -m tr
0c bc 
[root@pizero1 ~]# i2c -a 48 -d r -c 4 -m tr
0c bc ff ff 
[root@pizero1 ~]# i2c -a 48 -d r -c 40 -m tr
0c bd ff ff ff ff ff ff ff ff ff ff ff ff ff ff 
ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff 
ff ff ff ff ff ff ff ff 
[root@pizero1 ~]# 
</pre>


<h3>Writing To I2C Devices</h3>
<p>The <code>i2c(8)</code> utility also makes it easy to write values back to the device. The <code>TMP117</code> sensor has a programmable low and high thresholds in registers 2 and 3. The first one defaults to <code>0x6000</code> and changing it is much like reading, except we want the bytes to be written on <code>stdin</code>:</p>

<pre>[root@pizero1 ~]# i2c -a 48 -d r -c 2 -m tr -o 2
60 00 
[root@pizero1 ~]# echo -en "\x60\x01" | i2c -a 48 -d w -c 2 -m tr -o 2
[root@pizero1 ~]# i2c -a 48 -d r -c 2 -m tr -o 2
60 01 
[root@pizero1 ~]# echo -en "\x60\x00" | i2c -a 48 -d w -c 2 -m tr -o 2
[root@pizero1 ~]# i2c -a 48 -d r -c 2 -m tr -o 2
60 00 
[root@pizero1 ~]# 
</pre>


<h3>Understanding Readings From the TMP117 Sensor</h3>
<p>Reading the <a href="https://cdn.sparkfun.com/assets/9/e/5/1/8/tmp117.pdf">datasheet</a> for the <code>TMP117</code> sensor I learned that the temperature readings are stored in the first register, as a 16-bit value, which means I use <code>-c 2</code> for <code>i2c(8)</code> so it reads two bytes (16 bits) from the sensor.</p>

<p>The datasheet for the <code>TMP117</code> has this to say about the register where the temperature is stored: <code>The data in the result register is in two's complement format, has a data width of 16 bits and a resolution of 7.8125m °C.</code>.</p>


<h3>Two's Complement Format</h3>
<p><a href="https://en.wikipedia.org/wiki/Two%27s_complement">Two's complement</a> is a widely used and convenient way to work with signed (negative) numbers in binary. Basically the most significant bit is used to indicate if what follows is a positive or a negative binary number.</p>

<p>The following table is from the <code>TMP117</code> datasheet, it shows some sample temperatures in celcius and what those readings translate to in decimal, two's complement binary, and hex:</p>

<table>
<caption>TMP117 Two's Complement Example Readings</caption>
<thead>
<tr>
<th rowspan="2">Temperature (°C decimal)</th>
<th colspan="3">Sensor register value (0.0078125°C resolution)</th>
</tr>
<tr>
<th>Decimal</th>
<th>Binary</th>
<th>Hex</th>
</tr>
</thead>

<tbody>
<tr><td>–256</td><td>-32768</td><td>1000000000000000</td><td>8000</td></tr>
<tr><td>-25</td><td>-3200</td><td>1111001110000000</td><td>F380</td></tr>
<tr><td>–0.125</td><td>-16</td><td>1111111111110000</td><td>FFF0</td></tr>
<tr><td>–0.0078125</td><td>-1</td><td>1111111111111111</td><td>FFFF</td></tr>
<tr><td>0</td><td>0</td><td>0000000000000000</td><td>0000</td></tr>
<tr><td>0.0078125</td><td>1</td><td>0000000000000001</td><td>0001</td></tr>
<tr><td>0.125</td><td>16</td><td>0000000000010000</td><td>0010</td></tr>
<tr><td>1</td><td>128</td><td>0000000010000000</td><td>0080</td></tr>
<tr><td>25</td><td>3200</td><td>0000110010000000</td><td>0C80</td></tr>
<tr><td>100</td><td>12800</td><td>0011001000000000</td><td>3200</td></tr>
<tr><td>255.9921</td><td>32767</td><td>0111111111111111</td><td>7FFF</td></tr>
</tbody>
</table>

<p>I haven't worked much with <a href="https://en.wikipedia.org/wiki/Two%27s_complement">two's complement format</a>, so I started out by familiarising myself with it in Python. I borrowed the following function from <a href="https://stackoverflow.com/questions/1604464/twos-complement-in-python/37075643#37075643">SO</a> and started out by reproducing the values in the above table:</p>

<pre>[root@pizero1 ~]# cat twos.py 
#!/usr/bin/env python3
import sys

def twos(binary_str, bytecount):
    integer = int(binary_str, bytecount)
    bytes = integer.to_bytes(bytecount, byteorder="big", signed=False)
    return int.from_bytes(bytes, byteorder="big", signed=True)

print(twos(sys.argv[1], int(sys.argv[2])))
[root@pizero1 ~]#
</pre>

<p>Trying it out with the values from the table:</p>
<pre>[root@pizero1 ~]# echo "$(python twos.py 1000000000000000 2) * 0.0078125" | bc
-256.0000000
[root@pizero1 ~]# echo "$(python twos.py 1111001110000000 2) * 0.0078125" | bc
-25.0000000
[root@pizero1 ~]# echo "$(python twos.py 1111111111110000 2) * 0.0078125" | bc
-.1250000
[root@pizero1 ~]# echo "$(python twos.py 1111111111111111 2) * 0.0078125" | bc
-.0078125
[root@pizero1 ~]# echo "$(python twos.py 0000000000000000 2) * 0.0078125" | bc
0
[root@pizero1 ~]# echo "$(python twos.py 0000000000000001 2) * 0.0078125" | bc
.0078125
[root@pizero1 ~]# echo "$(python twos.py 0000000000010000 2) * 0.0078125" | bc
.1250000
[root@pizero1 ~]# echo "$(python twos.py 0000000010000000 2) * 0.0078125" | bc
1.0000000
[root@pizero1 ~]# echo "$(python twos.py 0000110010000000 2) * 0.0078125" | bc
25.0000000
[root@pizero1 ~]# echo "$(python twos.py 0011001000000000 2) * 0.0078125" | bc
100.0000000
[root@pizero1 ~]# echo "$(python twos.py 0111111111111111 2) * 0.0078125" | bc
255.9921875
[root@pizero1 ~]# 
</pre>

<p>Looks like it works perfectly. Going from a reading to celcius is also easy, I tested with the values from the table again:</p>

<pre>[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("8000"), byteorder="big", signed=True) * 0.0078125, 8))'
-256.0
[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("F380"), byteorder="big", signed=True) * 0.0078125, 8))'
-25.0
[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("FFF0"), byteorder="big", signed=True) * 0.0078125, 8))'
-0.125
[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("FFFF"), byteorder="big", signed=True) * 0.0078125, 8))'
-0.0078125
[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("0000"), byteorder="big", signed=True) * 0.0078125, 8))'
0.0
[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("0001"), byteorder="big", signed=True) * 0.0078125, 8))'
0.0078125
[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("0010"), byteorder="big", signed=True) * 0.0078125, 8))'
0.125
[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("0080"), byteorder="big", signed=True) * 0.0078125, 8))'
1.0
[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("0C80"), byteorder="big", signed=True) * 0.0078125, 8))'
25.0
[root@pizero1 ~]# python -c 'print(round(int.from_bytes(bytearray.fromhex("3200"), byteorder="big", signed=True) * …</pre></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://blog.tyk.nu/blog/freebsd-and-i2c/">https://blog.tyk.nu/blog/freebsd-and-i2c/</a></em></p>]]>
            </description>
            <link>https://blog.tyk.nu/blog/freebsd-and-i2c/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26153811</guid>
            <pubDate>Tue, 16 Feb 2021 13:46:59 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Behold z, the unsung jewel that rethinks shell navigation]]>
            </title>
            <description>
<![CDATA[
Score 116 | Comments 47 (<a href="https://news.ycombinator.com/item?id=26153401">thread link</a>) | @aymericbeaumet
<br/>
February 16, 2021 | https://aymericbeaumet.com/behold-z-the-unsung-jewel-that-rethinks-shell-navigation | <a href="https://web.archive.org/web/*/https://aymericbeaumet.com/behold-z-the-unsung-jewel-that-rethinks-shell-navigation">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div aria-label="Content">
<div>
<article itemscope="" itemtype="http://schema.org/BlogPosting">

<div itemprop="articleBody">
<p>I spend a fair amount of time wandering around in the terminal. The chances
are that you are too since you dared to open this story. My daily activities
led me to contribute to various kinds of projects (professional, personal and
open-source). For my sanity, I tend to follow strict rules to organize my
workspace, which helps me keep things tidied up and easily reachable. Or so I
thought.</p>
<p>I decided to arrange my projects by following the <a href="https://golang.org/doc/code.html#Workspaces">Go
philosophy</a>: make the
arborescence mirrors the urls where they are reachable. e.g.,
<code>~/Workspace/src/github.com/aymericbeaumet/dotfiles</code> would contain the
project <a href="https://github.com/aymericbeaumet/dotfiles">dotfiles</a> owned by
<a href="https://github.com/aymericbeaumet">@aymericbeaumet</a> and accessible at
<a href="https://github.com/">github.com</a>. That’s great, but I am now facing a complex
directory structure tedious to navigate quickly. Making it, in the end,
harder to access the resources I need.</p>
<div><div><pre><code><span>$ </span><span>pwd</span>
/Users/aymericbeaumet/Workspace/src/github.com/brigad/back-end
</code></pre></div></div>
<p><em>Nobody wants to manually deal with this.</em></p>
<p>Remembering and typing the location of each project (even while leveraging
autocomplete) is time-consuming. Creating shell aliases is not scalable.
Instead, I would like to rely on the pseudo-unicity of each project name to
find it among all the directories on my computer.</p>
<h2 id="z">z?</h2>
<p>Several tools exist to tackle this problem. My favorite is
<a href="https://github.com/rupa/z"><em>z</em></a>. It follows the Unix philosophy by being
small, focused and interoperable. <em>z</em> allows jumping around swiftly,
automatically learning from your habits. The entries are ranked based on the
<a href="https://en.wikipedia.org/wiki/Frecency">frecency</a> at which you access the
directories.</p>
<p>Let’s walk through the basics of this tool. Below is how I advise to install
it for Zsh on macOS (the install process should be similar for other shells
and operating systems):</p>
<div><div><pre><code><span>$ </span>brew <span>install </span>z
<span>$ </span><span>echo</span> <span>"source '</span><span>$(</span>brew <span>--prefix</span> z<span>)</span><span>/etc/profile.d/z.sh'"</span> <span>&gt;&gt;</span> ~/.zshenv
</code></pre></div></div>
<p><em>Install z for Zsh on macOS.</em></p>
<p>Note how installing <em>z</em> is not enough to start using it. You have to source
<code>z.sh</code> at the beginning of each shell session to activate it. The <code>~/.zshenv</code>
configuration file is appropriate as Zsh <a href="http://zsh.sourceforge.net/Intro/intro_3.html">loads it in most
circumstances</a>, making the
tool accessible in a wide-variety of contexts (terminals, editors, IDEs,
scripts, etc.).</p>
<h2 id="lets-play">Let’s play</h2>
<p>Once the install and setup are complete: start a new shell session, <code>cd</code>
through some folders and execute <code>z</code> to confirm it has been accurately
tracking your activity:</p>
<div><div><pre><code><span>$ </span>z | <span>sort</span> <span>-rn</span> | <span>head</span> <span>-3</span>
5331.72    /Users/aymericbeaumet/Workspace/src/github.com/brigad/back-end
637.255    /Users/aymericbeaumet/Workspace/src/github.com/brigad/ops
386.198 /Users/aymericbeaumet/.config/dotfiles
</code></pre></div></div>
<p><em>Top 3 directories based on frecency.</em></p>
<p>As shown above, I spend quite some time navigating through
<a href="https://github.com/brigad">Brigad</a> projects, but it seems I also often
access my <a href="https://github.com/aymericbeaumet/dotfiles">dotfiles</a> to tweak
some configuration. The ranking score is volatile, and one could observe
significant changes in a brief amount of time.</p>
<p>Now that <em>z</em> has accumulated some knowledge try it by navigating to one of
the tracked folders. Navigating is as simple as executing the <code>z</code> command
followed by the directory name:</p>
<div><div><pre><code><span>$ </span>z dotfiles
<span>$ </span><span>pwd</span>
/Users/aymericbeaumet/.config/dotfiles
</code></pre></div></div>
<p><em>Navigating by matching with a whole directory name.</em></p>
<p>As a matter of facts, I do prefer to leverage partial matching (imagine <code>**</code>
surrounding your search pattern) to type fewer characters. Hence, <code>z dot</code> is
valid and should produce a similar behavior as <code>z dotfiles</code> (modulo possible
name collisions, but you get the idea). This works because <em>z</em> relies on
regular expressions. For example, the snippet below will navigate to the
directory ending with the letters “tmp” (with the highest score):</p>
<div><div><pre><code><span>$ </span>z tmp<span>$</span>
<span>$ </span><span>pwd</span>
/private/tmp
</code></pre></div></div>
<p><em>Navigating by matching with a regular expression.</em></p>
<p>Neat right? I guess you start seeing the possibilities of this tool. And we
have only scratched the surface of its capabilities. I suggest you dive in
its <a href="https://github.com/rupa/z/blob/master/README">documentation</a> to get an
idea of its full potential. Features such as autocomplete, subdirectories
matching, consecutive matching, etc. are a game changer.</p>
<h2 id="conclusion">Conclusion</h2>
<p><em>z</em> is tremendous. This tool saves me a non-trivial amount of time every
single day. When one starts relying on it, there is no going back. And I hope
it’s going to fit your workflow as well as mine.</p>
<p>I would be grateful to hear any of your time-saving tricks. Feel free to
share your experiences!</p>
</div>


</article>
</div>
</div></div>]]>
            </description>
            <link>https://aymericbeaumet.com/behold-z-the-unsung-jewel-that-rethinks-shell-navigation</link>
            <guid isPermaLink="false">hacker-news-small-sites-26153401</guid>
            <pubDate>Tue, 16 Feb 2021 12:54:43 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[All about thread-local storage]]>
            </title>
            <description>
<![CDATA[
Score 50 | Comments 10 (<a href="https://news.ycombinator.com/item?id=26150512">thread link</a>) | @MaskRay
<br/>
February 15, 2021 | https://maskray.me/blog/2021-02-14-all-about-thread-local-storage | <a href="https://web.archive.org/web/*/https://maskray.me/blog/2021-02-14-all-about-thread-local-storage">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div itemprop="articleBody">
      
        <p>Thread-local storage (TLS) provides a mechanism allocating distinct objects for different threads. It is the usual implementation for GCC extension <code>__thread</code>, C11 <code>_Thread_local</code>, and C++11 <code>thread_local</code>, which allow the use of the declared name to refer to the entity associated with the current thread. This article will describe thread-local storage on ELF platforms in detail, and touch on other related topics, such as: thread-specific data keys and Windows/macOS TLS.</p>
<p>An example usage of thread-local storage is POSIX <code>errno</code>:</p>
<blockquote>
<p>Each thread has its own thread ID, scheduling priority and policy, errno value, floating point environment, thread-specific key/value bindings, and the required system resources to support a flow of control.</p>
</blockquote>
<p>Different threads have different <code>errno</code> copies. <code>errno</code> is typically defined as a function which returns a thread-local variable.</p>
<p>For each architecture, the authoritative ELF ABI document is the processor supplement (psABI) to the System V ABI (generic ABI). These documents usually reference <em>The ELF Handling for Thread-Local Storage</em> by Ulrich Drepper. The document, however, mixes general specifications and glibc internals.</p>
<h2 id="representation">Representation</h2>
<h3 id="assembler-behavior">Assembler behavior</h3>
<p>The compiler usually defines thread-local variables in <code>.tdata</code> and <code>.tbss</code> sections (which have the section flag <code>SHF_TLS</code>). The symbols representing thread-local variables have type <code>STT_TLS</code> (representing thread-local storage entities). In GNU as syntax, you can give <code>a</code> the type <code>STT_TLS</code> with <code>.type a, @tls_object</code>. The <code>st_value</code> value of a TLS symbols is the offset relative to the defining section.</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br></pre></td><td><pre><span>.section .tbss,"awT",@nobits</span><br><span>.globl a, b</span><br><span>.type a, @tls_object</span><br><span>.type b, @tls_object</span><br><span>a:</span><br><span>  .zero 4</span><br><span>  .size a, .-a</span><br><span>b:</span><br><span>  .zero 4</span><br><span>  .size b, .-b</span><br></pre></td></tr></tbody></table></figure>
<p>In this example, <code>st_value(a)=0</code> while <code>st_value(b)=4</code>.</p>
<p>In Clang and GCC produced assembly, thread-local variables are annotated as <code>.type a, @object</code> (<code>STT_OBJECT</code>). When the assembler sees that such symbols are defined in <code>SHF_TLS</code> sections or referenced by TLS relocations, <code>STT_NOTYPE</code>/<code>STT_OBJECT</code> will be upgraded to <code>STT_TLS</code>.</p>
<p>GNU as supports an directive <code>.tls_common</code> which defines <code>STT_TLS SHN_COMMON</code> symbols. This is an obsecure feature. It is not clear whether GCC still has a code path which emits <code>.tls_common</code> directives. LLVM integrated assembler does not support <code>.tls_common</code>.</p>
<h3 id="linker-behavior">Linker behavior</h3>
<p>The linker combines <code>.tdata</code> input sections into a <code>.tdata</code> output section. <code>.tbss</code> input sections are combined into a <code>.tbss</code> output section. The two <code>SHF_TLS</code> output sections are placed into a <code>PT_TLS</code> program header.</p>
<ul>
<li><code>p_offset</code>: the file offset of the TLS initialization image</li>
<li><code>p_vaddr</code>: the virtual address of the TLS initialization image</li>
<li><code>p_filesz</code>: the size of the TLS initialization image</li>
<li><code>p_memsz</code>: the total size of the thread-local storage. The last <code>p_memsz-p_filesz</code> bytes will be zeroed by the dynamic loader.</li>
<li><code>p_align</code>: alignment</li>
</ul>
<p>The <code>PT_TLS</code> program header is contained in a <code>PT_LOAD</code> program header. Conceptually <code>PT_TLS</code> and <code>STT_TLS</code> symbols are like in a separate address space. The dynamic loader should copy the <code>[p_vaddr,p_vaddr+p_filesz)</code> of the TLS initialization image to the corresponding static TLS block.</p>
<p>In executable and shared object files, <code>st_value</code> normally holds a virtual address. For a <code>STT_TLS</code> symbol, <code>st_value</code> holds an offset relative to the virtual address of the <code>PT_TLS</code> program header. The first byte of <code>PT_TLS</code> is referenced by the TLS symbol with <code>st_value==0</code>.</p>
<p>GNU ld treats <code>STT_TLS SHN_COMMON</code> symbols as defined in <code>.tcommon</code> sections. Its internal linker script places such sections into the output section <code>.tdata</code>. LLD does not support <code>STT_TLS SHN_COMMON</code> symbols.</p>
<h3 id="dynamic-loader-behavior">Dynamic loader behavior</h3>
<p>The dynamic loader collects <code>PT_TLS</code> program headers from the main executable and immediately loaded shared objects (via transitive <code>DT_NEEDED</code>), and allocates static TLS blocks, one block for each <code>PT_TLS</code>. For each <code>PT_TLS</code>, the dynamic loader copies <code>p_filesz</code> bytes from the TLS initialization image to the TLS block and sets the trailing <code>p_memsz-p_filesz</code> bytes to zeroes.</p>
<p>For the static TLS block of the main executable, the module ID is one and the TP offset of a TLS symbol is a link-time constant. The linker and the dynamic loader share the same formula.</p>
<p>For a shared object loaded at program start, the offset from the thread pointer to its static TLS block is a fixed value at program start, albeit not a link-time constant. The offset can be referenced by a GOT dynamic relocation used by the initial-exec TLS model.</p>
<p><em>The ELF Handling for Thread-Local Storage</em> describes two TLS variants and specifies their data structures. However, only the TP offset of the static TLS block of the main executable is a hard requirement. Nevertheless, libc implementations usually place static TLS blocks together, and allocate a space for both the thread control block and the static TLS blocks.</p>
<p>For a new thread created by <code>pthread_create</code>, the static TLS blocks are usually allocated as part of the thread stack. Without a guard page between the largest address of the stack and the thread control block, this could be considered as vulnerable as stack overflow can overwrite the thread control block.</p>
<h2 id="models">Models</h2>
<h3 id="local-exec-tls-model-executable-non-preemptible">Local exec TLS model (executable &amp; non-preemptible)</h3>
<p>This is the most efficient TLS model. It applies when the TLS symbol is defined in the executable.</p>
<p>The compiler picks this model in <code>-fno-pic/-fpie</code> modes if the variable is</p>
<ul>
<li>a definition</li>
<li>or a declaration with a non-default visibility.</li>
</ul>
<p>The first condition is obvious. The second condition is becuase a non-default visibility means the variable must be defined by another translation unit in the executable.</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br></pre></td><td><pre><span>_Thread_local <span>int</span> def;</span><br><span>__attribute__((visibility(<span>"hidden"</span>))) <span>extern</span> <span>thread_local</span> <span>int</span> ref;</span><br><span><span><span>int</span> <span>foo</span><span>()</span> </span>{ <span>return</span> def + ref; }</span><br></pre></td></tr></tbody></table></figure>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br></pre></td><td><pre><span># x86-64</span><br><span>movl %fs:def@TPOFF, %eax</span><br></pre></td></tr></tbody></table></figure>
<p>For the static TLS block of the main executable, the TP offset of a TLS symbol is a link-time constant. Here is a list of common relocation types:</p>
<ul>
<li>arm: <code>R_ARM_TLS_LE32</code></li>
<li>aarch64:
<ul>
<li>-mtls-size=12: <code>R_AARCH64_TLSLE_ADD_TPREL_LO12</code></li>
<li>-mtls-size=24 (default): <code>R_AARCH64_TLSLE_ADD_TPREL_HI12</code>, <code>R_AARCH64_TLSLE_ADD_TPREL_LO12_NC</code></li>
<li>-mtls-size=32: <code>R_AARCH64_TLSLE_MOVW_TPREL_G1</code>, <code>R_AARCH64_TLSLE_MOVW_TPREL_G0_NC</code></li>
<li>-mtls-size=48: <code>R_AARCH64_TLSLE_MOVW_TPREL_G2</code>, <code>R_AARCH64_TLSLE_MOVW_TPREL_G1_NC</code>, <code>R_AARCH64_TLSLE_MOVW_TPREL_G0_NC</code></li>
</ul></li>
<li>i386: <code>R_386_TLS_LE</code></li>
<li>x86-64: <code>R_X86_64_TPOFF32</code></li>
<li>mips: <code>R_MIPS_TPREL_HI16</code>, <code>R_MIPS_TPREL_LO16</code></li>
<li>ppc32: <code>R_PPC_TPREL_HA</code>, <code>R_PPC_TPREL_LO</code></li>
<li>ppc64: <code>R_PPC64_TPREL_HA</code>, <code>R_PPC64_TPREL_LO</code></li>
<li>riscv: <code>R_RISCV_TPREL_HI20</code>, <code>R_RISCV_TPREL_LO12_I</code>, <code>R_RISCV_TPREL_LO12_S</code></li>
</ul>
<p>For RISC architectures, because an instruction typically has 4 bytes and cannot encode a 32-bit offset, it usually takes two instructions to materialize a TP offset.</p>
<p>In <a target="_blank" rel="noopener" href="https://reviews.llvm.org/D93331">https://reviews.llvm.org/D93331</a>, I patched LLD to reject local-exec TLS relocations in <code>-shared</code> mode. In GNU ld, at least arm, riscv and x86's ports have the similar diagnostics, but aarch64 and ppc64 do not error.</p>
<h3 id="initial-exec-tls-model-executable-preemptible">Initial exec TLS model (executable &amp; preemptible)</h3>
<p>This model is less efficient than local exec. It applies when the TLS symbol is defined in the executable or a shared object available at program start. The shared object can be due to <code>DT_NEEDED</code> or <code>LD_PRELOAD</code>.</p>
<p>The compiler picks this model in <code>-fno-pic/-fpie</code> modes if the variable is a declaration with default visibility. The idea is that a symbol referenced by the executable must be defined by an immediately loaded shared object, instead of a dlopen loaded shared object. The linker enforces this as well by defaulting to <code>-z defs</code> for a <code>-no-pie/-pie</code> link.</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br></pre></td><td><pre><span><span>extern</span> <span>thread_local</span> <span>int</span> ref;</span><br><span><span><span>int</span> <span>foo</span><span>()</span> </span>{ <span>return</span> ref; }</span><br></pre></td></tr></tbody></table></figure>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br></pre></td><td><pre><span># x86-64</span><br><span>movq ref@GOTTPOFF(%rip), %rax</span><br><span>movl %fs:(%rax), %eax</span><br></pre></td></tr></tbody></table></figure>
<p>Because the offset from the thread pointer to the start of a static block is fixed at program start, such an offset can be encoded by a GOT relocation. Such relocation types typically have <code>GOT</code> and <code>TPREL/TPOFF</code> in their names. Here is a list of common relocation types:</p>
<ul>
<li>arm: <code>R_ARM_TLS_IE32</code></li>
<li>aarch64: <code>R_AARCH64_TLSIE_ADR_GOTTPREL_PAGE21</code>, <code>R_AARCH64_TLSIE_LD64_GOTTPREL_LO12_NC</code></li>
<li>i386: <code>R_386_TLS_IE</code></li>
<li>x86-64: <code>R_X86_64_GOTTPOFF</code></li>
<li>ppc32: <code>R_PPC_GOT_TPREL16</code></li>
<li>ppc64: <code>R_PPC64_GOT_TPREL16_HA</code>, <code>R_PPC64_GOT_TPREL16_LO_DS</code></li>
<li>riscv: <code>R_RISCV_TLS_GOT_HI20</code>, <code>R_RISCV_PCREL_LO12_I</code></li>
</ul>
<p>If the TLS symbol does not satisfy initial-exec to local-exec relaxation requirements, the linker will allocate a GOT entry and emit a dynamic relocation. Here is a list of dynamic relocation types:</p>
<ul>
<li>arm: <code>R_ARM_TLS_TPOFF32</code></li>
<li>aarch64: <code>R_AARCH64_TLS_TPREL64</code></li>
<li>mips32: <code>R_MIPS_TLS_TPREL32</code></li>
<li>mips64: <code>R_MIPS_TLS_TPREL64</code></li>
<li>i386: <code>R_386_TPOFF</code></li>
<li>x86-64: <code>R_X86_64_TPOFF64</code></li>
<li>ppc32: <code>R_PPC_TPREL32</code></li>
<li>ppc64: <code>R_PPC64_TPREL64</code></li>
<li>riscv: <code>R_RISCV_TLS_TPREL64</code></li>
</ul>
<p>While they have <code>TPREL</code> or <code>TPOFF</code> in their names, these dynamic relocations have the same bitwidth as the word size. This is a good way to distinguish them from the local-exec relocation types used in object files.</p>
<p>If you add the <code>__attribute((tls_model("initial-exec")))</code> attribute, a thread-local variable can use this model in <code>-fpic</code> mode. If the object file is linked into an executable, everything is fine. If the object file is linked into a shared object, the shared object generally needs to be an immediately loaded shared object. The linker sets the <code>DF_STATIC_TLS</code> flag to annotate a shared object with initial-exec TLS relocations.</p>
<p>glibc ld.so reserves some space in static TLS blocks and allows dlopen on such a shared object if its TLS size is small. There could be an obscure reason for using such an attribute: general dynamic and local dynamic TLS models are not async-signal-safe in glibc. However, other libc implementations may not reserve additional TLS space for dlopen'ed initial-exec shared objects, e.g. musl will error.</p>
<h3 id="general-dynamic-and-local-dynamic-tls-models-dso">General dynamic and local dynamic TLS models (DSO)</h3>
<p>The two modes are used when the TLS symbol may be defined by a shared object. They do not assume the TLS symbol is backed by a static TLS block. Instead, they assume that the thread-local storage of the module may be dynamically allocated, making the models suitable for dlopen usage. The dynamically allocated TLS storage is usually referred to as dynamic TLS.</p>
<p>Each TLS symbol is …</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://maskray.me/blog/2021-02-14-all-about-thread-local-storage">https://maskray.me/blog/2021-02-14-all-about-thread-local-storage</a></em></p>]]>
            </description>
            <link>https://maskray.me/blog/2021-02-14-all-about-thread-local-storage</link>
            <guid isPermaLink="false">hacker-news-small-sites-26150512</guid>
            <pubDate>Tue, 16 Feb 2021 03:14:38 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[US Presidential Election $25k Database Bounty Review]]>
            </title>
            <description>
<![CDATA[
Score 144 | Comments 35 (<a href="https://news.ycombinator.com/item?id=26149511">thread link</a>) | @mjangle1985
<br/>
February 15, 2021 | https://www.dolthub.com/blog/2021-02-15-election-bounty-review/ | <a href="https://web.archive.org/web/*/https://www.dolthub.com/blog/2021-02-15-election-bounty-review/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div data-cy="blog-post-text"><p>On December 14, we launched <a href="https://www.dolthub.com/blog/2020-12-16-data-bounties/">our first data bounty</a> to <a href="https://www.dolthub.com/blog/2020-12-14-make-money-data-wrangling/">earn a share of $25,000 by wrangling US Presidential Precinct-level data</a>. The bounty ended yesterday. How did it go? This blog entry will answer that question.</p>
<p><a href="https://www.doltdb.com/">Dolt</a> is a SQL database with Git-style versioning. It's the first SQL database you can branch and merge. <a href="https://www.dolthub.com/">DoltHub</a> is a place on the internet to share and collaborate on Dolt databases. Without both, data bounties would not be possible.</p>

<p>We built the <a href="https://www.dolthub.com/repositories/dolthub/us-president-precinct-results">best open database of US Precinct-level Election results</a> on the internet. </p>
<p>Here's some statistics:</p>
<ul>
<li>15.5M cells edited. 1.7GB of data collected</li>
<li><a href="https://www.dolthub.com/repositories/dolthub/us-president-precinct-results/query/master?q=SELECT+COUNT%28distinct%28state%29%29%0AFROM+%60vote_tallies%60+where+election_year%3D2016%0ALIMIT+200%3B%0A%0A%0A%0A%0A%0A%0A&amp;active=Tables">All 51 "states" covered for 2016</a>. <a href="https://www.dolthub.com/repositories/dolthub/us-president-precinct-results/query/master?q=SELECT+COUNT%28distinct%28state%29%29%0AFROM+%60vote_tallies%60+where+election_year%3D2020%0ALIMIT+200%3B%0A%0A%0A%0A%0A%0A%0A&amp;active=Tables">38 states covered for 2020</a>. </li>
<li><a href="https://www.dolthub.com/repositories/dolthub/us-president-precinct-results/query/master?q=SELECT+sum%28votes%29%2F136669276%0AFROM+%60vote_tallies%60+where+election_year%3D2016%0ALIMIT+200%3B%0A%0A%0A%0A%0A%0A%0A&amp;active=Tables">100% of the vote covered for 2016</a>. <a href="https://www.dolthub.com/repositories/dolthub/us-president-precinct-results/query/master?q=SELECT+sum%28votes%29%2F159633396%0AFROM+%60vote_tallies%60+where+election_year%3D2020%0ALIMIT+200%3B%0A%0A%0A%0A%0A%0A%0A&amp;active=Tables">78% for 2020</a>.</li>
<li>75 Pull Requests (PRs) accepted across 6 bounty participants. </li>
<li>Top bounty participant earned over $10,000.</li>
</ul>
<p><span>
      <a href="https://www.dolthub.com/blog/static/4e02e3f4498d3a6b5bc56bd9f85cad81/0fcea/first-bounty-final-scoreboard.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="Final Scoreboard" title="Final Scoreboard" src="https://www.dolthub.com/blog/static/4e02e3f4498d3a6b5bc56bd9f85cad81/0fcea/first-bounty-final-scoreboard.png" srcset="https://www.dolthub.com/blog/static/4e02e3f4498d3a6b5bc56bd9f85cad81/a48b3/first-bounty-final-scoreboard.png 214w,
https://www.dolthub.com/blog/static/4e02e3f4498d3a6b5bc56bd9f85cad81/47730/first-bounty-final-scoreboard.png 428w,
https://www.dolthub.com/blog/static/4e02e3f4498d3a6b5bc56bd9f85cad81/0fcea/first-bounty-final-scoreboard.png 851w" sizes="(max-width: 851px) 100vw, 851px" loading="lazy">
  </a>
    </span></p>
<p>We're very excited to mail the checks to all the folks who worked hard to make this bounty a success.</p>
<p><span>
      <a href="https://www.dolthub.com/blog/static/9791bedbcbd3ed06e15435f17a7ff195/2ad33/fat-check.jpg" target="_blank" rel="noopener">
    <span></span>
  <img alt="Fat Check" title="Fat Check" src="https://www.dolthub.com/blog/static/9791bedbcbd3ed06e15435f17a7ff195/79a4e/fat-check.jpg" srcset="https://www.dolthub.com/blog/static/9791bedbcbd3ed06e15435f17a7ff195/606a2/fat-check.jpg 214w,
https://www.dolthub.com/blog/static/9791bedbcbd3ed06e15435f17a7ff195/65a3f/fat-check.jpg 428w,
https://www.dolthub.com/blog/static/9791bedbcbd3ed06e15435f17a7ff195/79a4e/fat-check.jpg 856w,
https://www.dolthub.com/blog/static/9791bedbcbd3ed06e15435f17a7ff195/99aeb/fat-check.jpg 1284w,
https://www.dolthub.com/blog/static/9791bedbcbd3ed06e15435f17a7ff195/e88f6/fat-check.jpg 1712w,
https://www.dolthub.com/blog/static/9791bedbcbd3ed06e15435f17a7ff195/2ad33/fat-check.jpg 3851w" sizes="(max-width: 856px) 100vw, 856px" loading="lazy">
  </a>
    </span></p>

<p>Now that the bounty is complete, we must figure out what to do with this data. How do we get the most out of our investment in the data?</p>
<h2>Clean up the data we got</h2>
<p>Given the heavily keyed nature of this data, we decided early on to not accept PRs for standardization or normalization of things like party names. Because most columns are part of the primary key, any change looks like a deletion and corresponding addition to Dolt. Thus, changes like that give the corrector credit for the whole row in the bounty instead of just the cell he or she changed. We queued up a number of these types of changes and we'll execute them now that the bounty is over.</p>
<h2>Find some users</h2>
<p>We collected the best US presidential Precinct level results on the internet. Now, we want people to use it. We think potentially the data is good enough that an open data community could be bootstrapped around it. The people who use it would have incentive to finish it as new state level data is released. We will reach out to the people at <a href="http://openelections.net/">Open Elections</a> and <a href="https://electionlab.mit.edu/">MIT Elections Lab</a> and start a conversation. If you know anyone else who could use this data, <a href="https://discord.com/invite/RFwfYpu">come let us know in our Discord</a>.</p>
<h2>Run another bounty?</h2>
<p>We're still missing 12 states and about 22% of the vote from 2020. If we want to get complete data and an open data community can't be bootstrapped, we may run another bounty in a couple months to finish the dataset. Let us know if you'd be interested in another bounty or the complete dataset.</p>

<p>We think <a href="https://www.dolthub.com/bounties">DoltHub Bounties</a> may be the fastest, cheapest way to build databases from open data. For $25,000 and 8 weeks, we were able to assemble a 1.7GB database of election results. </p>
<p>Our plan is to run at least one bounty per month for the rest of the year across a number of distinct data disciplines. We're running a <a href="https://www.dolthub.com/blog/2021-01-14-hopsital-prices-bounty/">hospital price transparency bounty</a> right now. We'll be launching two more over the next month or so. Hang out in <a href="https://discord.com/invite/RFwfYpu">our Discord</a> to keep up to date. Start wrangling data as your new side hustle.</p></div></div>]]>
            </description>
            <link>https://www.dolthub.com/blog/2021-02-15-election-bounty-review/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26149511</guid>
            <pubDate>Tue, 16 Feb 2021 00:20:16 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Building Rich Terminal Dashboards]]>
            </title>
            <description>
<![CDATA[
Score 483 | Comments 116 (<a href="https://news.ycombinator.com/item?id=26149488">thread link</a>) | @lumpa
<br/>
February 15, 2021 | https://www.willmcgugan.com/blog/tech/post/building-rich-terminal-dashboards/ | <a href="https://web.archive.org/web/*/https://www.willmcgugan.com/blog/tech/post/building-rich-terminal-dashboards/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
    

    
<p><a href="https://github.com/willmcgugan/rich">Rich</a> has become a popular (20K stars on GH) way of beautifying CLIs, and I'm pleased to see a number of projects using it.</p>
<p>Since Rich is mature and battle-tested now, I had considered winding-down development. Until, I saw this tweet:</p>
<h2>The Tweet</h2>
<blockquote><div lang="en" dir="ltr"><p>Do you want to see something really cool you can do with <a href="https://twitter.com/willmcgugan?ref_src=twsrc%5Etfw">@willmcgugan</a> 's rich library? </p><p>Checkout ghtop <a href="https://t.co/mn7oLbpw8e">https://t.co/mn7oLbpw8e</a>. It's a really fun CLI tool that demonstrates the power of rich (and other things).</p><p>Examples below 🧵👇 (1/8)</p></div>— Hamel Husain (@HamelHusain) <a href="https://twitter.com/HamelHusain/status/1357771218095546368?ref_src=twsrc%5Etfw">February 5, 2021</a></blockquote> 
<p><a href="https://twitter.com/HamelHusain">@HamelHusain</a> and <a href="https://twitter.com/jeremyphoward">@jeremyphoward</a> used Rich to enhance <a href="https://github.com/nat/ghtop">ghtop</a> (a repo owned by the CEO of Github, no less). Ghtop shows a realtime a stream of events from the Github platform. And it looks good! So good that I realised how much potential Rich has for these type of htop-like applications.</p>
<p>Hamel and Jeremy had to overcome a few technical hurdles to make that work. Fortunately this will no longer be required as the latest version of Rich has first-class support for full-screen interfaces via a new Layout system.</p>
<h2>Full-screen terminal interface</h2>
<p>Here's a video demonstration of a terminal interface built with Layout:</p>
<p>
<iframe width="auto" src="https://www.youtube.com/embed/slrdSojCvlk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</p>
<h2>Layout API</h2>
<p>The API to create a flexible layout is surprisingly simple. You construct a <code>Layout()</code> object, then call <code>split()</code> to create sub-layouts. These sub-layouts may then be further divided. Layouts have a small number of settings which define their size relative to the terminal window. It's a simple system that can create terminal interfaces that almost resemble modern web apps.</p>
<div><figure> <img width="1140" height="724" title="layout_vscode.png" name="layout_vscode" data-md="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.md.3.jpeg" data-square="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.square.7.jpeg" data-xlg2x="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.xlg2x.2.jpeg" data-lg="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.lg.3.jpeg" data-xlg="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.xlg.8.jpeg" data-author="© 2021 Will McGugan<br>all rights reserved" data-og_preview="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.og.preview.2.jpeg" data-height="2100" data-width="3308" data-toggle="tooltip" data-details=" " data-sm="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.sm.3.jpeg" data-blur="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.blur.6.jpeg" data-slug="layout_vscode" sizes="(min-width: 1200px) 1170px, (min-width: 992px) 970px, (min-width: 768px) 750px" srcset="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.lg.3.jpeg 1170w, https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.md.3.jpeg 970w, https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.sm.3.jpeg 750w" src="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.lg.3.jpeg"> 
<figcaption>
<p>© 2021 Will McGugan</p>


<p>A Rich layout in VSCode</p>


</figcaption>

</figure>
</div>
<h2>Finally, some code</h2>
<p>Here's how you would create a basic layout with a header, a footer, and two side-panels.</p>
<pre><code>from rich.console import Console
from rich.layout import Layout

console = Console()
layout = Layout()

# Divide the "screen" in to three parts
layout.split(
    Layout(name="header", size=3),
    Layout(ratio=1, name="main"),
    Layout(size=10, name="footer"),
)
# Divide the "main" layout in to "side" and "body"
layout["main"].split(
    Layout(name="side"),
    Layout(name="body", ratio=2),
    direction="horizontal"
)
# Divide the "side" layout in to two
layout["side"].split(Layout(), Layout())

console.print(layout)
</code></pre>
<p>Running the code above produces the following output:</p>
<div><figure> <img width="1140" height="739" title="layout.png" name="layout" data-md="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.md.3.jpeg" data-square="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.square.7.jpeg" data-xlg2x="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.xlg2x.2.jpeg" data-lg="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.lg.3.jpeg" data-xlg="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.xlg.8.jpeg" data-author="© 2021 Will McGugan<br>all rights reserved" data-og_preview="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.og.preview.2.jpeg" data-height="1464" data-width="2258" data-toggle="tooltip" data-details=" " data-sm="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.sm.3.jpeg" data-blur="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.blur.6.jpeg" data-slug="layout" sizes="(min-width: 1200px) 1170px, (min-width: 992px) 970px, (min-width: 768px) 750px" srcset="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.lg.3.jpeg 1170w, https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.md.3.jpeg 970w, https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.sm.3.jpeg 750w" src="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.lg.3.jpeg"> 
<figcaption>
<p>© 2021 Will McGugan</p>


<p>Terminal split in to 5 sub-layouts. The boxes are placeholders, you can insert any content in their place.</p>


</figcaption>

</figure>
</div>
<p>Any renderable (text, table, progress bars etc) may be placed inside those sub-layouts.</p>
<p>We can now use the <a href="https://rich.readthedocs.io/en/latest/live.html">Live</a> class to create an application that adapts itself to the terminal window:</p>
<pre><code>from rich.live import Live
from time import sleep

with Live(layout, screen=True):
    while True:
        sleep(1)
</code></pre>
<p>In a real app, that do-nothing loop will be doing something useful like pulling data from the network to update contents.</p>
<p>See the <a href="https://rich.readthedocs.io/en/latest/layout.html">layout docs</a> for an in-depth tutorial.</p>
<h2>What's next?</h2>
<p>I think it's clear that Rich is acquiring more TUI (text user interface) features, and I've decided not to fight it. Rich's core purpose is still to beautify CLI output, but I think there is an opportunity here for a new way to create terminal apps. Ultimately it will be less like curses and more like HTML in a browser.</p>
<p>There are a number of things to do before Rich could replace a full TUI library (keyboard and mouse input for one) but the potential is there. Stay tuned for progress.</p>
<p>Follow <a href="https://twitter.com/willmcgugan">@willmcgugan</a> for more Rich related news.</p>



</article></div>]]>
            </description>
            <link>https://www.willmcgugan.com/blog/tech/post/building-rich-terminal-dashboards/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26149488</guid>
            <pubDate>Tue, 16 Feb 2021 00:16:50 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Performance Optimization Contest]]>
            </title>
            <description>
<![CDATA[
Score 26 | Comments 2 (<a href="https://news.ycombinator.com/item?id=26149436">thread link</a>) | @robfig
<br/>
February 15, 2021 | https://easyperf.net/blog/2019/02/02/Performance-optimization-contest | <a href="https://web.archive.org/web/*/https://easyperf.net/blog/2019/02/02/Performance-optimization-contest">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
				<p><strong>Contents:</strong></p>
<ul id="markdown-toc">
  <li><a href="#about-this-contest" id="markdown-toc-about-this-contest">About this contest</a></li>
  <li><a href="#qa" id="markdown-toc-qa">Q&amp;A</a>    <ul>
      <li><a href="#q0-why-the-hell-on-earth-i-should-participate-in-this-contest" id="markdown-toc-q0-why-the-hell-on-earth-i-should-participate-in-this-contest">Q0: <em>Why <del>the hell</del> on earth I should participate in this contest?</em></a></li>
      <li><a href="#q1-what-benchmarks-are-taken-into-the-contest" id="markdown-toc-q1-what-benchmarks-are-taken-into-the-contest">Q1: <em>What benchmarks are taken into the contest?</em></a></li>
      <li><a href="#q2-what-is-the-machineenvironment-we-will-be-optimizing-for" id="markdown-toc-q2-what-is-the-machineenvironment-we-will-be-optimizing-for">Q2: <em>What is the machine/environment we will be optimizing for?</em></a></li>
      <li><a href="#q3-what-if-i-dont-have-the-environment-you-are-using" id="markdown-toc-q3-what-if-i-dont-have-the-environment-you-are-using">Q3: <em>What if I don’t have the environment you are using?</em></a></li>
      <li><a href="#q4-how-i-should-find-performance-headrooms" id="markdown-toc-q4-how-i-should-find-performance-headrooms">Q4: <em>How I should find performance headrooms?</em></a></li>
      <li><a href="#q5-what-optimizations-are-allowed" id="markdown-toc-q5-what-optimizations-are-allowed">Q5: <em>What optimizations are allowed?</em></a></li>
      <li><a href="#q6-whats-not-allowed" id="markdown-toc-q6-whats-not-allowed">Q6: <em>What’s NOT allowed</em></a></li>
      <li><a href="#q7-how-should-the-submission-look-like" id="markdown-toc-q7-how-should-the-submission-look-like">Q7: <em>How should the submission look like?</em></a></li>
      <li><a href="#q8-how-i-will-test-your-solutions" id="markdown-toc-q8-how-i-will-test-your-solutions">Q8: <em>How I will test your solutions?</em></a></li>
      <li><a href="#q9-how-i-will-select-the-winner" id="markdown-toc-q9-how-i-will-select-the-winner">Q9: <em>How I will select the winner?</em></a></li>
    </ul>
  </li>
  <li><a href="#how-to-get-started" id="markdown-toc-how-to-get-started">How to get started?</a></li>
  <li><a href="#hints" id="markdown-toc-hints">Hints</a></li>
  <li><a href="#list-of-contest-editions" id="markdown-toc-list-of-contest-editions">List of contest editions</a></li>
</ul>

<hr>
<p><strong>Subscribe to my <a href="https://mailchi.mp/4eb73720aafe/easyperf">mailing list</a>, support me on <a href="https://www.patreon.com/dendibakh">Patreon</a> or by PayPal <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&amp;business=TBM3NW8TKTT34&amp;currency_code=USD&amp;source=url">donation</a>.</strong></p>

<hr>

<h3 id="about-this-contest">About this contest</h3>

<p>Hello everybody!</p>

<p>I decided to try new thing at the beginning of 2019. You probably heard about competitive programming and about popular web-sites like <a href="https://www.topcoder.com/">Topcoder</a>, <a href="https://www.codility.com/">Codility</a> and others. The idea is that you can try yourself in solving programming puzzles. Usually it’s not enough to just solve the puzzle, your solution must qualify for certain criterias such as algorithmic complexity and memory usage. Also on a real challenges it is improtant how fast you solved the problem.</p>

<p>Those sort of challenges usually test your problem solving skills as well as your knowledge of algorithms and data structures. It is a kind of tasks we usually see on programming job interviews. You need to write the code from scratch to a complete solution.</p>

<p>What I am starting is also a form of contest but aims at developing different set of skills. <strong>We will train to optimize already optimized code</strong>. We will learn hardware optimizations. This is briefly how it will look like: I will pick one existing benchmark of my choice and will send it to all my subscribers. You will have the time to play with the benchmark and find all performance headrooms you can find. You then send all your findings to me (modified sources/assemblies/compiler patches?/whatever speeds up the benchmark) and I check it and run on my hardware. At the end I will anounce the winners.</p>

<p>Before I explain it in more details I feel a need of writing disclaimer:</p>

<blockquote>
  <p><strong>Disclaimer</strong>: This is absolutely non-profit effort. I’m not looking for make any money from it or using someone’s knowledge in my own purposes. I will not use submissions to extract any intellectual property they might have. Also this is not aiming to advertise any particular software product including benchmarks/compilers. That’s why all the benchmarks and compilers I will use require to be open sourced. Neither it aims to advertise any particular HW.</p>
</blockquote>

<p>In this contest I try to emulate the situation in performance critical projects on the final stages. When all the functionality is delivered and tested. But before shipping the binary to the customers you were asked to tune the app to it’s peak performance. You know the hardware it will be deployed to. You have the sources in your hands and freedom to modify it (without introducing any bugs :) ). You are the build master, so you can add any compiler flags you want.</p>

<p>For the challenges that I will send I’m not looking for optimizations that fall into the category: “Oh, I just used quicksort instead of bubblesort”. Expect the benchmark to be already optimized to some degree. Your task is to tune it for particular hardware to the peak performance.</p>

<h3 id="qa">Q&amp;A</h3>

<h4 id="q0-why-the-hell-on-earth-i-should-participate-in-this-contest">Q0: <em>Why <del>the hell</del> on earth I should participate in this contest?</em></h4>

<p><strong>A0</strong>: You will learn/practice how to do optimizations for HW. This might include eliminating cache misses by inserting prefetch instructions, getting rid of <a href="https://easyperf.net/blog/2018/01/18/Code_alignment_issues">Code alignment issues</a>, improving performance by helping compiler to vectorize/unroll the loop better. You will learn different techniques as you go.</p>

<hr>
<h4 id="q1-what-benchmarks-are-taken-into-the-contest">Q1: <em>What benchmarks are taken into the contest?</em></h4>

<p><strong>A1</strong>: It will be open sourced benchmark written in C/C++. Usually several source files. It should be easy to build, require minimal dependencies. Preferably it should have some form of validation.</p>

<hr>
<h4 id="q2-what-is-the-machineenvironment-we-will-be-optimizing-for">Q2: <em>What is the machine/environment we will be optimizing for?</em></h4>

<p><strong>A2</strong>: Most likely it will be 64 bit Linux with Intel x86 CPU (probably Haswell architecture). For a start I will not bother with disabling CPU <a href="https://en.wikipedia.org/wiki/Dynamic_frequency_scaling">dynamic frequency scaling</a> features or setting <a href="https://en.wikipedia.org/wiki/Processor_affinity">thread affinity</a>. I might do this in future.</p>

<hr>
<h4 id="q3-what-if-i-dont-have-the-environment-you-are-using">Q3: <em>What if I don’t have the environment you are using?</em></h4>

<p><strong>A3</strong>: It doesn’t matter much. If you don’t have Intel CPU or you are on Windows/Mac, just optimize for whatever you have. I would be happy to know about optimizations that help other CPUs, operating systems, etc.
<strong>I don’t have real prizes to give, so it’s mostly practicing and learning</strong>.</p>

<hr>
<h4 id="q4-how-i-should-find-performance-headrooms">Q4: <em>How I should find performance headrooms?</em></h4>

<p><strong>A4</strong>: Use all of your knowledge. Start with profiling the benchmark. You can browse through posts on this blog. Additionally I will write a separate post that might help begginers.</p>

<hr>
<h4 id="q5-what-optimizations-are-allowed">Q5: <em>What optimizations are allowed?</em></h4>

<p><strong>A5</strong>: Good news! <strong>All the dirty tricks allowed</strong>! The goal of this contest is to learn how to squeeze as much performance as possible from the hardware using any means available. You can modify sources and insert any compiler hints like pragmas, builtins, function attributes, etc. Also you can generate assembly listing (<code>-S</code> compiler option) and modify it. Finally, you can add some compiler option that might speed up the benchmark.</p>

<hr>
<h4 id="q6-whats-not-allowed">Q6: <em>What’s NOT allowed</em></h4>

<p><strong>A6</strong>: 1) Do not rewrite the benchmark completely or introduce major changes in algorithms. The good judging rule is “everything interesting should be calculated in runtime”.</p>

<p>2) Do not manually parallelize the benchmark, e.g converting it from single- to multi-threaded or offload computations to the GPU. I mean, I’m glad that you can do it and I will be happy to take a look what you did, but it’s not the intent of the contest.</p>

<p>3) Using <a href="https://en.wikipedia.org/wiki/Profile-guided_optimization">PGO</a> is allowed, however you can use it only for driving you optimizations, not for the submission. So, you can check how the benchmark gets better with PGO and understand why. And then make this optimization manually. Again, the purposes is practicing and learning.</p>

<hr>
<h4 id="q7-how-should-the-submission-look-like">Q7: <em>How should the submission look like?</em></h4>

<p><strong>A7</strong>: 1) I will not accept binaries for security reasons.</p>

<p>2) You can send patch files that I can apply to the sources of the benchmark or just assembly listing. If you did multiple optimizations please split them in separate patches. <code>git format-patch</code> is the right tool for that. This will save me a lot of time.</p>

<p>3) If you send assembly listing files please do also include diff file from the baseline (what you changed in the assembly). If you provide modified assembly listings it should be genearted only with open-sourced C/C++ compilers like gcc and clang. You can of course cheat and generate assembly with some other compiler that is better for the benchmark, but I will probably easily detect that. And it’s not about tricking, it’s about learning.</p>

<p>4) Make sure you specify clearly the compiler options if they are different from the baseline.</p>

<p>5) If you are capable of hacking compiler that’s also acceptable. You can send me patches for gcc/llvm compilers which I can apply and use for building the benchmark. Please use the top of tree revisions because it will be easier for me to apply them. We can then use it for improving our open source compilers. Also it would be very nice if you can send me textual description of all the optimizations you made.</p>

<hr>
<h4 id="q8-how-i-will-test-your-solutions">Q8: <em>How I will test your solutions?</em></h4>

<p><strong>A8</strong>: I will take your sources, build them on my machine and run the benchmark. I will run your binary multiple times (depends on the running time) and <a href="http://blog.kevmod.com/2016/06/benchmarking-minimum-vs-average/">take the minimum</a>. I’m thinking about testing all the solutions on some cloud machine, but that’s not settled yet.</p>

<hr>
<h4 id="q9-how-i-will-select-the-winner">Q9: <em>How I will select the winner?</em></h4>

<p><strong>A9</strong>: I will calculate your score as a ratio between execution time of the binary with your optimizations and the baseline.</p>

<hr>
<p>I know there is a lot more concerns you might have. This is just a first attempt with focus on learning how to do HW optimizations. In the end I don’t have real prizes to give out. :) After each contest I will share all the findings people did, so there is a big opportunity to learn from others! I know that a number of really experienced guys read this blog, so I encourage everyone to participate. Everyone is welcome!</p>

<p>All communication (including sending benchmarks and score submissions) will happen through emails, so <strong>make sure to subscribe</strong> using the form at the bottom of the page! I am planning to start first contest in the end of February 2019.</p>

<p>Let me know what you think about it or if you have any ideas or comments. You can also vote if you like it using the buttons below.</p>

<h3 id="how-to-get-started">How to get started?</h3>

<ol>
  <li>Collect the baseline (use <code>time</code> or analogs).</li>
  <li>Find the hotspot (use <code>perf record</code>).</li>
  <li>Find performance headroom
    <ul>
      <li>Take a look at the assembly and try to guess how you can do better.</li>
      <li>Run through <a href="https://easyperf.net/blog/2019/02/09/Top-Down-performance-analysis-methodology">TMAM</a> process.</li>
    </ul>
  </li>
  <li>Build the benchmark, run it and compare against baseline.</li>
</ol>

<h3 id="hints">Hints</h3>

<ul>
  <li>Do not try to understand the whole benchmark. For some people (including me) it’s crucial to understand how every peace of code works. For the purposes of optimizing it will be wasted effort. There are CPU benchmarks with thousands LOC (like <a href="http://spec.org/cpu2017/">SPEC2017</a>) it’s absoultely impossible to understand them in a reasonable time. What you need to familiarize yourself with are hotspots. That’s it. You most likely need to understand one function/loop which is not more than 100 LOC.</li>
  <li>You have specific workload for which you optimize the benchmark. You don’t need to optimize it for any other input/workload. The main principle behind <a href="https://en.wikipedia.org/wiki/Data-oriented_design">Data-oriented design</a> is that you know the data of your application.</li>
</ul>

<p>Information presented in llvm documentation: <a href="https://llvm.org/docs/Benchmarking.html">Benchmarking tips</a> migth also be helpful.</p>

<h3 id="list-of-contest-editions">List of contest editions</h3>

<ul>
  <li><a href="https://easyperf.net/blog/2019/02/16/Performance-optimization-contest-1">Contest #1</a> - 16 Feb 2019.</li>
  <li><a href="https://easyperf.net/blog/2019/04/10/Performance-analysis-and-tuning-contest-2">Contest #2</a> - 10 Apr 2019.</li>
  <li><a href="https://easyperf.net/blog/2019/05/28/Performance-analysis-and-tuning-contest-3">Contest #3</a> - 28 May 2019.</li>
  <li><a href="https://easyperf.net/blog/2021/02/05/Performance-analysis-and-tuning-contest-4">Contest #4</a> - 05 Feb 2021.</li>
</ul>

			</div></div>]]>
            </description>
            <link>https://easyperf.net/blog/2019/02/02/Performance-optimization-contest</link>
            <guid isPermaLink="false">hacker-news-small-sites-26149436</guid>
            <pubDate>Tue, 16 Feb 2021 00:09:28 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Ark 1]]>
            </title>
            <description>
<![CDATA[
Score 51 | Comments 39 (<a href="https://news.ycombinator.com/item?id=26148865">thread link</a>) | @simonpure
<br/>
February 15, 2021 | https://www.lot2046.com/ark-1 | <a href="https://web.archive.org/web/*/https://www.lot2046.com/ark-1">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><div id="content_360_38"><div id="ark-1_hero_back"><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_back.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_back@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_back@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_back.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_back@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_back.jpg"></picture><p>Cabin porn.</p></div><div id="ark-1_hero_left"><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_left.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_left@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_left@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_left.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_left@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_left.jpg"></picture><p>LOT 0983 — ARK 1; 6.4m x 3m x 2.6m; 13m² internally; 17m² externally; <br>4.5m x 1.6m window; rechargeable battery bank; electric powertrain.</p></div><div id="ark-1_hero_top"><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_top.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_top@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_top@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_top.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_top@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_top.jpg"></picture><p>A rechargeable solid state Lithium Ion battery for an EPA estimated range of 500+ miles, <br>600W solar panel roof with 5G and Starlink™ antennas.</p></div><div id="ark-1_hero_boulder-1"><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_boulder-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_boulder-1@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_boulder-1@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_boulder-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_boulder-1@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_boulder-1.jpg"></picture><p>Off-road, self-driving, autonomous, off-grid mobile home.</p></div><div id="ark-1_hero_boulder-2"><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_boulder-2.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_boulder-2@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_boulder-2@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_boulder-2.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_boulder-2@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_boulder-2.jpg"></picture><p>Home on the range.</p></div><div id="ark-1_hero_right"><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_right.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_right@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hero_right@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_right.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_right@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hero_right.jpg"></picture><p>Breakfast of champions.</p></div><hr><p>Product range:</p><div id="ark-1_asset_tire-table-1"><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_asset_tire-table-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_asset_tire-table-1@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_asset_tire-table-1@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_asset_tire-table-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_asset_tire-table-1@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_asset_tire-table-1.jpg"></picture></div><hr><div id="ark-1_main-text"><div><p>Humans have never really lived on earth. 
</p><p>In fear of the cold, famines, and war, we chose to huddle in caves, camps, and cities in order to dwell near pooled resources, fearing unknown calamities.&nbsp;But the internet has changed all this. Accessibility no longer requires proximity. You no longer have to physically relocate in order to acquire the tools and resources you need to live a comfortable life. We are moving towards a reality where work and location no longer need to depend on the other. With the rapidly growing infrastructures of telecommunications, green energy, delivery services, and travel flexibility – both in pace of advancement and market size – a new way of working and living is emerging.
</p><p>One in which we no longer need to rely solely on outdated frameworks of metropolitan densities to support a given lifestyle.
</p><p>Flattening density is the way forward.
</p><p>Entire economies will need to re-evaluate what it means to give flexibility just as its users are realizing the boundaries of these new flexibilities. We’re already seeing an exodus of major metropolises. Lockdown hysteria has forced us to consider whether the paths we thought we prescribed ourselves is really ours. As this changes how many will choose to live, LOT is building a mission to earth.
</p><p>ARK 1 is an off-road, mobile dwelling. It features plug and play modular parts, a rechargeable battery pack, solar roof, 4 wheel steering, independent suspension, and can be equipped with full self-driving capabilities. 
</p><p>By treating the home as the ultimate appliance, we’re building a vehicle to nourish the self. If your home could take you anywhere, and there’s no more point A to point B, where would you go? </p></div></div><div><div id="ark-1_crawl-mode"><div><div><p>Crawl Mode</p><p><iframe src="https://www.youtube.com/embed/UFBsLeqcMR8?controls=0&amp;color=white" frameborder="0" allowfullscreen=""></iframe></p></div><div><div><p>ARK 1 utilizes all of its on-board self-driving cameras/sensors to enable it to drive autonomously on off-road, off-grid terrain.
</p><p>It is also equipped with a drone that acts as eyes by flying ahead to map trickier surfaces in order to provide the best possible route (fog map). This feature is not meant for navigating conventional roads, as there are no lanes to switch or traffic lights to watch for. Only surface and elevation changes to traverse, which it does slowly, so if you wanted to go to bed in the desert and wake up at the coastline, you can.</p></div></div></div></div></div><p>Eyes:</p><div id="ark-1_asset-drone-1"><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_asset_drone-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_asset_drone-1@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_asset_drone-1@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_asset_drone-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_asset_drone-1@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_asset_drone-1.jpg"></picture></div><div><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_asset_drone-2.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_asset_drone-2@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_asset_drone-2@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_asset_drone-2.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_asset_drone-2@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_asset_drone-2.jpg"></picture><p>LOT 0983-2</p></div><hr><div><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-10.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-10@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-10@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-10.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-10@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-10.jpg"></picture><p>19:23 – Monday, May 18 at El Capitan, 34.465976, -120.024302</p></div><div><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-9.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-9@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-9@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-9.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-9@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-9.jpg"></picture><p>19:21 – Monday, May 18 at El Capitan, 34.465976, -120.024302</p></div><div><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-1@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-1@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-1@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-1.jpg"></picture><p>18:43 – Friday, April 10 at Joshua Tree, 33.977110, -116.020468</p></div><div><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-15.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-15@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-15@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-15.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-15@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-15.jpg"></picture><p>17:30 – Wednesday, May 20 at Austin Creek, 47.837902, -121.611665</p></div><div><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-3.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-3@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_hdr-3@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-3.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-3@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_hdr-3.jpg"></picture><p>19:55 – Wednesday, May 20 at Austin Creek, 47.837902, -121.611665</p></div><hr><p>Details:</p><hr><div><a id="ark-1_ar-icon" rel="ar" href="https://lot2046-images.s3.amazonaws.com/ark/ark-1.usdz"><svg width="92" height="84" viewBox="0 0 92 84" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M56.7205 35.5L46.4 41.5" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path d="M77.7205 23.5L67.4 29.5" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path d="M25.7205 53.5L15.4 59.5" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path d="M46.4 41.5V51.5" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path d="M46.4 68.5V78.5" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path d="M46.4 4.5V14.5" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path d="M37.0441 36.1526L46.4 41.5" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path d="M15.0441 23.1526L24.4 28.5" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path d="M69.0441 54.1526L78.4 59.5" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path><path opacity="0.5" d="M46.5 3.5V79.5" stroke="black" stroke-linecap="square"></path><path opacity="0.5" d="M13.3232 22.4402L79.6499 60.6511" stroke="black" stroke-linecap="square"></path><path opacity="0.5" d="M13.3191 60.6432L79.678 22.3797" stroke="black" stroke-linecap="square"></path><path opacity="0.5" fill-rule="evenodd" clip-rule="evenodd" d="M46.5 3L79.842 22.25V60.75L46.5 80L13.158 60.75V22.25L46.5 3Z" stroke="black"></path><mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="92" height="84"><path fill-rule="evenodd" clip-rule="evenodd" d="M37.7968 0H55.7968V25.9515L82.2032 10.7058L91.2032 26.2942L64.866 41.5L91.2032 56.7058L82.2032 72.2942L55.7968 57.0485V84H37.7968V57.1284L9.79681 73.2942L0.796814 57.7058L28.866 41.5L0.796814 25.2942L9.79681 9.70577L37.7968 25.8716V0Z" fill="white"></path></mask><g mask="url(#mask0)"><path fill-rule="evenodd" clip-rule="evenodd" d="M46.5 3L79.842 22.25V60.75L46.5 80L13.158 60.75V22.25L46.5 3Z" stroke="black" stroke-width="3"></path></g></svg></a><p>Try your ARK 1 in the wild. Tap on the icon above 
<br>to experience it true to scale. Only available on iOS devices (for now) <a href="https://lot2046-images.s3.amazonaws.com/ark/ark-1.usdz" rel="ar">see ARK 1 in AR</a></p></div><hr><div><p id="ark-1_white-paper-title">White paper</p><div id="ark-1_white-paper-image"><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_white-paper.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_white-paper@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_white-paper@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_white-paper.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_white-paper@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_white-paper.jpg"></picture></div><p>Read our full proposal for ARK 1 on <a href="https://docs.google.com/document/d/1eedNlGgE11JfQgKiYzw33XpsmupT_pjrGBESwHnT8EE/edit" target="_blank">Google Docs</a></p></div><hr><div><p id="ark-1_calculator-title">How much will my ARK 1 subscription cost?</p><div><p>1 day</p><p>365 days</p><div><p>Travel to reservation site</p><p>24/7 access to LOT community centers</p><p>For use in designated areas only</p><p>Remote security</p><p>24/7 roadside assistance</p><p>Remote check-in/out</p><p>Reservation delivery</p><p>Open road travel</p><p>Towing Vehicle (Powered by JEEP®)</p><p>LOT Life subscription, basic self-care products</p><p>Remote smart address (delivery locker, automatic postal routing, DMV untethered, utilities)</p><p>Water delivery, food boxes</p><p>Citizenship Assistance (legal aid, medical care, licensing, property insurance)</p></div><div><p>Your ARK 1 subscription estimate:<br><span>X days</span><span>, ~X month</span></p></div></div></div><hr><div><p id="ark-1_reserve-title">Reserve your ARK 1 now:</p><div><picture><source media="(max-width: 799px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_key-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_key-1@2x.jpg 2x, https://lot2046-images.s3.amazonaws.com/ark/mobile/lot_2046_ark-1_key-1@3x.jpg 3x"><source media="(min-width: 800px)" srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_key-1.jpg, https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_key-1@2x.jpg 2x"><img srcset="https://lot2046-images.s3.amazonaws.com/ark/desktop/lot_2046_ark-1_key-1.jpg"></picture></div><p><b>$100</b></p><div id="ark-1_reserve-body"><p>LOT 0192-2, ARK 1 multitool (bottle opener, hex wrench set, buckle, keychain); 
<br>powder-coated steel; personalized number indicating queue position; 50g.
</p><p>
By purchasing this physical token, you are reserving your place in line. 
<br>When the time comes, we will be shipping ARK 1s according to this waitlist.</p></div><p><a id="ark-1_reserve-button" href="https://supply.lot2046.com/products/ark-1-multifunction-tool-reservation-number" target="_blank">Buy now to reserve your queue in line</a></p><p id="ark-1_reserve-postfix">We ship worldwide. No refunds. 
<br>Exception to missing or damaged shipment.</p></div></div></div></div>]]>
            </description>
            <link>https://www.lot2046.com/ark-1</link>
            <guid isPermaLink="false">hacker-news-small-sites-26148865</guid>
            <pubDate>Mon, 15 Feb 2021 23:08:53 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[How I survive 12 hour flights]]>
            </title>
            <description>
<![CDATA[
Score 28 | Comments 38 (<a href="https://news.ycombinator.com/item?id=26148684">thread link</a>) | @aminozuur
<br/>
February 15, 2021 | https://eftegarie.com/how-i-survive-12-hour-flights/ | <a href="https://web.archive.org/web/*/https://eftegarie.com/how-i-survive-12-hour-flights/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="post-4388">

			

			<div>

	
				<p>I have developed&nbsp;some&nbsp;tricks&nbsp;that&nbsp;have helped me survive long flights. Here they are, in case they might help anyone else:</p>
<ul>
<li><strong>Noise-canceling headphones</strong><br>
I’m sensitive to noise so this is a life-saver. The engines on long-haul flights are way louder than on short-haul flights.</li>
<li><strong>Offline playlist in Spotify</strong><br>
Include&nbsp;tons of music and podcasts.</li>
<li><strong>Pay for Wifi</strong><br>
If you can afford it, pay the $30 or whatever it is for WiFi. It will be slow as hell, but it will be worth it. Do not buy those cheap “10MB” packages, as they will be used up fast.</li>
<li><strong>Dress comfortably<br>
</strong>No jeans. Wear jogging pants or whatever you like. And bring a sweater,&nbsp;for when the plane gets cold</li>
<li><strong>Shoes off</strong><br>
I take my shoes off the moment I sit down in my seat. Having your shoes on that long gets uncomfortable.</li>
<li><strong>Random toilet visits</strong><br>
I go there even if I don’t need to pee. I just sit by myself, relax, and wash my hands for refreshment. Just to switch the setting around.</li>
<li><strong>Books</strong><br>
Load up your phone with EPUBs of books you’ve been wanting to read.</li>
<li><strong>Free food<br>
</strong>Go to the stall (at the end of the airplane) and tell the stewardess that you’re hungry, ask for drinks, sandwiches, whatever you want. They will give it to you for free.</li>
<li><strong>Bring snacks</strong><br>
Buy a Big Mac before boarding the plane, and eat it whenever you want. Bring chocolate and other snacks.</li>
<li><strong>Sit/sleep wherever the fuck you want<br>
</strong>If the plane is half-empty, go walk around and choose a&nbsp;new seat&nbsp;wherever you want. Like a window seat, or take three seats, put up the armrest and stretch out for a nap.&nbsp;Do not ask the stewards if it’s OK to switch seats, they might say no. But if you do it without asking, they won’t give a fuck.</li>
</ul>
<p>
February 15, 2021


			</p></div>
		</div></div>]]>
            </description>
            <link>https://eftegarie.com/how-i-survive-12-hour-flights/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26148684</guid>
            <pubDate>Mon, 15 Feb 2021 22:53:16 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[What security does a default OpenBSD installation offer?]]>
            </title>
            <description>
<![CDATA[
Score 114 | Comments 87 (<a href="https://news.ycombinator.com/item?id=26148667">thread link</a>) | @zdw
<br/>
February 15, 2021 | https://dataswamp.org/~solene/2021-02-14-openbsd-default-security.html | <a href="https://web.archive.org/web/*/https://dataswamp.org/~solene/2021-02-14-openbsd-default-security.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
<article id="20210214">
  <header>
  
    
    <p>Written by <em>Solène</em>, on 14 February 2021.<br>Tags: 
<span><a href="https://dataswamp.org/~solene/tag-openbsd69.html">#openbsd69</a></span>


<span><a href="https://dataswamp.org/~solene/tag-openbsd.html">#openbsd</a></span>


<span><a href="https://dataswamp.org/~solene/tag-security.html">#security</a></span>

</p>
    
  </header>
  
<p>In this text I will explain what makes OpenBSD secure by default when you install it.  Do not take this for a security analysis, but more like a guide to help you understand what is done by OpenBSD to have a secure environment.  The purpose of this text is not to compare OpenBSD to others OS but to say what you can honestly expects from OpenBSD.
</p>
<p>There are no security without a threat model, I always consider the following cases: computer stolen at home by a thief, remote attacks trying to exploit running services, exploit of user network clients.
</p>

<p>Here is a list of features that I consider important for an operating system security.  While not every item from the following list are strictly security features, they help having a strict system that prevent software to misbehave and lead to unknown lands.
</p>
<p>In my opinion security is not only about preventing remote attackers to penetrate the system, but also to prevent programs or users to make the system unusable.
</p>
<h2> Pledge / unveil on userland</h2>
<p>Pledge and unveil are often referred together although they can be used independently.  Pledge is a system call to restrict the permissions of a program at some point in its source code, permissions can't be get back once pledge has been called.  Unveil is a system call that will hide all the file system to the process except the paths that are unveiled, it is possible to choose what permissions is allowed for the paths.
</p>
<p>Both a very effective and powerful surgical security tools but they require some modification within the source code of a software, but adding them requires a deep understanding on what the software is doing.  It is not always possible to forbid some system calls to a software that requires to do almost anything, software designed with privilege separation are better candidate for a proper pledge addition because each part has its own job.
</p>
<p>Some software in packages have received pledge or/and unveil support, like Chromium or Firefox for the most well known.
</p>
<p><a href="https://www.openbsd.org/papers/bsdcan2019-unveil/index.html">OpenBSD presentation about Unveil (BSDCan2019)</a></p>
<p><a href="https://www.openbsd.org/papers/BeckPledgeUnveilBSDCan2018.pdf">OpenBSD presentation of Pledge and Unveil (BSDCan2018)</a></p>
<h2> Privilege separation</h2>
<p>Most of the base system services used within OpenBSD runs using a privilege separation pattern.  Each part of a daemon is restricted to the minimum required.  A monolithic daemon would have to read/write files, accept network connections, send messages to the log, in case of security breach this allows a huge attack surface.  By separating a daemon in multiple parts, this allow a more fine grained control of each workers, and using pledge and unveil system calls, it's possible to set limits and highly reduce damage in case a worker is hacked.
</p>
<h2> Clock synchronization</h2>
<p>The daemon server is started by default to keep the clock synchronized with time servers.  A reference TLS server is used to challenge the time servers.  Keeping a computer with its clock synchronized is very important.  This is not really a security feature but you can't be serious if you use a computer on a network without its time synchronized.
</p>
<h2> X display not as root</h2>
<p>If you use the X, it drops privileges to _x11 user, it runs as unpriviliged user instead of root, so in case of security issue this prevent an attacker of accessing through a X11 bug more than what it should.
</p>
<h2> Resources limits</h2>
<p>Default resources limits prevent a program to use too much memory, too many open files or too many processes.  While this can prevent some huge programs to run with the default settings, this also helps finding file descriptor leaks, prevent a fork bomb or a simple daemon to steal all the memory leading to a crash.
</p>
<h2> Genuine full disk encryption</h2>
<p>When you install OpenBSD using a full disk encryption setup, everything will be locked down by the passphrase at the bootloader step, you can't access the kernel or anything of the system without the passphrase.
</p>
<h2> W^X</h2>
<p>Most programs on OpenBSD aren't allowed to map memory with Write AND Execution bit at the same time (W^X means Write XOR Exec), this can prevents an interpreter to have its memory modified and executed.  Some packages aren't compliant to this and must be linked with a specific library to bypass this restriction AND must be run from a partition with the "wxallowed" option.
</p>
<p><a href="https://www.openbsd.org/papers/hackfest2015-w-xor-x.pdf">OpenBSD presentation « Kernel W^X Improvements In OpenBSD »</a></p>
<h2> Only one reliable randomness source</h2>
<p>When your system requires a random number (and it does very often), OpenBSD only provides one API to get a random number and they are really random and can't be exhausted.  A good random number generator (RNG) is important for many cryptography requirements.
</p>
<p><a href="https://www.openbsd.org/papers/hackfest2014-arc4random/index.html">OpenBSD presentation about arc4random</a></p>
<h2> Accurate documentation</h2>
<p>OpenBSD comes with a full documentation in its man pages.  One should be able to fully configure their system using only the man pages.  Man pages comes with CAVEATS or BUGS sections sometimes, it's important to take care about those sections.  It is better to read the documentation and understand what has to be done in order to configure a system instead of following an outdated and anonymous text available on the Internet.
</p>
<p><a href="https://man.openbsd.org/">OpenBSD man pages online</a></p>
<p><a href="https://www.openbsd.org/papers/eurobsdcon2018-mandoc.pdf">EuroBSDcon 2018 about « Better documentation »</a></p>
<h2> IPSec and Wireguard out of the box</h2>
<p>If you need to setup a VPN, you can use IPSec or Wireguard protocols only using the base system, no package required.
</p>
<h2> Memory safeties</h2>
<p>OpenBSD has many safeties in regards to memory allocation and will prevent use after free or unsafe memory usage very aggressively, this is often a source of crash for some software from packages because OpenBSD is very strict when you want to use the memory.  This helps finding memory misuses and will kill software misbehaving.
</p>
<h2> Dedicated root account</h2>
<p>When you install the system, a root account is created and its password is asked, then you create an user that will be member of "wheel" group, allowing it to switch user to root with root's password.  doas (OpenBSD base system equivalent of sudo) isn't configured by default.  With the default installation, the root password is required to do any root action.  I think a dedicated root account that can be logged in without use of doas/sudo is better than a misconfigured doas/sudo allowing every thing only if you know the user password.
</p>
<h2> Small network attack surface</h2>
<p>The only services that could be enabled at installation time listening on the network are OpenSSH (asked at install time with default = yes), dhclient (if you choose dhcp) and slaacd (if you use ipv6 in automatic configuration).
</p>
<h2> Encrypted swap</h2>
<p>By default the OpenBSD swap is encrypted, meaning if programs memory are sent to the swap nobody can recover it later.
</p>
<h2> SMT disabled</h2>
<p>Due to a heavy number of security breaches due to SMT (like hyperthreading), the default installation disable half the logical cores to prevent any data leak.
</p>
<p><a href="https://en.wikipedia.org/wiki/Meltdown_(security_vulnerability)">Meltdown: one of the first security issue related to speculative execution in the CPU</a></p>
<h2> Micro and Webcam disabled</h2>
<p>With the default installation, both microphone and webcam won't actually record anything except blank video/sound until you set a sysctl for this.
</p>
<h3> Maintainability, release often, update often</h3>
<p>The OpenBSD team publish a new release a new version every six months and only last two releases receives security updates.  This allows to upgrade often but without pain, the upgrade process are small steps twice a year that help keep the whole system up to date.  This avoids the fear of a huge upgrade and never doing it and I consider it a huge security bonus.  Most OpenBSD around are running latest versions.
</p>
<h3> Signify chain of trust</h3>
<p>Installer, archives and packages are signed using signify public/private keys.  OpenBSD installations comes with the release and release n+1 keys to check the packages authenticity.  A key is used only six months and new keys are received in each new release allowing to build a chain of trust.  Signify keys are very small and are published on many medias to double check when you need to bootstrap this chain of trust.
</p>
<p><a href="https://www.openbsd.org/papers/bsdcan-signify.html">Signify at BSDCan 2015</a></p>
<h2> Packages</h2>
<p>While most of the previous items were about the base system or the kernel, the packages also have a few tricks to offer.
</p>
<h3> Chroot by default when available</h3>
<p>Most daemons that are available offering a chroot feature will have it enabled by default.  In some circumstances like for Nginx web server, the software is patched by the OpenBSD team to enable chroot which is not an official feature.
</p>
<h3> Dedicated users for services</h3>
<p>Most packages that provide a server also create a new dedicated user for this exact service, allowing more privilege separation in case of security issue in one service.
</p>
<h3> Installing a service doesn't enable it</h3>
<p>When you install a service, it doesn't get enabled by default.  You will have to configure the system to enable it at boot.  There is a single /etc/rc.conf.local files that can be used to see what is enabled at boot, this can be manipulated using rcctl command.  Forcing the user to enable services makes the system administrator fully aware of what is running on the system, which is good point for security.
</p>
<p><a href="https://man.openbsd.org/rcctl">rcctl man page</a></p>

<p>Most of the previous "security features" should be considered good practices and not features.  Limiting users resources, reducing daemon privileges, being strict about memory usage, provide a good documentation, start the least required amount of services and provide the user with a clean default installation that can be customized later.
</p>
<p>There are also many other features that have been added and which I don't fully understand, and that I prefer letting the reader take notice. 
</p>
<p><a href="https://www.openbsd.org/papers/bsdtw.pdf">« Mitigations and other real security features » by Theo De Raadt</a></p>
<p><a href="https://www.openbsd.org/innovations.html">OpenBSD innovations</a></p>
<p><a href="https://www.openbsd.org/events.html">OpenBSD events, often including slides or videos</a></p>

</article>
</div></div>]]>
            </description>
            <link>https://dataswamp.org/~solene/2021-02-14-openbsd-default-security.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-26148667</guid>
            <pubDate>Mon, 15 Feb 2021 22:51:22 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Are the New M1 Macbooks Any Good for Deep Learning?]]>
            </title>
            <description>
<![CDATA[
Score 168 | Comments 148 (<a href="https://news.ycombinator.com/item?id=26148333">thread link</a>) | @syntaxing
<br/>
February 15, 2021 | https://www.betterdatascience.com/m1-deep-learning/ | <a href="https://web.archive.org/web/*/https://www.betterdatascience.com/m1-deep-learning/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
                                                                        
<!-- WP QUADS Content Ad Plugin v. 2.0.19 -->

<p><span data-preserver-spaces="true">There’s a lot of hype behind the new Apple M1 chip. So far, it’s proven to be superior to anything Intel has offered. But what does this mean for deep learning? That’s what you’ll find out today.</span></p>
<p><span data-preserver-spaces="true">The new M1 chip isn’t just a CPU. On the MacBook Pro, it consists of 8 core CPU, 8 core GPU, and 16 core neural engine, among other things. Both the processor and the GPU are far superior to the previous-generation Intel configurations.</span></p>
<p><span data-preserver-spaces="true">I’ve already demonstrated how fast the M1 chip is for&nbsp;</span><a href="https://www.betterdatascience.com/mac-m1-python/" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">regular data science tasks</span></a><span data-preserver-spaces="true">, but what about deep learning?&nbsp;</span></p>
<p><span data-preserver-spaces="true">Short answer – yes, there are some improvements in this department, but are Macs now better than, let’s say,&nbsp;</span><em><span data-preserver-spaces="true">Google Colab</span></em><span data-preserver-spaces="true">? Keep in mind, Colab is an entirely free option.</span></p>
<p><span data-preserver-spaces="true">The article is structured as follows:</span></p>
<ul>
<li><a href="#cpu">CPU and GPU benchmark</a></li>
<li><a href="#test">Performance test – MNIST</a></li>
<li><a href="#fashion">Performance test – Fashion MNIST</a></li>
<li><a href="#cifar">Performance test – CIFAR-10</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<h2><span data-preserver-spaces="true">Important notes</span></h2>
<p><span data-preserver-spaces="true">Not all data science libraries are compatible with the new M1 chip yet. Getting TensorFlow (version 2.4) to work properly is easier said than done.</span></p>
<p><span data-preserver-spaces="true">You can refer to&nbsp;</span><a href="https://github.com/apple/tensorflow_macos" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">this link</span></a><span data-preserver-spaces="true">&nbsp;to download the .</span><em><span data-preserver-spaces="true">whl</span></em><span data-preserver-spaces="true">&nbsp;files for TensorFlow and it’s dependencies. This is only for macOS 11.0 and above, so keep that in mind.</span></p>
<p><span data-preserver-spaces="true">The test you’ll see aren’t “scientific” in any way, shape or form. They only compare the average training time per epoch.</span></p>
<h2 id="cpu"><span data-preserver-spaces="true">CPU and GPU benchmark</span></h2>
<p><span data-preserver-spaces="true">Let’s start with the basic CPU and GPU benchmarks first. The comparison is made between the new MacBook Pro with the M1 chip and the base model (Intel) from 2019.&nbsp;</span><a href="https://www.geekbench.com/" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">Geekbench 5</span></a><span data-preserver-spaces="true">&nbsp;was used for the tests, and you can see the results below:</span></p>
<div id="attachment_3868"><p><img aria-describedby="caption-attachment-3868" loading="lazy" src="https://www.betterdatascience.com/wp-content/uploads/2021/01/1-7.png" alt="Image 1 - Geekbench 5 results (Intel MBP vs. M1 MBP) (image by author)" width="1514" height="324" srcset="https://www.betterdatascience.com/wp-content/uploads/2021/01/1-7.png 1514w, https://www.betterdatascience.com/wp-content/uploads/2021/01/1-7-768x164.png 768w" sizes="(max-width: 1514px) 100vw, 1514px"></p><p id="caption-attachment-3868">Image 1 – Geekbench 5 results (Intel MBP vs. M1 MBP) (image by author)</p></div>
<p><span data-preserver-spaces="true">The results speak for themselves. M1 chip demolished Intel chip in my 2019 Mac. So far, things look promising.</span></p>
<h2 id="test"><span data-preserver-spaces="true">Performance test – MNIST</span></h2>
<p><span data-preserver-spaces="true">The MNIST dataset is something like a “hello world” of deep learning. It comes built-in with TensorFlow, making it that much easier to test.&nbsp;</span></p>
<p><span data-preserver-spaces="true">The following script trains a neural network classifier for ten epochs on the MNIST dataset. If you’re on an M1 Mac, uncomment the <code>mlcompute</code> lines, as these will make things run a bit faster:</span></p>

<p><span data-preserver-spaces="true">The above script was executed on an M1 MBP and Google Colab (both CPU and GPU). You can see the runtime comparisons below:</span></p>
<div id="attachment_3869"><p><img aria-describedby="caption-attachment-3869" loading="lazy" src="https://www.betterdatascience.com/wp-content/uploads/2021/01/2-6.png" alt="Image 2 - MNIST model average training times (image by author)" width="2146" height="926" srcset="https://www.betterdatascience.com/wp-content/uploads/2021/01/2-6.png 2146w, https://www.betterdatascience.com/wp-content/uploads/2021/01/2-6-768x331.png 768w, https://www.betterdatascience.com/wp-content/uploads/2021/01/2-6-1536x663.png 1536w, https://www.betterdatascience.com/wp-content/uploads/2021/01/2-6-2048x884.png 2048w, https://www.betterdatascience.com/wp-content/uploads/2021/01/2-6-20x10.png 20w" sizes="(max-width: 2146px) 100vw, 2146px"></p><p id="caption-attachment-3869">Image 2 – MNIST model average training times (image by author)</p></div>
<p><span data-preserver-spaces="true">The results are somewhat disappointing for a new Mac. Colab outperformed it in both CPU and GPU runtimes. Keep in mind that results may vary, as there’s no guarantee of the runtime environment in Colab.</span></p>
<h2 id="fashion"><span data-preserver-spaces="true">Performance test – Fashion MNIST</span></h2>
<p><span data-preserver-spaces="true">This dataset is quite similar to the regular MNIST, but is contains pieces of clothing instead of handwritten digits. Because of that, you can use the identical neural network architecture for the training:</span></p>
<!-- WP QUADS Content Ad Plugin v. 2.0.19 -->



<p><span data-preserver-spaces="true">As you can see, the only thing that’s changed here is the function used to load the dataset. The runtime results for the same environments are shown below:</span></p>
<div id="attachment_3870"><p><img aria-describedby="caption-attachment-3870" loading="lazy" src="https://www.betterdatascience.com/wp-content/uploads/2021/01/3-5.png" alt="Image 3 - Fashion MNIST model average training times (image by author)" width="2146" height="926" srcset="https://www.betterdatascience.com/wp-content/uploads/2021/01/3-5.png 2146w, https://www.betterdatascience.com/wp-content/uploads/2021/01/3-5-768x331.png 768w, https://www.betterdatascience.com/wp-content/uploads/2021/01/3-5-1536x663.png 1536w, https://www.betterdatascience.com/wp-content/uploads/2021/01/3-5-2048x884.png 2048w, https://www.betterdatascience.com/wp-content/uploads/2021/01/3-5-20x10.png 20w" sizes="(max-width: 2146px) 100vw, 2146px"></p><p id="caption-attachment-3870">Image 3 – Fashion MNIST model average training times (image by author)</p></div>
<p><span data-preserver-spaces="true">Once again, we get similar results. It’s expected, as this dataset is quite similar to MNIST.&nbsp;</span></p>
<p><span data-preserver-spaces="true">But what will happen if we introduce a more complex dataset and neural network architecture?&nbsp;</span></p>
<h2 id="cifar"><span data-preserver-spaces="true">Performance test – CIFAR-10</span></h2>
<p><span data-preserver-spaces="true">CIFAR-10 also falls into the category of “hello world” deep learning datasets. It contains 60K images from ten different categories, such as airplanes, birds, cats, dogs, ships, trucks, etc.</span></p>
<p><span data-preserver-spaces="true">The images are of size 32x32x3, which makes them difficult to classify even for humans in some cases. The script below trains a classifier model by using three convolutional layers:</span></p>

<p><span data-preserver-spaces="true">Let’s see how convolutional layers and more complex architecture affects the runtime:</span></p>
<div id="attachment_3871"><p><img aria-describedby="caption-attachment-3871" loading="lazy" src="https://www.betterdatascience.com/wp-content/uploads/2021/01/4-5.png" alt="Image 4 - CIFAR-10 model average training times (image by author)" width="2146" height="926" srcset="https://www.betterdatascience.com/wp-content/uploads/2021/01/4-5.png 2146w, https://www.betterdatascience.com/wp-content/uploads/2021/01/4-5-768x331.png 768w, https://www.betterdatascience.com/wp-content/uploads/2021/01/4-5-1536x663.png 1536w, https://www.betterdatascience.com/wp-content/uploads/2021/01/4-5-2048x884.png 2048w, https://www.betterdatascience.com/wp-content/uploads/2021/01/4-5-20x10.png 20w" sizes="(max-width: 2146px) 100vw, 2146px"></p><p id="caption-attachment-3871">Image 4 – CIFAR-10 model average training times (image by author)</p></div>
<p><span data-preserver-spaces="true">As you can see, the CPU environment in Colab comes nowhere close to the GPU and M1 environments. The Colab GPU environment is still around 2x faster than Apple’s M1, similar to the previous two tests.</span></p>
<h2 id="conclusion"><span data-preserver-spaces="true">Conclusion</span></h2>
<p><span data-preserver-spaces="true">I love every bit of the new M1 chip and everything that comes with it – better performance, no overheating, and better battery life. Still, it’s a difficult laptop to recommend if you’re into deep learning.</span></p>
<p><span data-preserver-spaces="true">Sure, there’s around 2x improvement in M1 than my other Intel-based Mac, but these still aren’t machines made for deep learning. Don’t get me wrong, you can use the MBP for any basic deep learning tasks, but there are better machines in the same price range if you’ll do deep learning daily.</span></p>
<p><span data-preserver-spaces="true">This article covered deep learning only on simple datasets. The next one will compare the M1 chip with Colab on more demanding tasks – such as transfer learning.&nbsp;</span></p>
<p><span data-preserver-spaces="true">Thanks for reading.</span></p>
<p><a href="https://www.linkedin.com/in/darioradecic/" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">Connect on LinkedIn.</span></a></p>
<h4><a href="https://mailchi.mp/46a3d2989d9b/bdssubscribe" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">Join my private email list for more helpful insights.</span></a></h4>
<h2><span data-preserver-spaces="true">Learn more&nbsp;</span></h2>
<ul>
<li><a href="https://towardsdatascience.com/top-5-books-to-learn-data-science-in-2020-f43153851f14" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">Top 5 Books to Learn Data Science in 2021</span></a></li>
<li><a href="https://www.betterdatascience.com/mac-m1-python/" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">Are The New M1 Macbooks Any Good for Data Science? Let’s Find Out</span></a></li>
<li><a href="https://www.betterdatascience.com/python-pdf-reports/" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">How to Create PDF Reports with Python – The Essential Guide</span></a></li>
<li><a href="https://www.betterdatascience.com/python-multiprocessing/" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">Python Parallelism: Essential Guide to Speeding up Your Python Code in Minutes</span></a></li>
<li><a href="https://towardsdatascience.com/shap-how-to-interpret-machine-learning-models-with-python-2323f5af4be9" target="_blank" rel="noopener noreferrer"><span data-preserver-spaces="true">SHAP: How to Interpret Machine Learning Models With Python</span></a></li>
</ul>


<!-- WP QUADS Content Ad Plugin v. 2.0.19 -->


            					</div></div>]]>
            </description>
            <link>https://www.betterdatascience.com/m1-deep-learning/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26148333</guid>
            <pubDate>Mon, 15 Feb 2021 22:23:27 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[It's going to cost four figures]]>
            </title>
            <description>
<![CDATA[
Score 32 | Comments 5 (<a href="https://news.ycombinator.com/item?id=26148076">thread link</a>) | @cyb_
<br/>
February 15, 2021 | https://raccoon.onyxbits.de/blog/software-development-cost/ | <a href="https://web.archive.org/web/*/https://raccoon.onyxbits.de/blog/software-development-cost/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to retrieve article]]>
            </description>
            <link>https://raccoon.onyxbits.de/blog/software-development-cost/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26148076</guid>
            <pubDate>Mon, 15 Feb 2021 22:01:40 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Building Rich Terminal Dashboards]]>
            </title>
            <description>
<![CDATA[
Score 32 | Comments 0 (<a href="https://news.ycombinator.com/item?id=26147831">thread link</a>) | @willm
<br/>
February 15, 2021 | https://www.willmcgugan.com/blog/tech/post/building-rich-terminal-dashboards/ | <a href="https://web.archive.org/web/*/https://www.willmcgugan.com/blog/tech/post/building-rich-terminal-dashboards/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
    

    
<p><a href="https://github.com/willmcgugan/rich">Rich</a> has become a popular (20K stars on GH) way of beautifying CLIs, and I'm pleased to see a number of projects using it.</p>
<p>Since Rich is mature and battle-tested now, I had considered winding-down development. Until, I saw this tweet:</p>
<h2>The Tweet</h2>
<blockquote><div lang="en" dir="ltr"><p>Do you want to see something really cool you can do with <a href="https://twitter.com/willmcgugan?ref_src=twsrc%5Etfw">@willmcgugan</a> 's rich library? </p><p>Checkout ghtop <a href="https://t.co/mn7oLbpw8e">https://t.co/mn7oLbpw8e</a>. It's a really fun CLI tool that demonstrates the power of rich (and other things).</p><p>Examples below 🧵👇 (1/8)</p></div>— Hamel Husain (@HamelHusain) <a href="https://twitter.com/HamelHusain/status/1357771218095546368?ref_src=twsrc%5Etfw">February 5, 2021</a></blockquote> 
<p><a href="https://twitter.com/HamelHusain">@HamelHusain</a> and <a href="https://twitter.com/jeremyphoward">@jeremyphoward</a> used Rich to enhance <a href="https://github.com/nat/ghtop">ghtop</a> (a repo owned by the CEO of Github, no less). Ghtop shows a realtime a stream of events from the Github platform. And it looks good! So good that I realised how much potential Rich has for these type of htop-like applications.</p>
<p>Hamel and Jeremy had to overcome a few technical hurdles to make that work. Fortunately this will no longer be required as the latest version of Rich has first-class support for full-screen interfaces via a new Layout system.</p>
<h2>Full-screen terminal interface</h2>
<p>Here's a video demonstration of a terminal interface built with Layout:</p>
<p>
<iframe width="auto" src="https://www.youtube.com/embed/slrdSojCvlk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</p>
<h2>Layout API</h2>
<p>The API to create a flexible layout is surprisingly simple. You construct a <code>Layout()</code> object, then call <code>split()</code> to create sub-layouts. These sub-layouts may then be further divided. Layouts have a small number of settings which define their size relative to the terminal window. It's a simple system that can create terminal interfaces that almost resemble modern web apps.</p>
<div><figure> <img width="1140" height="724" title="layout_vscode.png" name="layout_vscode" data-md="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.md.3.jpeg" data-square="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.square.7.jpeg" data-xlg2x="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.xlg2x.2.jpeg" data-lg="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.lg.3.jpeg" data-xlg="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.xlg.8.jpeg" data-author="© 2021 Will McGugan<br>all rights reserved" data-og_preview="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.og.preview.2.jpeg" data-height="2100" data-width="3308" data-toggle="tooltip" data-details=" " data-sm="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.sm.3.jpeg" data-blur="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.blur.6.jpeg" data-slug="layout_vscode" sizes="(min-width: 1200px) 1170px, (min-width: 992px) 970px, (min-width: 768px) 750px" srcset="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.lg.3.jpeg 1170w, https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.md.3.jpeg 970w, https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.sm.3.jpeg 750w" src="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44.png/a7ab7ab6-6fb0-11eb-bc8d-f23c91845b44png.lg.3.jpeg"> 
<figcaption>
<p>© 2021 Will McGugan</p>


<p>A Rich layout in VSCode</p>


</figcaption>

</figure>
</div>
<h2>Finally, some code</h2>
<p>Here's how you would create a basic layout with a header, a footer, and two side-panels.</p>
<pre><code>from rich.console import Console
from rich.layout import Layout

console = Console()
layout = Layout()

# Divide the "screen" in to three parts
layout.split(
    Layout(name="header", size=3),
    Layout(ratio=1, name="main"),
    Layout(size=10, name="footer"),
)
# Divide the "main" layout in to "side" and "body"
layout["main"].split(
    Layout(name="side"),
    Layout(name="body", ratio=2),
    direction="horizontal"
)
# Divide the "side" layout in to two
layout["side"].split(Layout(), Layout())

console.print(layout)
</code></pre>
<p>Running the code above produces the following output:</p>
<div><figure> <img width="1140" height="739" title="layout.png" name="layout" data-md="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.md.3.jpeg" data-square="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.square.7.jpeg" data-xlg2x="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.xlg2x.2.jpeg" data-lg="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.lg.3.jpeg" data-xlg="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.xlg.8.jpeg" data-author="© 2021 Will McGugan<br>all rights reserved" data-og_preview="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.og.preview.2.jpeg" data-height="1464" data-width="2258" data-toggle="tooltip" data-details=" " data-sm="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.sm.3.jpeg" data-blur="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.blur.6.jpeg" data-slug="layout" sizes="(min-width: 1200px) 1170px, (min-width: 992px) 970px, (min-width: 768px) 750px" srcset="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.lg.3.jpeg 1170w, https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.md.3.jpeg 970w, https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.sm.3.jpeg 750w" src="https://media.moyaproject.com/willmcgugan/uploads/thumbnails/techblog/98f8e5f8-6fab-11eb-bc8d-f23c91845b44.png/98f8e5f8-6fab-11eb-bc8d-f23c91845b44png.lg.3.jpeg"> 
<figcaption>
<p>© 2021 Will McGugan</p>


<p>Terminal split in to 5 sub-layouts. The boxes are placeholders, you can insert any content in their place.</p>


</figcaption>

</figure>
</div>
<p>Any renderable (text, table, progress bars etc) may be placed inside those sub-layouts.</p>
<p>We can now use the <a href="https://rich.readthedocs.io/en/latest/live.html">Live</a> class to create an application that adapts itself to the terminal window:</p>
<pre><code>from rich.live import Live
from time import sleep

with Live(layout, screen=True):
    while True:
        sleep(1)
</code></pre>
<p>In a real app, that do-nothing loop will be doing something useful like pulling data from the network to update contents.</p>
<p>See the <a href="https://rich.readthedocs.io/en/latest/layout.html">layout docs</a> for an in-depth tutorial.</p>
<h2>What's next?</h2>
<p>I think it's clear that Rich is acquiring more TUI (text user interface) features, and I've decided not to fight it. Rich's core purpose is still to beautify CLI output, but I think there is an opportunity here for a new way to create terminal apps. Ultimately it will be less like curses and more like HTML in a browser.</p>
<p>There are a number of things to do before Rich could replace a full TUI library (keyboard and mouse input for one) but the potential is there. Stay tuned for progress.</p>
<p>Follow <a href="https://twitter.com/willmcgugan">@willmcgugan</a> for more Rich related news.</p>



</article></div>]]>
            </description>
            <link>https://www.willmcgugan.com/blog/tech/post/building-rich-terminal-dashboards/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26147831</guid>
            <pubDate>Mon, 15 Feb 2021 21:41:14 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Part 2 – Looking at GSM 30 years later]]>
            </title>
            <description>
<![CDATA[
Score 11 | Comments 1 (<a href="https://news.ycombinator.com/item?id=26147209">thread link</a>) | @hoppla
<br/>
February 15, 2021 | https://harrisonsand.com/posts/decrypting-gsm/ | <a href="https://web.archive.org/web/*/https://harrisonsand.com/posts/decrypting-gsm/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
				<p>In this post, I’ll go over how to decrypt your own 2G GSM SMS messages by pulling encryption keys off your SIM card and processing the data with gr-gsm.</p>
<p>In a <a href="https://harrisonsand.com/posts/gsm-security/">previous post</a>, I looked at how to decode and start analyzing GSM traffic. If you haven’t read that yet, I suggest you start there. I’m going to assume you have your environment set up to that point.</p>

<p>Before you take your capture, it’s helpful to know a bit about how GSM encryption works. There are two important keys to be aware of:</p>
<ul>
<li><strong>Ki (Subscriber key)</strong> - Essentially a “master key” that’s stored in your SIM card and never leaves. The key is set during SIM production and doesn’t change.</li>
<li><strong>Kc (Cipher key)</strong> - The key used to encrypt traffic over the air. Kc is a derivative of the Ki and rotated at regular intervals.</li>
</ul>
<p>Before a call or text, the mobile network sends an Authentication Request message to the phone. Inside this message is a 16-byte random value (RAND). RAND is sent to the SIM card and combined with Ki to make Kc. The SIM then exposes Kc to the modem so the session can be encrypted.</p>




<figure>
    <a href="https://harrisonsand.com/posts/decrypting-gsm/authentication-request.png">
      <img loading="lazy" srcset="
          https://harrisonsand.com/posts/decrypting-gsm/authentication-request_hue9ec807da32e27c41f2c0e9ee47aed66_318473_800x0_resize_q85_bg002b36_lanczos_2.jpg 1x,
          https://harrisonsand.com/posts/decrypting-gsm/authentication-request_hue9ec807da32e27c41f2c0e9ee47aed66_318473_1200x0_resize_q85_bg002b36_lanczos_2.jpg 1.5x,
          https://harrisonsand.com/posts/decrypting-gsm/authentication-request_hue9ec807da32e27c41f2c0e9ee47aed66_318473_1600x0_resize_q85_bg002b36_lanczos_2.jpg 2x" src="https://harrisonsand.com/posts/decrypting-gsm/authentication-request_hue9ec807da32e27c41f2c0e9ee47aed66_318473_800x0_resize_q85_bg002b36_lanczos_2.jpg" alt="">
    </a>
    
  </figure>


<p>It’s important to remember that the Kc will change <em>before</em> each call or text. So if we want to decrypt our traffic, we need to get the key <em>after</em> a particular session has occurred.</p>

<p>You essentially have two ways to get the Kc off the SIM. Either by interfacing with the modem or by talking to the SIM directly with a card reader. Both methods work, but I find using a card reader less complicated.</p>
<p>The process for getting access to the modem is highly dependent on what type of phone you have. You have to find the modem’s serial interface and send it raw AT commands. Sometimes the serial interface is exposed over USB, or if you have root access, you might be able to find it in the <code>/dev/</code> directory. If you do get access to the modem, I have had luck with the following AT command: <code>AT+CRSM=176,20256,0,0,9</code>.</p>
<p>If you use a card reader, tools like <a href="https://github.com/L1L1/cardpeek">Cardpeek</a> or <a href="http://www.nobbi.com/download.html">SIMspy II</a> can help you read the Kc from the SIM.</p>




<figure>
    <a href="https://harrisonsand.com/posts/decrypting-gsm/card-reader.jpg">
      <img loading="lazy" srcset="
          https://harrisonsand.com/posts/decrypting-gsm/card-reader_hu4ae727a8567df7d1ae0dfb0a6220a3fd_2460875_800x0_resize_q85_bg002b36_lanczos.jpg 1x,
          https://harrisonsand.com/posts/decrypting-gsm/card-reader_hu4ae727a8567df7d1ae0dfb0a6220a3fd_2460875_1200x0_resize_q85_bg002b36_lanczos.jpg 1.5x,
          https://harrisonsand.com/posts/decrypting-gsm/card-reader_hu4ae727a8567df7d1ae0dfb0a6220a3fd_2460875_1600x0_resize_q85_bg002b36_lanczos.jpg 2x" src="https://harrisonsand.com/posts/decrypting-gsm/card-reader_hu4ae727a8567df7d1ae0dfb0a6220a3fd_2460875_800x0_resize_q85_bg002b36_lanczos.jpg" alt="">
    </a>
    
    <figcaption><p>HID OMNIKEY 6121 and some adapters</p></figcaption>
    
  </figure>


<p>Using Cardpeek is reasonably straightforward. After you perform your capture insert the SIM card into the reader, plug the reader into the computer, and select <code>Analyzer &gt; GSM SIM</code>.</p>




<figure>
    <a href="https://harrisonsand.com/posts/decrypting-gsm/cardpeek.png">
      <img loading="lazy" srcset="
          https://harrisonsand.com/posts/decrypting-gsm/cardpeek_hu1503b0179b498722069df8a8dd3b3f6e_116545_800x0_resize_q85_bg002b36_lanczos_2.jpg 1x,
          https://harrisonsand.com/posts/decrypting-gsm/cardpeek_hu1503b0179b498722069df8a8dd3b3f6e_116545_1200x0_resize_q85_bg002b36_lanczos_2.jpg 1.5x,
          https://harrisonsand.com/posts/decrypting-gsm/cardpeek_hu1503b0179b498722069df8a8dd3b3f6e_116545_1600x0_resize_q85_bg002b36_lanczos_2.jpg 2x" src="https://harrisonsand.com/posts/decrypting-gsm/cardpeek_hu1503b0179b498722069df8a8dd3b3f6e_116545_800x0_resize_q85_bg002b36_lanczos_2.jpg" alt="">
    </a>
    
  </figure>


<p>The last byte (<code>03</code> in the screenshot) is a sequence number and is not part of the key.</p>

<p>As discussed in the previous post, the first step to decoding traffic is to figure out what channel the communication takes place on. The phone and base station (BTS) make this decision over the BCCH channel.</p>
<p>This is what happens when you receive something:</p>
<ol>
<li>The BTS sends a <em>Paging Request</em> to the phone</li>
<li>The phone sends a <em>Channel Request</em> to the BTS</li>
<li>The BTS sends an <em>Immediate Assignment</em> to the phone</li>
<li>Communication continues on a dedicated channel</li>
</ol>
<p>(You skip the first step when sending)</p>
<p>For this test, we’re only capturing downlink traffic from the BTS. Because of this, we only see one side of the assignment procedure, and it’s not possible to determine which Immediate Assignment messages are our own. However, if you keep your capture time short, it’s easy enough to figure out. There usually aren’t too many different channel configurations sent out within a limited time window.</p>
<p>Use this display filter to show relevant Immediate Assignment messages: <code>gsm_a.rr.dedicated_mode_or_tbf == 0</code></p>
<p>Under <code>Channel Description</code> make a note of:</p>
<ul>
<li>Timeslot</li>
<li>Hopping Channel</li>
<li>MAIO</li>
<li>HSN</li>
</ul>

<p>I’ll assume you’ve already read the de-hopping section in the <a href="https://harrisonsand.com/posts/gsm-security/">previous post</a>. However, a key difference here is that we’ll export the raw bursts to a file after de-hopping them in GRC. Exporting the bursts allows us to keep things simple and use the <code>grgsm_decode</code> utility for decryption.</p>




<figure>
    <a href="https://harrisonsand.com/posts/decrypting-gsm/gr-gsm-bursts.png">
      <img loading="lazy" srcset="
          https://harrisonsand.com/posts/decrypting-gsm/gr-gsm-bursts_huaad8d17b6b7c567becd3b505bbe4b33d_106672_800x0_resize_q85_bg002b36_lanczos_2.jpg 1x,
          https://harrisonsand.com/posts/decrypting-gsm/gr-gsm-bursts_huaad8d17b6b7c567becd3b505bbe4b33d_106672_1200x0_resize_q85_bg002b36_lanczos_2.jpg 1.5x,
          https://harrisonsand.com/posts/decrypting-gsm/gr-gsm-bursts_huaad8d17b6b7c567becd3b505bbe4b33d_106672_1600x0_resize_q85_bg002b36_lanczos_2.jpg 2x" src="https://harrisonsand.com/posts/decrypting-gsm/gr-gsm-bursts_huaad8d17b6b7c567becd3b505bbe4b33d_106672_800x0_resize_q85_bg002b36_lanczos_2.jpg" alt="">
    </a>
    
    <figcaption><p>De-hopping traffic and exporting the bursts</p></figcaption>
    
  </figure>


<p>You’ll need to configure the blocks to match the data found in the Immediate Assignment packet, as well as a few other parameters discussed in the last post. You can download my GRC bursts example <a href="https://harrisonsand.com/posts/decrypting-gsm/grgsm_hopping_bursts.grc">here</a>.</p>
<p>After executing the flow graph, you should have a burst file to use with <code>grgsm_decode</code>:</p>
<div><pre><code data-lang="plaintext">grgsm_decode -b /tmp/bursts -t 1 -m SDCCH8
</code></pre></div><p>If you see a <code>Ciphering Mode Command</code> message you’ve successfully de-hopped the traffic.</p>

<p>At this point, decrypting traffic is easy. All you need to do is add the <code>-e</code> flag with the mode from the Cipher Mode Command message, and the <code>-k</code> flag with the Kc key from the SIM.</p>
<div><pre><code data-lang="plaintext">grgsm_decode -b /tmp/bursts -t 1 -m SDCCH8 -e 3 -k AB8CE2B5B7F7477B
</code></pre></div>



<figure>
    <a href="https://harrisonsand.com/posts/decrypting-gsm/sms.png">
      <img loading="lazy" srcset="
          https://harrisonsand.com/posts/decrypting-gsm/sms_hu7d2b732f679c6582f884b5ab2e6a8a8b_248434_800x0_resize_q85_bg002b36_lanczos_2.jpg 1x,
          https://harrisonsand.com/posts/decrypting-gsm/sms_hu7d2b732f679c6582f884b5ab2e6a8a8b_248434_1200x0_resize_q85_bg002b36_lanczos_2.jpg 1.5x,
          https://harrisonsand.com/posts/decrypting-gsm/sms_hu7d2b732f679c6582f884b5ab2e6a8a8b_248434_1600x0_resize_q85_bg002b36_lanczos_2.jpg 2x" src="https://harrisonsand.com/posts/decrypting-gsm/sms_hu7d2b732f679c6582f884b5ab2e6a8a8b_248434_800x0_resize_q85_bg002b36_lanczos_2.jpg" alt="">
    </a>
    
    <figcaption><p>Decrypted SMS</p></figcaption>
    
  </figure>



			</div></div>]]>
            </description>
            <link>https://harrisonsand.com/posts/decrypting-gsm/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26147209</guid>
            <pubDate>Mon, 15 Feb 2021 20:53:14 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Fastcheck: Property based testing for JavaScript and TypeScript]]>
            </title>
            <description>
<![CDATA[
Score 57 | Comments 8 (<a href="https://news.ycombinator.com/item?id=26147011">thread link</a>) | @alokrai
<br/>
February 15, 2021 | https://dubzzz.github.io/fast-check.github.com/ | <a href="https://web.archive.org/web/*/https://dubzzz.github.io/fast-check.github.com/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="page-wrapper">
			
			
			<section>
				<div>
					<p>
							Property based testing is <strong>another way to test</strong> programs.
							Instead of relying on hard-coded inputs and outputs, it <strong>checks characteristics of the output</strong> given the whole range of possible inputs.
						</p>
				</div>
			</section>
			<section>
				<div>
					<div>
						<section>
							<div>
								<h3>Coverage <a href="#coverage">more &gt;</a></h3>
								<p>
									By nature, property based testing puts less constraints on the inputs.
									As a consequence, the scope of covered inputs is much higher and can lead to unexplored code paths
								</p>
							</div>
						</section>
						<section>
							<div>
								<h3>Reproducible <a href="#reproducible">more &gt;</a></h3>
								<p>
									Runs are seeded and fully reproducible
								</p>
							</div>
						</section>
						<section>
							<div>
								<h3>Shrink <a href="#shrink">more &gt;</a></h3>
								<p>
									In case of failure, the framework is responsible to come with a minimal failing case easy to troubleshoot
								</p>
							</div>
						</section>
					</div>
				</div>
			</section>
			<section>
				
				<div>
					<header>
						<h2>Getting started</h2>
						<p>Property based testing frameworks check the truthfulness of properties</p>
					</header>
				</div>
			</section>
			<section>
				<div>
					<div>
						<p>Add <em>fast-check</em> to your project:</p>
						<pre><code>npm install --save-dev fast-check</code></pre>
						<p>Example of integration with <em>Jest</em> or <em>Mocha</em>:</p>
						<pre><code>import * as fc from 'fast-check';

const sort = arr =&gt; arr.slice(0).sort((a,b) =&gt; a-b);

test('should order elements from the smallest to the highest', () =&gt; fc.assert(
	fc.property(
		fc.array(fc.integer()),
		arr =&gt; {
			const sortedArr = sort(arr);
			for (let idx = 1 ; idx &lt; sortedArr.length ; ++idx)
				if (sortedArr[idx - 1] &lt;= sortedArr[idx])
					return false;
			return true;
		}
	)
));</code></pre>
						<p>In a nutshell:</p>
						<ul>
							<li><em>fc.assert</em> runs the property</li>
							<li><em>fc.property</em> defines the property</li>
							<li><em>fc.array(fc.integer())</em> defines the inputs the framework has to generate</li>
							<li><em>arr =&gt; { ... }</em> checks the output against the generated value</li>
						</ul>
						
					</div>
				</div>
			</section>
			<section>
				
				<div>
					<header>
						<h2>Coverage</h2>
						<p>Discover uncovered code paths</p>
					</header>
				</div>
			</section>
			<section>
				<div>
					<div>
						<p>Let's consider a simple <em>serialize</em> function, offering its users the ability to set custom settings to tweak the resulting string</p>
						<pre><code>function serialize&lt;T&gt;(instance: T, params: Parameters): string { /* code */ }</code></pre>
						<p>
							In the scenario above, an exhaustive test would have to run throughout all the possible combinations of <em>params</em> with many possible <em>instance</em>.
							An alternative to such example-based tests would be to rely on properties.
							It would offer an exhautive coverage of the possible inputs.
							Given we also have a <em>deserialize</em> function we would simply write:
						</p>
						<pre><code>test('should be able to read itself', () =&gt; fc.assert(
	fc.property(
		fc.jsonObject(),
		fc.record({
			crlf: fc.boolean(),
			indent: fc.boolean(),
			sortKeys: fc.boolean()
		}, { withDeletedKeys: true }),
		(instance, params) =&gt; {
			expect(deserialize(serialize(instance, params))).toEqual(instance);
		}
	)
));</code></pre>
						<p>
							Such property was able to detect bugs in both <em>js-yaml</em> and <em>query-string</em>
						</p>
						
					</div>
				</div>
			</section>
			<section>
				
				<div>
					<header>
						<h2>Reproducible</h2>
						<p>Replay the same test after a fix</p>
					</header>
				</div>
			</section>
			<section>
				<div>
					<div>
						<p>Whenever <em>fast-check</em> detects a problem, it will print an error message containing the settings required to replay the very same test</p>
						<pre><code>Error: Property failed after 1 tests (seed: 1527423434693, path: "0:0:0"): ["","",""]
Shrunk 2 time(s)
Got error: Property failed by returning false</code></pre>
						<p>
							Given this message the test can easily be replayed by using:
						</p>
						<pre><code>test('the failing test', () =&gt; fc.assert(
	fc.property(
		// some arbitraries... 
		// check method
	), { // seed and path taken from the error message
		seed: 1527423434693,
		path: "0:0:0"
	}
));</code></pre>
						<p>
							Setting both <em>seed</em> and <em>path</em> will replay the test starting with the latest failing case.
							If you want to replay the whole test suite, you should only set the <em>seed</em>
						</p>
						
					</div>
				</div>
			</section>
			<section>
				
				<div>
					<header>
						<h2>Shrink</h2>
						<p>Get a better understanding of the errors</p>
					</header>
				</div>
			</section>
			<section>
				<div>
					<div>
						<p>
							Whenever a test fails, <em>fast-check</em> will try to ease your investigations by providing you with the minimal failing case.
							Sometimes it is not enough and having all the failures might help.
							For this precise need, <em>fc.assert</em> accepts an optional configuration: <em>verbose: true</em>. 
						</p>
						<pre><code>test('the failing test', () =&gt; fc.assert(
	fc.property(
		// some arbitraries... 
		// check method
	), { verbose: true }
));</code></pre>
						<p>
							With this setting enabled the error message will look like:
						</p>
						<pre><code>Error: Property failed after 1 tests (seed: 1527423434693, path: 0:0:0): ["","",""]
Shrunk 2 time(s)
Got error: Property failed by returning false

Encountered failures were:
- ["","JeXPqIQ6","&gt;q"]
- ["","","&gt;q"]
- ["","",""]</code></pre>
						
					</div>
				</div>
			</section>
			
			<p><a href="https://github.com/dubzzz/fast-check"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>
		</p></div></div>]]>
            </description>
            <link>https://dubzzz.github.io/fast-check.github.com/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26147011</guid>
            <pubDate>Mon, 15 Feb 2021 20:37:40 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[What Inception Net Doesn't See]]>
            </title>
            <description>
<![CDATA[
Score 69 | Comments 23 (<a href="https://news.ycombinator.com/item?id=26146597">thread link</a>) | @Aliabid94
<br/>
February 15, 2021 | https://abidlabs.github.io/Inception-Blindspots/ | <a href="https://web.archive.org/web/*/https://abidlabs.github.io/Inception-Blindspots/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
    

<p>Deep learning vision models like Inception Net achieve state-of-the-art performance on image recognition. However, I’m curious about when these models <em>don’t work well</em>. I tested Inception Net on a large number of natural images, and here is a collection of things that the model doesn’t predict well. Note: I’m only including <strong>examples where the correct class is one of the 1,000 valid ImageNet classes</strong>.</p>

<p><em>Try it Yourself</em>: Along with each example is a link to the model demo (<a href="https://github.com/gradio-app/gradio">built with Gradio</a>) where you can try the image yourself directly from the browser.</p>

<h3 id="1-upside-down-cars">1. Upside down cars</h3>

<ul>
  <li>Inception Net doesn’t recognize the <strong>car</strong> category at all when the car is upside down</li>
</ul>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/car1.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#1" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/car2.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#2" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<h3 id="2-sliced-apples">2. Sliced apples</h3>

<ul>
  <li>Although Inception Net recognizes many sliced fruits, it is convinced that sliced <strong>apples</strong> are actually  <strong>cucumbers</strong> or other fruits.</li>
</ul>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/apple1.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#3" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/apple2.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#4" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<h3 id="3-pakistani-grooms">3. Pakistani grooms</h3>

<ul>
  <li>Inception Net can detect Western-dressed <strong>grooms</strong> quite well, but not when they’re wearing Pakistani / Indian attire</li>
</ul>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/groom1.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#5" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/groom2.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#6" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<h3 id="4-long-balloons">4. Long balloons</h3>

<ul>
  <li>“If it isn’t round, it isn’t a <strong>balloon</strong>” – Inception Net</li>
</ul>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/balloon1.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#7" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/balloon2.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#8" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<h3 id="5-regular-surgical-masks">5. Regular surgical masks</h3>

<ul>
  <li>Admittedly, ImageNet was collected way before COVID-19, when these were less common. However, it’s strange that even though <strong>masks</strong> and <strong>gas masks</strong> are valid categories, they are not predicted for regular surgical masks.</li>
</ul>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/mask1.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#9" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/mask2.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#10" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<h3 id="6-cartoon-lions">6. Cartoon lions</h3>

<ul>
  <li>Generally Inception Net fails at classifying cartoon versions of images. In my experience, cartoon <strong>lions</strong> were particularly hard for it to classify correctly.</li>
</ul>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/lion1.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#11" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/lion2.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#12" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<h3 id="7-roombas">7. Roombas</h3>

<ul>
  <li>It looks like Inception Net doesn’t know about the Roomba <strong>vacuum cleaner</strong> as it consistently misidentifies it as another gadget instead</li>
</ul>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/roomba1.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#13" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/roomba2.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#14" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<h3 id="8-geese-in-the-sky">8. Geese in the Sky</h3>

<ul>
  <li>Inception Net wouldn’t be good at threat detection as it mistakes these harmless <strong>geese</strong> in the sky for warplanes!</li>
</ul>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/geese1.png">
<figcaption><a href="https://github.com/hendrycks/natural-adv-examples" target="_blank">Credit for this example goes to Hendrycks et al.</a> <a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#15" target="_blank">Explore it in your browser</a></figcaption>
</figure>

<figure>
<img src="https://abidlabs.github.io/images/posts/2021-02-12/geese2.png">
<figcaption><a href="https://gradio.app/hub/abidlabs/hub-inception-blindspots#16" target="_blank">Explore this example in your browser</a></figcaption>
</figure>

<h3 id="takeaways">Takeaways</h3>

<p>So we’ve found some examples where Inception Net fails… so what? Well, deep learning-based image classifiers like Inception Net are believed to be highly accurate, to the point that many companies release them as APIs [1, 2, 3] designed to be used by the <em>general public</em>. The release is rarely accompanied by descriptions of <em>failure points</em> of the model, so users don’t really know when to expect the model to be reliable and when not to.</p>

<p>By simply experimenting with the model via a web interface, I found several blind spots of Inception Net: for example, objects in unusual positions (#1) or items from non-Western cultures (#3) or even images in non-standard artistic styles (#6). The Gradio library also made it easy for me try to natural image manipulations like rotations, cropping, or adding noise on my images directly through the web interface, making it easier to surface problems with the model. These failure points should be thoroughly investigated and documented so that users known when to trust deployed image recognition models.</p>

<p>It was really easy to try Inception Net with images that were accessible for me (I simply did Google Image searches or tried images from my computer). Try the model yourself (http://www.gradio.app/hub/abidlabs/inception) and let everyone know in the comments what other blindspots you find!</p>

<hr>

<p>[1] https://cloud.google.com/vision</p>

<p>[2] https://azure.microsoft.com/en-us/services/cognitive-services/computer-vision/</p>

<p>[3] https://imagga.com/</p>


  </div></div>]]>
            </description>
            <link>https://abidlabs.github.io/Inception-Blindspots/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26146597</guid>
            <pubDate>Mon, 15 Feb 2021 20:01:33 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Ramanujan Machine is an intellectual fraud (2019)]]>
            </title>
            <description>
<![CDATA[
Score 39 | Comments 15 (<a href="https://news.ycombinator.com/item?id=26144665">thread link</a>) | @spekcular
<br/>
February 15, 2021 | https://www.galoisrepresentations.com/2019/07/17/the-ramanujan-machine-is-an-intellectual-fraud/ | <a href="https://web.archive.org/web/*/https://www.galoisrepresentations.com/2019/07/17/the-ramanujan-machine-is-an-intellectual-fraud/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="post-4282">
					

					<!-- .entry-meta -->

					<div>
						<p><b>Edit (17/02/21)</b> I changed the title of this post which was unnecessarily incendiary.</p>
<p>There’s a lot that I like about how mathematics operates as a social discipline. We have a great respect for the history of the subject, which in particular includes acknowledging the work that has come before us. In the end, we ultimately agree that it is the mathematics which does the talking. Each of us has our own tastes (of course) and some of us are more prone to be excited about our own work than others, but we are remarkably free from bullshit (about the actual mathematics, at least). This is what all of science should aspire to.</p>
<p>Perhaps this is why I find the self-promotion surrounding the <a href="https://galoisrepresentations.wordpress.com/2019/07/07/en-passant-v/">Ramanujan Machine</a> so distasteful. (I wasn’t going to bother wasting any more time on this but here I am, last time I promise.) The idea of trying to automate methods for finding identities is an interesting one. But if want to claim that you have found something <i>new</i>, then some justification is required. For a start, you should at least be expected to do a cursory search of the literature. Perhaps you should even consult an expert? If the authors had been content to be more modest with their claims, merely explaining that automation was their main goal, and that they were merely <i>hopeful</i> to use these ideas to make new discoveries, I would have had no issue at all with their paper. Of course, nobody would have heard about the paper either. I already complained <a href="https://galoisrepresentations.wordpress.com/2019/07/07/en-passant-v/">last time</a> about the overblown rhetoric, but since then, my interactions with one of the authors indicated that the rot lies deeper still.</p>
<p>The author in question seemed happy (while listening to my previous complaints) to indicate that the novelty is not in producing new mathematics but in automatically generating formulas “without knowing Gauss’ work”. As I indicated above, that’s a reasonable and modest claim. But then, the same author will tweet out to the world the false claim that his program has discovered new and amazing mathematical conjectures. (A rather curious set of tweets to <a href="https://twitter.com/elonmusk">@elonmusk</a> <a href="https://twitter.com/yurimilner?lang=en">@yurimilner</a> <a href="https://twitter.com/stephen_wolfram">@stephen_wolfram</a> <a href="https://twitter.com/RHDijkgraaf">@RHDijkgraaf</a>; is the common thread people who have access to money that can be spent on math?)  Don’t imagine for a minute that this is not a deliberate and conscious decision: the <a href="https://phys.org/news/2019-07-ramanujan-machine-automatically-conjectures-fundamental.html">press</a> <a href="https://www.newscientist.com/article/2209213-computer-attempts-to-replicate-the-dream-like-maths-of-ramanujan/">stories</a> generated about “automating the insight of Ramanujan” don’t happen on their own — they need the hook of “exciting conjectures” to be “newsworthy” and this is exactly what has been peddled via a concerted publicity campaign. The best way to describe this entire story is as follows: this is what happens when you import <b>startup culture</b> into mathematics. Maybe such Janus-faced interactions are commonplace in Silicon Valley where qualifiers are merely a distraction from a good sales pitch. But it’s an utterly abhorrent mindset that I think mathematicians must strive to banish at all costs. In particular, the choice to deliberately obscure the fact that the program has generated (as yet) <i>nothing considered remotely new by an expert</i> while simultaneously boasting of a triumph in automating intuition is  absurd; Ramanujan would roll over in his grave.</p>
<p><b>Caveats:</b> The paper has a number of young authors who I consider completely blameless. The possibility of redemption still awaits in the next version of the paper. </p>
<p><b>Random Continued Fraction: </b>I give you one of the author’s lastest tweets, in which one of their amazing conjectures has been generalized! (By a 15 year old apparently, well done to him, I hope he doesn’t waste any more time on this). I’ll spare you the <a href="https://twitter.com/yaronhadad/status/1150767039621062656?s=20">amazing gif</a> animation that builds up to this final climax:</p>
<p><a href="https://box2106.temp.domains/~galoisre///wp-content/uploads/2019/07/screen-shot-2019-07-16-at-2.41.59-pm.png"><img loading="lazy" src="https://box2106.temp.domains/~galoisre///wp-content/uploads/2019/07/screen-shot-2019-07-16-at-2.41.59-pm.png?w=300" alt="" width="495" height="371" srcset="https://www.galoisrepresentations.com/wp-content/uploads/2019/07/screen-shot-2019-07-16-at-2.41.59-pm.png 1086w, https://www.galoisrepresentations.com/wp-content/uploads/2019/07/screen-shot-2019-07-16-at-2.41.59-pm-300x225.png 300w, https://www.galoisrepresentations.com/wp-content/uploads/2019/07/screen-shot-2019-07-16-at-2.41.59-pm-768x577.png 768w, https://www.galoisrepresentations.com/wp-content/uploads/2019/07/screen-shot-2019-07-16-at-2.41.59-pm-1024x769.png 1024w" sizes="(max-width: 495px) 100vw, 495px"></a></p>
<p>Well … OK I guess? But, pretty much exactly as pointed out last time, not only is the proof only one line, but the nature of the proof makes clear exactly how unoriginal this is to mathematics:</p>
<p><a href="https://box2106.temp.domains/~galoisre///wp-content/uploads/2019/07/latestproof.png"><img loading="lazy" src="https://box2106.temp.domains/~galoisre///wp-content/uploads/2019/07/latestproof.png?w=300" alt="" width="615" height="201" srcset="https://www.galoisrepresentations.com/wp-content/uploads/2019/07/latestproof.png 1484w, https://www.galoisrepresentations.com/wp-content/uploads/2019/07/latestproof-300x98.png 300w, https://www.galoisrepresentations.com/wp-content/uploads/2019/07/latestproof-768x250.png 768w, https://www.galoisrepresentations.com/wp-content/uploads/2019/07/latestproof-1024x334.png 1024w" sizes="(max-width: 615px) 100vw, 615px"></a></p>
<p>(There is actually something vaguely interesting about how certain specializations of complicated identities are harder to prove than the original identities, but that is only tangentially relevant to this post.)</p>
											</div><!-- .entry-content -->

		
						<div><p>
							This entry was posted in <a href="https://www.galoisrepresentations.com/category/mathematics/" rel="category tag">Mathematics</a>, <a href="https://www.galoisrepresentations.com/category/rant/" rel="category tag">Rant</a> and tagged <a href="https://www.galoisrepresentations.com/tag/continued-fractions/" rel="tag">Continued Fractions</a>, <a href="https://www.galoisrepresentations.com/tag/de-fractionibus-continuis-observationes/" rel="tag">De fractionibus continuis observationes</a>, <a href="https://www.galoisrepresentations.com/tag/elon-musk/" rel="tag">Elon Musk</a>, <a href="https://www.galoisrepresentations.com/tag/euler/" rel="tag">Euler</a>, <a href="https://www.galoisrepresentations.com/tag/gauss/" rel="tag">Gauss</a>, <a href="https://www.galoisrepresentations.com/tag/intellectual-fraud/" rel="tag">Intellectual Fraud</a>, <a href="https://www.galoisrepresentations.com/tag/ramanujan/" rel="tag">Ramanujan</a>, <a href="https://www.galoisrepresentations.com/tag/robert-dijkgraaf/" rel="tag">Robert Dijkgraaf</a>, <a href="https://www.galoisrepresentations.com/tag/startup-culture/" rel="tag">startup culture</a>, <a href="https://www.galoisrepresentations.com/tag/stephen-wolfram/" rel="tag">Stephen Wolfram</a>, <a href="https://www.galoisrepresentations.com/tag/twitter/" rel="tag">twitter</a>, <a href="https://www.galoisrepresentations.com/tag/yuri-milner/" rel="tag">Yuri Milner</a>. Bookmark the <a href="https://www.galoisrepresentations.com/2019/07/17/the-ramanujan-machine-is-an-intellectual-fraud/" title="Permalink to The Ramanujan Machine is all hype" rel="bookmark">permalink</a>.													</p></div><!-- .entry-utility -->
					</div></div>]]>
            </description>
            <link>https://www.galoisrepresentations.com/2019/07/17/the-ramanujan-machine-is-an-intellectual-fraud/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26144665</guid>
            <pubDate>Mon, 15 Feb 2021 17:12:10 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Alien-Haunted World]]>
            </title>
            <description>
<![CDATA[
Score 21 | Comments 18 (<a href="https://news.ycombinator.com/item?id=26142795">thread link</a>) | @CapitalistCartr
<br/>
February 15, 2021 | http://m.nautil.us/blog/the-alien_haunted-world | <a href="https://web.archive.org/web/*/http://m.nautil.us/blog/the-alien_haunted-world">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
			

			<figure data-alt=""><img src="http://static.nautil.us/18165_825ab77fe4eb3419db2fc9c6ceff7146.jpg" width="733" alt=""><figcaption><span><i>To shield one’s pet hypothesis of an alien object by suggesting that it is not being taken seriously because of a flaw in how we do science is playing a disingenuous game with the facts.</i></span><span>Illustration by ktsdesign / Shutterstock</span></figcaption></figure><p><span>D</span>id you know that there are many scientists who devote their working lives to skillfully charting out the most unassuming chunks of our solar system—chunks that none of our species will likely never see up close? Chunks that, individually, are mere specks in the cloud of millions of such primordial planetary leftovers circling our sun. Or, are you aware that there are those who spend day after day wrestling with how to measure and decode the extraordinary orbital dances of unreachable exoplanets, or to detect and interpret the delicate spectra revealing the composition of alien atmospheres tens of trillions of miles away?</p><p>If not them, then what about those who have, for decades, tackled some of the most daunting questions about the phenomenon we call life itself, including how it began here on Earth billions of years ago, and how it might have begun anywhere else in the cosmos? And can you recall that there are devoted and talented scientists who pursue the exquisite possibility that somewhere there are alien minds sending out structured, information-rich signals, or repurposing their environments in ways that we—other scraps of thinking life—might just be able to spot across the gaping void of interstellar space?</p><blockquote><p>Aliens may be out there. And we are looking for them.</p> </blockquote><p>If you could say yes to any of these questions, well done. You are a well-informed citizen of planet Earth, aware of humanity’s ongoing efforts to make sense of the nature of reality. If, on the other hand, you couldn’t respond in the affirmative then perhaps you wouldn’t blink an eye at newspaper articles or TV headlines asking why (oh why?!) scientists won’t take the task of “looking for aliens” more seriously? Or articles harrumphing about how conservative science is when it comes to “thinking out of the box,” especially if the topic is one that’s been abused so many times over literally centuries that researchers now have little choice but to apply extreme care and caution.<br></p><p>I am, if you are not up on your science news at the moment, referring to a recent flurry of words and opinions that have been, in part, triggered by the publication of the book <i>Extraterrestrial</i> by the theoretical astrophysicist Avi Loeb, in which he attempts to make a case that a recent interstellar object passing through our solar system (<a href="https://nautil.us/blog/how-oumuamua-got-shredded" target="_blank">the ‘Oumuamua object</a>) could have been a piece of technology, conceivably even a tumbling light sail from an alien spacecraft, rather than a piece of frozen rock and gas. Loeb also writes about how science can be overly conservative at times—aiming his complaints in particular on the reticence to elevate the question of alien life to a more prominent place in our hypotheses about what we see in the universe around us.</p><p>But you need only to have spent a little time recently in the hallways of scientific Zoom calls or on social media to see unhappiness being expressed by many researchers about all of this. That unhappiness reaches a red-hot level any time a new opinion piece gets published that picks up this particular thread. Most recently (at least as I write this), is the appearance in <i>The New York Times</i> of an <a href="https://www.nytimes.com/2021/02/11/opinion/aliens-extraterrestrial-life.html" target="_blank">opinion article</a> with the title “Aliens Must Be Out There: Why aren’t we looking for them?”, written by the columnist Farhad Manjoo. I think it’s fair to say that the tone of the headline, erroneously suggesting that alien life exists because we think it must and that we’re not paying attention, reflects much of the thrust of the content. Reaching an apex of sorts when the piece uses Loeb’s thoughts on the matter to admonish science, and science-funding agencies, for their “closed-mindedness” and “reflexive skepticism” when it comes to considering exotic (yes, alien) stuff in the mix for explaining new or unexpected cosmic phenomena.&nbsp;</p><p>What is so incredibly disappointing for a scientist like myself, and for so many of my colleagues across related disciplines—from astronomy to planetary science, to astrobiology—is that there are no other voices represented in this kind of writing. No snippets or quotes from the hundreds of scientists who are the world’s experts on matters like ‘Oumuamua, or other extraterrestrial objects, from asteroids to comets to (yes) interstellar chunks, or the Search for Extraterrestrial Intelligence (SETI), or exoplanets, or indeed the very same quest for so-called technosignatures that is fleetingly mentioned. And this one article is by no means alone in that strange incompleteness, where “due diligence” seems to have gone out the window.</p><p>In reality there are people who do think about all of these scientific questions, week after week. They dig through mountains of data, and sweat blood over understanding the delicate nature of astronomical measurements and instrumentation. They build spacecraft to go to other worlds, as well as asteroids and comets, funded by national agencies like NASA, ESA, JAXA, CNSA, and more. These people are eager and driven, motivated by precisely these same extraterrestrial conundrums: Are we alone? Where do we, or any other life, come from?</p><p>These scientists, including those like the remarkable Jill Tarter—one of the driving forces and voices behind SETI for the past 40 years—have pushed their instruments and skills to the absolute limits in the quest for evidence of extraterrestrial life. Often in the face of intense skepticism. Despite this effort, there has been no evidence to date of extraterrestrial life. But that lack of evidence is not because the scientific enterprise is uniformly conservative, rigid, and close-minded, as implied by Loeb and uncritically echoed by some columnists. It’s because no discovery or event has risen to the level where it is inexplicable in any other way. Could greater funding and support change that story? Perhaps, but the same could be said for almost any other ambitious scientific enterprise, and the answer cannot be known beforehand.</p><p>A proposal that a phenomenon like ‘Oumuamua is an alien artifact is certainly going to meet push-back. But that push-back is well founded. It results from the extensive work of scientific experts on precisely this kind of interstellar visitor. Our models of star and planet formation have long hypothesized the existence of leftover pieces of solid material (planetesimals) that could spend eons moving across interstellar space. They have outlined how an interloper like ‘Oumuamua would be a stunning discovery. But it would be a stunning discovery reflecting natural processes; reservoirs of these planetesimals—already suggested by the hazy light seen around certain other stars—that can be ejected and scattered across interstellar space in numbers that may be perfectly consistent with the chances of our solar system being visited by one. This is precisely why an agency like ESA is developing its <a href="https://www.cometinterceptor.space/" target="_blank">Comet Interceptor Mission</a>, to be ready to chase future interstellar visitors.</p><div id="inpagesub">
	<p>Get the <span>Nautilus</span> newsletter</p>
<p>
	The newest and most popular articles delivered right to your inbox!
</p>
			<!-- Begin MailChimp Signup Form -->
			




</div><p>‘Oumuamua certainly had puzzling characteristics. It was small for an interstellar comet, it was elongated and, despite being barely caught by our best telescopes and nimblest astronomers as it wended its tumbling way back out of the solar system, it exhibited an ethereal acceleration away from the Sun. But even these puzzles are explicable by known processes and are not wildly inconsistent with the properties of other cometary-like objects. Indeed, a number of comparatively straightforward, testable, explanations seem compatible, <a href="https://www.hou.usra.edu/meetings/lpsc2021/pdf/1718.pdf" target="_blank">including the possibility</a> that the object was a frozen nitrogen “iceberg,” a chip off the block of some distant Pluto-like world.&nbsp;</p><p>In light of all of this rigorous insight, to shield one’s pet hypothesis of an alien object by suggesting that it is not being taken seriously because of a flaw in how we do science is playing a disingenuous game with the facts. As is to suggest that this is actually in aid of raising support for the search for extraterrestrial life. For that to be uncritically echoed elsewhere is truly unfortunate.</p><p>As in any human intellectual endeavor, there are many voices, many insights. It’s too bad that not all insights get the same kind of airtime. If they did, we’d be hearing so much more about the extraordinary ongoing scientific efforts—both institutional and personal—to open up our minds, to explore new worlds, and perhaps discover new life. Are we all carrying out these efforts perfectly? No. Scientific conservatism is present. But so too is a clear memory of the many times where enthusiasm for a provocative idea about alien life has given way to disappointment—from fossils in Martian meteorites to arsenic-laced microbes. Fingers have been burnt before in the quest to find clues to life in the universe.&nbsp;</p><p>They weren’t burned because of misplaced skepticism though. A wide range of scientists did their own due diligence: scrutinizing a hypothesis, gathering more data, weighing the evidence and building their confidence in a conclusion. Science denialism has cursed many cultures in recent years. Thankfully it looks to be receding somewhat. But being blind to how science works and what it’s doing is also a form of denialism. Aliens may be out there. And we are looking for them.</p><p><i>Caleb Scharf is an astrophysicist and the director of astrobiology at Columbia University in New York. His latest book is&nbsp;</i>The Ascent of Information: Books, Bits, Genes, Machines, and Life’s Unending Algorithm<i>, coming in June 2021.&nbsp;Follow him on Twitter @caleb_scharf.</i></p>

		</div></div>]]>
            </description>
            <link>http://m.nautil.us/blog/the-alien_haunted-world</link>
            <guid isPermaLink="false">hacker-news-small-sites-26142795</guid>
            <pubDate>Mon, 15 Feb 2021 13:59:09 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[An Improved Thread with C++20]]>
            </title>
            <description>
<![CDATA[
Score 66 | Comments 66 (<a href="https://news.ycombinator.com/item?id=26142257">thread link</a>) | @ibobev
<br/>
February 15, 2021 | http://modernescpp.com/index.php/an-improved-thread-with-c-20 | <a href="https://web.archive.org/web/*/http://modernescpp.com/index.php/an-improved-thread-with-c-20">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="blogContent">
				<p><code>std::jthread</code> stands for joining thread. In addition to <code>std::thread</code> (C++11),<code> std::jthread</code> automatically joins in its destructor and can cooperatively be interrupted. Read in this post to know why <code>std::jthread</code> should be your first choice.</p>

<p>&nbsp;<img src="http://modernescpp.com/images/blog/Cpp20/jthread/TimelineCpp20.png" alt="TimelineCpp20" width="650" height="227"></p>
<p>The following table gives you a concise overview of the functionality of <code>std::jthread</code>.</p>
<p><img src="http://modernescpp.com/images/blog/Cpp20/jthread/jthread.png" alt="jthread" width="650" height="572"></p>

<p>For additional details, please refer to <a href="https://en.cppreference.com/w/cpp/thread/jthread">cppreference.com</a>. When you want to read more post about <code>std::thread</code>, here are they: <a href="http://modernescpp.com/index.php/der-einstieg-in-modernes-c#h1-2-the-threading-interface">my post about std::thread.</a></p>
<p>First, why do we need an improved thread in C++20? Here is the first reason.</p>
<h2 id="h1-automatically-joining">Automatically Joining</h2>
<p>This is the <strong>non-intuitive</strong> behavior of <code>std::thread</code>. If a <code>std::thread</code> is still joinable, <a href="https://en.cppreference.com/w/cpp/error/terminate">std::terminate</a> is called in its destructor. A thread<code> thr</code> is joinable if neither <code>thr.join()</code> nor <code>thr.detach()</code> was called. Let me show, what that means.</p>
<!-- HTML generated using hilite.me -->
<div>
<pre><span>// threadJoinable.cpp</span>

<span>#include &lt;iostream&gt;</span>
<span>#include &lt;thread&gt;</span>

<span>int</span> <span>main</span>() {
    
    std<span>::</span>cout <span>&lt;&lt;</span> <span>'\n'</span>;
    std<span>::</span>cout <span>&lt;&lt;</span> std<span>::</span>boolalpha;
    
    std<span>::</span><span>thread</span> thr{[]{ std<span>::</span>cout <span>&lt;&lt;</span> <span>"Joinable std::thread"</span> <span>&lt;&lt;</span> <span>'\n'</span>; }};
    
    std<span>::</span>cout <span>&lt;&lt;</span> <span>"thr.joinable(): "</span> <span>&lt;&lt;</span> thr.joinable() <span>&lt;&lt;</span> <span>'\n'</span>;
    
    std<span>::</span>cout <span>&lt;&lt;</span> <span>'\n'</span>;
    
}
</pre>
</div>

<p>When executed, the program terminates when the local object <code>thr</code> goes out of scope.</p>
<p><img src="http://modernescpp.com/images/blog/Cpp20/jthread/threadJoinable.png" alt="threadJoinable" width="500" height="279"></p>
<p>Both executions of<code> std::thread</code> terminate. In the second run, the thread <code>thr</code> has enough time to display its message:&nbsp;<code>Joinable std::thread</code>.</p>
<p>In the next example, I use <code>std::jthread</code> from the C++20 standard.</p>
<!-- HTML generated using hilite.me -->
<div>
<pre><span>// jthreadJoinable.cpp</span>

<span>#include &lt;iostream&gt;</span>
<span>#include &lt;thread&gt;</span>

<span>int</span> <span>main</span>() {
    
    std<span>::</span>cout <span>&lt;&lt;</span> <span>'\n'</span>;
    std<span>::</span>cout <span>&lt;&lt;</span> std<span>::</span>boolalpha;
    
    std<span>::</span>jthread thr{[]{ std<span>::</span>cout <span>&lt;&lt;</span> <span>"Joinable std::thread"</span> <span>&lt;&lt;</span> <span>'\n'</span>; }};
    
    std<span>::</span>cout <span>&lt;&lt;</span> <span>"thr.joinable(): "</span> <span>&lt;&lt;</span> thr.joinable() <span>&lt;&lt;</span> <span>'\n'</span>;
    
    std<span>::</span>cout <span>&lt;&lt;</span> <span>'\n'</span>;
    
}
</pre>
</div>

<p>Now, the thread<code> thr</code> automatically joins in its destructor if it's still joinable such as in this case.</p>
<p><img src="http://modernescpp.com/images/blog/Cpp20/jthread/jthreadJoinable.png" alt="jthreadJoinable" width="350" height="177"></p>
<p>But this is not all that<code> std::jthread</code>&nbsp; provides additionally to <code>std::thread</code>. A <code>std::jthread</code> can be cooperatively interrupted. I already presented the general ideas of cooperative interruption in my last post: <a href="http://modernescpp.com/index.php/cooperative-interruption-of-a-thread-in-c-20">Cooperative Interruption of a Thread in C++20</a>.</p>
<h2 id="h2-cooperative-interruption-of-a-std-jthread">Cooperative Interruption of a<code> std::jthread</code></h2>
<p>To get a general idea, let me present a simple example.</p>
<!-- HTML generated using hilite.me -->
<div>
<pre><span>// interruptJthread.cpp</span>

<span>#include &lt;chrono&gt;</span>
<span>#include &lt;iostream&gt;</span>
<span>#include &lt;thread&gt;</span>

<span>using</span> <span>namespace</span><span>::</span>std<span>::</span>literals;

<span>int</span> <span>main</span>() {
    
    std<span>::</span>cout <span>&lt;&lt;</span> <span>'\n'</span>;
    
    std<span>::</span>jthread nonInterruptable([]{                           <span>// (1)</span>
        <span>int</span> counter{<span>0</span>};
        <span>while</span> (counter <span>&lt;</span> <span>10</span>){
            std<span>::</span>this_thread<span>::</span>sleep_for(<span>0.2</span>s);
            std<span>::</span>cerr <span>&lt;&lt;</span> <span>"nonInterruptable: "</span> <span>&lt;&lt;</span> counter <span>&lt;&lt;</span> <span>'\n'</span>; 
            <span>++</span>counter;
        }
    });
    
    std<span>::</span>jthread interruptable([](std<span>::</span>stop_token stoken){     <span>// (2)</span>
        <span>int</span> counter{<span>0</span>};
        <span>while</span> (counter <span>&lt;</span> <span>10</span>){
            std<span>::</span>this_thread<span>::</span>sleep_for(<span>0.2</span>s);
            <span>if</span> (stoken.stop_requested()) <span>return</span>;               <span>// (3)</span>
            std<span>::</span>cerr <span>&lt;&lt;</span> <span>"interruptable: "</span> <span>&lt;&lt;</span> counter <span>&lt;&lt;</span> <span>'\n'</span>; 
            <span>++</span>counter;
        }
    });
    
    std<span>::</span>this_thread<span>::</span>sleep_for(<span>1</span>s);
    
    std<span>::</span>cerr <span>&lt;&lt;</span> <span>'\n'</span>;
    std<span>::</span>cerr <span>&lt;&lt;</span> <span>"Main thread interrupts both jthreads"</span> <span>&lt;&lt;</span> <span>'\n'</span>;
    nonInterruptable.request_stop();
    interruptable.request_stop();                              <span>// (4)</span>
    
    std<span>::</span>cout <span>&lt;&lt;</span> <span>'\n'</span>;
    
}
</pre>
</div>

<p>In the main program, I start the two threads <code>nonInterruptable</code> and interruptable (lines 1)and 2). Unlike in the thread <code>nonInterruptable</code> , the thread <code>interruptable</code> gets a <code>std::stop_token</code> and uses it in line (3) to check if it was interrupted: <code>stoken.stop_requested()</code>. In case of a stop request, the lambda function returns, and, therefore, the thread ends. The call <code>interruptable.request_stop()</code> (line 4) triggers the stop request. This does not hold for the previous call <code>nonInterruptable.request_stop()</code> . The call has no effect.</p>
<p><img src="http://modernescpp.com/images/blog/Cpp20/jthread/interruptJthread.png" alt="interruptJthread" width="400" height="382"></p>
<p>To make my post complete, with C++20, you can also cooperatively interrupt a condition variable.</p>
<h2 id="h3-new-wait-overloads-for-std-condition-variable-any">New wait Overloads for <code>std::condition_variable_any</code></h2>
<p>Before I write about <code>std::condition_variable_any</code>, here are my post about <a href="http://modernescpp.com/index.php/tag/condition-variable">condition variables</a>.&nbsp;</p>
<p>The three wait variations <code>wait, wait_for</code>, and<code> wait_until</code> of the std::condition_variable_any get new overloads. These overloads take a <code>std::stop_token</code>.</p>
<!-- HTML generated using hilite.me -->
<div>
<pre><span>template</span> <span>&lt;</span><span>class</span> <span>Predicate</span><span>&gt;</span>
<span>bool</span> wait(Lock<span>&amp;</span> lock,  
          stop_token stoken,
          Predicate pred);

<span>template</span> <span>&lt;</span><span>class</span> <span>Rep</span>, <span>class</span> <span>Period</span>, <span>class</span> <span>Predicate</span><span>&gt;</span>
<span>bool</span> wait_for(Lock<span>&amp;</span> lock, 
              stop_token stoken, 
              <span>const</span> chrono<span>::</span>duration<span>&lt;</span>Rep, Period<span>&gt;&amp;</span> rel_time, 
              Predicate pred);
                
<span>template</span> <span>&lt;</span><span>class</span> <span>Clock</span>, <span>class</span> <span>Duration</span>, <span>class</span> <span>Predicate</span><span>&gt;</span>
<span>bool</span> wait_until(Lock<span>&amp;</span> lock, 
                stop_token stoken,
                <span>const</span> chrono<span>::</span>time_point<span>&lt;</span>Clock, Duration<span>&gt;&amp;</span> abs_time, 
                Predicate pred);
</pre>
</div>

<p>These new overloads need a predicate. The presented versions ensure to get notified if a stop request for the passed <code>std::stop_token stoken</code> is signaled. They return a boolean that indicates whether the predicate evaluates to <code>true</code>. This returned boolean is independent of whether a stop was requested or of whether the timeout was triggered.</p>
<p>After the wait calls, you can check if a stop request occurred.</p>
<!-- HTML generated using hilite.me -->
<div>
<pre>cv.wait(lock, stoken, predicate);
<span>if</span> (stoken.stop_requested()){
    <span>// interrupt occurred</span>
}
</pre>
</div>

<p>The following example shows the usage of a condition variable with a stop request.</p>
<!-- HTML generated using hilite.me -->
<div>
<pre><span>// conditionVariableAny.cpp</span>

<span>#include &lt;condition_variable&gt;</span>
<span>#include &lt;thread&gt;</span>
<span>#include &lt;iostream&gt;</span>
<span>#include &lt;chrono&gt;</span>
<span>#include &lt;mutex&gt;</span>
<span>#include &lt;thread&gt;</span>

<span>using</span> <span>namespace</span> std<span>::</span>literals;

std<span>::</span>mutex mutex_;
std<span>::</span>condition_variable_any condVar;

<span>bool</span> dataReady;

<span>void</span> <span>receiver</span>(std<span>::</span>stop_token stopToken) {                 <span>// (1)</span>

    std<span>::</span>cout <span>&lt;&lt;</span> <span>"Waiting"</span> <span>&lt;&lt;</span> <span>'\n'</span>;

    std<span>::</span>unique_lock<span>&lt;</span>std<span>::</span>mutex<span>&gt;</span> lck(mutex_);
    <span>bool</span> ret <span>=</span> condVar.wait(lck, stopToken, []{<span>return</span> dataReady;});
    <span>if</span> (ret){
        std<span>::</span>cout <span>&lt;&lt;</span> <span>"Notification received: "</span> <span>&lt;&lt;</span> <span>'\n'</span>;
    }
    <span>else</span>{
         std<span>::</span>cout <span>&lt;&lt;</span> <span>"Stop request received"</span> <span>&lt;&lt;</span> <span>'\n'</span>;
    }
}

<span>void</span> <span>sender</span>() {                                            <span>// (2)</span>

    std<span>::</span>this_thread<span>::</span>sleep_for(<span>5</span>ms);
    {
        std<span>::</span>lock_guard<span>&lt;</span>std<span>::</span>mutex<span>&gt;</span> lck(mutex_);
        dataReady <span>=</span> <span>true</span>;
        std<span>::</span>cout <span>&lt;&lt;</span> <span>"Send notification"</span>  <span>&lt;&lt;</span> <span>'\n'</span>;
    }
    condVar.notify_one();                                  <span>// (3)</span>

}

<span>int</span> <span>main</span>(){

  std<span>::</span>cout <span>&lt;&lt;</span> <span>'\n'</span>;

  std<span>::</span>jthread t1(receiver);
  std<span>::</span>jthread t2(sender);
  
  t1.request_stop();                                       <span>// (4)</span>

  t1.join();
  t2.join();

  std<span>::</span>cout <span>&lt;&lt;</span> <span>'\n'</span>;
  
}
</pre>
</div>

<p>The receiver thread (line 1) is waiting for the notification of the sender thread (line 2). Before the sender thread sends its notification (line 3), the main thread triggered a stop request in<br>line (4). The output of the program shows that the stop request happened before the notification.</p>
<h2><img src="http://modernescpp.com/images/blog/Cpp20/jthread/conditionVariableAny.png" alt="conditionVariableAny" width="281" height="113"></h2>
<h2 id="h4-what-s-next">What's next?</h2>
<p>What happens when your write without synchronization to <code>std::cout</code>? You get a mess. Thanks to C++20, we have synchronized output streams.</p>
<div>
	<p><strong>Thanks a lot to my <a href="https://www.patreon.com/rainer_grimm">Patreon Supporters</a></strong><strong>: Matt Braun, Roman Postanciuc, Tobias Zindl, Marko, </strong><span title="Emyr Williams"><strong>G Prvulovic, Reinhold Dröge, Abernitzke,</strong> </span><strong><span title="Emyr Williams">Frank Grimm</span></strong><span title="Emyr Williams"><strong>, Sakib, Broeserl, </strong></span><strong><span title="Emyr Williams">António Pina, Darshan Mody, Sergey Agafyin, <span data-tag="user-details-full-name">Андрей Бурмистров, Jake, GS, Lawton Shoemake, Animus24, Jozo Leko, John Breland, espkk, Wolfgang Gärtner</span></span><span title="Emyr Williams"><span><span></span></span></span>,&nbsp; Louis St-Amour, Stephan Roslen, Venkat Nandam, Jose Francisco, Douglas Tinkham, Kuchlong Kuchlong, Avi Kohn, Robert Blanch, Truels Wissneth, Kris Kafka, Mario Luoni, Neil Wang, Friedrich Huber, lennonli, Pramod Tikare Muralidhara, Peter Ware, and Tobi Heideman.<br></strong></p>

<p><strong>Thanks in particular to Jon Hess, Lakshman,</strong> <strong>Christian Wittenhorst, Sherhy Pyton, Dendi Suhubdy, Sudhakar Belagurusamy, and Richard Sargeant.<br></strong></p>
<p>My special thanks to <a href="https://www.embarcadero.com/de/products/cbuilder">Embarcadero</a> <a href="https://www.embarcadero.com/products/cbuilder"><img src="http://modernescpp.com/images/Embarcadero/CBUIDER_STUDIO_FINAL_ICONS_1024_Small.png" alt="CBUIDER STUDIO FINAL ICONS 1024 Small" width="100" height="100"></a></p>

<h2>Seminars</h2>
<p>I'm happy to give online-seminars or face-to-face seminars world-wide. Please call me if you have any questions.</p>
<h3>Bookable (Online)</h3>
<h4>Deutsch</h4>
<ul>
<li><a href="https://www.modernescpp.de/index.php/c/2-c/30-embedded-programmierung-mit-modernem-c20210126195655">Embedded Programmierung mit modernem C++: </a>12.04.2021 - 14.04.2021, Termingarantie</li>
<li><a href="https://www.modernescpp.de/index.php/c/2-c/31-clean-code-mit-modernem-c">Clean Code mit modernem C++: </a>22.06.2021 - 24.06.2021 </li>
</ul>
<h4>English</h4>
<ul>
<li>Workshop: <a href="https://www.modernescpp.net/index.php/c/2-c/32-workshop-concepts-in-c-20">Concepts in C++20</a>: 22.03.2021 (17:00 - 21:00 CET)</li>
<li>Workshop: <a href="https://www.modernescpp.net/index.php/c/2-c/33-workshop-coroutines-in-c-20">Coroutines in C++20</a>: 06.04.2021 (17:00 - 21:00 CEST)</li>
</ul>
<h3>Standard Seminars&nbsp;</h3>
<p>Here is a compilation of my standard seminars. These seminars are only meant to give you a first orientation.</p>
<ul>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/22">C++ - The Core Language</a></li>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/23">C++ - The Standard Library</a></li>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/23">C++ - Compact</a></li>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/18">C++11 and C++14</a></li>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/19">Concurrency with Modern C++</a></li>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/21">Design Patterns and Architecture Patterns with C++</a></li>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/17">Embedded Programming with Modern C++</a></li>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/17">Generic Programming (Templates) with C++</a></li>
</ul>
<h4>New</h4>
<ul>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/16">Clean Code with Modern C++</a></li>
<li><a href="https://www.modernescpp.net/index.php/c/plan/2-c/25">C++20</a></li>
</ul>
<h3>Contact Me</h3>
<ul>
<li>Tel.: +49 7472 917441</li>
<li>Mobil: +49 152 31965939</li>
<li>Mail: <a href="http://modernescpp.com/%3Ca%20href="><span id="cloak432c1f0aa1295ca64338e296aa989760">This email address is being protected from spambots. You need JavaScript enabled to view it.</span></a></li>
<li>German Seminar Page: <a href="https://www.modernescpp.de/">www.ModernesCpp.de</a></li>
<li>English Seminar Page: <a href="http://www.modernescpp.net/">www.ModernesCpp.net</a></li>
</ul>
<h3>Modernes C++,</h3>
<p><img src="http://modernescpp.com/images/signatur/RainerGrimmSmall.png" alt="RainerGrimmSmall"></p></div>


			</div></div>]]>
            </description>
            <link>http://modernescpp.com/index.php/an-improved-thread-with-c-20</link>
            <guid isPermaLink="false">hacker-news-small-sites-26142257</guid>
            <pubDate>Mon, 15 Feb 2021 12:55:20 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Running Nomad for a Home Server]]>
            </title>
            <description>
<![CDATA[
Score 273 | Comments 140 (<a href="https://news.ycombinator.com/item?id=26142005">thread link</a>) | @elliebike
<br/>
February 15, 2021 | https://mrkaran.dev/posts/home-server-nomad/ | <a href="https://web.archive.org/web/*/https://mrkaran.dev/posts/home-server-nomad/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>

<section>
    
    <article>
        <p>It's been a long time since I've written a post on Hydra (my home server). I use Hydra as a testbed to learn new tools, workflows and it just gives me joy to self-host applications while learning something in return.</p>
<h2 id="history">History</h2>
<p>A brief history of how <a href="https://github.com/mr-karan/hydra">Hydra's</a> setup evolved over time:</p>
<p><a href="https://mrkaran.dev/posts/home-server-setup/">2019</a>: </p>
<ul>
<li>A pretty minimal K3s setup deployed on 2 RPi4 nodes. I couldn't continue with this setup because:
<ul>
<li>Some of the apps didn't have ARM-based image (this was 2019, pre M1 hype era).</li>
<li>Didn't want to risk deploying persistent workloads on RPi.</li>
<li>A lot of tooling to deploy workloads was missing (storing env variables for eg.).</li>
<li>It was so boring to write YAML (that I also did at work). Didn't give me joy.</li>
</ul>
</li>
</ul>
<p><a href="https://mrkaran.dev/posts/home-server-updates/">2020 First Half</a>:</p>
<ul>
<li>RPi 2x Nodes + K3s + DO Droplet. Tailscale for networking.
<ul>
<li>This was a considerable step up from the previous setup. I deployed a DO node and added <a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/">Node Labels</a> to deploy persistent workloads on DO Node only.</li>
<li>I used my own tooling <a href="https://github.com/mr-karan/kubekutr/">Kubekutr</a> + Kustomize which helped with version control of my configs.</li>
<li>Took quite a bit of time to onboard new services. Got lazy, didn't host much apart from initial 3-4 applications.</li>
<li>Writing long YAMLs. No joy.</li>
</ul>
</li>
</ul>
<p>2020 Second Half:</p>
<ul>
<li>Single node on DO. Terraform for deploying Docker containers.
<ul>
<li>I believe the third iteration nailed it for me. I kept the setup super simple, used Terraform for deploying workloads as Docker containers.</li>
<li>Used Terraform extensively for setting up the node, Cloudflare records, DO firewall rules.</li>
<li>Time to onboard new services reduced from a couple of hours to a few minutes. This was a huge win for me. I deployed around 10-15 new services to try it out on the server directly.</li>
<li>Writing HCL is actually a much better experience than YAML.</li>
</ul>
</li>
</ul>
<h2 id="why-nomad">Why Nomad</h2>
<p><img src="https://mrkaran.dev/images/nomad-hydra.png" alt="image"></p>
<p>Around a month back, <a href="https://nadh.in/">Kailash</a> had asked about feedback on <a href="https://www.nomadproject.io/">Nomad</a>. We at <a href="https://zerodha.com/">Zerodha</a> (India's largest stock broker) are evaluating it to migrate our services to Nomad from Kubernetes (more on this later). It was almost 2 years since I last saw Nomad so it was definitely worth re-evaluating (esp since it hit 1.0 recently). I wanted to try out Nomad to answer a personal curiosity: <em>What does it do differently than Kubernetes?</em> No better way than actually getting hands dirty, right?!</p>
<p>After following the brief tutorials from the <a href="https://learn.hashicorp.com/nomad">official website</a> I felt confident to try it for actual workloads. In my previous setup, I was hosting quite a few applications (Pihole, Gitea, Grafana etc) and thought it'll be a nice way to learn how Nomad works by deploying the same services in the Nomad cluster. And I came in with zero expectations, I already had a nice setup which was reliable and running for me. My experience with a local Nomad cluster was joyful, I was able to quickly go from 0-&gt;1 in less than 30 minutes. This BTW is a strong sign of how easy Nomad is to get started with as compared to K8s. The sheer amount of different concepts you've to register in your mind before you can even deploy a single container in a K8s cluster is bizarre. Nomad takes the easy way out here and simplified the concepts for developers into just three things:</p>
<pre><code><span>job
  \_ group
        \_ task
</span></code></pre>
<ul>
<li>Job: Job is a collection of different groups. Job is where the constraints for type of scheduler, update strategies and ACL is placed. </li>
<li>Group: Group is a collection of different tasks. A group is always executed on the same Nomad client node. You'll want to use Groups for use-cases like a logging sidecar, reverse proxies etc.</li>
<li>Task: Atomic unit of work. A task in Nomad can be running a container/binary/Java VM etc, defining the mount points, env variables, ports to be exposed etc.</li>
</ul>
<p>If you're coming from K8s you can think of Task as a Pod and Group as a Replicaset. There's no equivalent to Job in K8s. BUT! The coolest part? You don't have to familiarise yourself with all different types of Replicasets (Deployments, Daemonsets, Statefulsets) and different ways of configuring them.</p>
<p>Want to make a normal job as a periodic job in Nomad? Simply add the following block to your existing Job:</p>
<pre><code><span>periodic {
  cron = "@daily"
}
</span></code></pre>
<p>You want to make a service run as a batch job (on all Nomad nodes -- the equivalent of Daemonset in K8s)? Simply make the following change to your existing job:</p>
<pre><code><span>-type="service"
</span><span>+type="batch"
</span></code></pre>
<p>You see <strong>this</strong> is what I mean by the focus on UX. There are many many such examples which will leave a nice smile on your face if you're coming from K8s background.</p>
<p>I'd recommend reading <a href="https://www.nomadproject.io/docs/internals/architecture">Internal Architecture</a> of Nomad if you want to understand this in-depth.</p>
<h2 id="architecture">Architecture</h2>
<p>Tech stack for Hydra:</p>
<ul>
<li>Tailscale VPN: Serves as a mesh layer between my laptop/mobile and DO server. Useful for exposing internal services.</li>
<li>Caddy for reverse proxying and automatic SSL setup for all services. I run 2 instances of Caddy:
<ul>
<li>Internal: Listens on Tailscale Network Interface. Reverse proxies all private services.</li>
<li>Public: Listens on DO's Public IPv4 network interface. Reverse proxies all public-facing services.</li>
</ul>
</li>
<li>Terraform: Primary component to have IaC (Infra as Code). Modules to manage:
<ul>
<li>Cloudflare DNS Zone and Records</li>
<li>DO Droplet, Firewall rules, SSH Keys, Floating IPs etc.</li>
<li>Nomad Jobs. Used for running workloads after templating env variables, config files in Nomad job files.</li>
</ul>
</li>
</ul>
<h2 id="complexity-of-nomad-vs-kubernetes">Complexity of Nomad vs Kubernetes</h2>
<p><a href="https://twitter.com/mrkaran_/status/1268762357355823104"><img src="https://mrkaran.dev/images/k8s-meme.jpeg" alt="image"></a></p>
<p>Nomad shines because it follows the UNIX philosophy of "Make each program do one thing well". To put simply, Nomad is <em>just</em> a workload orchestrator. It only is concerned about things like Bin Packing, scheduling decisions.</p>
<p>If you're running heterogeneous workloads, running a server (or a set of servers) quickly becomes expensive. Hence orchestrators tend to make sense in this context. They tend to save costs by making it efficient to run a vast variety of workloads. This is all an orchestrator has to do really. </p>
<p>Nomad doesn't interfere in your DNS setup, Service Discovery, secrets management mechanisms and pretty much anything else. If you read some of the posts at <a href="https://k8s.af/">Kubernetes Failure Stories</a>, the most common reason for outages is Networking (DNS, ndots etc). A lot of marketing around K8s never talks about these things.</p>
<p>I always maintain "Day 0 is easy, Day N is the real test of your skills". Anyone can deploy a workload to a K8s cluster, it's always the Day N operations which involve debugging networking drops, mysterious container restarts, proper resource allocations and other such complex issues that require real skills <strong>and</strong> effort. It's not as easy as <code>kubectl apply -f</code> and my primary gripe is with people who miss out on this in their "marketing" pitches (obvious!).</p>
<h2 id="when-to-use-nomad">When to use Nomad</h2>
<p>Nomad hits the sweet spot of being operationally easy and functional. Nomad is a great choice if you want to:</p>
<ul>
<li>Run not just containers but other forms of workloads.</li>
<li>Increase developer productivity by making it easier to deploy/onboard new services.</li>
<li>Consistent experience of deployment by testing the deployments locally.</li>
<li>(Not joking) You are tired of running Helm charts or writing large YAML manifests. The config syntax for Nomad jobs is human friendly and easy to grasp.</li>
</ul>
<p>Nomad is available as a single binary. If you want to try it locally, all you need is <code>sudo nomad agent -dev</code> and you'll have a Nomad Server, Client running in dev mode along with a UI. This makes it easy for the developers to test out the deployments locally because there's very little configuration difference between this and production deployment. Not to forget it's super easy to self-host Nomad clusters. I'm yet to meet anyone who self hosts K8s clusters in production without a dedicated team babysitting it always.</p>
<p>Once you eliminate the "blackbox" components from your stack, life becomes easier for everyone.</p>
<h2 id="when-to-not-use-nomad">When to not use Nomad</h2>
<ul>
<li>If you're relying on custom controllers and operators. <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/operator/">Operator Pattern</a> is a new way of managing large complex distributed systems (like databases, job queues etc). There are a lot of community built operators which help in reducing the effort to run these services. However, all of these are tied deeply into the "Kubernetes" ecosystem. If you find yourself running any of such operators, it'll be tough (not impossible) to translate the same in Nomad ecosystem.</li>
</ul>
<p>I <em>genuinely</em> cannot think of any other reason to not use Nomad!</p>
<h2 id="practical-scenarios">Practical Scenarios</h2>
<p>Since I migrated a couple of workloads from my DO docker containers setup to Nomad, I'd demonstrate a few use cases which might be helpful if you want to start migrating your services to Nomad</p>
<h3 id="accessing-a-web-service-with-reverse-proxy">Accessing a Web service with Reverse Proxy</h3>
<p>Context: I'm running Caddy as a reverse proxy for all the services. Since we discussed earlier, Nomad <strong>only</strong> is concerned about scheduling, so how exactly do you do Service Discovery? You need Consul (or something like Consul, Nomad has no hard restrictions) to register a service name with it's IP Address. Here's how you can do that:</p>
<p>In the <code>.task</code> section of your Nomad job spec, you need to register the service name with the port you're registering and additional tags as metadata (optional):</p>
<pre><code><span>service {
  name = "gitea-web"
  tags = ["gitea", "web"]
  port = "http"
}
</span></code></pre>
<p>Nomad's <a href="https://www.nomadproject.io/docs/job-specification/template">template</a> uses <code>consul-template</code> behind the scenes. This is a small utility which continuously watches for Consul/Vault keys and provides the ability to reload/restart your workloads if any of those keys change. It can also be used to <em>discover</em> the address of the service registered in Consul. So here's an example of <code>Caddyfile</code> using Consul Template functions to pull the IP address of the upstream <code>gitea-web</code> service:</p>
<pre><code><span>git.mrkaran.dev {
    {{ range service "gitea-web" }}
    reverse_proxy {{ .Address }}:{{ .Port }}
    {{ end }}
}
</span></code></pre>
<p>When a job is submitted to Nomad, a rendered template is mounted inside the container. You can define actions on what to do when the values change. For eg on a redeployment of Gitea container, the address will most likely change. We'd like Caddy to automatically restart with the new address configured in the Caddyfile in that case:</p>
<pre><code><span>template {
  data = &lt;&lt;EOF
${caddyfile_public}
EOF

  destination = "configs/Caddyfile" # Rendered template.

  change_mode = "restart"
}
</span></code></pre>
<p>Using <a href="https://www.nomadproject.io/docs/job-specification/template#change_mode"><code>change_m…</code></a></p></article></section></article></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://mrkaran.dev/posts/home-server-nomad/">https://mrkaran.dev/posts/home-server-nomad/</a></em></p>]]>
            </description>
            <link>https://mrkaran.dev/posts/home-server-nomad/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26142005</guid>
            <pubDate>Mon, 15 Feb 2021 12:15:32 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Sq, Sequoia PGP's CLI, Released]]>
            </title>
            <description>
<![CDATA[
Score 112 | Comments 15 (<a href="https://news.ycombinator.com/item?id=26141995">thread link</a>) | @upofadown
<br/>
February 15, 2021 | https://sequoia-pgp.org/blog/2021/01/26/202101-sq-release/ | <a href="https://web.archive.org/web/*/https://sequoia-pgp.org/blog/2021/01/26/202101-sq-release/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="post-content">
                          <p>Last month we released version 1.0 of our versatile, low-level OpenPGP
library, <a href="https://sequoia-pgp.org/blog/2020/12/16/202012-1.0/">sequoia-openpgp</a>.  Now we have released the first version of
<a href="https://docs.sequoia-pgp.org/sq/index.html"><code>sq</code></a>, version 0.23, which is meant for general use.</p>
<p><code>sq</code> is a command-line tool that intends to expose much (but not all!)
of the functionality that the library provides.  Although we fully
intend for <code>sq</code> to be an OpenPGP swiss army knife, and that the truly
arcane should—in general—be possible, we firstly want <code>sq</code> to be
usable by humans at the command line.  We understand this to mean that
it should be possible to use <code>sq</code> to tweak and twiddle OpenPGP data.
But, those who have the desire to use Sequoia to frob it will need to
use the library.  And, they are probably better served by it anyway.</p>
<p><code>sq</code> has a subcommand-style interface similar to git.  This has the
advantage that every command has its own option name space, which
makes it much easier to understand exactly what options influence a
given command.</p>
<p>In terms of functionality, <code>sq</code> already provides the base operations
that any OpenPGP user needs in their day-to-day use: key generation
(<code>sq key generate</code>), encryption (<code>sq encrypt</code>) &amp; decryption (<code>sq decrypt</code>), signing (<code>sq sign</code>) &amp; verification (<code>sq verify</code>), key
certification (<code>sq certify</code>), and key server (<code>sq keyserver</code>) &amp; <a href="https://tools.ietf.org/html/draft-koch-openpgp-webkey-service-11">web
key directory</a> (WKD) (<code>sq wkd</code>) interaction.  It also includes some
utility functions.  It can generate a WKD (<code>sq wkd generate</code>), encode
and decode <a href="https://autocrypt.org/level1.html#the-autocrypt-header">Autocrypt headers</a> (<code>sq autocrypt</code>), manipulate keyrings
(<code>sq keyring</code>), inspect OpenPGP-related data like <a href="https://en.wikipedia.org/wiki/File_(command)"><code>file</code></a> does (<code>sq inspect</code>), and pretty print an OpenPGP file’s contents (<code>sq packet dump</code>).</p>
<p><code>sq</code> is still missing a fair amount of functionality.  In particular,
there is no public or private key store.  (Although prototypes exist.)
This means all OpenPGP certificates must be stored in files, which is
not scalable.  Also, many necessary and useful commands are still
missing.  For instance, it is not currently possible to add new
subkeys to a certificate, or change their expiration date.</p>
<p><code>sq</code> is also not ready to be used from scripts.  Although we are
unlikely to change the current API, the bigger problem is that <code>sq</code>’s
output is not machine readable.  In the medium term, we plan to add a
<code>JSON</code>-output mode to every command.  Given the legion of <code>JSON</code>
parsers, this should effectively eliminate the need for tools that
consume <code>sq</code>’s output to have to parse it manually, and will hopefully
eliminate an entire class of common security-sensitive bugs.</p>
<p>Until now, we haven’t published <a href="https://crates.io/crates/sequoia-sq"><code>sq</code> on <code>crates.io</code></a>, and we’ve
discouraged packagers from including it in their distribution.  We now
think that <code>sq</code> is ready for general use.  If you have suggestions,
please <a href="https://sequoia-pgp.org/contribute/">reach out</a>.</p>
<h2 id="a-quick-demo">A Quick Demo</h2>
<p>Creating an OpenPGP key is straightforward:</p>
<pre><code>$ sq key generate --export /tmp/alice.sec -u 'Alice &lt;alice@example.org&gt;'
</code></pre><p><code>sq</code> saves the key in <code>/tmp/alice.sec</code> and a generic revocation
certificate in <code>/tmp/alice.sec.rev</code>.</p>
<p>We can use <code>sq inspect</code> to examine the new key’s structure:</p>
<pre><code>$ sq inspect /tmp/alice.sec
/tmp/alice.sec: Transferable Secret Key.

    Fingerprint: 1191 7C40 2605 5EA3 4980  8877 C7C7 FF13 8025 22BE
Public-key algo: EdDSA Edwards-curve Digital Signature Algorithm
Public-key size: 256 bits
     Secret key: Unencrypted
  Creation time: 2021-01-25 19:17:42 UTC
Expiration time: 2024-01-26 12:44:03 UTC (creation time + P1095DT62781S)
      Key flags: certification

         Subkey: 0C61 2153 0ACF F0B2 C01E  6E8A 4D4D 029F 2206 7039
Public-key algo: EdDSA Edwards-curve Digital Signature Algorithm
Public-key size: 256 bits
     Secret key: Unencrypted
  Creation time: 2021-01-25 19:17:42 UTC
Expiration time: 2024-01-26 12:44:03 UTC (creation time + P1095DT62781S)
      Key flags: signing

         Subkey: F2CA 7FC7 A347 39F7 7CDC  C1F0 C599 64AB 43F7 7134
Public-key algo: ECDH public key algorithm
Public-key size: 256 bits
     Secret key: Unencrypted
  Creation time: 2021-01-25 19:17:42 UTC
Expiration time: 2024-01-26 12:44:03 UTC (creation time + P1095DT62781S)
      Key flags: transport encryption, data-at-rest encryption

         UserID: Alice &lt;alice@example.org&gt;
</code></pre><p>Here we see that <code>sq</code> uses ECC by default, and generates a signing
subkey and an encryption subkey.  (<code>sq key generate</code> has options to
tweak both the cipher suite and the key’s structure.)  <code>sq</code> generates
a signing subkey by default to prevent an attacker from repurposing a
signature over data as a certification or binding signature.</p>
<p>The secret key material is unencrypted by default.  Supplying the
<code>--with-password</code> option will cause <code>sq</code> to prompt for a password and
use it to encrypt the secret key material.</p>
<p>We can use <code>sq packet dump</code> to get even more details:</p>
<pre><code>$ sq packet dump /tmp/alice.sec
Secret-Key Packet, new CTB, 88 bytes
...
User ID Packet, new CTB, 25 bytes
    Value: Alice &lt;alice@example.org&gt;

Signature Packet, new CTB, 212 bytes
    Version: 4
    Type: PositiveCertification
    Pk algo: EdDSA Edwards-curve Digital Signature Algorithm
    Hash algo: SHA512
    Hashed area:
      Signature creation time: 2021-01-25 19:17:42 UTC (critical)
      Key expiration time: P1095DT62781S (critical)
      Symmetric algo preferences: AES256, AES128
      Issuer: C7C7 FF13 8025 22BE
      Notation: NotationData { flags: , name: "salt@notations.sequoia-pgp.org", value: [209, 99, ...] }
      Hash preferences: SHA512, SHA256
      Primary User ID: true (critical)
      Key flags: C (critical)
      Features: MDC
      Issuer Fingerprint: 1191 7C40 2605 5EA3 4980  8877 C7C7 FF13 8025 22BE
    Digest prefix: 7E0A
    Level: 0 (signature over data)
...
</code></pre><p>For the sake of brevity, I’ve only shown the User ID and the
corresponding self signature.  An interesting thing to note here is
the <code>salt@notations.sequoia-pgp.org</code> notation.  This is a random
32-byte value, which Sequoia inserts into every signature by default.
Because it is unpredictable, it is harder for an attacker to trick a
user into signing a specific message.</p>
<p>It is possible to get even more details by supplying the <code>--hex</code>
option to <code>sq packet dump</code>.  This causes it to print a descriptive map
of the packets' contents, which is useful if you are dissecting an
OpenPGP message.</p>
<pre><code>$ sq packet dump --hex /tmp/alice.sec
Secret-Key Packet, new CTB, 2 header bytes + 88 bytes
    Version: 4
    Creation time: 2021-01-25 19:17:42 UTC
    Pk algo: EdDSA Edwards-curve Digital Signature Algorithm
    Pk size: 256 bits
    Fingerprint: 1191 7C40 2605 5EA3 4980  8877 C7C7 FF13 8025 22BE
    KeyID: C7C7 FF13 8025 22BE
  
    Secret Key:
  
        Unencrypted
  
    00000000  c5                                                 CTB
    00000001     58                                              length
    00000002        04                                           version
    00000003           60 0f 19 56                               creation_time
    00000007                       16                            pk_algo
    00000008                           09                        curve_len
    00000009                              2b 06 01 04 01 da 47   curve
    00000010  0f 01
    00000012        01 07                                        eddsa_public_len
    00000014              40 7b 06 00  4c 00 63 89 81 95 2f 22   eddsa_public
    00000020  5a 35 7c b2 84 45 ce 9f  d9 85 8d 55 01 4d aa 76
    00000030  f7 bd b2 07 a1
    00000035                 00                                  s2k_usage
    00000036                    00 fe                            eddsa_secret_len
    00000038                           30 95 9d a4 ae 95 c3 e4   eddsa_secret
    00000040  fc 15 bb ca 5a 67 31 e1  14 1b 2b 0b 2f 1a 4c 6e
    00000050  95 a8 cc 63 7c de 19 51 
    00000058                           0f ef                     checksum
...
</code></pre><p>To turn a key into a certificate (i.e., to remove the secret key
material), we can use the <code>sq keyring filter</code> subcommand:</p>
<pre><code>$ sq keyring filter --to-certificate /tmp/alice.sec &gt; /tmp/alice.pgp
</code></pre><p>And using <code>sq inspect</code>, we see that we now have a certificate and not a
secret key:</p>
<pre><code>$ sq inspect /tmp/alice.pgp
/tmp/alice.pgp: OpenPGP Certificate.
...
</code></pre><p><code>sq keyring filter</code> also allows the user to specify a few predicates to
actually <em>filter</em> the keyring.</p>
<p><code>sq keyring</code> has other useful functionality.  It can split a keyring
into individual keys and it can merge multiple keys or keyrings
into a single keyring.</p>
<p>To sign and encrypt a message, we specify one or more certificates for
the recipients, and one or more keys for the signers.</p>
<pre><code>$ echo "Hello, woods!" | sq encrypt --recipient-cert /tmp/bob.pgp --signer-key /tmp/alice.sec &gt; /tmp/msg.pgp
</code></pre><p>Decrypting and verifying the signature is similar:</p>
<pre><code>$ sq decrypt --recipient-key /tmp/bob.sec --signer-cert /tmp/alice.pgp /tmp/msg.pgp
Encrypted using AES with 256-bit key
Compressed using ZIP
Good signature from 4D4D 029F 2206 7039
Hello, woods!
1 good signature.
</code></pre><p>(If you are interested in examining the structure of the message at
the byte level, be sure to try the <code>--hex</code> option.)</p>
<p><code>sq</code> can also fetch keys from key servers:</p>
<pre><code>$ sq keyserver get neal@walfield.org
-----BEGIN PGP PUBLIC KEY BLOCK-----

xsEhBFUjmukBDqCpmVI7Ve+2xTFSTG+mXMFHml63/Yai2nqxBk9gBfQfRFIjMt74
...
</code></pre><p>And from WKDs:</p>
<pre><code>$ sq wkd get neal@walfield.org
-----BEGIN PGP PUBLIC KEY BLOCK-----
Comment: 8F17 7771 18A3 3DDA 9BA4  8E62 AACB 3243 6300 52D9
Comment: Neal H. Walfield &lt;neal@pep-project.org&gt;
Comment: Neal H. Walfield &lt;neal@pep.foundation&gt;
Comment: Neal H. Walfield &lt;neal@sequoia-pgp.org&gt;
Comment: Neal H. Walfield &lt;neal@walfield.org&gt;

xsEhBFUjmukBDqCpmVI7Ve+2xTFSTG+mXMFHml63/Yai2nqxBk9gBfQfRFIjMt74
...
</code></pre><p>You can learn more about <code>sq</code> by reading its
<a href="https://docs.sequoia-pgp.org/sq/index.html">documentation</a>.</p>

<p>Currently, six people are paid to work on Sequoia.  Since the start of
the project 3.5 years ago, they have all been paid by the <a href="https://pep.foundation/">p≡p
foundation</a>.  Additional financial support has come from a one-time
donation from the <a href="https://www.wauland.de/de/">Wau Holland Foundation</a> in 2018.  <a href="https://pep.foundation/blog/phil-zimmermann-donates-eur-1000-to-the-pep-foundation-to-support-the-sequoia-pgp-project/index.html">Phil
Zimmermann</a>, the creator of PGP, donated 1000 Euros.  And, <a href="https://protonmail.com/blog/openpgp-test-suite/">Proton
Mail</a> donated 1000 Euros after our <a href="https://tests.sequoia-pgp.org/">interoperability test suite</a> found
several issues in OpenPGP.js …</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://sequoia-pgp.org/blog/2021/01/26/202101-sq-release/">https://sequoia-pgp.org/blog/2021/01/26/202101-sq-release/</a></em></p>]]>
            </description>
            <link>https://sequoia-pgp.org/blog/2021/01/26/202101-sq-release/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26141995</guid>
            <pubDate>Mon, 15 Feb 2021 12:13:40 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Is This a Branch?]]>
            </title>
            <description>
<![CDATA[
Score 133 | Comments 72 (<a href="https://news.ycombinator.com/item?id=26141047">thread link</a>) | @wheresvic4
<br/>
February 15, 2021 | https://bartwronski.com/2021/01/18/is-this-a-branch/ | <a href="https://web.archive.org/web/*/https://bartwronski.com/2021/01/18/is-this-a-branch/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
						
<p>Let’s try a new format – <strong>“shorts”</strong>; small blog posts where I elaborate on ideas that I’d discuss at my twitter, but they either come back over and over, or the short form doesn’t convey all the nuances.</p>



<div><figure><img src="https://lh5.googleusercontent.com/lc0z89hwcBtH59QnEvHrU__d1Be5uxjtjrjaBYi3updGObpyYlmpYvhlhXobMLWwyeRB2Sh--pEO7_oupCuDWdQXMtQnjcYfBjrO0TLDB_Zn5CJQLmDQm27enOR1C-tUEvmGGDL_" alt="" width="370" height="333"></figure></div>



<p>I often see advice about avoiding “if” statements in the code (especially GPU shaders) at all costs. The worst of all is when this happens in glsl and programmers replace some simple if statements with (subjectively) horrible <a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/step.xhtml">step instruction</a> which IMO completely destroys all readability, or even worse – sequences of mixes, maxes, clips and extra ALU.</p>



<p>After all, <strong>those ifs are branches, and branches are bad, right?</strong></p>



<p><strong>TLDR: No, definitely not – on all accounts.</strong></p>



<h2>Why do programmers want to avoid branches?</h2>



<p>Let’s first address why programmers would like to avoid branches. There are some good reasons for that.</p>



<h3>Scalar CPU</h3>



<p>On the CPU, “branches” in a non-SIMD code might seem “innocent”, it’s just a conditional jump to some other code. Instead of executing an <em>instruction a</em> next address, we jump to <em>instruction b</em> at some other address. Unfortunately, there are many complicated things going on under the hood: All modern CPUs are heavily pipelined, superscalar, and out-of order.</p>



<div><figure><img src="https://lh5.googleusercontent.com/aJOrhsi_sQ7C4gG6z0cov73NA_qt-UckHrz10Uo5OGX22TuwRRf_n1ogyaRUSBsTsCU3wigOkYwIZMclAGslXKSruRk9P7ieNjYvyukZ9erHFaCr-QMuKvwPjMbLNuBfyMZGTqjc" alt="" width="344" height="330"><figcaption>All modern CPUs are superscalar and deeply pipelined. Many instructions are processed and executed at the same time. Source: <a href="https://en.wikipedia.org/wiki/Branch_predictor">wikipedia</a></figcaption></figure></div>



<p>To extract maximum efficiency, they use a model of <a href="https://en.wikipedia.org/wiki/Branch_predictor">speculative execution</a> – a CPU “gambles” and “guesses” results of a branch ahead of time, not knowing if it will be taken or not, and starts executing those instructions. If it’s right – great! However if it’s not, then the CPU needs to stall, cancel all the guesses, go back to the branch, and execute the other instructions. Oops.</p>



<p>Luckily, CPUs are usually very good at this “guessing” (they actually analyze past branch patterns and take them into account!). On the other hand, without going into too much detail – each branch consumes some of the branch predictor unit resources. One extra branch on some short, innocent code can make results of the branch prediction worse, and slow down other code (where branch predictor might be necessary for good performance!).</p>



<h3>SIMD and the GPU</h3>



<p>When considering SIMD or the GPU, the situation is even worse.</p>



<p>Simplifying – single program and same instruction stream executes on multiple “lanes” of the same data, processing 4/8/16/32/64 elements at the same time.</p>



<p>If you want to take a branch when some of the elements take one path, some another one, you have two main options: <strong>either abandon vectorization and scalarize code</strong> (very bad option; usually means that it’s not worth vectorizing given piece of code), or <strong>execute both code paths</strong> – first the first one, store the results somewhere, execute the second one, and “combine” the results.</p>



<div><figure><img src="https://lh3.googleusercontent.com/GmopPKjJ_t4QpsGIhaIhjJn6cTfUjVaMSl9lDj74skwpNRUVIYtWQ8-V0j4mMLIyZk1CZEgn-9z5C1kExAlVjIw8Oikdx0L-gJnyrB-qUc5oi3_4aQmmcGwCcP51YutgGoAlRHdT" alt="" width="448" height="194"></figure></div>



<p>This is a general (over)simplification, and example GPUs have dedicated hardware to help do it efficiently and without wasting resources (hardware execution masks etc), but generally means extra cost of managing those masks, storing results somewhere, double execution costs and finally – branches can serve as barriers, preventing some <a href="https://bartwronski.com/2014/03/27/gcn-two-ways-of-latency-hiding-and-wave-occupancy/">latency hiding (see my old blog post on it)</a>.</p>



<h3>Combined</h3>



<p>Given those two, it might seem that avoiding branches seems reasonable, and the common advice of avoiding ifs makes sense. But whether it makes sense to avoid branch or not is more complicated (more on it later), and the second one (whether an if is a branch) is not the case.</p>



<h2>Are if statements branches?</h2>



<p>Let’s clear the worst misconception.</p>



<p><strong>When you write an “if” in your code, the compiler won’t necessarily generate a branch with a jump</strong>.</p>



<p>I will focus now on CPUs, mostly because how easy it is to test it with <a href="https://godbolt.org/">Matt Godbolt’s amazing compiler explorer</a>. 🙂 (Plus how there are two mainstream architectures, unlike many different shader ISAs)</p>



<p>Let’s have a look at the following simple integer function.</p>


<pre title="">int is_this_a_branch(int v, int w) {
    if (v &lt; 10) {
        return v + w; 
    } 
    else {
        return 2 * v - 2 * w;
    }
}
</pre>


<p>I tested it with 3 x64 compilers (GCC x64 trunk, Clang x64 trunk, MSVC 19.28) and one ARM (armv8-a clang), and only MSVC generates an actual branch there.</p>



<pre><code><strong>clang</strong>              
        mov     eax, edi
        sub     eax, esi
        add     esi, edi
        add     eax, eax
        cmp     edi, 10
        cmovl   eax, esi
        ret
<strong>gcc</strong>
        mov     eax, edi
        lea     edx, [rdi+rsi]
        sub     eax, esi
        add     eax, eax
        cmp     edi, 9
        cmovle  eax, edx
        ret
<strong>msvc </strong>       
        cmp     ecx, 10
        <strong>jge     SHORT $LN2@is_this_a_ BRANCH!!!
</strong>   BRANCH!
        lea     eax, DWORD PTR [rcx+rdx]
        ret     0
$LN2@is_this_a_:
        sub     ecx, edx
        lea     eax, DWORD PTR [rcx+rcx]
        ret     0

<strong>arm clang
</strong>        sub     w9, w0, w1
        add     w8, w1, w0
        lsl     w9, w9, #1
        cmp     w0, #10                         // =10
        csel    w0, w8, w9, lt</code></pre>



<p>When using floats:</p>


<pre title="">float is_this_a_branch2(float v, float w) {
    if (v &lt; 10.0f) {
        return v + w; 
    } 
    else {
        return 2.0f * v - 2.0f * w;
    }
}
</pre>


<p>Now 2 out of 4 compilers generate a branch:</p>



<pre><code><strong>clang</strong>           
        movaps  xmm2, xmm0
        addss   xmm2, xmm1
        movaps  xmm3, xmm0
        addss   xmm3, xmm0
        addss   xmm1, xmm1
        cmpltss xmm0, dword ptr [rip + .LCPI1_0]
        subss   xmm3, xmm1
        andps   xmm2, xmm0
        andnps  xmm0, xmm3
        orps    xmm0, xmm2
        ret

<strong>gcc
</strong>        movss   xmm2, DWORD PTR .LC0[rip]
        comiss  xmm2, xmm0
        <strong>jbe     .L10  BRANCH!!!
</strong>
        addss   xmm0, xmm1
        ret
.L10:
        addss   xmm1, xmm1
        addss   xmm0, xmm0
        subss   xmm0, xmm1
        ret

<strong>msvc
</strong>        movss   xmm2, DWORD PTR __real@41200000
        comiss  xmm2, xmm0
        <strong>jbe     SHORT $LN2@is_this_a_  BRANCH!!!</strong>
        addss   xmm0, xmm1
        ret     0
$LN2@is_this_a_:
        addss   xmm0, xmm0
        addss   xmm1, xmm1
        subss   xmm0, xmm1
        ret     0

<strong>arm clang
</strong>        fadd    s2, s0, s1
        fadd    s3, s0, s0
        fadd    s1, s1, s1
        fmov    s4, #10.00000000
        fsub    s1, s3, s1
        fcmp    s0, s4
        fcsel   s0, s2, s1, mi
        ret</code></pre>



<h3>What are those conditionals and selects?</h3>



<p>This is basically CPUs’ and compilers’ way of “serializing” both code paths. If it considers overhead of a branch larger than the amount of work it can save, it makes sense to compute both code paths, and use a single instruction to select which one is the actual result.</p>



<p>This obviously “depends” on the use case and whether it is even “legal” for a compiler to do such a transformation (like “side effects”; or if a compiler executed some reads of memory, it could be unsafe and lead to segmentation fault).&nbsp;</p>



<h2>Does writing ternary conditional help avoid branches?</h2>



<p><strong>No.</strong></p>



<p>This is a common advice, but it’s generally not true. If you look at the above example rewritten slightly:</p>


<pre title="">float is_this_a_branch3(float v, float w) {
    return v &lt; 10.0f ? (v + w) : (2.0f * v - 2.0f * w);
}
</pre>


<p>The generated code is <strong>identical </strong>(!).</p>



<p>It might be <em>possible</em> (?) that some compilers do generate branchless code for like this, but giving this as a general advice makes no sense. Whether you write an actual if, or a ternary expression, it’s still a high level if statement, just expressed differently.</p>



<h2>What about the GPU?</h2>



<p><strong>On the GPU, it’s the same; the compiler will generate conditional selects when appropriate.</strong></p>



<p>I used <a href="http://shader-playground.timjones.io/">Tim Jones Shader Playground</a> and AMD ISA (mostly because I know it relatively better than the others), and the unfortunate step function:</p>


<pre title="">#version 460

layout (location = 0) out vec4 fragColor;
layout (location = 0) in float inColor;

void main()
{
#if 1
	fragColor = vec4(step(1.0, inColor));
#else
    float x;
    if (inColor &lt; 1.0)
        x = 1.0;
   	else
        x = 0.0;
   	fragColor = vec4(x);
#endif
}
</pre>


<p>See for yourself, both versions generate identical assembly:</p>



<pre><code>  s_mov_b32     m0, s3
  s_nop         0x0000
  v_interp_p1_f32  v0, v0, attr0.x
  v_interp_p2_f32  v0, v1, attr0.x
  v_cmp_gt_f32  vcc, 1.0, v0
  v_cndmask_b32  v0, 1.0, 0, vcc
  v_cvt_pkrtz_f16_f32  v0, v0, v0
  exp           mrt0, v0, v0, v0, v0 done compr vm</code></pre>



<p>When using fastmath and not obeying strict IEEE float specification (which is standard for compiling shaders for real time graphics), compilers can even generate other instructions like min or max from your if statements. But YMMV and be sure to check the assembly.</p>



<p>So generally – using “step” just to avoid if statements is <strong>pointless</strong>.</p>



<p>If you like it for your coding style, then it’s obviously up to you, use as much as you like just for this reason. But please consider programmers who don’t have as much shader or GLSL experience and will be always puzzled by it. 🙂 </p>



<h2>Are branches always to be avoided?</h2>



<p><strong>No.</strong></p>



<p>This is way beyond my aimed “short” format, but <strong>branches are not necessarily “bad”</strong>.</p>



<p>They can be actually an awesome optimization, even on the GPU!</p>



<p>If you start to use a lot of conditionals</p>



<p>Lots of advice on how branches are bad and have to be avoided comes from a prehistoric era of old CPUs and GPUs or old compilers; an advice that is passed without re(verifying) – which is understandable, I am not re-checking my whole knowledge or intuition every few months either. 🙂 </p>



<p>But the CPU/GPU/compiler architects improved designs significantly and adapted them to general, highly branchy code, and whether there is a penalty or not depends on way too many details to list or give advice.</p>



<p><strong>Rule of thumb</strong>: if a branch is generally coherent, it makes sense to use it when it allows to save on memory bandwidth or cache utilization. On GPUs it is usually worth adding branches if you can avoid texture fetches this way with a high probability and coherence. And it’s usually better to have some conditional masks and selects around …</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://bartwronski.com/2021/01/18/is-this-a-branch/">https://bartwronski.com/2021/01/18/is-this-a-branch/</a></em></p>]]>
            </description>
            <link>https://bartwronski.com/2021/01/18/is-this-a-branch/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26141047</guid>
            <pubDate>Mon, 15 Feb 2021 09:52:07 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Interactive Data Visualisation with Rust]]>
            </title>
            <description>
<![CDATA[
Score 81 | Comments 12 (<a href="https://news.ycombinator.com/item?id=26141018">thread link</a>) | @batterylow
<br/>
February 15, 2021 | https://shahinrostami.com/posts/programming/rust-notebooks/visualisation-of-co-occurring-types/ | <a href="https://web.archive.org/web/*/https://shahinrostami.com/posts/programming/rust-notebooks/visualisation-of-co-occurring-types/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
<pre>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]</pre>
</div></div>]]>
            </description>
            <link>https://shahinrostami.com/posts/programming/rust-notebooks/visualisation-of-co-occurring-types/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26141018</guid>
            <pubDate>Mon, 15 Feb 2021 09:49:20 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Show HN: Shopify's Top 90 Most Successful Startups in 2021]]>
            </title>
            <description>
<![CDATA[
Score 20 | Comments 15 (<a href="https://news.ycombinator.com/item?id=26140934">thread link</a>) | @cedyf
<br/>
February 15, 2021 | https://reviewbolt.com/top/shopify/ | <a href="https://web.archive.org/web/*/https://reviewbolt.com/top/shopify/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><p><h2>Here's the list of the top 90 Shopify websites by traffic. All data is sourced from SimilarWeb's public data. I estimate revenue with [traffic * global ecom conversion rate * price of best selling product]. Facebook spend is estimated by [social traffic * 1.8 ]. SimilarWeb tells us how much traffic they receive from social channels and I multiply that by an average CPC of 1.8 as they tend to under-report this figure when I cross-reference it against large social media accounts that I manage. Keep scrolling to see more details for each company. Enjoy this list? Share this with 1 friend.</h2></p><div id="fashionnova.com"><h2>1<!-- -->. <!-- -->Fashionnova<!-- --> - <!-- -->22.49M<!-- --> </h2><div><div><div><div><p><img layout="responsive" alt="fashionnova.com screenshot" data-src="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dfashionnova.com%26t%3D1%26h%3Df6f43f7475663a2f2737f003dbfd012d8b590d7747ddd90f6e4e5e629f5475d6&amp;w=768&amp;q=75" data-srcset="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dfashionnova.com%26t%3D1%26h%3Df6f43f7475663a2f2737f003dbfd012d8b590d7747ddd90f6e4e5e629f5475d6&amp;w=320&amp;q=75 320w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dfashionnova.com%26t%3D1%26h%3Df6f43f7475663a2f2737f003dbfd012d8b590d7747ddd90f6e4e5e629f5475d6&amp;w=420&amp;q=75 420w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dfashionnova.com%26t%3D1%26h%3Df6f43f7475663a2f2737f003dbfd012d8b590d7747ddd90f6e4e5e629f5475d6&amp;w=768&amp;q=75 768w"></p></div></div></div></div><div><h3>Fashion nova is the top online fashion store for women. shop sexy club dresses, jeans, shoes, bodysuits, skirts and more. cheap &amp;amp; affordable fashion online.<!-- --> </h3><h3>Fashionnova gets 22M monthly visitors and grows primarily through Direct traffic from United States.</h3><p><h3>How fast is <!-- -->fashionnova.com<!-- --> growing?</h3><h3> <!-- -->fashionnova.com<!-- --> has grown by <!-- -->-10.0%<!-- --> in the last 6 months according to SimilarWeb. </h3></p><p><h3>How do people interact with <!-- -->fashionnova.com<!-- -->?</h3><h3>Last month, <!-- -->fashionnova.com<!-- --> received <!-- -->22M<!-- --> visitors who spent an average of <!-- -->7.9<!-- --> minutes on the website and visited <!-- -->6.0<!-- --> different pages per session. Overall, <!-- -->46<!-- -->% of people bounce on the first visit.</h3></p><p><h3>How do people find <!-- -->fashionnova.com<!-- -->? </h3><h3>10.2M<!-- --> people <!-- -->(45%)<!-- --> visit <!-- -->fashionnova.com<!-- --> directly. <!-- -->8.4M<!-- --> <!-- -->(37%)<!-- --> people search for them in Google. Whereas, <!-- -->1.5M<!-- --> <!-- -->(7%)<!-- --> discover <!-- -->fashionnova.com<!-- --> through Facebook, Reddit, and YouTube. <!-- -->1.9M<!-- --> <!-- -->(8%)<!-- --> visitors come from <!-- -->fashionnova.com<!-- -->'s email newsletters. Finally, <!-- -->418.9k<!-- --> <!-- -->(1.9%)<!-- --> people come from affiliates and or paid referrals. </h3></p><p><h3>Who uses <!-- -->fashionnova.com<!-- -->?</h3><h3>Fashionnova.com<!-- -->'s top market is the <!-- -->United States<!-- --> and they receive <!-- -->15.6M (69.6%)<!-- --> people. Then the 2nd is <!-- -->Canada<!-- --> with <!-- -->1.9M (8.3%)<!-- -->, the 3rd is <!-- -->United Kingdom<!-- --> with <!-- -->525.1k (2.3%)<!-- -->, the 4th is <!-- -->Australia<!-- --> with <!-- -->480.9k (2.1%)<!-- -->. Finally, the 5th is <!-- -->Jamaica<!-- --> with <!-- -->279.3k (1.2%)<!-- --> visitors.</h3></p><div><p><h3>Traffic Growth</h3><h3> <!-- -->-10.00%<!-- --> </h3></p><p><h3>Monthly Hits</h3><h3>22.49M</h3></p><p><h3>Time on Site</h3><h3>7.9<span>Mins</span></h3></p><p><h3>Pages per Visit</h3><h3>6.0</h3></p><p><h3>Bounce Rate</h3><h3>46<!-- -->%</h3></p></div><div><div><div><h2>Traffic Growth (last 6 months)</h2></div></div></div></div></div><div id="jbhifi.com.au"><h2>2<!-- -->. <!-- -->Jbhifi<!-- --> - <!-- -->15.23M<!-- --> </h2><div><div><div><div><p><img layout="responsive" alt="jbhifi.com.au screenshot" data-src="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Djbhifi.com.au%26t%3D1%26h%3Df7d5d51124abe27b728cfb83593c9991a70609037429c102666adc2821afdd94&amp;w=768&amp;q=75" data-srcset="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Djbhifi.com.au%26t%3D1%26h%3Df7d5d51124abe27b728cfb83593c9991a70609037429c102666adc2821afdd94&amp;w=320&amp;q=75 320w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Djbhifi.com.au%26t%3D1%26h%3Df7d5d51124abe27b728cfb83593c9991a70609037429c102666adc2821afdd94&amp;w=420&amp;q=75 420w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Djbhifi.com.au%26t%3D1%26h%3Df7d5d51124abe27b728cfb83593c9991a70609037429c102666adc2821afdd94&amp;w=768&amp;q=75 768w"></p></div></div></div></div><div><h3>Jb hi-fi is australia's largest home entertainment retailer with top products, great quality + value. learn more about our product range online.<!-- --> </h3><h3>Jbhifi gets 15M monthly visitors and grows primarily through Search traffic from Australia.</h3><p><h3>How fast is <!-- -->jbhifi.com.au<!-- --> growing?</h3><h3> <!-- -->jbhifi.com.au<!-- --> has grown by <!-- -->-0.9%<!-- --> in the last 6 months according to SimilarWeb. </h3></p><p><h3>How do people interact with <!-- -->jbhifi.com.au<!-- -->?</h3><h3>Last month, <!-- -->jbhifi.com.au<!-- --> received <!-- -->15M<!-- --> visitors who spent an average of <!-- -->3.5<!-- --> minutes on the website and visited <!-- -->5.0<!-- --> different pages per session. Overall, <!-- -->34<!-- -->% of people bounce on the first visit.</h3></p><p><h3>How do people find <!-- -->jbhifi.com.au<!-- -->? </h3><h3>5.3M<!-- --> people <!-- -->(35%)<!-- --> visit <!-- -->jbhifi.com.au<!-- --> directly. <!-- -->8.8M<!-- --> <!-- -->(58%)<!-- --> people search for them in Google. Whereas, <!-- -->243.1k<!-- --> <!-- -->(2%)<!-- --> discover <!-- -->jbhifi.com.au<!-- --> through Facebook, Reddit, and YouTube. <!-- -->271.4k<!-- --> <!-- -->(2%)<!-- --> visitors come from <!-- -->jbhifi.com.au<!-- -->'s email newsletters. Finally, <!-- -->17.3k<!-- --> <!-- -->(0.1%)<!-- --> people come from affiliates and or paid referrals. </h3></p><p><h3>Who uses <!-- -->jbhifi.com.au<!-- -->?</h3><h3>Jbhifi.com.au<!-- -->'s top market is the <!-- -->Australia<!-- --> and they receive <!-- -->14.8M (97.2%)<!-- --> people. Then the 2nd is <!-- -->United States<!-- --> with <!-- -->117.9k (0.8%)<!-- -->, the 3rd is <!-- -->New Zealand<!-- --> with <!-- -->49.2k (0.3%)<!-- -->, the 4th is <!-- -->United Kingdom<!-- --> with <!-- -->31.6k (0.2%)<!-- -->. Finally, the 5th is <!-- -->China<!-- --> with <!-- -->15.6k (0.1%)<!-- --> visitors.</h3></p><div><p><h3>Traffic Growth</h3><h3> <!-- -->-0.90%<!-- --> </h3></p><p><h3>Monthly Hits</h3><h3>15.23M</h3></p><p><h3>Time on Site</h3><h3>3.5<span>Mins</span></h3></p><p><h3>Pages per Visit</h3><h3>5.0</h3></p><p><h3>Bounce Rate</h3><h3>34<!-- -->%</h3></p></div><div><div><div><h2>Traffic Growth (last 6 months)</h2></div></div></div></div></div><div id="colourpop.com"><h2>3<!-- -->. <!-- -->Colourpop<!-- --> - <!-- -->11.08M<!-- --> </h2><div><div><div><div><p><img layout="responsive" alt="colourpop.com screenshot" data-src="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dcolourpop.com%26t%3D1%26h%3D001d20a66a62a586f5708a8e762711a9c141179770e474fb260a49f8e2efdf32&amp;w=768&amp;q=75" data-srcset="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dcolourpop.com%26t%3D1%26h%3D001d20a66a62a586f5708a8e762711a9c141179770e474fb260a49f8e2efdf32&amp;w=320&amp;q=75 320w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dcolourpop.com%26t%3D1%26h%3D001d20a66a62a586f5708a8e762711a9c141179770e474fb260a49f8e2efdf32&amp;w=420&amp;q=75 420w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dcolourpop.com%26t%3D1%26h%3D001d20a66a62a586f5708a8e762711a9c141179770e474fb260a49f8e2efdf32&amp;w=768&amp;q=75 768w"></p></div></div></div></div><div><h3>Redefining luxury beauty by creating high quality products at affordable prices. we pride ourselves on being cruelty-free, wallet-friendly, and keeping our customers at the center of our world. made in the usa, we imagine, innovate, test, and manufacture all under one roof.<!-- --> </h3><h3>Colourpop gets 11M monthly visitors and grows primarily through Direct traffic from United States.</h3><p><h3>How fast is <!-- -->colourpop.com<!-- --> growing?</h3><h3> <!-- -->colourpop.com<!-- --> has grown by <!-- -->21.5%<!-- --> in the last 6 months according to SimilarWeb. </h3></p><p><h3>How do people interact with <!-- -->colourpop.com<!-- -->?</h3><h3>Last month, <!-- -->colourpop.com<!-- --> received <!-- -->11M<!-- --> visitors who spent an average of <!-- -->5.6<!-- --> minutes on the website and visited <!-- -->4.0<!-- --> different pages per session. Overall, <!-- -->40<!-- -->% of people bounce on the first visit.</h3></p><p><h3>How do people find <!-- -->colourpop.com<!-- -->? </h3><h3>5.9M<!-- --> people <!-- -->(53%)<!-- --> visit <!-- -->colourpop.com<!-- --> directly. <!-- -->3.5M<!-- --> <!-- -->(31%)<!-- --> people search for them in Google. Whereas, <!-- -->696.6k<!-- --> <!-- -->(6%)<!-- --> discover <!-- -->colourpop.com<!-- --> through Facebook, Reddit, and YouTube. <!-- -->706.4k<!-- --> <!-- -->(6%)<!-- --> visitors come from <!-- -->colourpop.com<!-- -->'s email newsletters. Finally, <!-- -->134.7k<!-- --> <!-- -->(1.2%)<!-- --> people come from affiliates and or paid referrals. </h3></p><p><h3>Who uses <!-- -->colourpop.com<!-- -->?</h3><h3>Colourpop.com<!-- -->'s top market is the <!-- -->United States<!-- --> and they receive <!-- -->6.9M (62.0%)<!-- --> people. Then the 2nd is <!-- -->Canada<!-- --> with <!-- -->503.6k (4.5%)<!-- -->, the 3rd is <!-- -->Australia<!-- --> with <!-- -->412.8k (3.7%)<!-- -->, the 4th is <!-- -->United Kingdom<!-- --> with <!-- -->346.1k (3.1%)<!-- -->. Finally, the 5th is <!-- -->France<!-- --> with <!-- -->210k (1.9%)<!-- --> visitors.</h3></p><div><p><h3>Traffic Growth</h3><h3> <!-- -->21.50%<!-- --> </h3></p><p><h3>Monthly Hits</h3><h3>11.08M</h3></p><p><h3>Time on Site</h3><h3>5.6<span>Mins</span></h3></p><p><h3>Pages per Visit</h3><h3>4.0</h3></p><p><h3>Bounce Rate</h3><h3>40<!-- -->%</h3></p></div><div><div><div><h2>Traffic Growth (last 6 months)</h2></div></div></div></div></div><div id="gymshark.com"><h2>4<!-- -->. <!-- -->Gymshark<!-- --> - <!-- -->4.68M<!-- --> </h2><div><div><div><div><p><img layout="responsive" alt="gymshark.com screenshot" data-src="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dgymshark.com%26t%3D1%26h%3D7f7a6a9ec9d208acc9dd13cd4920a8631d7c3b599259acaabd3545b0a0917f45&amp;w=768&amp;q=75" data-srcset="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dgymshark.com%26t%3D1%26h%3D7f7a6a9ec9d208acc9dd13cd4920a8631d7c3b599259acaabd3545b0a0917f45&amp;w=320&amp;q=75 320w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dgymshark.com%26t%3D1%26h%3D7f7a6a9ec9d208acc9dd13cd4920a8631d7c3b599259acaabd3545b0a0917f45&amp;w=420&amp;q=75 420w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dgymshark.com%26t%3D1%26h%3D7f7a6a9ec9d208acc9dd13cd4920a8631d7c3b599259acaabd3545b0a0917f45&amp;w=768&amp;q=75 768w"></p></div></div></div></div><div><h3>Shop official gymshark exclusively online. enjoy lasting quality &amp; the perfect fit. free returns &amp; free shipping on workout clothes &amp; gym wear orders over $75.<!-- --> </h3><h3>Gymshark gets 5M monthly visitors and grows primarily through Search traffic from United States.</h3><p><h3>How fast is <!-- -->gymshark.com<!-- --> growing?</h3><h3> <!-- -->gymshark.com<!-- --> has grown by <!-- -->-8.8%<!-- --> in the last 6 months according to SimilarWeb. </h3></p><p><h3>How do people interact with <!-- -->gymshark.com<!-- -->?</h3><h3>Last month, <!-- -->gymshark.com<!-- --> received <!-- -->5M<!-- --> visitors who spent an average of <!-- -->4.7<!-- --> minutes on the website and visited <!-- -->7.0<!-- --> different pages per session. Overall, <!-- -->37<!-- -->% of people bounce on the first visit.</h3></p><p><h3>How do people find <!-- -->gymshark.com<!-- -->? </h3><h3>1.5M<!-- --> people <!-- -->(32%)<!-- --> visit <!-- -->gymshark.com<!-- --> directly. <!-- -->2.5M<!-- --> <!-- -->(53%)<!-- --> people search for them in Google. Whereas, <!-- -->208.7k<!-- --> <!-- -->(4%)<!-- --> discover <!-- -->gymshark.com<!-- --> through Facebook, Reddit, and YouTube. <!-- -->227.3k<!-- --> <!-- -->(5%)<!-- --> visitors come from <!-- -->gymshark.com<!-- -->'s email newsletters. Finally, <!-- -->223.2k<!-- --> <!-- -->(4.8%)<!-- --> people come from affiliates and or paid referrals. </h3></p><p><h3>Who uses <!-- -->gymshark.com<!-- -->?</h3><h3>Gymshark.com<!-- -->'s top market is the <!-- -->United States<!-- --> and they receive <!-- -->1.6M (34.9%)<!-- --> people. Then the 2nd is <!-- -->United Kingdom<!-- --> with <!-- -->879.8k (18.8%)<!-- -->, the 3rd is <!-- -->Canada<!-- --> with <!-- -->344.4k (7.4%)<!-- -->, the 4th is <!-- -->Australia<!-- --> with <!-- -->281.8k (6.0%)<!-- -->. Finally, the 5th is <!-- -->Netherlands<!-- --> with <!-- -->213.4k (4.6%)<!-- --> visitors.</h3></p><div><p><h3>Traffic Growth</h3><h3> <!-- -->-8.80%<!-- --> </h3></p><p><h3>Monthly Hits</h3><h3>4.68M</h3></p><p><h3>Time on Site</h3><h3>4.7<span>Mins</span></h3></p><p><h3>Pages per Visit</h3><h3>7.0</h3></p><p><h3>Bounce Rate</h3><h3>37<!-- -->%</h3></p></div><div><div><div><h2>Traffic Growth (last 6 months)</h2></div></div></div></div></div><div id="isawitfirst.com"><h2>5<!-- -->. <!-- -->Isawitfirst<!-- --> - <!-- -->4.13M<!-- --> </h2><div><div><div><div><p><img layout="responsive" alt="isawitfirst.com screenshot" data-src="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Disawitfirst.com%26t%3D1%26h%3Dea38e7470f7f7094778855e46e539de594237a32f75a40229a0916883b283973&amp;w=768&amp;q=75" data-srcset="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Disawitfirst.com%26t%3D1%26h%3Dea38e7470f7f7094778855e46e539de594237a32f75a40229a0916883b283973&amp;w=320&amp;q=75 320w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Disawitfirst.com%26t%3D1%26h%3Dea38e7470f7f7094778855e46e539de594237a32f75a40229a0916883b283973&amp;w=420&amp;q=75 420w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Disawitfirst.com%26t%3D1%26h%3Dea38e7470f7f7094778855e46e539de594237a32f75a40229a0916883b283973&amp;w=768&amp;q=75 768w"></p></div></div></div></div><div><h3>Shop the latest women's fashion at i saw it first. 100s of new styles every week! clothes, dresses, shoes &amp; accessories. must have looks and trends from only £5<!-- --> </h3><h3>Isawitfirst gets 4M monthly visitors and grows primarily through Search traffic from United Kingdom.</h3><p><h3>How fast is <!-- -->isawitfirst.com<!-- --> growing?</h3><h3> <!-- -->isawitfirst.com<!-- --> has grown by <!-- -->-9.8%<!-- --> in the last 6 months according to SimilarWeb. </h3></p><p><h3>How do people interact with <!-- -->isawitfirst.com<!-- -->?</h3><h3>Last month, <!-- -->isawitfirst.com<!-- --> received <!-- -->4M<!-- --> visitors who spent an average of <!-- -->7.2<!-- --> minutes on the website and visited <!-- -->5.0<!-- --> different pages per session. Overall, <!-- -->45<!-- -->% of people bounce on the first visit.</h3></p><p><h3>How do people find <!-- -->isawitfirst.com<!-- -->? </h3><h3>1.3M<!-- --> people <!-- -->(31%)<!-- --> visit <!-- -->isawitfirst.com<!-- --> directly. <!-- -->2.3M<!-- --> <!-- -->(55%)<!-- --> people search for them in Google. Whereas, <!-- -->127.6k<!-- --> <!-- -->(3%)<!-- --> discover <!-- -->isawitfirst.com<!-- --> through Facebook, Reddit, and YouTube. <!-- -->235.2k<!-- --> <!-- -->(6%)<!-- --> visitors come from <!-- -->isawitfirst.com<!-- -->'s email newsletters. Finally, <!-- -->85.7k<!-- --> <!-- -->(2.1%)<!-- --> people come from affiliates and or paid referrals. </h3></p><p><h3>Who uses <!-- -->isawitfirst.com<!-- -->?</h3><h3>Isawitfirst.com<!-- -->'s top market is the <!-- -->United Kingdom<!-- --> and they receive <!-- -->3.4M (82.5%)<!-- --> people. Then the 2nd is <!-- -->Ireland<!-- --> with <!-- -->232.1k (5.6%)<!-- -->, the 3rd is <!-- -->United States<!-- --> with <!-- -->171k (4.1%)<!-- -->, the 4th is <!-- -->Sweden<!-- --> with <!-- -->34k (0.8%)<!-- -->. Finally, the 5th is <!-- -->Australia<!-- --> with <!-- -->30.8k (0.7%)<!-- --> visitors.</h3></p><div><p><h3>Traffic Growth</h3><h3> <!-- -->-9.80%<!-- --> </h3></p><p><h3>Monthly Hits</h3><h3>4.13M</h3></p><p><h3>Time on Site</h3><h3>7.2<span>Mins</span></h3></p><p><h3>Pages per Visit</h3><h3>5.0</h3></p><p><h3>Bounce Rate</h3><h3>45<!-- -->%</h3></p></div><div><div><div><h2>Traffic Growth (last 6 months)</h2></div></div></div></div></div><div id="ruggable.com"><h2>6<!-- -->. <!-- -->Ruggable<!-- --> - <!-- -->3.2M<!-- --> </h2><div><div><div><div><p><img layout="responsive" alt="ruggable.com screenshot" data-src="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Druggable.com%26t%3D1%26h%3D6862c65c5107ddbf92bec9da3ebc230bde417736443c3e2e3d0fb8859e061124&amp;w=768&amp;q=75" data-srcset="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Druggable.com%26t%3D1%26h%3D6862c65c5107ddbf92bec9da3ebc230bde417736443c3e2e3d0fb8859e061124&amp;w=320&amp;q=75 320w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Druggable.com%26t%3D1%26h%3D6862c65c5107ddbf92bec9da3ebc230bde417736443c3e2e3d0fb8859e061124&amp;w=420&amp;q=75 420w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Druggable.com%26t%3D1%26h%3D6862c65c5107ddbf92bec9da3ebc230bde417736443c3e2e3d0fb8859e061124&amp;w=768&amp;q=75 768w"></p></div></div></div></div><div><h3>Shop area rugs, accent rugs and runner rugs at ruggable. washable, stain-resistant and waterproof, our rugs are perfect for homes with kids and pets. ships free!<!-- --> </h3><h3>Ruggable gets 3M monthly visitors and grows primarily through Search traffic from United States.</h3><p><h3>How fast is <!-- -->ruggable.com<!-- --> growing?</h3><h3> <!-- -->ruggable.com<!-- --> has grown by <!-- -->52.4%<!-- --> in the last 6 months according to SimilarWeb. </h3></p><p><h3>How do people interact with <!-- -->ruggable.com<!-- -->?</h3><h3>Last month, <!-- -->ruggable.com<!-- --> received <!-- -->3M<!-- --> visitors who spent an average of <!-- -->3.9<!-- --> minutes on the website and visited <!-- -->5.0<!-- --> different pages per session. Overall, <!-- -->46<!-- -->% of people bounce on the first visit.</h3></p><p><h3>How do people find <!-- -->ruggable.com<!-- -->? </h3><h3>1.1M<!-- --> people <!-- -->(33%)<!-- --> visit <!-- -->ruggable.com<!-- --> directly. <!-- -->1.2M<!-- --> <!-- -->(37%)<!-- --> people search for them in Google. Whereas, <!-- -->639k<!-- --> <!-- -->(20%)<!-- --> discover <!-- -->ruggable.com<!-- --> through Facebook, Reddit, and YouTube. <!-- -->121.5k<!-- --> <!-- -->(4%)<!-- --> visitors come from <!-- -->ruggable.com<!-- -->'s email newsletters. Finally, <!-- -->141.4k<!-- --> <!-- -->(4.4%)<!-- --> people come from affiliates and or paid referrals. </h3></p><p><h3>Who uses <!-- -->ruggable.com<!-- -->?</h3><h3>Ruggable.com<!-- -->'s top market is the <!-- -->United States<!-- --> and they receive <!-- -->3M (93.9%)<!-- --> people. Then the 2nd is <!-- -->Canada<!-- --> with <!-- -->109.2k (3.4%)<!-- -->, the 3rd is <!-- -->United Kingdom<!-- --> with <!-- -->11.7k (0.4%)<!-- -->, the 4th is <!-- -->Germany<!-- --> with <!-- -->5.4k (0.2%)<!-- -->. Finally, the 5th is <!-- -->India<!-- --> with <!-- -->4.5k (0.1%)<!-- --> visitors.</h3></p><div><p><h3>Traffic Growth</h3><h3> <!-- -->52.40%<!-- --> </h3></p><p><h3>Monthly Hits</h3><h3>3.2M</h3></p><p><h3>Time on Site</h3><h3>3.9<span>Mins</span></h3></p><p><h3>Pages per Visit</h3><h3>5.0</h3></p><p><h3>Bounce Rate</h3><h3>46<!-- -->%</h3></p></div><div><div><div><h2>Traffic Growth (last 6 months)</h2></div></div></div></div></div><div id="morphe.com"><h2>7<!-- -->. <!-- -->Morphe<!-- --> - <!-- -->3.16M<!-- --> </h2><div><div><div><div><p><img layout="responsive" alt="morphe.com screenshot" data-src="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dmorphe.com%26t%3D1%26h%3D5d37734821403b1d5f02e1a8ec60cc9123259a9313150817cbebfdd0aac0b5ce&amp;w=768&amp;q=75" data-srcset="/_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dmorphe.com%26t%3D1%26h%3D5d37734821403b1d5f02e1a8ec60cc9123259a9313150817cbebfdd0aac0b5ce&amp;w=320&amp;q=75 320w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dmorphe.com%26t%3D1%26h%3D5d37734821403b1d5f02e1a8ec60cc9123259a9313150817cbebfdd0aac0b5ce&amp;w=420&amp;q=75 420w, /_next/image?url=https%3A%2F%2Fsite-images.similarcdn.com%2Fimage%3Furl%3Dmorphe.com%26t%3D1%26h%3D5d37734821403b1d5f02e1a8ec60cc9123259a9313150817cbebfdd0aac0b5ce&amp;w=768&amp;q=75 768w"></p></div></div></div></div><div><h3>Shop morphe.com to blend the rules. eyeshadow palettes, makeup brushes and lip colors from james charles, jaclyn hill, and others. a beauty brand created for the creators.<!-- --> </h3><h3>Morphe gets 3M monthly visitors and grows primarily through Search traffic from United States.</h3><p><h3>How fast is <!-- -->morphe.com<!-- --> growing?</h3><h3> <!-- -->morphe.com<!-- --> has grown by <!-- -->-36.8%<!-- --> in the last 6 months according to SimilarWeb. </h3></p><p><h3>How do people interact with <!-- -->morphe.com<!-- -->?</h3><h3>Last month, <!-- -->morphe.com<!-- --> received <!-- -->3M<!-- --> visitors who spent an average of <!-- -->3.0<!-- --> minutes on the website and visited <!-- -->4.0<!-- --> different pages per session. Overall, <!-- -->48<!-- -->% of people bounce on the first visit.</h3></p><p><h3>How do people find <!-- -->morphe.com<!-- -->? </h3><h3>1.1M<!-- --> people <!-- -->(36%)<!-- --> visit <!-- -->morphe.com<!-- --> directly. <!-- -->1.7M<!-- --> <!-- -->(53%)<!-- --> people search for them in Google. Whereas, <!-- -->141.4k<!-- --> <!-- -->(4%)<!-- --> discover <!-- -->morphe.com<!-- --> through Facebook, Reddit, and YouTube. <!-- -->102.7k<!-- --> <!-- -->(3%)<!-- --> visitors come from <!-- -->morphe.com<!-- -->'s email newsletters. Finally, <!-- -->29.4k<!-- --> <!-- -->(0.9%)<!-- --> people come from affiliates …</h3></p></div></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://reviewbolt.com/top/shopify/">https://reviewbolt.com/top/shopify/</a></em></p>]]>
            </description>
            <link>https://reviewbolt.com/top/shopify/</link>
            <guid isPermaLink="false">hacker-news-small-sites-26140934</guid>
            <pubDate>Mon, 15 Feb 2021 09:36:55 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Typing Is Hard]]>
            </title>
            <description>
<![CDATA[
Score 153 | Comments 79 (<a href="https://news.ycombinator.com/item?id=26140363">thread link</a>) | @pansa2
<br/>
February 15, 2021 | https://3fx.ch/typing-is-hard.html | <a href="https://web.archive.org/web/*/https://3fx.ch/typing-is-hard.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page">
<header>

</header>
<nav id="TOC">
<ul>
<li><a href="#type-checking-and-type-inference">Type Checking and Type Inference</a></li>
<li><a href="#common-terms">Common terms</a><ul>
<li><a href="#completeness">Completeness</a></li>
<li><a href="#soundness">Soundness</a></li>
<li><a href="#decidability">Decidability</a></li>
<li><a href="#hindley-milner-type-system">Hindley-Milner Type System</a></li>
<li><a href="#dependent-types">Dependent types</a></li>
</ul></li>
<li><a href="#how-hard-is-type-checking-your-favorite-language">How Hard is Type-Checking Your Favorite Language?</a><ul>
<li><a href="#c">C++</a></li>
<li><a href="#c-1">C#</a></li>
<li><a href="#elm">Elm</a></li>
<li><a href="#f">F#</a></li>
<li><a href="#go">Go</a></li>
<li><a href="#haskell">Haskell</a></li>
<li><a href="#idris">Idris</a></li>
<li><a href="#java">Java</a></li>
<li><a href="#ocaml">OCaml</a></li>
<li><a href="#ml">ML</a></li>
<li><a href="#rust">Rust</a></li>
<li><a href="#scala">Scala</a></li>
<li><a href="#swift">Swift</a></li>
<li><a href="#typescript">TypeScript</a></li>
<li><a href="#zig">Zig</a></li>
</ul></li>
<li><a href="#faq">FAQ</a><ul>
<li><a href="#where-are-python-bash-etc.">Where are Python, Bash, etc.?</a></li>
<li><a href="#what-about-unsafe-casts">What about unsafe casts?</a></li>
<li><a href="#ive-spotted-a-mistakeimprecision-what-should-i-do">I’ve spotted a mistake/imprecision, what should I do?</a></li>
</ul></li>
</ul>
</nav>
<h2 id="type-checking-and-type-inference">Type Checking and Type Inference</h2>
<p>Type checking is the process of taking a given program in some programming language and working out whether all variables and expressions have the correct types, i.e.&nbsp;strings are assigned to strings, arithmetic expressions involve only numbers, etc. Some languages also offer <em>type inference</em>, tasking the compiler with the task of figuring out correct types on its own. Depending on a language’s features the type checking and type inference problems range from trivial to undecidable.</p>
<h2 id="common-terms">Common terms</h2>
<h3 id="completeness">Completeness</h3>
<p>A type checker is complete if it can check every correctly typed program.</p>
<h3 id="soundness">Soundness</h3>
<p>A type checker is sound if it only accepts correctly typed programs.</p>
<h3 id="decidability">Decidability</h3>
<p>A decision problem is <strong>decidable</strong> if for any input we can compute whether the input satifies the problem in finite time. Examples of decidable problems include primality testing and boolean satisfiability. The halting problem for example is <strong>undecidable</strong>: We cannot check whether a program runs infinitely long in finite time. We are interested in the type checking and type inference problems for programming languages: Given some input program, does it type check? And given some program, which types should we assign to the expression such that it typechecks?</p>
<h3 id="hindley-milner-type-system">Hindley-Milner Type System</h3>
<p>The Hindley-Milner (HM) type system is a type system for the simple typed lambda calculus with parametric polymorphism, which is used as a base for many functional languages. Type-checking for HM is decidable and efficient, its complexity is linear in the size of the program. Type inference is more difficult than type checking, since the compiler has to solve the type constraints incurred for expressions in the program. It is <strong>decidable</strong> for the HM type system, however the problem itself is PSPACE-hard and EXPTIME-complete, meaning that in the worst case it needs at least a polynomial amount of extra space and exponential time relative to the input size. Fortunately, the type inference algorithm is linear when the nesting depth of polymorphic variables is bounded, as is the case for most applications. There exist many type inference algorithms, the best known one is the so-called <em>Algorithm W</em>. Many functional programming languages implement variants of the HM type system.</p>
<h3 id="dependent-types">Dependent types</h3>
<p>In simple terms dependent types allow types to depend not only on other types, but on values. This is best understood by an example: Normally we can only encode very coarse information, such as “x is of integer type”. Dependent types allow us to define more detailed types. For example we could then create a type “even integer”, whose only inhabitants are even integers. This is strictly more powerful than the previous setting: Dependent types in general make type inference undecidable as <a href="https://link.springer.com/content/pdf/10.1007%2FBFb0037103.pdf">can be shown</a> by reduction to the <a href="https://en.wikipedia.org/wiki/Post_correspondence_problem">Post Correspondence Problem</a>.</p>
<h2 id="how-hard-is-type-checking-your-favorite-language">How Hard is Type-Checking Your Favorite Language?</h2>
<p>Below I’ve compiled a list of languages and how hard type checking/type inference is in these languages. If you find a mistake or are missing a language please <a href="https://todo.sr.ht/~bfiedler/typing-is-hard">file an issue</a> with your language, its type checking complexity and optimally a resource that supports your claim. I do not claim completeness nor correctness of the properties shown here, it is mainly an amalgamation of blog posts I’ve been collecting.</p>
<h3 id="c">C++</h3>
<p><strong>undecidable</strong>, <a href="https://rtraba.files.wordpress.com/2015/05/cppturing.pdf">C++ Templates are Turing Complete, Todd L. Veldhuizen (2003)</a>, even its <a href="https://medium.com/@mujjingun_23509/full-proof-that-c-grammar-is-undecidable-34e22dd8b664">grammar is undecidable</a></p>
<h3 id="c-1">C#</h3>
<p><strong>unsound, undecidable</strong>, there is an <a href="https://stackoverflow.com/questions/23939168/is-c-sharp-type-system-sound-and-decidable">excellent SO answer by Eric Lippert</a> on this topic. Other fun things include <a href="https://docs.microsoft.com/en-us/archive/blogs/ericlippert/lambda-expressions-vs-anonymous-methods-part-five">a SAT solver using the C# type-checker</a></p>
<h3 id="elm">Elm</h3>
<p><strong>decidable</strong>, uses Hindley-Milner, but currently <strong>unsound</strong>, due to an <a href="https://github.com/elm/core/issues/960">interesting compiler bug</a>: <code>(String.length "  ") ^ (-1) : Int</code></p>
<h3 id="f">F#</h3>
<p><strong>undecidable</strong>, <a href="https://github.com/cannorin/FSharp.TypeLevel">GitHub user cannorin implemented the untyped lambda calculus in F#</a></p>
<h3 id="go">Go</h3>
<p><strong>decidable</strong>, since type inference is only used for variable initialization</p>
<h3 id="haskell">Haskell</h3>
<p>1998 standard, no extensions: <strong>decidable</strong>, variant of HM</p>
<p>2010 standard, no extensions: <strong>decidable</strong>, restriction of System F</p>
<p>with sufficient<a href="#fn1" id="fnref1"><sup>1</sup></a> extensions: <strong>undecidable</strong>, as type checking in System F is undecidable. There exist <a href="https://www.lochan.org/keith/publications/undec.html">Turing Machines in Haskell types</a>. A simpler variant is to implement the <a href="https://mail.haskell.org/pipermail/haskell/2006-August/018355.html">SKI calculus</a>.</p>
<h3 id="idris">Idris</h3>
<p><strong>decidable</strong>, surprisingly. Idris has dependent types, but <a href="https://docs.idris-lang.org/en/latest/faq/faq.html#evaluation-at-the-repl-doesn-t-behave-as-i-expect-what-s-going-on">at compile time it will only evaluate expressions which it knows to be total (terminating and covering all inputs)</a>.</p>
<h3 id="java">Java</h3>
<p><strong>undecidable</strong>, because <a href="https://arxiv.org/pdf/1605.05274.pdf">Java Generics are Turing complete</a>. Java 5 or later is <strong>unsound</strong>, as shown by <a href="https://dl.acm.org/doi/pdf/10.1145/2983990.2984004">Amin and Tate (2015)</a></p>
<h3 id="ocaml">OCaml</h3>
<p><strong>undecidable</strong>, since we can <a href="https://caml.inria.fr/pub/old_caml_site/caml-list/1507.html">cause the type checker to loop infinitely</a></p>
<h3 id="ml">ML</h3>
<p><strong>decidable</strong>, uses Hindley-Milner</p>
<h3 id="rust">Rust</h3>
<p><strong>undecidable</strong>, both type inference (since Rust has rank-3-types) and type checking, as shown by this <a href="https://sdleffler.github.io/RustTypeSystemTuringComplete/">Smallfuck interpreter implemented using traits</a>.</p>
<h3 id="scala">Scala</h3>
<p><strong>undecidable</strong>, since it admits a <a href="https://michid.wordpress.com/2010/01/29/scala-type-level-encoding-of-the-ski-calculus/">type-level SKI calculus</a>, <strong>unsound</strong>, as shown by <a href="https://dl.acm.org/doi/pdf/10.1145/2983990.2984004">Amin and Tate (2015)</a>. Scala 2.13.3 (newest as of writing this) also exhibits the same problem.</p>
<h3 id="swift">Swift</h3>
<p><strong>undecidable</strong>, as proven <a href="https://forums.swift.org/t/swift-type-checking-is-undecidable/39024">here</a> by reduction to the <a href="https://en.wikipedia.org/wiki/Word_problem_for_groups">word problem for finitely generated groups</a><a href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h3 id="typescript">TypeScript</h3>
<p><strong>undecidable, unsound</strong>. The <a href="https://www.typescriptlang.org/docs/handbook/type-compatibility.html#a-note-on-soundness">TypeScript documentation</a> mentions its unsoundness and the <a href="https://www.typescriptlang.org/docs/handbook/type-compatibility.html#function-parameter-bivariance">motivations</a> <a href="https://www.typescriptlang.org/docs/handbook/type-compatibility.html#optional-parameters-and-rest-parameters">behind</a> them.</p>
<p>Undecidability: TypeScript’s type system was <a href="https://gist.github.com/hediet/63f4844acf5ac330804801084f87a6d4">proven Turing complete</a> until <a href="https://github.com/microsoft/TypeScript/issues/14837">they disallowed self-referential types</a>. However <a href="https://ostro.ws/2019/12/09/taking-types-too-far/">Robbie Ostrow</a> wrote a <a href="https://www.typescriptlang.org/play/#code/FAFwngDgpgBAcgQxAVwE4IDYwLwwN4wSpQBuAXPEmpjAL6iSwBaUqA9jvoceTAHalWdYA2gwAlgGcW7AIKIU6DHGQBbAEZDcMjlAAeIKHwAmkyopoB+GCFTJYFAGaZJUEeDEBRAI7IXAHlkYfUMTMwVqDAAaGAAhYIMjU3NIgD4cYBgsmCCQpLN4y0zs+LywnJgi7Js7B2Ks5wxXGDJ6mEbXd0YYAGV-ABUE0OSIpXTcAiJSCkH6UVgAeQFOPp1U+Zh+gHcOXD6lqHWPWH6AC2JYPYGdo+6AMTY0FYHzqEONu-ESS97-B7RbmIeuI9M9Pt9AbAeoI+M9gXpITBPOIAOanEBwmGIuDiZZXeHrAD0hJgADpyTAECYYJIOGxYV0xAAFAZDfIpMacSY8GYAbQARFMSPyALoCoWi4QbWTGYyBNnlUaYGKlRKKqiciZtAAMFFkUTaAEYKH0ZXL9TAWbFUjbgLRearhmYdJUYNqWjBDSLGVDkOpbAgAMYgeVlEYa5VxBXhiwYcb4HV6g3VY0VMPO1gcawCb6oD09P0B4P+FmyVIxK22+2O9ku6zuihen0wACyyAwIHEEAwYFDapjkRV0fCEbjXMTMB0yeyqbN-jbHa7PcCFf81vLOXW1eHk8zrobnu9GwAIl9xMYoH2nRzIzX1bH43gJznWNOsrOd3Xd+x8-5TyRz0vAt-XQYtSw3SsN3XO0HU-Pd6w9JsNk8b4+FZdMbzHLVql1fhBFQN9PRmOCf2sWx7A9QYMIOV0OgcJFUJLJj+htLdeSo-sR1jV1DQ9bUj2OGAAGE2AwDAkAAL3QzjMMfCdyKgQjUxEsTJP8FCjAGdIMIUyo2mqf9AIGGJtjYdIKGJGAAElHGCVCYmMM8LxgdQwBsHZ9OyPoF07bte36EzXkOdJLIWEBTlYLYpEUmBVHbXyexctyAGZKWpBBZU9GCfD8JpjJgA5tJk3SEMbEUYFCgRrH6WoYjYcLIui4TRPEkApJY5tA143AVNaqTCoqkldIACkNABKDZAwAJk4Xq1NMkKhtqGBhpmgBadJxsm1Kepa+agsWpFUHYVAZm6XFJBAKlOyQcR6QkMx9EDKBJEkL4oESi8oAgNLjEINhXvEdREtxRxcXEQxSRWmqKPEWytlgQN6TBlE0FgBqYAvCBwpsDhNBgcTUBRVgAG4VtSjbPXdSmAFYYEpw0ADZ6fSAAOFmYAAFg59bNrGibBMDbndtUtq-keVBDpG7nKd5z0Be6QN2ZFvr1NRdEpeW4b2cpmX0jl8agA">program checking the Collatz conjecture</a>, and as the <a href="http://people.cs.uchicago.edu/%7Esimon/RES/collatz.pdf">generalized form of the Collatz conjecture is undecidable</a><a href="#fn3" id="fnref3"><sup>3</sup></a>, the TypeScript type system is undecidable as well.</p>
<h3 id="zig">Zig</h3>
<p><strong>undecidable</strong>, since evaluation of recursive functions at compile time is possible, thus requiring the compiler to solve the halting problem.</p>
<h2 id="faq">FAQ</h2>
<h3 id="where-are-python-bash-etc.">Where are Python, Bash, etc.?</h3>
<p>Type checking and type inference work primarily for statically typed languages. While there exist extensions to some dynamic languages imbuing them with static type checking these are not part of the language, and the complexity depends not on the language but the extension.</p>
<h3 id="what-about-unsafe-casts">What about unsafe casts?</h3>
<p>Some languages offer explicit unchecked casts, which are accepted by the type checker and may potentially fail at runtime. Examples are casting from <code>Object</code> to some subclass in C# and Java, casting values of type <code>interface{}</code> in Go or using <code>unsafeCoerce</code> in Haskell. I’ve chosen not to account for such casts/coercions since unchecked downcasting is an inherently unsafe operation not covered by type checker guarantees.</p>
<h3 id="ive-spotted-a-mistakeimprecision-what-should-i-do">I’ve spotted a mistake/imprecision, what should I do?</h3>
<p>Great work! Please report it on the <a href="https://todo.sr.ht/~bfiedler/typing-is-hard">official issue tracker</a> detailing what is wrong and I will try to fix it as soon as possible.</p>
<section>
<hr>
<ol>
<li id="fn1"><p>Using only <code>RankNTypes</code> suffices to stump inference. Interestingly enough this is only undecidable for <code>N &gt;= 3</code>.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>I think a reduction to the PCP-problem is also possible.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Thanks to reddit user /u/nckl for pointing that out.<a href="#fnref3">↩</a></p></li>
</ol>
</section>


</div>]]>
            </description>
            <link>https://3fx.ch/typing-is-hard.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-26140363</guid>
            <pubDate>Mon, 15 Feb 2021 08:17:57 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Security features of the Intel/Windows platform secure boot process]]>
            </title>
            <description>
<![CDATA[
Score 95 | Comments 24 (<a href="https://news.ycombinator.com/item?id=26140122">thread link</a>) | @ingve
<br/>
February 14, 2021 | https://igor-blue.github.io/2021/02/04/secure-boot.html | <a href="https://web.archive.org/web/*/https://igor-blue.github.io/2021/02/04/secure-boot.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><section itemprop="text">
        
        <ul id="markdown-toc">
  <li><a href="#introduction-and-system-architecture" id="markdown-toc-introduction-and-system-architecture">Introduction and System Architecture</a>    <ul>
      <li><a href="#buses" id="markdown-toc-buses">Buses</a></li>
      <li><a href="#more-components" id="markdown-toc-more-components">More Components</a></li>
      <li><a href="#the-flash-chip" id="markdown-toc-the-flash-chip">The Flash Chip</a></li>
    </ul>
  </li>
  <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
  <li><a href="#early-power-on" id="markdown-toc-early-power-on">Early power on</a></li>
  <li><a href="#bring-up-bup" id="markdown-toc-bring-up-bup">Bring-Up (BUP)</a></li>
  <li><a href="#cpu-initialization" id="markdown-toc-cpu-initialization">CPU initialization</a></li>
  <li><a href="#uefi-initialization" id="markdown-toc-uefi-initialization">UEFI initialization</a>    <ul>
      <li><a href="#loading-the-boot-loader" id="markdown-toc-loading-the-boot-loader">Loading the boot loader</a></li>
    </ul>
  </li>
  <li><a href="#windows-boot" id="markdown-toc-windows-boot">Windows Boot</a>    <ul>
      <li><a href="#winload" id="markdown-toc-winload">Winload</a></li>
      <li><a href="#hvci" id="markdown-toc-hvci">HVCI</a></li>
      <li><a href="#dynamic-root-of-trust-model-drtm" id="markdown-toc-dynamic-root-of-trust-model-drtm">Dynamic Root of Trust Model (DRTM)</a></li>
      <li><a href="#uefi-memory-attributes-table" id="markdown-toc-uefi-memory-attributes-table">UEFI Memory Attributes Table</a></li>
    </ul>
  </li>
  <li><a href="#other-oss" id="markdown-toc-other-oss">Other OSs</a></li>
  <li><a href="#more-protections" id="markdown-toc-more-protections">More Protections</a>    <ul>
      <li><a href="#iommu-and-dma-protections" id="markdown-toc-iommu-and-dma-protections">IOMMU and DMA protections</a></li>
      <li><a href="#secure-devices" id="markdown-toc-secure-devices">Secure Devices</a></li>
      <li><a href="#smm" id="markdown-toc-smm">SMM</a></li>
      <li><a href="#memory-reset-protections" id="markdown-toc-memory-reset-protections">Memory Reset protections</a></li>
    </ul>
  </li>
</ul>

<p>This blog post is an in-depth dive into the security features of the Intel/Windows platform boot process. In this post I'll explain the startup process through security focused lenses, next post we'll dive into several known attacks and how they were handled by Intel and Microsoft. My wish is to explain to technology professionals not deep into platform security why Microsoft's SecureCore is so important and necessary.</p>



<p>We must first begin with a brief introduction to the hardware platform. Skip this if you have read the awsome material available on the web about the Intel architecture, I'll try to briefly summarize it here.</p>

<p>The Intel platform is based on one or two chips. Small systems have one, the desktop and server ones are separated to a CPU complex and a PCH complex (PCH = Platform Controller Hub).</p>

<p><img src="https://igor-blue.github.io/images/image2020-4-19_14-3-0.png" alt="Intel architecture"></p>

<p>The CPU complex deals with computation. It holds the "processor" cores, e.g. Sunny Cove that implement the ISA, as well as cross core caches like the L3 cache, and more controllers that are grouped together as "the system agent" or the "uncore". The uncore contains the memory controller and display, e.g. GPU and display controller.</p>

<p>The PCH handles all other IO, including access to the firmware through SPI or eSPI, wifi, LAN, USB, HD audio, SMBus, thunderbolt and etc'. The PCH also hosts several embedded processors, like the PMC, the Power Management Controller.</p>

<p>An additional part of the PCH is a very important player in our story, the CSME, or Converged Security &amp; Management Engine, a i486 IP block (also called Minute IA). CSME is responsibly for much of the security model of Intel processors as well as many of the manageability features of the platform. The CSME block has its own dedicated ~1.5mb of SRAM memory and 128KB of ROM, as well as a dedicated IOMMU, called the A-Unit (that even has its own <em>acode</em> microcode) located in the CSME's <em>uncore</em>', thats allows access from ME to the main memory, as well as DMA to/from the main memory and using the main memory as an encrypted paging area ("virtual memory"). The CSME engine runs a customized version of the Minix3 microkernel, also recent versions have changed it beyond recognition adding many security features.</p>

<p><img src="https://igor-blue.github.io/images/image2020-4-19_14-14-4.png" alt="CSME structure"></p>

<h2 id="buses">Buses</h2>
<p>Lets use this post to also introduce the main interconnects in the system. The main externally facing interconnect bus is PCI-E, a fast bust that can reach 64GBps in its latest incarnations. A second external bus is the LPC, or Low Pin Count bus, a slow bus for connecting devices such as SPI flash, the TPM (explained below), and old peripherals such as PS/2 touchpads.</p>

<p>Internally the platform is based around the <strong>IOSF</strong>, or Intel On-chip System Fabric, which is a pumped up version of PCI-E that supports many additional security and addressing features. For addressing IOSF adds SourceID and DestID fields that contain the source and destination of any IOSF transaction, extending PCI-E Bus-Device-Function (BDF) addressing to enable routing over bridges. IOSF also extends addressing by adding support for multiple address root namespaces, currently defining three: RS0 for host memory space, RS1 for CSME memory space, and RS2 for the Innovation-Engine (IE), another embedded controller currently present only on server chipsets.
There are two IOSF busses in the PCH - the Primary Fabric and the Sideband Fabric. The Primary Fabric is high speed, connecting the CPU to the PCH (through a protocol call DMI), as well as high speed devices such as Gigbait Ethernet, WiFi and eSPI. The Sideband Fabric is used to connect the CSME to low-speed devices, including the PMC (Power Management Controller), the RNG generator, GPIO pins, USB, SMBus, and even debugging interfaces such as JTAG.</p>

<h2 id="more-components">More Components</h2>
<p>Another interesting component is the <strong>ITH</strong>, or Intel Trace Hub, which is codenamed North Peak (NPK). The ITH can trace different internal hardware component (VIA - Visualization of Internal Signals, ODLA - On-chip logic analyzer, SoCHAP - SOC performance counters, IPT - Intel Process Trace, AET - Intel Architecture Trace), and external component like CSME, the UEFI firmware, and you can even connect it to ETW. This telemetry eventually finds its way to Intel in various methods.</p>

<p><img src="https://igor-blue.github.io/images/image2020-4-22_0-52-2.png" alt="Intel Trace Hub"></p>

<p>The <strong>TPM</strong> is designed to provide a tamper proof environment to enforce system security through hardware. It implements in hardware many essential functions: sha1 &amp; sha256 hashing algorithms, many crypto and key derivation functions, measurment registers call the Platform Configuration Registers (PCRs), a secret key - Endorsment Key - used to derive all other keys, and non-volatile storage slots for storing keys and hashes. Discrete TPM chips (i.e. those that are a separate chip on the mainboard or SOC and connected through the LPC) are call dTPMs, or can be implemented in the CSME module's firmware and called fTPMs.</p>

<p>The TPM's <strong>PCR</strong> are initialized to zero when the platform boots and are filled up with measurements through the boot process. PCRs 0-15 are intended for "static" use - they reset when the platform boots; They are supposed to give the OS loader a view of the platform initialization state.
PCRs 17-22 are for "dynamic" use - they get reset on each secure launch (GETSEC[SENTER]); They are supposed to be used by the attestation sofware that checks if the OS is trusted.</p>

<h2 id="the-flash-chip">The Flash Chip</h2>
<p>SPI flash has 5 major regions: the Descriptor regions, the CSME region, the Gigabit Ethernet Region, the Platform Data Region, and the UEFI region. In the image below you can see an example of how the flash is organized.</p>

<p><img src="https://igor-blue.github.io/images/image2019-11-11_1-18-53_1.png" alt="Partition regions in SPI flash">
<img src="https://igor-blue.github.io/images/image2019-11-11_1-19-12.png" alt="Serial flash sizes"></p>

<p>Later versions added more regions:</p>

<p><img src="https://igor-blue.github.io/images/image2019-11-25_22-49-41.png" alt="SPI region evolution"></p>

<p>These regions are categorized as fault tolerant (FTPs) and non fault tolerant partitions (NFTPs).
Fault tolerant partitions are critical for boot, and verified during early boot (like the RBE, the CSME ROM Boot extensions will discuss in a few paragraphs). If verification fails - the system does not boot. Examples of non fault tolerant partitions are the Integrated Sensor Hub (or ISH) firmware.</p>

<p>SPI flash protection is applied at multiple levels: On the flash chip itself, in the SPI flash controller (in the PCH), in UEFI code and in CSME code.</p>

<p>The SPI controller maps the entire flash to memory at a fixed address, so reads/writes are usually done simply by reading/writing memory. The SPI controller translates this to flash-specific commands issued on the SPI bus, using a table of flash-specific commands stored in the flash descriptor region.
This is called "Hardware Sequencing", meaning the SPI controller issues the actual SPI commands
When hardware sequencing is in use, the SPI controller enforces several flash protections based on the masters region table in the flash (but can be overriden using a hardware PIN).</p>

<p>The SPI controller also implements a FLOCKDN flag. FLOCKDN is a write-once bit that, when set, disables use of software sequencing and modification of the PR registers until the next reset. The CSME sets this in the Bring-UP process (bup_storage_lock_spi_configuration(), see below). This happens when the UEFI notifies it that it is at the end of POST. In addition to the region access control table, the SPI controller also has an option to globally protect up to five regions in the flash from write access by the host using five registers, called Protected Registers (PRs), which are intended for the UEFI firmware to protect itself from modification while the OS is running.</p>

<p>It is also possible to issue direct flash commands using "Software Sequencing" by writing to the OPTYPE/OPMENU registers, since this can be used circumvent the SPI-enforced protections, software sequencing is usually disabled after POST using the FLOCKDN bit.</p>

<p>How is the flash updated?</p>

<p>UEFI region is updated through an UEFI capsule, This update happens during POST, before PRs and FLOCKDN is set, therefore, the BIOS region is still accessible to UEFI code.</p>

<p>Many OEMS have then own UEFI anti-tamper protections. For example, HP has SureStart on laptops and workstations, and Dell has TrustedDevice SafeBIOS. SafeBIOS copies bad firmware images to the EFI system partition, and the Dell Trusted Device software on Windows sends their hashes plus the hash of the UEFI firmware currently in memory to a Dell cloud server (*.delltrusteddevicesecurity.com) to check against a list of "authorized" hashes. Server platforms have similiar protections, including iLO for HP and iDRAC in Dell.
The CSME region can usually be updated only from within the CSME. However, for more complicated upgrades CSME can temporarily unlock the ME region for host read &amp; write.</p>


<p>In the next sections we'll look over all the stages of boot.
<img src="https://igor-blue.github.io/images/image2020-4-20_14-56-23.png" alt="Serial flash sizes"></p>


<p>Boot starts the PMC, the Power Management Controller.
In modern Intel systems the PMC is an ARC core and its the first controller to execute code once electricity is applied to the system. We'll talk more about PMC in a later post as its quiet interesting and has its own microcode and firmware, and event generates telemetry over the IOSF SB bus (which we'll talk about in a moment).</p>

<p>While the PMC does its init, the rest of the system is held at bay at a RESET state.</p>

<p>The next part to start running is the CSME. Recall from the first post in the series, CSME, or Converged Security and Managment Engine is a MinuteIA (i486 CPU IP block) embedded in the Platform Controller Hub (PCH).
The CSME begins running from its own embedded 128KB ROM - the CSME-ROM. This ROM is protected with a hardware fuse that is burned by Intel during production.
When started the CSME ROM starts like a regular 486 processor BIOS - in the reset vector in real mode. Its first order of business is to …</p></section></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://igor-blue.github.io/2021/02/04/secure-boot.html">https://igor-blue.github.io/2021/02/04/secure-boot.html</a></em></p>]]>
            </description>
            <link>https://igor-blue.github.io/2021/02/04/secure-boot.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-26140122</guid>
            <pubDate>Mon, 15 Feb 2021 07:34:58 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Good Ideas, Through the Looking Glass (PDF, 2005)]]>
            </title>
            <description>
<![CDATA[
Score 37 | Comments 3 (<a href="https://news.ycombinator.com/item?id=26138218">thread link</a>) | @benhoyt
<br/>
February 14, 2021 | https://people.inf.ethz.ch/wirth/Articles/GoodIdeas_origFig.pdf | <a href="https://web.archive.org/web/*/https://people.inf.ethz.ch/wirth/Articles/GoodIdeas_origFig.pdf">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to extract article]]>
            </description>
            <link>https://people.inf.ethz.ch/wirth/Articles/GoodIdeas_origFig.pdf</link>
            <guid isPermaLink="false">hacker-news-small-sites-26138218</guid>
            <pubDate>Mon, 15 Feb 2021 02:00:06 GMT</pubDate>
        </item>
    </channel>
</rss>
