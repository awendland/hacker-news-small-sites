<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>
<![CDATA[Hacker News - Small Sites - Score >= 10]]>
        </title>
        <description>
<![CDATA[Hacker News stories from domains that aren't in the top 1M and that have a score of at least 10. Updated nightly via https://github.com/awendland/hacker-news-small-sites]]>
        </description>
        <link>https://news.ycombinator.com</link>
        <generator>RSS for Node</generator>
        <lastBuildDate>Fri, 04 Sep 2020 04:23:17 GMT</lastBuildDate>
        <atom:link href="https://raw.githubusercontent.com/awendland/hacker-news-small-sites/generated/feeds/hn-small-sites-score-10.xml" rel="self" type="application/rss+xml"></atom:link>
        <pubDate>Fri, 04 Sep 2020 04:23:17 GMT</pubDate>
        <language>
<![CDATA[en-US]]>
        </language>
        <managingEditor>
<![CDATA[me@alexwendland.com (Alex Wendland)]]>
        </managingEditor>
        <ttl>240</ttl>
        <item>
            <title>
<![CDATA[I Actively Discourage Online Tooling Like Jwt.io and Online JSON Validators]]>
            </title>
            <description>
<![CDATA[
Score 23 | Comments 18 (<a href="https://news.ycombinator.com/item?id=24352360">thread link</a>) | @pcr910303
<br/>
September 2, 2020 | https://www.jvt.me/posts/2020/09/01/against-online-tooling/ | <a href="https://web.archive.org/web/*/https://www.jvt.me/posts/2020/09/01/against-online-tooling/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><p>Something my colleagues know well is how little I trust online tools like <a href="https://jwt.io/">jwt.io</a>, online JSON validators or online tooling in general, but it also bleeds into <a href="https://www.jvt.me/mf2/2020/08/zebqf/">comments I make online</a> and in my blog posts, too, and I thought I'd share a little bit of a reason as to why.</p><p>Instead of using an online service, I will reach for a way to run it locally, using whichever programming language toolchain I have available. But why? Why wouldn't I recommend something like jwt.io? Or an online JSON validator, especially if they boast client-side functionality, and mean I don't need things installed?</p><p>Let's start with a bit of background. Firstly, I'd just like to caveat this all with the note that <strong>I have no access to Production data, customer or otherwise</strong>. All of these examples are referencing Non-Production examples.</p><p>I also want to caveat this with the fact that this is <strong>not a personal attack</strong> on jwt.io. I am using them as an example as they're a well-known and well-used service, and I've seen issues with it before. Auth0 run it, and are probably one of the few companies we'd want to be running it. It's also <a href="https://github.com/jsonwebtoken/jsonwebtoken.github.io">Open Source</a> <em>but</em> one of the great difficulties of Web-hosted services are that we have no idea if the source code that we're told is being used is actually being used!</p><p>I'm currently working on the Open Banking platform for Capital One. We're fortunate to have very restricted access to Production, which makes things safer for everyone. One thing we strive to do is to treat Non-Production secrets like Production ones where possible - where we shouldn't have access to them at all, and shouldn't be sharing them with external services. Some of these Non-Production secrets may be usable outside of Capital One, for instance Open Banking Sandbox signing certificates.</p><p>We perform a fair bit of testing in our Non-Production environments and sometimes need to debug things, such as what's inside a JWT (as Open Banking introduces several places they're used). I've been burned a number of times by folks putting a Non-Production JWT or an Open Banking Sandbox certificate into jwt.io. Although Non-Production, these are sensitive in of themselves, as they have implementation details for our services, and as mentioned, certain things could be used outside of Capital One.</p><p>The biggest reason I hear from folks using online tooling is that it's easier, and that they'd rather do that than find out how to run it locally. I disagree with this, but am quite biased, as I often have a blog post for many of these common issues. I love sharing my blog with others and having a handy solution, or if I don't have an answer to a problem, I'll find out how and <a href="https://www.jvt.me/tags/blogumentation/">blogument it for later</a>. So I see that reaching for online tooling is more just because we've got folks who aren't aware of how they could do otherwise.</p><p>One great thing about removing the need for an online tool is that you can self-serve it once you have the tools locally. You can run it locally when you've got no internet (which isn't as much of an issue in these Coronavirus times) but also regardless of whether the upstream service is broken. You can use it with other i.e. command-line tooling, for instance how I've set up <a href="https://gitlab.com/jamietanna/dotfiles-arch/-/blob/master/terminal/home/bin/unpack">this command-line script</a> to handle a lot of common data formats I deal with and unpack them to a human-readable format.</p><p>But most importantly, by telling people to put sensitive data (such as credentials, configuration files, etc) it's a really dangerous lesson for our teams. We're teaching people to blindly trust arbitrary websites that they don't have any relationship with, nor have fully audited the source code, when posting potentially sensitive data.</p><p>I realise this may not be something you do when running it locally, but it's less likely for a well-known library running locally to need to reach outbound.</p><p>jwt.io is an interesting example, because although it boasts that it runs as a client-side solution, you may not have been aware that <a href="https://github.com/jsonwebtoken/jsonwebtoken.github.io/commit/b362ab19a9f37e337b5f8ea38987aa680aa6e0a9">until last September</a>, there were metrics being determined which although may have seemed innocent, show that it's easy for other functionality to be hidden in a seemingly client-side-only website. Unless you audit everything, every time, you're in a risky position where you may be leaking data you're not expecting to.</p><p>I feel that we can do something to help services that handle potentially sensitive data with helping educate the user that they should be more careful, because jwt.io's warning definitely doesn't help with folks who don't fully appreciate what the risk is if jwt.io isn't actually as trustworthy as the user thinks:</p><blockquote><p>Warning: JWTs are credentials, which can grant access to resources. Be careful where you paste them! We do not record tokens, all validation and debugging is done on the client side.</p></blockquote><p>What do you think? Am I maybe being a little too sensitive? Am I not being sensitive enough?</p><p>Edit: Based on some conversations being had in response to the post, I thought it'd mention I've written about how to <a href="https://www.jvt.me/posts/2019/06/13/pretty-printing-jwt-openssl/">pretty-print a JWT locally with OpenSSL</a> and <a href="https://www.jvt.me/posts/2018/08/31/pretty-printing-jwt-ruby/">a Ruby alternative</a>.</p></div></div>]]>
            </description>
            <link>https://www.jvt.me/posts/2020/09/01/against-online-tooling/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24352360</guid>
            <pubDate>Wed, 02 Sep 2020 12:01:00 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Kubernetes: Make your services faster by removing CPU limits]]>
            </title>
            <description>
<![CDATA[
Score 31 | Comments 27 (<a href="https://news.ycombinator.com/item?id=24351566">thread link</a>) | @iansinnott
<br/>
September 2, 2020 | https://erickhun.com/posts/kubernetes-faster-services-no-cpu-limits/ | <a href="https://web.archive.org/web/*/https://erickhun.com/posts/kubernetes-faster-services-no-cpu-limits/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
        <p>At Buffer, we‚Äôve been using <a href="https://kubernetes.io/case-studies/buffer/">Kubernetes since 2016</a>.  We‚Äôve been managing our k8s (kubernetes) cluster with <a href="https://kops.sigs.k8s.io/">kops</a>, it has about 60 nodes (on AWS), and runs about 1500 containers. Our transition to a micro-service architecture has been full of trial and errors. Even after a few years running k8s, we are still learning its secrets. This post will talk about how something we thought was a good thing, but ended up to be not as great as we thought: <strong>CPU limits</strong>.</p>
<h2 id="cpu-limits-and-throttling">CPU limits and Throttling</h2>
<p>It is s general recommendation to set CPU limits. <a href="https://cloud.google.com/blog/products/gcp/kubernetes-best-practices-resource-requests-and-limits">Google, among others, highly recommends it</a>. The danger of not setting a CPU limit is that containers running in the node could exhaust all CPU available. This can trigger a cascade of unwanted events such as having key Kubernetes processes (such as <code>kubelet</code>) to become unresponsive. So it is in theory a great thing to set CPU limit in order to protect your nodes.</p>
<p>CPU limits is the maximum CPU time a container can uses at a given period (100ms by default). The CPU usage for a container will never go above that limit you specified. Kubernetes use a mechanism called <a href="https://en.wikipedia.org/wiki/Completely_Fair_Scheduler">CFS Quota</a> to <strong>throttle</strong> the container to prevent the CPU usage from going above the limit. That means CPU will be artificially restricted, making the performance of your containers lower (and slower when it comes to latency).</p>
<h2 id="what-can-happen-if-we-dont-set-cpu-limits">What can happen if we don‚Äôt set CPU limits?</h2>
<p>We unfortunately experienced the issue. The <code>kubelet</code> , a process running on every node, and in charge of managing the containers (pods)  in the nodes became unresponsive. The node will turn into a <code>NotReady</code> state, and containers (pods) that were present will be rescheduled somewhere else, and create the issue in the new nodes. Definitely not ideal isn‚Äôt it?</p>
<h2 id="discovering-the-throttling-and-latency-issue">Discovering the throttling and latency issue</h2>
<p>A key metric to check when you are running container is the <code>throttling</code> . This indicate the number of time your container has been throttled. Interestingly, we‚Äôve discovered a lot of containers having throttling no matter if the CPU usage was near the limits or not. Here the example of one of our main API:</p>
<p><img src="https://erickhun.com/img/kubernetes-cpu-limits/cpu-usage-limits.png" alt="Kubernetes pods CPU usage and limits"></p>
<p>You can see in the animation that the CPU limits is set at <code>800m</code> (0.8 core, 80% of a core), and the peak usage is at most <code>200m</code> (20% of a core). After seeing, we might think we have plenty of CPU to let the service running before it throttle right? . Now check this one out:</p>
<p><img src="https://erickhun.com/img/kubernetes-cpu-limits/cpu-throttling-low-usage.gif" alt="Kubernetes pods Low CPU usage, High limit, lot of throttling"></p>
<p>You can notice the CPU throttling occurs, even though the CPU usage is below the CPU Limits. The maximum CPU usage isn‚Äôt even near the CPU limits.</p>
<p>We‚Äôve then found a few resources(<a href="https://github.com/kubernetes/kubernetes/issues/67577">github issue</a>, <a href="https://www.youtube.com/watch?v=LpFApeaGv7A&amp;feature=youtu.be&amp;t=1204">zanado talk</a>,  <a href="https://medium.com/omio-engineering/cpu-limits-and-aggressive-throttling-in-kubernetes-c5b20bd8a718">omio post</a>) talking about how throttling lead to poorer performances and latency for your services.</p>
<p><strong>Why do we see CPU throttling while CPU usage is low?</strong>
The tldr is basically a bug in the Linux kernel throttling unecessarly containers with CPU limit. If you‚Äôre curious about the nature of it, I invite you to check Dave Chiluk‚Äôs <a href="https://www.youtube.com/watch?v=UE7QX98-kO0">great talk</a>, a <a href="https://engineering.indeedblog.com/blog/2019/12/unthrottled-fixing-cpu-limits-in-the-cloud/">written version</a> also exists with more details.</p>

<p>After many long discussions, we‚Äôve decided to remove the CPU limits for all services that were directly or indirectly on the critical path of our users.</p>
<p>This wasn‚Äôt an easy decision since we value the stability of our cluster. We‚Äôve experimented in the past some instability in our cluster with services using too much resources and disrupting all other services present in the same node.  That time was a bit different, we understood more about how our services needed to be and had a good strategy to roll this out.</p>
<p><img src="https://erickhun.com/img/kubernetes-cpu-limits/unleash-k8s.jpg" alt="Buffer-remove-cpu-limits-announcement"></p>
<h2 id="how-to-keep-your-nodes-safe-when-removing-limits-">How to keep your nodes safe when removing limits ?</h2>
<p><strong>Isolating ‚ÄúNo CPU Limits‚Äù services:</strong></p>
<p>In the past we‚Äôve seen some nodes going to a <code>notReady</code> state, mainly because some services were using too much resources in a node.</p>
<p>We‚Äôve decided to put those services on some specific nodes (tainted nodes), so those services will not disrupt all the ‚Äúbounded‚Äù ones.  We have better control and could identify easier if any issue occurs with a node. We did this by tainting some nodes and adding toleration to services that were ‚Äúunbounded‚Äù. Check <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/">the documentation</a> on how you can do that.</p>
<p><img src="https://erickhun.com/img/kubernetes-cpu-limits/buffer-k8s-infrastructure-nodes.jpg" alt="Buffer k8s nodes infrastructure"></p>
<p><strong>Assigning the correct CPU and memory request:</strong></p>
<p>The main worry we had was service using too much resources and leading to nodes becoming unresponsive. Because we now had great observability of all services running in our cluster (with Datadog), I‚Äôve analyzed a few months of usage of each service we wanted to ‚Äúunbound‚Äù. I‚Äôve assigned the maximum CPU usage as the CPU request with a &gt; 20% margin. This will make sure to have allocated space in a node. If k8s won‚Äôt try to schedule any other service in that node.</p>
<p><img src="https://erickhun.com/img/kubernetes-cpu-limits/choose-cpu-request-based-on-max.png" alt="Chose CPU request based on max"></p>
<p>You can see in the graph that the peak CPU usage was <code>242m</code> CPU core (0.242 CPU core). Simply take this number and make it a bit higher to become the CPU request. You can notice that since the service is user facing, the peak CPU usage matches peak traffic time.</p>
<p>Do the same with your memory usage and requests, and you will be all set!
To add more safety, you can use the horizontal pod autoscaler to create new pods if the resource usage is high, so kubernetes will schedule it in nodes that have room for it. Set an alert if your cluster do not have any room, or use the node austoscaler to add it automatically.</p>
<p>The downsides are that we lose in ‚Äú<a href="https://wiki.openvz.org/WP/Containers_density">container density</a>‚Äù, the number of containers that can run in a single node. We could also end up with a lot of ‚Äúslack‚Äù during a low traffic time.
You could also hit some high CPU usage, but nodes autoscaling should help you with it.</p>
<h2 id="results">Results</h2>
<p>I‚Äôm happy to publish really great results after few weeks of experimentation, we‚Äôve already seen really great latency improvements across all the services we‚Äôve modified:</p>
<p><img src="https://erickhun.com/img/kubernetes-cpu-limits/speedup-no-cpu-limits2.png" alt="faster-kubernetes-containers"></p>
<p>The best result happened on our main landing page (<a href="https://buffer.com/">buffer.com</a>) where we speed the service up to <strong>22x</strong> faster!</p>
<p><img src="https://erickhun.com/img/kubernetes-cpu-limits/no-cpu-limit-speedup-buffer-com.jpg" alt="buffer.com speedup without cpu limits"></p>
<h2 id="is-the-linux-kernel-bug-fixed">Is the Linux kernel bug fixed?</h2>
<p>The bug <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=763a9ec06c4">has been fixed and merged into the kernel</a> for Linux distribution running 4.19 or higher (kudo again to <a href="https://twitter.com/dchiluk">Dave Chiluk</a> for finding and fixing that).</p>
<p>However, as for <em>September 2nd 2020</em>, when reading <a href="https://github.com/kubernetes/kubernetes/issues/67577">the kubernetes issue</a>, we can see various Linux projects that keep referencing the issue, so I guess some Linux distribution still have the bug and working into integrating the fix.</p>
<p>If you are below a Linux distribution that has a kernel version below 4.19, I‚Äôd recommend you to upgrade to the latest Linux distribution for your nodes, but in any case, you should try removing the CPU limits and see if you have any throttling.  Here a non exhausting list of various managed Kubernetes services or Linux distribution:</p>
<ul>
<li>Debian: The latest version <a href="https://erickhun.com/posts/kubernetes-faster-services-no-cpu-limits/%5Bhttps://www.debian.org/releases/buster/">buster</a> has the fix,  it looks <a href="https://tracker.debian.org/news/1167353/accepted-linux-latest-419-105deb10u5deb9u1-source-amd64-into-oldstable-oldstable/">quite recent (august 2020)</a>. Some previous version might have get patched</li>
<li>Ubuntu: The latest version <a href="https://releases.ubuntu.com/20.04/">Ubuntu Focal Fosa 20.04</a> has the fix.</li>
<li>EKS has the fix since <a href="https://github.com/aws/containers-roadmap/issues/175">December 2019</a>. Upgrade your AMI if you have a version below than that</li>
<li>kops: Since <a href="https://github.com/kubernetes/kops/pull/9283">June 2020</a>,  <code>kops 1.18+</code> will start using <code>Ubuntu 20.04</code> as the default host image. If you‚Äôre using a lower version of kops, you‚Äôll have to probably to wait the fix. We are currently in this situation.</li>
<li>GKE (Goggle Cloud) : The kernel fix was merged in <a href="https://cloud.google.com/container-optimized-os/docs/release-notes#cos-stable-77-12371-141-0">January 2020</a>. But it does looks like throttling are <a href="https://news.ycombinator.com/item?id=24356903">still hapenning</a></li>
</ul>
<p>ps: Feel free to <a href="https://news.ycombinator.com/item?id=24351566">comment</a> if you have more precise information, I‚Äôll update the post accordingly</p>
<p><strong>If the fix solved the throttling issue?</strong></p>
<p>I‚Äôm unsure if totally solved the issue. I will give it a try once we hit a kernel version where the fix has been implemented and will update this post accordingly. If anyone have upgrade I‚Äôm keen to hear their results.</p>
<h2 id="takeaways">Takeaways</h2>
<ul>
<li>If you run Docker containers under Linux (no matter Kubernetes/Mesos/Swarm) you might have your containers underperforming because of throttling</li>
<li>Upgrade to the latest version of your distribution hoping the bug is fixed</li>
<li>Removing CPU limit is a solution to solve this issue, but this is dangerous and should be made with extra-care (prefer upgrading your kernel first and monitor throttling first)</li>
<li>If you remove CPU limits, carefully monitor CPU and  memory usage in your nodes, and make sure your CPU requests are</li>
<li>A safe way to is to use the Horizontal pod autoscaler to create new pods if the resource usage is high, so kubernetes will schedule it in nodes that have space.</li>
</ul>
<p>üëâ<strong>Hacker news update: lot of insighful <a href="https://news.ycombinator.com/item?id=24351566">comments</a>. I‚Äôve updated the post to have better recommendations. You should prefer upgrading your kernel version over removing the CPU limits. Be really mindful, set the proper CPU requests, add the necessary monitoring when you do this</strong></p>
<p>I hope this post helps you get performance gains on the containers you are running. If so, don‚Äôt hesitate to share or <a href="https://news.ycombinator.com/item?id=24351566">comment</a> with always some insighful comments</p>
<p>Special thanks to <a href="https://www.linkedin.com/in/dilyevsky/">Dmitry</a>, <a href="https://coderanger.net/">Noah</a> and <a href="https://mydev.org/">Andre</a> that adviced me on this.</p>
<h4 id="next-reads">Next reads:</h4>
<p>üëâ <a href="https://erickhun.com/posts/why-you-should-have-a-side-project/">Why you should have a side project</a></p>
<p>üëâ <a href="https://erickhun.com/posts/sharing-knowledge-in-a-remote-team/">How we share technical knowledge in a remote team, across timezones</a></p>




        <center>

            
            <a href="https://twitter.com/eric_khun" data-size="large" data-show-count="true">Follow @eric_khun</a>
            <br>
            <a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ferickhun.com%2fposts%2fkubernetes-faster-services-no-cpu-limits%2f&amp;s=fb" target="_blank" rel="noopener" aria-label="Facebook">
              
            </a>
  
            
            <a href="https://twitter.com/intent/tweet/?text=Kubernetes%3a%20Make%20your%20services%20faster%20by%20removing%20CPU%20limits%20by%20@eric_khun%20&amp;url=https%3a%2f%2ferickhun.com%2fposts%2fkubernetes-faster-services-no-cpu-limits%2f&amp;s=tw" target="_blank" rel="noopener" aria-label="Twitter">
              
            </a>
  
            
            <a href="https://erickhun.com/cdn-cgi/l/email-protection#47783432252d2224337a0c3225223529223322346274266275770a262c226275773e283235627577342235312e242234627577212634332235627577253e62757735222a28312e29206275770417126275772b2e2a2e33346761262a377c2528233e7a0c3225223529223322346274266275770a262c226275773e283235627577342235312e242234627577212634332235627577253e62757735222a28312e29206275770417126275772b2e2a2e3334676a672f3333373462742662752162752122352e242c2f32296924282a62752137283433346275212c3225223529223322346a2126343322356a342235312e2422346a29286a2437326a2b2e2a2e333462752161347a222a262e2b" target="_self" rel="noopener" aria-label="E-Mail">
              
            </a>
  
            
            <a href="https://reddit.com/submit/?url=https%3a%2f%2ferickhun.com%2fposts%2fkubernetes-faster-services-no-cpu-limits%2f&amp;resubmit=true&amp;title=Kubernetes%3a%20Make%20your%20services%20faster%20by%20removing%20CPU%20limits&amp;s=red" target="_blank" rel="noopener" aria-label="Reddit">
              
            </a>
  
            
            <a href="whatsapp://send?text=Kubernetes%3a%20Make%20your%20services%20faster%20by%20removing%20CPU%20limits%20-%20https%3a%2f%2ferickhun.com%2fposts%2fkubernetes-faster-services-no-cpu-limits%2f&amp;s=whatsapp" target="_blank" rel="noopener" aria-label="WhatsApp">
              
            </a>
    
          </center>
      </div></div>]]>
            </description>
            <link>https://erickhun.com/posts/kubernetes-faster-services-no-cpu-limits/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24351566</guid>
            <pubDate>Wed, 02 Sep 2020 09:47:30 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Lesser-known Web APIs]]>
            </title>
            <description>
<![CDATA[
Score 197 | Comments 71 (<a href="https://news.ycombinator.com/item?id=24350647">thread link</a>) | @Sandeepg33k
<br/>
September 1, 2020 | https://blog.greenroots.info/10-lesser-known-web-apis-you-may-want-to-use-ckejv75cr012y70s158n85yhn | <a href="https://web.archive.org/web/*/https://blog.greenroots.info/10-lesser-known-web-apis-you-may-want-to-use-ckejv75cr012y70s158n85yhn">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div itemprop="text"><p><code>API</code> is the acronym for Application Programming Interface which defines interactions between multiple software architecture layers. Programmers carry out complex tasks easily using APIs in software development. Without APIs, a programmer's life would have been miserable with no proper(security, for example) access to data,  knowing unnecessary low level details etc.</p>
<p>When it comes to Web APIs, there are extremely useful  objects, properties and functions available to perform tasks as minor as accessing DOM to as complex as managing audios, videos, graphics, etc. </p>

<p>If you are from the web development background, you are using many of them already. Here is the list of very well known web APIs.</p>
<ul>
<li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API">Canvas</a></li>
<li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch</a></li>
<li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/History_API">History</a> </li>
<li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API">Geolocation</a> </li>
<li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model">DOM</a></li>
<li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/Console_API">Console</a></li>
<li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API">Drag &amp; Drop API</a></li>
</ul>
<p>In this article, I am going to talk about 10 more web APIs that are not so popular. Lesser popular doesn't mean, they are not useful. You can use them in various use-cases of your project. Please have a look.</p>

<p>If you would like to jump into the source code or see the demonstration immediately, here are the quick links to them:</p>
<blockquote>
<ul>
<li><a target="_blank" href="https://github.com/atapas/demolab/tree/master/code/src/demos/web-apis">Link to the Source Code @GitHub</a></li>
<li><a target="_blank" href="https://demo.greenroots.info/categories/web-apis/">Link to the Web API DemoLab</a></li>
</ul>
</blockquote>
<p>Note: Web APIs are nothing but the interfaces, functions, objects, properties written and exposed using vanilla JavaScript. However the usage of the web APIs is not limited to the vanilla JavaScript based application alone. It is very straightforward to use them with an Angular, React or Vue based applications as well.</p>
<p>All the examples I have used to demonstrate the web apis in this article are written using reactjs. You can find them in the github link mentioned above. Please feel free to fork, change and use!</p>

<p>A big (pain) point about  using a web API is, most of them are not standardized yet. It means, the support for a web API  may differ from one browser vendor to another. For example, You may find an API working with the Chrome browser but, not supported by Firefox or Edge browsers yet.</p>
<p>I would suggest a couple of ways to have a check on this,</p>


<p>Alright, time to get started knowing them. Hope you also find these useful.</p>
<h2 id="1-fullscreen-api">1. üì∫ Fullscreen API</h2>
<p>Do you have the need to show any of the DOM elements in full-screen mode? The full-screen use-case is very demanding for gaming applications, online video platforms(like, youtube) etc. </p>
<p>The <code>Fullscreen API</code> provides methods to present a specific Element (and its children) in a full-screen mode. There is a method available to exit full-screen mode once it is no longer needed. Not only that, this API can also help to perform any actions when a DOM element transition into a full-screen mode or comes out of it.</p>
<p>In the example below, my favorite Santa Claus can get into the full-screen mode and come out of it with ease.</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1598715764074/fR7trCfsA.gif?auto=format,compress&amp;gif-q=60" alt="full_screen.gif"></p>
<p>In the code below, the <code>manageFullScreen()</code> function uses  the <code>requestFullscreen()</code> API on an element which is having an id called, <code>fs_id</code>. </p>
<pre><code><span>const</span> manageFullscreen = () =&gt; {
   <span>document</span>.getElementById(<span>'fs_id'</span>).requestFullscreen();
}
</code></pre>
<p>This element with id, <code>fs_id</code> is a <code>DIV</code> with a child element, i.e, the Santa Clause image.</p>
<pre><code>&lt;div className=<span>"column"</span>&gt;
  <span><span>&lt;<span>div</span> <span>id</span>=<span>"fs_id"</span>&gt;</span>
    <span>&lt;<span>Img</span> <span>fixed</span>=<span>{imageData.image.childImageSharp.fixed}</span> <span>alt</span>=<span>"santa"</span> /&gt;</span>
   <span>&lt;/<span>div</span>&gt;</span>

    <span>&lt;<span>StyledButton</span> 
         <span>onClick</span>=<span>{manageFullscreen}</span>&gt;</span>
            Enter Fullscreen with Santa
    <span>&lt;/<span>StyledButton</span>&gt;</span>
 <span>&lt;/<span>div</span>&gt;</span></span>
</code></pre>
<p>You can check if the <code>Fullscreen API</code> is supported by the browser,</p>
<pre><code><span>if</span> (<span>document</span>.fullscreenEnabled) {
   setSupported(<span>true</span>);
} <span>else</span> {
   setSupported(<span>false</span>);
}
</code></pre>
<p>Also watch out for the useful handlers like,</p>
<ul>
<li><code>onfullscreenchange</code>: An event handler for the fullscreenchange event.</li>
<li><code>onfullscreenerror</code>: An event handler for the fullscreenerror event.</li>
</ul>
<p>Direct link to the demo: <a target="_blank" href="https://demo.greenroots.info/web-apis/web-apis-fullscreen/">https://demo.greenroots.info/web-apis/web-apis-fullscreen/</a></p>
<h2 id="2-clipboard-async-api">2. üìã Clipboard Async API</h2>
<p>What is a clipboard in comuping?</p>
<blockquote>
<p>The clipboard is a buffer that some operating systems provide for short-term storage and transfer within and between application programs.</p>
</blockquote>
<p>There are mainly three operations you can perform with the clipboard. They are, <code>copy</code>, <code>cut</code> and <code>paste</code>. The Clipboard API provides the ability to respond to these three operations. </p>
<p>Interestingly, copying content to the clipboard is open as in, there is no need of a user permission. However, for pasting the content from the clipboard to the user application, the user needs to grant permission for it. It is achieved using another web API called, <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/Permissions_API">Permission API</a></p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1598716493747/PwPwDDK8Y.png?auto=format&amp;q=60" alt="image.png"></p>
<p>Here is a simple example of the copy-paste operation,</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1598716547383/PoXUNZmnr.gif?auto=format,compress&amp;gif-q=60" alt="clip_board.gif"></p>
<p>This is how to check if the feature is supported by the browser,</p>
<pre><code><span>if</span> (navigator.clipboard 
     &amp;&amp; navigator.clipboard.read 
     &amp;&amp; navigator.clipboard.write) {
   setSupported(<span>true</span>);
} <span>else</span> {
   setSupported(<span>false</span>);
}
</code></pre>
<p>Here is the async API function for writing the content to the clipboard,</p>
<pre><code><span>async</span> <span><span>function</span> <span>performCopy</span>(<span>event</span>) </span>{
   event.preventDefault();
   <span>try</span> {
      <span>await</span> navigator.clipboard.writeText(copyText);
      <span>console</span>.log(<span>`<span>${copyText}</span> copied to clipboard`</span>);
   } <span>catch</span> (err) {
      <span>console</span>.error(<span>'Failed to copy: '</span>, err);
   }
}
</code></pre>
<p>The Async API function to read the content from the clipboard and do something with it,</p>
<pre><code><span>async</span> <span><span>function</span> <span>performPaste</span>(<span>event</span>) </span>{
   event.preventDefault();
   <span>try</span> {
       <span>const</span> text = <span>await</span> navigator.clipboard.readText();
       setPastetext(text);
       <span>console</span>.log(<span>'Pasted content: '</span>, text);
   } <span>catch</span> (err) {
      <span>console</span>.error(<span>'Failed to read clipboard contents: '</span>, err);
   }
}
</code></pre>
<p>Note: With the inclusion of the <code>Clipboard Async API</code>, you can get rid of the usage of <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand">document.execCommad()</a> function as it is obsolete now.</p>
<p>Direct link to the demo: <a target="_blank" href="https://demo.greenroots.info/web-apis/web-apis-clipboard-apis/">https://demo.greenroots.info/web-apis/web-apis-clipboard-apis/</a></p>
<h2 id="3-resize-observer-api">3. üßê Resize Observer API</h2>
<p>Do you want to take some actions based on the changes to the content or border box of a DOM element? Are you thinking of writing a handler by yourself? What if I tell you, there is already one provided by the web API implementation?</p>
<p>Here is a story about a dumb button. We use a range slider to resize the button. While the button gets resized, we also want to control the text color, without letting the button know much about it. </p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1598717277220/dITL6Nog2.gif?auto=format,compress&amp;gif-q=60" alt="resizer.gif"></p>
<p>First, create a button and specify an id so that, we can access the button later using the id.</p>
<pre><code>&lt;StyledButton id=<span>"dumbBtnId"</span>&gt;
   I am a Dumb Button
&lt;<span>/StyledButton&gt;</span>
</code></pre>
<p>Now we create a slider using the <code>range</code> input type from HTML5. A <code>resize()</code> function is invoked when the slider value changes.</p>
<pre><code>&lt;div&gt;
   <span><span>&lt;<span>input</span> 
         <span>onChange</span>=<span>{(event)</span> =&gt;</span> resize(event)} 
         type="range" 
         min={minRange} 
         max={maxRange} 
         defaultValue={rangeValue} /&gt;
<span>&lt;/<span>div</span>&gt;</span></span>
</code></pre>
<p>The <code>resize()</code> function simply sets the width of the button as the slider range value so that, it can be resized dynamically.</p>
<pre><code><span>const</span> resize = event =&gt; {
   <span>const</span> value = event.target.valueAsNumber;
   setRangeValue(value);
   <span>let</span> dumbBtn = <span>document</span>.getElementById(<span>'dumbBtnId'</span>);
   dumbBtn.style.width = <span>`<span>${value}</span>px`</span>;
 }
</code></pre>
<p>So far, so good? Now for every range value change, the button gets resized. We have a <code>ResizeObserver</code> observing this change and change the color of the button text.</p>
<pre><code>useEffect(() =&gt; {
   <span>try</span> {
            <span>let</span> dumbBtn = <span>document</span>.getElementById(<span>'dumbBtnId'</span>);
            <span>var</span> resizeObserver = <span>new</span> ResizeObserver(entries =&gt; {
                <span>for</span>(<span>const</span> entry <span>of</span> entries) {
                    
                    
                   entry.target.style.color = <span>'green`;
                }
      });
      resizeObserver.observe(dumbBtn);
   } catch(e) {
            setSupported(false);
            console.log(e);      
   }
}, [rangeValue]);</span>
</code></pre>
<p>Direct link to the demo: <a target="_blank" href="https://demo.greenroots.info/web-apis/web-api-resize-observer/">https://demo.greenroots.info/web-apis/web-api-resize-observer/</a></p>
<h2 id="4-image-capture-api">4. üì∑ Image Capture API</h2>
<p>There are some cool and useful APIs around user media like, audio, video etc. I love the <code>Image Capture API</code> which helps us to capture an image or grab a frame from the video devices(like webcam). Not only that, you can also perform actions on capturing an image or grabbing a frame.</p>
<p>First, get the user media access. In this case we are getting the webcam access.</p>
<pre><code>navigator.mediaDevices.getUserMedia({video: <span>true</span>})
  .then(mediaStream =&gt; {
     <span>document</span>.querySelector(<span>'video'</span>).srcObject = mediaStream;
     <span>const</span> track = mediaStream.getVideoTracks()[<span>0</span>];
     setTrack(track);
  }).catch(error =&gt; {
     <span>console</span>.error(<span>` <span>${error}</span> is not yet supported`</span>);
     setError(error);
});
</code></pre>
<p>Just like the clipboard paste operation, a webcam media access permission has to be granted by the user.</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1598717565379/MCRNY49Tl.png?auto=format&amp;q=60" alt="image.png"></p>
<p>Now Grab a frame and do something. In this example, I am just drawing the frame on a Canvas.</p>
<pre><code><span>const</span> imageCapture = <span>new</span> ImageCapture(track);
    imageCapture.grabFrame()
      .then(imageBitmap =&gt; {
          <span>const</span> canvas = <span>document</span>.querySelector(<span>'#grabFrameCanvas'</span>);
          drawCanvas(canvas, imageBitmap);
    }).catch(error =&gt; {
          <span>console</span>.log(error);
          setError(error);
});
</code></pre>
<p>I can also take a picture and do the similar thing.</p>
<pre><code><span>const</span> imageCapture = <span>new</span> ImageCapture(track);
    imageCapture.takePhoto().then(blob =&gt; createImageBitmap(blob))
      .then(imageBitmap =&gt; {
          <span>const</span> canvas = <span>document</span>.querySelector(<span>'#takePhotoCanvas'</span>);
          drawCanvas(canvas, imageBitmap);
    }).catch(error =&gt; {
          <span>console</span>.log(error);
          setError(error);
});
</code></pre>
<p>To stop the video streaming from the webcam, just call he method <code>stop()</code> on the running video track.</p>
<pre><code><span>const</span> videoOff = () =&gt; {
   track.stop();
 }
</code></pre>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1598717833234/MPOxVZ92M.png?auto=format&amp;q=60" alt="chrome_Umvi16wUlu.png"></p>
<p>Also watch out for the methods,</p>
<ul>
<li><code>getPhotoCapabilities()</code>: To get the ranges of available configuration options.</li>
<li><code>getPhotoSettings()</code>: To get the current photo configuration settings.</li>
</ul>
<p>Direct link to the demo: <a target="_blank" href="https://demo.greenroots.info/web-apis/web-apis-image-capture/">https://demo.greenroots.info/web-apis/web-apis-image-capture/</a></p>
<h2 id="5-broadcast-channel-api">5. üì° Broadcast Channel API</h2>
<p>The <code>Broadcast Channel API</code> allows communication between browsing contexts (windows, tabs, iframes) and workers on the <strong>same origin</strong>. Think of a use-case like, once you logout from an app running in a browser tab, you want to broadcast it to the app instances opened in other tabs of the same browser.</p>
<p>Here is an example where a sender is sending a message to the receiver and the same is being ‚Ä¶</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://blog.greenroots.info/10-lesser-known-web-apis-you-may-want-to-use-ckejv75cr012y70s158n85yhn">https://blog.greenroots.info/10-lesser-known-web-apis-you-may-want-to-use-ckejv75cr012y70s158n85yhn</a></em></p>]]>
            </description>
            <link>https://blog.greenroots.info/10-lesser-known-web-apis-you-may-want-to-use-ckejv75cr012y70s158n85yhn</link>
            <guid isPermaLink="false">hacker-news-small-sites-24350647</guid>
            <pubDate>Wed, 02 Sep 2020 06:44:09 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[A round-up of topology-based papers at ICML 2020]]>
            </title>
            <description>
<![CDATA[
Score 74 | Comments 3 (<a href="https://news.ycombinator.com/item?id=24350436">thread link</a>) | @Topolomancer
<br/>
September 1, 2020 | https://bastian.rieck.me/blog/posts/2020/icml_topology_roundup/ | <a href="https://web.archive.org/web/*/https://bastian.rieck.me/blog/posts/2020/icml_topology_roundup/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
        <p>With this year‚Äôs <a href="https://icml.cc/Conferences/2020">International Conference on Machine Learning&nbsp;(ICML)</a>
being over, it is time to have another instalment of this series.
Similar to <a href="http://bastian.rieck.me/blog/posts/2019/icml_tda_roundup/">last year‚Äôs post</a>, I shall cover
several papers that caught my attention because of their use of
topological concepts‚Äîhowever, <em>unlike</em> last year, I shall not
restrict the selection to papers using <a href="https://en.wikipedia.org/wiki/Topological_data_analysis">topological data analysis&nbsp;(TDA)</a>.</p>
<p><strong>Caveat lector:</strong> I might have missed some promising papers. Any
suggestions for additions are more than welcome! Please reach out
to me via <a href="https://twitter.com/Pseudomanifold">Twitter</a> or
<a href="mailto:bastian@rieck.me">e-mail</a>.</p>

<div>
<figure>
    <img src="https://bastian.rieck.me/images/icml20_chen.png" alt="Learning Flat Latent Manifolds with VAEs" width="500"> 
</figure>

</div>
<p><a href="https://arxiv.org/abs/2002.04881">Learning Flat Latent Manifolds with VAEs</a>
by <a href="https://argmax.ai/team/nutan-chen">Nutan Chen</a>, <a href="https://www.argmax.ai/team/alexej-klushyn">Alexej Klushyn</a>,
Francesco Ferroni, <a href="http://bayerj.github.io/">Justin Bayer</a>, and
<a href="https://argmax.ai/team/patrick-van-der-smagt">Patrick van der Smagt</a>
discusses an interesting modification of variational autoencoders, viz.
an extended loss term that regularises the latent space to be
<em>flat</em>&nbsp;(i.e. having no <a href="https://en.wikipedia.org/wiki/Curvature">curvature</a>).
The main idea is to ensure that the <a href="https://en.wikipedia.org/wiki/Metric_tensor">Riemannian metric tensor</a>
is the identity matrix.</p>
<p>The ingenious implication of such a latent space is that the Euclidean
distance is a good proxy for the similarity between data points, whereas
this is <em>not</em> a priori the case for other latent spaces. It is interesting
to note that there is a ‚Äòsibling‚Äô paper to this one, which was published
at ICLR 2020, namely <a href="https://openreview.net/pdf?id=S1g6xeSKDS">Mixed-curvature Variational Autoencoders</a>.
This paper presents an autoencoder whose latent space is a product of
Riemannian manifolds, whose curvature is either fixed or learnable.</p>
<p>I am glad to see that curvature is starting to attract more attention
from the machine learning community. It is such a fundamental property
of a manifold but can influence the validity of many calculations in
latent spaces. It also has some beneficial properties for <a href="https://openreview.net/pdf?id=BylEqnVFDB">graph
classification</a>, but this is
maybe a better topic for a subsequent post!</p>

<div>
<figure>
    <img src="https://bastian.rieck.me/images/icml20_hoferb.png" alt="Graph Filtration Learning" width="500"> 
</figure>

</div>
<p><a href="https://arxiv.org/abs/1905.10996">Graph Filtration Learning</a> by
<a href="https://www.researchgate.net/profile/Christoph_Hofer8">Christoph Hofer</a>,
<a href="https://www.uni-salzburg.at/index.php?id=213185&amp;L=1">Florian Graf</a>,
<a href="https://bastian.rieck.me/">Bastian Rieck</a>,
<a href="http://wwwx.cs.unc.edu/~mn/?q=content/overview">Marc Niethammer</a>, and
<a href="https://rkwitt.github.io/">Roland Kwitt</a> is arguably<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup> the first step
towards properly integrating topological features into neural networks
for graph classification! Briefly put, we developed a homological
<code>READOUT</code> function&nbsp;(to use the parlance of graph neural networks)
that gives rise to a learnable filter function‚Äîa <em>filtration</em>.</p>
<p>This concept might be unknown to some readers, but a filtration in this
context is a scalar-valued function on the vertices of a graph that
permits <em>sorting</em> it. Filtrations serve as the backbone for many
topology-based algorithms, primarily for the aforementioned <a href="https://christian.bock.ml/posts/persistent_homology/">persistent homology</a>,
which permits us to study multi-scale topological
features&nbsp;(connected components, cycles, etc.) of an object.
Prior to this paper, filtrations were pre-defined or chosen based on
some target function, such as the vertex degree function of a graph. Our
approach changes this‚Äîleading to a filtration that is learnable in an
end-to-end fashion and thus specifically designed for a classification
problem.</p>
<p>We manage to achieve this by first initialising our filter function
based on a regular graph neural network; essentially, one level of
message passing between nodes is sufficient. This provides us with
a non-trivial filter function whose performance we can subsequently
adjust by calculating the topological features induced by said filter,
and vectorising the resulting representations. Since each of these steps
is differentiable<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup>, the resulting function is also differentiable,
making it possible to adjust the filter for the best classification
results.</p>
<p>I would recommend this paper to anyone who is interested in learning
more about the benefits that a topology-based perspective brings to
certain application problems. Being able to learn the <em>right</em> topological features
to classify a set of graphs opens up exciting opportunities.</p>

<div>
<figure>
    <img src="https://bastian.rieck.me/images/icml20_hofera.png" alt="Topologically Densified Distribution" width="500"> 
</figure>

</div>
<p><a href="https://arxiv.org/abs/2002.04805">Topologically Densified Distributions</a>
by <a href="https://www.researchgate.net/profile/Christoph_Hofer8">Christoph Hofer</a>,
<a href="https://www.uni-salzburg.at/index.php?id=213185&amp;L=1">Florian Graf</a>,
<a href="http://wwwx.cs.unc.edu/~mn/?q=content/overview">Marc Niethammer</a>, and
<a href="https://rkwitt.github.io/">Roland Kwitt</a> studies regularisation properties of
over-parametrised neural networks in the context of small sample-size learning.
This is achieved by studying the properties of latent
representations&nbsp;(the paper uses the term <em>internal representation</em>,
but this is equivalent). More precisely, generalisation properties are
analysed via the <a href="https://en.wikipedia.org/wiki/Pushforward_measure">push-forward probability measure</a>
induced by the latent representation&nbsp;(or <em>encoding</em>).</p>
<p>The authors show that probability mass concentration around training
samples in the latent space is linked to the generalisation capabilities
of a model, but, even more exciting, such a concentration can be achieved by applying
topological constraints on samples from that space! In the context of
this paper, such constraints pertain to measuring the <em>connectivity</em> of
samples. This is achieved using <a href="https://christian.bock.ml/posts/persistent_homology/">persistent homology</a>, specifically,
by calculating a zero-dimensional Vietoris‚ÄìRips complex‚Äîif you are
not familiar with this term, just think of a minimum spanning tree.</p>
<p>What I particularly enjoyed about this paper is that it starts providing
solid answers to fundamental concepts in machine learning. All too often,
we remain in the realm of the empirical and just <em>observe</em> whether our
network generalises. This paper ventures into hitherto-unknown territories
and gives us a theoretical justification!</p>

<div>
<figure>
    <img src="https://bastian.rieck.me/images/icml20_moor.png" alt="Topological Autoencoders" width="250"> 
</figure>

</div>
<p><a href="https://arxiv.org/abs/1906.00722">Topological Autoencoders</a> by
<a href="https://michaelmoor.ml/">Michael Moor</a>,
<a href="https://expectationmax.github.io/">Max Horn</a>,
<a href="https://bastian.rieck.me/">Bastian Rieck</a>, and
<a href="https://bsse.ethz.ch/mlcb/karsten.html">Karsten Borgwardt</a> deals with
regularising the latent space in terms of its topology. More precisely,
we preserve the topological features of the input data in the respective
latent space&nbsp;(on the batch level, respectively). While we restrict
our experiments to connected components for now&nbsp;(so no cycles
yet, even though our method generalises to higher dimensions),
our approach makes it possible to create latent representations
that ‚Äòmimic‚Äô the topological features of the input.</p>
<p>This leads to a nice plug-and-play loss term that can be easily
integrated into most architectures, and we can demonstrate that, among
others, it considerably improves the quality of a ‚Äòvanilla‚Äô autoencoder
architecture. To achieve this goal, we had to solve all kinds of
interesting adventures, one of them being how to make everything
differentiable. Interestingly, we end up with a similar necessary
condition for differentiability than for the graph filtration learning
paper, viz. the pairwise distances between different samples of the
input batch need to be <em>unique</em>.</p>
<p>The coolest feature of our method is that it technically <em>only</em> requires
a distance metric between input samples<sup id="fnref:3"><a href="#fn:3" role="doc-noteref">3</a></sup>, nothing more‚Äîno feature
vector representation or anything. It can thus conceivably be used to
represent the topology of any object you fancy&nbsp;(including
documents, images, and graphs).</p>
<p>If you are interested in a beautifully-animated high-level introduction
to this publication, you should take the time to read Michael‚Äôs <a href="https://michaelmoor.ml/blog/topoae/main/">blog post on our paper</a>.</p>

<div>
<figure>
    <img src="https://bastian.rieck.me/images/icml20_rezende.png" alt="Normalizing Flows on Tori and Spheres" width="500"> 
</figure>

</div>
<p><a href="https://arxiv.org/abs/2002.02428">Normalizing Flows on Tori and Spheres</a> by
<a href="https://danilorezende.com/">Danilo Jimenez Rezende</a>,
<a href="https://gpapamak.github.io/">George Papamakarios</a>,
<a href="https://scholar.google.com/citations?user=o-h0vrQAAAAJ">S√©bastien Racani√®re</a>,
<a href="http://malbergo.me/">Michael S. Albergo</a>,
<a href="https://scholar.google.com/citations?user=zK77P6MAAAAJ">Gurtej Kanwar</a>,
<a href="https://web.mit.edu/physics/people/faculty/shanahan_phiala.html">Phiala E.  Shanahan</a>,
and <a href="http://theoryandpractice.org/">Kyle Cranmer</a>
present a novel method for calculating normalising flows on more complex
spaces than the usual Euclidean ones. Specifically, as the title
implies, they develop methods for calculating such flows on tori and
spheres.</p>
<p>What I enjoyed about this paper is the smart way of constructing flows
iteratively: first, flows on the circle are being constructed&nbsp;(using
different concepts for defining a <a href="https://en.wikipedia.org/wiki/Diffeomorphism">diffeomorphism</a>, the most favourite of
mine being a <a href="https://en.wikipedia.org/wiki/M%C3%B6bius_transformation">M√∂bius transformation</a>).
Since a torus can be described as the Cartesian product of circles, this
is sufficient to describe flows on tori of arbitrary dimensions! Next,
the flows are generalised to higher-dimensional spheres.</p>
<p>While I am by no means and expert in normalising flows, I liked
reading this paper a lot. The theory is well-developed and it is another
one of those publications that shows you how to go beyond the boundaries
of what is currently possible. Moreover, I enjoyed the discussion of the
implementation details‚Äîit turns out that achieving numerical stability
here is another feat that deserves some mention!</p>

<p>This year‚Äôs ICML also featured an interesting array of topology-based
papers. Not all of them fit neatly into the field of topological data
analysis&nbsp;(TDA), but I am happy to see that the community is
starting to pick up this fundamental topic. I remain convinced that
a topology-driven perspective is needed to answer certain foundational
questions in machine learning. Here‚Äôs to the future of topology!</p>
<section role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>Even if say so myself. <a href="#fnref:1" role="doc-backlink">‚Ü©Ô∏é</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>Under mild assumptions, viz. provided that the filter function
values are unique for each vertex. This can always be achieved by
a small symbolic perturbation. <a href="#fnref:2" role="doc-backlink">‚Ü©Ô∏é</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>Practically, it might not even require the properties of a metric,
although the mathematician in me is screaming at the horrors of this
thought. <a href="#fnref:3" role="doc-backlink">‚Ü©Ô∏é</a></p>
</li>
</ol>
</section>

      </div></div>]]>
            </description>
            <link>https://bastian.rieck.me/blog/posts/2020/icml_topology_roundup/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24350436</guid>
            <pubDate>Wed, 02 Sep 2020 06:03:30 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The problem with C according to a C++ developer]]>
            </title>
            <description>
<![CDATA[
Score 18 | Comments 12 (<a href="https://news.ycombinator.com/item?id=24349256">thread link</a>) | @eatonphil
<br/>
September 1, 2020 | https://cor3ntin.github.io/posts/c/ | <a href="https://web.archive.org/web/*/https://cor3ntin.github.io/posts/c/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
      <p><img src="https://cor3ntin.github.io/posts/c/fight.jpeg" alt="Fish"></p>
<p>In the early 70s, C was created at Bell Labs as a byproduct of the development of UNIX.
It quickly became one of the most popular programming languages.
But it was not expressive enough for Bjarne Stroustrup.
And so, in 1983, as a byproduct of his Ph.D. thesis, he extended C.</p>
<p>C with classes was born.</p>
<p>At the time, Bjarne Stroustrup understood that a programming language has many components,
not only the language, its compiler, but also a linker and libraries.
Offering a familiar tool also makes adoption easier.
In this historical context, it makes sense that C++ would be based on C.</p>
<p>Fast-forward 40 years later.</p>
<p>Both C and C++ are widely used in the industry.
But go 5 minutes on the Internet and C developers will tell you that C++ is the most horrific man-made creation,
while many C++ developers wait for the day when C finally burns in the hot flames of hell.</p>
<h2 id="so-what-happened">So what happened?</h2>
<p>On the surface, C and C++ cater to the same use cases: high performance, deterministic, native but portable code for the widest range of hardware and applications.</p>
<p>But C is proudly a low-level language. A nicer assembly.</p>
<p>From day one, C++ had magic. Dark witchcraft: destructors. Suddenly the compiler was doing things on its own.
It also had type inference very early on, but the developers of the mid-80s were not quite ready for that and Bjarne Stroustrup
was pressured into removing <code>auto</code>, until it was added back to C++11.</p>
<p>From then, C++ got more and more tools to build abstractions.
I don‚Äôt think it would be fair to say that C++ is a low-level or high-level language. It‚Äôs both, by design.
But building high-level abstractions while not sacrificing performance is hard.
C++ then needed tools to achieve that: <code>constexpr</code>, move semantics, templates, and an ever-growing standard library.</p>
<p>Fundamentally I think C trusts developers while C++ trusts compilers.
This is a massive difference that sharing the same native types or syntax for while loop cannot hide.</p>
<p>C++ developers blame C for all their lost limbs, while C developers probably think C++ is batshit crazy.
I imagine that is a fair perspective if you look at C++ through a C lense. C++ is pretty wild <em>as a superset of C</em>.
A seasoned C person looking at C++ expecting familiarity in C++ will not find it. C++ is not C.
This is enough to feed flamewars for generations.</p>
<p>But as much as I dislike C, I don‚Äôt have any legitimacy to make fun of it. See, I have some experience with C++ but I
wrote very little C. It was probably bad C.
A language is also its good practices, patterns, idioms, and these take years to learn. If you try to write C code like it‚Äôs C++ or C++ like it is C, you will have a bad time.
Knowing <a href="https://www.youtube.com/watch?v=YnWhqhNdYyk">C doesn‚Äôt teach you C++</a>. Knowing C++ does not teach you C.</p>
<p>So can we all stop saying C/C++, regret the unfortunate naming, and sing kumbaya in harmony?
Not so fast.</p>
<p>See, despite being philosophically different from C, C++ is still somewhat a superset of C.
That is to say, you can include a C header in a C++ translation unit and that should compile.
And this is where it gets messy.</p>
<p>C++ is not an extension of C.
It is designed as a separate standard, by a different committee, different people.
Logically, people who like C++'s philosophy will get involved in the C++ community and the C++ standardization process
while other people might try to get involved with C.
Committees, whether its C‚Äôs or C++'s, only manifest intent and direction through their respective end-product: the standards; standards which are the fruits of numerous voting.</p>
<p>At the same time, it is difficult for a compiler to know that it is dealing with a C header or a C++ header.</p>
<p><code>extern "C"</code> is not used consistently and only affects mangling, but neither grammar nor semantics.
And headers only exists in the eyes of the preprocessor, for a C++ compiler, everything is a C++ translation unit, and therefore C++.
And yet, people include C headers in C++ and expect it to ‚Äújust work‚Äù ‚Ñ¢Ô∏è.
Which it mostly does.</p>
<p>We can wonder then,</p>
<h2 id="how-c-maintains-c-compatibility-while-being-developed-by-different-people-in-different-places">How C++ maintains C compatibility while being developed by different people in different places?</h2>
<p>Badly, I‚Äôm afraid.</p>
<p>A coworker recently reminded me of Conway‚Äôs law:</p>
<blockquote>
<p>Any organization that designs a system (defined broadly) will produce a design whose structure is a copy of the organization‚Äôs communication structure</p>
</blockquote>
<p>By that logic, it would stand to reason that if the two committees don‚Äôt interoperate,
neither would the languages they produce.</p>
<p>C++ maintains a list of <a href="http://eel.is/c++draft/diff.iso">incompatibilities with C</a> and <a href="http://eel.is/c++draft/diff.library">its standard library</a>.
This list does not seem to reflect the many features that were added to C11 and C18 but are not valid C++ constructs. <a href="https://en.wikipedia.org/wiki/Compatibility_of_C_and_C%2B%2B">Wikipedia</a> draws a clearer picture.</p>
<p>Listing incompatibilities isn‚Äôt sufficient to get a measure of incompatibilities between both languages.</p>
<p>Functions that exist in the C++ standard library but whose primary declaration is expected to come from C are difficult to make <code>constexpr</code>, and more difficult still to make <code>noexcept</code>.
C compatibility translates to performance costs and C functions are optimization barriers.</p>
<p>Many C constructs are valid C++ but should never pass a code review (<code>NULL</code>, <code>longjmp</code>, <code>malloc</code>, create/destroy functions, <code>free</code>, C  casts), etc.</p>
<p>These might not be bad C idioms, but they are bad C++. C++ has a stronger type system,
and unfortunately using C idioms punch a giant hole in that type system, and so C compatibility has a cost in terms of safety.</p>
<p>Don‚Äôt get me wrong, C++ still care about C compatibility. Somewhat.
And interestingly C cares about C++. Somewhat.
Truth be told, C might care about C++ more than C++ cares about C.
So each committee cares somewhat about what the other does.
We care reluctantly.</p>
<p>See, C++ is aware of the many foundational libraries written in C, not only the <code>libc</code> but also <code>zip</code>, <code>png</code>, <code>curl</code>, <code>openssl</code> (!), and countless others, which are used in many, many C++ projects.
We can‚Äôt break that.</p>
<p>But recently, especially over the past decade, C++ has become much bigger than C.
C++ has more users - and a much more active community: <a href="https://nullprogram.com/blog/2018/11/21/">There Are No C Conferences</a>.
Maybe that‚Äôs why the C++ committee is now over 10 times the size of the C committee.</p>
<p>C++ then is a force to be reckoned with and the C committee has to consider not breaking C++.
To the point that if a standard would track another, these days, C++ leads and C follow.</p>
<p>C++ is now on a steady three years cycle come rain or shine, or deadly pandemics.
Meanwhile, C has a major release every decade or so.
This makes sense. As a lower-level language, C doesn‚Äôt need to evolve as fast.</p>
<p>The C landscape is also rather different from the C++ landscape.
C caters to more platforms and a lot more compilers.
Everybody and their dog is writing C compilers because the language has a surface area small enough to make that possible, whereas the C++ committee will only really consider 4 implementations, all of which are represented at every meeting.
As a result, many features in C are implementation-defined or optionally supported so that the variety of compilers that exist can claim conformance without doing much work, which I‚Äôm told pleases regulatory bodies.</p>
<p>C++ these days is more interested in portability than implementation freedom. Yet another difference of philosophy.</p>
<h2 id="so-your-proposal-breaks-c-compatibility">So, your proposal breaks C compatibility</h2>
<p>Parts of my <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2020/p2178r1.pdf">P2178</a> paper theoretically affects C compatibility.
In such cases, none of the options seems satisfactory.</p>
<p>You could be told that you have to first get your feature into C. Which means more meetings.
Meetings you might not be able to attend because C has strict <a href="https://thephd.github.io/follow-the-river-wg14-ithaca-2019">attendance rules</a> - Excluding individuals not willing to put down thousands of dollars to become ISO members.
This is because the C committee is forced to adhere strictly to ISO rules.</p>
<p>It might also take a decade if the standard just shipped.
And most importantly, it might go nowhere if the C committee doesn‚Äôt understand or doesn‚Äôt care about the particular problem you are trying to solve.
And they probably don‚Äôt have the bandwidth to deal with it.
And you may not have the bandwidth to deal with C. After all, you joined C++ to improve C++.
In fact, if the room invites you to ‚Äútalk to the C committee‚Äù, it is likely your proposal is dead, even in the unlikely event that no one in the room was against it.</p>
<p>Another likely scenario is that the C committee accepts a version of a proposal that is slightly different from what exists in C++.
<code>true</code>? Let‚Äôs make that a macro. <code>char16_t</code> ? Let‚Äôs make that a typedef. <code>char32_t</code>? Not necessarily UTF-32. <code>static_assert</code> ? <code>_Static_assert</code>.</p>
<p>The list goes on. Should we blame C? Probably not. Their committee does what they think is best for their language.
The opposite is true too. In C++20 designated initializers were inspired by C‚Äôs but are slightly different because they would otherwise not fit with the C++ initialization rules.</p>
<p>I am part of the problem. C has VLAs. I would vote against a proposal to adopt that in standard C++, <a href="https://www.phoronix.com/scan.php?page=news_item&amp;px=Linux-Kills-The-VLA">too many security issues</a>. A proposal to add <code>_Generic</code> to C++ would be over-my-dead-body. I am not sure if <code>_Generic</code> attempts to palliate to the lack of template or the lack of overloads, but C++ has both these features - from my point of view <code>_Generic</code> doesn‚Äôt fit into the big picture of what I imagine C++ to be.</p>
<p>Both committees seem also inconsistent in how much they care about the other language.
Sometimes we go to great lenghts (<a href="https://en.cppreference.com/w/cpp/numeric/complex">std::complex</a>), sometimes we don‚Äôt care at all (<a href="https://en.cppreference.com/w/c/language/array">static array parameters</a>).</p>
<p>There is no way around this. Don‚Äôt forget that each committee is a bunch of people
voting at different times in different rooms and trying to control the outcome would defeat the purpose
of having a vote.
Putting people in the same room is not realistic either. ISO might object and the participation inbalance
would put C people at an enormous disadvantage.</p>
<h2 id="c-compatibility-doesnt-matter-kinda">C compatibility doesn‚Äôt matter, kinda</h2>
<p>If you are a C developer, I imagine you see C as a neat programming language.
But for the rest of us, C is something else.</p>
<p>C is the universal, cross-language glue that ties it all together.</p>
<p>For C++ users, C is ‚Ä¶</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://cor3ntin.github.io/posts/c/">https://cor3ntin.github.io/posts/c/</a></em></p>]]>
            </description>
            <link>https://cor3ntin.github.io/posts/c/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24349256</guid>
            <pubDate>Wed, 02 Sep 2020 01:53:46 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[NeoAxis Game Engine 2020.5]]>
            </title>
            <description>
<![CDATA[
Score 53 | Comments 10 (<a href="https://news.ycombinator.com/item?id=24348494">thread link</a>) | @IvanEfimov
<br/>
September 1, 2020 | https://www.neoaxis.com/news/neoaxis_engine_2020_5_released | <a href="https://web.archive.org/web/*/https://www.neoaxis.com/news/neoaxis_engine_2020_5_released">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
    <div>
          <div><p>NeoAxis company releases a new version of NeoAxis Engine, an integrated development environment with built-in 3D and 2D game engine. The environment can be used to develop all kinds of 3D and 2D projects such as computer games, visual trainers, VR systems, to visualize processes and develop windowed applications.</p>
<p>In this release, the engine has been translated to .NET Core 3.1 from .NET Framework, has been added support for Visual Studio Code, Rider and other C# IDEs, the editor has been improved and optimized, in the launcher you can now create Window App projects, also examples of creating add-ons have been added to the Assets\Samples\Addons folder.</p>
<p><a href="https://www.neoaxis.com/images/2020_5/NeoAxis_2020_5_ScifiDemo.png"><img src="https://www.neoaxis.com/images/2020_5/NeoAxis_2020_5_ScifiDemo.jpg" alt="" width="900"></a></p>
<h2>.NET Core 3.1</h2>
<p>In this release, the engine was upgraded to .NET Core 3.1, previously .NET Framework 4.6 was used. This gave a performance improvement. The engine and editor are noticeably faster. Now the created application does not require .NET installation, it is included into the project. It is also now easy to update the project to newer versions of .NET such as .NET 5.</p>
<h2>Support for Visual Studio Code, Rider and other C# IDEs</h2>
<p>Project compilation is now supported using any IDE that supports C# and .NET Core 3.1.</p>
<h2>Window app creation</h2>
<p>The ability to create windowed applications has been improved. When creating a new project, you can choose a Window App template, with which you can set the initial settings. The engine includes its own GUI system and GUI designer. This allows you to create full-fledged windowed applications, however, creating of windowed applications is still a new feature of NeoAxis.</p>
<p><a href="https://www.neoaxis.com/images/2020_5/NeoAxis_2020_5_GUIEditor.png"><img src="https://www.neoaxis.com/images/2020_5/NeoAxis_2020_5_GUIEditor.png" alt="" width="600"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_4/NeoAxisEngine_2020_4_Windowed_Apps.png"><img src="https://www.neoaxis.com/images/2020_4/NeoAxisEngine_2020_4_Windowed_Apps.png" alt="" width="600"></a></p>
<h2>Editor improvements</h2>
<p>The editor has improved the work with windows and the performance. In total, the editor is now a user-friendly, polished application.</p>
<p><a href="https://www.neoaxis.com/images/2020_5/NeoAxis_2020_5_StartPage.png"><img src="https://www.neoaxis.com/images/2020_5/NeoAxis_2020_5_StartPage.png" alt="" width="600"></a></p>
<h2>Changelog</h2>
<p>Full changelog:</p>
<ul>
<li>Switch to .NET Core 3.1 from .NET Framework 4.6. It works faster. Now you can easy upgrade your project to latest .NET as example to .NET 5.0.</li>
<li>Support for Visual Studio Code, Rider and other C# IDEs.</li>
<li>More polished GUI of the editor. Made very big amount of improvements and fixes.</li>
<li>Much better performance of the engine and the editor.</li>
<li>Better compilation support for built-in editor Project.csproj when run NeoAxis Player while the editor is loaded.</li>
<li>UWP build support has been simplified.</li>
<li>The examples of creation add-ons for the editor now available in Assets\Samples\Addons.</li>
<li>The template for window app creation has been added to the Launcher.</li>
<li>Component classes have been updated for better cross-platform support. System.Windows.Form.dll, System.Drawing.dll now are not used by the project DLLs (NeoAxis.CoreExtension.dll, Project.dll, add-ons).</li>
<li>NeoAxis.Core.dll now has no references to another DLLs. It made easier to manage references for libraries because need just one reference to core DLL.</li>
</ul>
<h2>More screenshots</h2>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_CharacterScene.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_CharacterScene.jpg" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_NatureDemo.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_NatureDemo.jpg" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2019_3/NeoAxisEngine_NatureDemo01.jpg"><img src="https://www.neoaxis.com/images/2019_3/NeoAxisEngine_NatureDemo01.jpg" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2019_3/NeoAxisEngine_NatureDemo02.jpg"><img src="https://www.neoaxis.com/images/2019_3/NeoAxisEngine_NatureDemo02.jpg" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2019_3/NeoAxisEngine_NatureDemo03.jpg"><img src="https://www.neoaxis.com/images/2019_3/NeoAxisEngine_NatureDemo03.jpg" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_Builder3D.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_Builder3D.png" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_CSharpEditor.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_CSharpEditor.png" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_Character2D.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_Character2D.png" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_Spaceship2D.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_Spaceship2D.jpg" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_MaterialEditor.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_MaterialEditor.png" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_MaterialScript.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_MaterialScript.png" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_RenderTargetIn3D.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_RenderTargetIn3D.jpg" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_ShaderEditor.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_ShaderEditor.png" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_ScreenSpaceEffect.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_ScreenSpaceEffect.png" alt="" width="900"></a></p>
<p><a href="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_UIEditor.png"><img src="https://www.neoaxis.com/images/2020_3/NeoAxis_2020_3_UIEditor.png" alt="" width="900"></a></p>
<h2>See also</h2>
<ul>
<li><a href="https://www.neoaxis.com/neoaxis/overview">Overview of NeoAxis Engine</a></li>
<li><a href="https://www.neoaxis.com/neoaxis/downloads">Download</a></li>
<li><a href="https://www.neoaxis.com/neoaxis/roadmap">Roadmap</a></li>
<li><a href="https://www.neoaxis.com/support/changelog">Changelog</a></li>
</ul>
</div>
      </div>
</div></div>]]>
            </description>
            <link>https://www.neoaxis.com/news/neoaxis_engine_2020_5_released</link>
            <guid isPermaLink="false">hacker-news-small-sites-24348494</guid>
            <pubDate>Tue, 01 Sep 2020 23:51:57 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Zstandard]]>
            </title>
            <description>
<![CDATA[
Score 25 | Comments 10 (<a href="https://news.ycombinator.com/item?id=24348394">thread link</a>) | @gjvc
<br/>
September 1, 2020 | http://facebook.github.io/zstd/#other-languages | <a href="https://web.archive.org/web/*/http://facebook.github.io/zstd/#other-languages">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
      <div>
        <!-- <h1><img src="images/zstd.png"/> Zstandard</h1> -->
        
        
        <p>
        Zstandard is a real-time compression algorithm,
        providing high compression ratios.
        It offers a very wide range of compression / speed trade-off,
        while being backed by a very fast decoder (see <a href="#benchmarks">benchmarks</a> below).
        It also offers a special mode for small data, called <a href="#small-data">dictionary compression</a>,
        and can create dictionaries from any sample set.
        Zstandard library is provided as open source software using a BSD license.
      </p></div>
    </div></div>]]>
            </description>
            <link>http://facebook.github.io/zstd/#other-languages</link>
            <guid isPermaLink="false">hacker-news-small-sites-24348394</guid>
            <pubDate>Tue, 01 Sep 2020 23:38:40 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Build Your Own Flight Tracking Application with Python and Open Air Traffic Data]]>
            </title>
            <description>
<![CDATA[
Score 16 | Comments 0 (<a href="https://news.ycombinator.com/item?id=24347545">thread link</a>) | @rbanffy
<br/>
September 1, 2020 | https://www.geodose.com/2020/08/create-flight-tracking-apps-using-python-open-data.html | <a href="https://web.archive.org/web/*/https://www.geodose.com/2020/08/create-flight-tracking-apps-using-python-open-data.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="post-body-3508679137719749308" itemprop="articleBody">
<div>
  <p>
    Tracking position of something is a topic that I like, cause it makes me
    feel like to be a human with a sixth sense. With this sense I know where an
    object is and how it moves, in spite of&nbsp; I can't see the object
    directly with my naked eyes. Then how do we get a sixth sense? Because as
    ordinary human we only have five senses.<br>
  </p>
  <p>
    In my opinion, living in this digital age today, we already had a sixth
    sense which is called technology that implemented in an application. Related
    with our topic in this post about flight tracking, there are numerous flight
    tracking applications out there such as flightradar24, FlightAware,
    flightview and so on, which enabled us to monitor position of airplanes
    around the earth. This post won't discuss about those applications, moreover
    I will discuss how to make our own flight tracking application with
    python.&nbsp; <br>
  </p>
  <p>
    Previously I already posted two tutorials about flight tracking with python.
    The first one is about
    <a href="https://www.geodose.com/2018/11/create-simple-live-flight-tracking-python.html">creating a simple flight tracking application with python</a>
    and the another one is
    <a href="https://www.geodose.com/2019/01/realtime-flight-tracking-pandas-bokeh-python.html">creating a flight tracking application with pandas and bokeh</a>. What is the difference with this one? The main difference is data source.
    In those two previous posts, I used
    <a href="https://www.adsbexchange.com/#" rel="nofollow" target="_blank">ADS-B Exchange</a>
    and in this tutorial I'm using
    <a href="https://opensky-network.org/" rel="nofollow" target="_blank">Opensky Network</a>. Another difference is module version. In this tutorial I'm using the
    latest version python library in particular for plotting library. So there
    will be a slight change in the code.
  </p>
  <p>
    Enough for introduction. Now let's move to our main topic how to build a
    flight tracking application with python using open air traffic data. This
    tutorial consists of several sub-topics, there are: Getting data, importing
    required libraries, loading basemap, plotting aircraft's position and make a
    "realtime" flight tracking application. We will discuss each part, and at
    the end of this tutorial we will get a flight tracking application which is
    running in a browser as shown in figure 1.
  </p>
  <table>
    <tbody>
      <tr>
        <td>
          <a href="https://1.bp.blogspot.com/-tSyKLdFep0E/X0VBBYNiezI/AAAAAAAACO8/6OIv1ixWmv80xGQAHUHCl1ntvVjUjvQjACNcBGAsYHQ/s913/flight_track_sf_bridge.gif"><img alt="Flight Tracking Application" data-original-height="505" data-original-width="913" height="354" src="https://1.bp.blogspot.com/-tSyKLdFep0E/X0VBBYNiezI/AAAAAAAACO8/6OIv1ixWmv80xGQAHUHCl1ntvVjUjvQjACNcBGAsYHQ/w640-h354/flight_track_sf_bridge.gif" title="Flight Tracking Application" width="640"></a>
        </td>
      </tr>
      <tr>
        <td>
          Figure 1. Flight Tracking Application <br>
        </td>
      </tr>
    </tbody>
  </table>
  <br>
</div><h3>Getting Air Traffic Data

<ins data-ad-client="ca-pub-5632482621101280" data-ad-format="fluid" data-ad-layout="in-article" data-ad-slot="7655392618"></ins>
</h3>
<p>
  As I mentioned earlier, in this tutorial we are using open air traffic data
  from OpenSky Network. OpenSky Network is an non-profit consortium that
  provides open air traffic data to the public in particular for research and
  non-commercial purposes. The data can be accessed through REST API, Python API
  and Java API. In this tutorial we will use REST API to retrieve the live air
  traffic data.
</p>
<p>
  To retrieve the data using REST API can be done using request operation. There
  are two types of requests can be used. The first one is request for specific
  airplane based on time in UNIX timestamp or ICAO24 address. The second one we
  can get all airplane data within an area extent using WGS84 coordinates
  system. Moreover the access for the data can be done anonymously or registered
  user. For anonymously request, it has 10 seconds resolution and 5 seconds for
  registered user. <br>
</p>
<p>
  In this tutorial we will use the second one. We will define an area extent
  with minimum and maximum coordinates, and then send the query to get all
  airplane data within the area. For example we want to fetch the data over United States
  with minimum coordinate -125.974,30.038 and maximum coordinate -68.748,52.214. The query for both anonymously and registered user will be as follow.
</p>
<pre><span>#</span>Anonymously Request
https:<span>//</span>opensky<span>-</span>network.org<span>/</span>api<span>/</span>states<span>/</span><span>all</span><span>?</span>lamin<span>=30.038</span><span>&amp;</span>lomin<span>=-125.974</span><span>&amp;</span>&nbsp;</pre>
<pre>lamax<span>=52.214</span><span>&amp;</span>lomax<span>=-68.748</span><span></span>

<span>#</span>Registered User Request
https:<span>//</span>username:password<span>@</span>opensky<span>-</span>network.org<span>/</span>api<span>/</span>states<span>/</span><span>all</span><span>?</span>lamin<span>=</span><span>30.038</span><span>&amp;</span>lomin<span>=-125.974</span><span>&amp;</span>&nbsp;</pre>
<pre>lamax<span>=52.214</span><span>&amp;</span>lomax<span>=</span><span>-68.748</span><span></span></pre>
<p>
  Before continuing reading and to make sure the query is right, let's try it.
  Copy the anonymously query and paste into a browser. If you get a response
  like figure 2 below, then it works.&nbsp; <br>
</p>

<table>
  <tbody>
    <tr>
      <td>
        <a href="https://1.bp.blogspot.com/-GQiKB2PwkgA/X0XYeIYjduI/AAAAAAAACPI/mbTmJBtuWlUAcE2ThpbaiE6N5i8bAjaJwCNcBGAsYHQ/s1005/flight-data-response.png"><img alt="Air traffic data response" data-original-height="550" data-original-width="1005" height="350" src="https://1.bp.blogspot.com/-GQiKB2PwkgA/X0XYeIYjduI/AAAAAAAACPI/mbTmJBtuWlUAcE2ThpbaiE6N5i8bAjaJwCNcBGAsYHQ/w640-h350/flight-data-response.png" title="Air traffic data response" width="640"></a>
      </td>
    </tr>
    <tr>
      <td>
        Figure 2. Air traffic data response<br>
      </td>
    </tr>
  </tbody>
</table>
<p>
  The return response as shown in figure 2 is in JSON structure with two keys.
  The first one is <i>time </i>and the second one is <i>States</i> that contains
  data for each airplane in a list array. The list array stores many data such
  as: ICAO24 address, airplane call sign, origin country, time position, last
  contact, longitude, latitude, barometer altitude and so on. For complete
  explanation about the data response and also further information about OpenSky
  Network API please refer to
  <a href="https://www.geodose.com/2020/08/OpenSky%20Network%20API" rel="nofollow" target="_blank">OpenSky Network API Documentation</a>. &nbsp; &nbsp;
</p>
<h3>Getting Air Traffic Data in Python</h3>

<p>
  We already retrieved the traffic data using REST API in a browser. Now let's
  do it in Python and process the response for the next purpose. For this
  tutorial I'm using Jupyter notebook with Python 3.8.2 and some libraries such
  as Bokeh 2.1.1, Pandas 0.25.3, requests, json and numpy. <br>
</p>
<p>
  Below is the code to make a request and do a little processing on the
  data. At the beginning, we import the required libraries such as requests,
  json and Pandas. Then define the extent coordinate in WGS84 with respective
  variable <i>lon_min,lat_min, lon_max and lat_max</i>.&nbsp; Based on the
  extent coordinate, make the request query. If you are a registered user, give
  the user name and password in <i>user_name</i> and <i>password</i> variable at
  line 11-12. Based on given extent coordinate and user data, we create a
  request query in <i>url_data</i> variable as in line 13 and get the response
  in json format. The remain of the code is used to dump the response data into
  Pandas data frame and replace the blank/empty data with 'NaN' value with 'No
  Data'. The last line which is data frame's <i>head</i> method is used to view
  the first 5 top row of the data as shown in figure 3. &nbsp;
</p>
<!--HTML generated using hilite.me-->
<div>
  <table>
    <tbody>
      <tr>
        <td>
          <pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre>
        </td>
        <td>
          <pre><span>#IMPORTING LIBRARY</span>
<span>import</span> <span>requests</span>
<span>import</span> <span>json</span>
<span>import</span> <span>pandas</span> <span>as</span> <span>pd</span>

<span>#AREA EXTENT COORDINATE WGS4</span>
<span>lon_min,lat_min</span><span>=-</span><span>125.974</span><span>,</span><span>30.038</span>
<span>lon_max,lat_max</span><span>=-</span><span>68.748</span><span>,</span><span>52.214</span>

<span>#REST API QUERY</span>
<span>user_name</span><span>=</span><span>''</span>
<span>password</span><span>=</span><span>''</span>
<span>url_data</span><span>=</span><span>'https://'</span><span>+</span><span>user_name</span><span>+</span><span>':'</span><span>+</span><span>password</span><span>+</span><span>'@opensky-network.org/api/states/all?'</span><span>+</span><span>'lamin='</span><span>+</span><span>str</span><span>(lat_min)</span><span>+</span><span>'&amp;lomin='</span><span>+</span><span>str</span><span>(lon_min)</span><span>+</span><span>'&amp;lamax='</span><span>+</span><span>str</span><span>(lat_max)</span><span>+</span><span>'&amp;lomax='</span><span>+</span><span>str</span><span>(lon_max)</span>
<span>response</span><span>=</span><span>requests</span><span>.</span><span>get(url_data)</span><span>.</span><span>json()</span>

<span>#LOAD TO PANDAS DATAFRAME</span>
<span>col_name</span><span>=</span><span>[</span><span>'icao24'</span><span>,</span><span>'callsign'</span><span>,</span><span>'origin_country'</span><span>,</span><span>'time_position'</span><span>,</span><span>'last_contact'</span><span>,</span><span>'long'</span><span>,</span><span>'lat'</span><span>,</span><span>'baro_altitude'</span><span>,</span><span>'on_ground'</span><span>,</span><span>'velocity'</span><span>,</span>       
<span>'true_track'</span><span>,</span><span>'vertical_rate'</span><span>,</span><span>'sensors'</span><span>,</span><span>'geo_altitude'</span><span>,</span><span>'squawk'</span><span>,</span><span>'spi'</span><span>,</span><span>'position_source'</span><span>]</span>
<span>flight_df</span><span>=</span><span>pd</span><span>.</span><span>DataFrame(response[</span><span>'states'</span><span>],columns</span><span>=</span><span>col_name)</span>
<span>flight_df</span><span>=</span><span>flight_df</span><span>.</span><span>fillna(</span><span>'No Data'</span><span>)</span> <span>#replace NAN with No Data</span>
<span>flight_df</span><span>.</span><span>head()</span>
</pre>
        </td>
      </tr>
    </tbody>
  </table>
</div>


<table>
  <tbody>
    <tr>
      <td>
        <a href="https://1.bp.blogspot.com/-Q1EDtS-EWFk/X0aYM-IA2DI/AAAAAAAACPU/TiqV96inP1MaPXA28FtTa0m_WqEwqXN_ACNcBGAsYHQ/s871/response_data_pandas.png"><img alt="Flight tracking data frame" data-original-height="136" data-original-width="871" height="100" src="https://1.bp.blogspot.com/-Q1EDtS-EWFk/X0aYM-IA2DI/AAAAAAAACPU/TiqV96inP1MaPXA28FtTa0m_WqEwqXN_ACNcBGAsYHQ/w640-h100/response_data_pandas.png" title="Flight tracking data frame" width="640"></a>
      </td>
    </tr>
    <tr>
      <td>
        Figure 3. Flight tracking data frame<br>
      </td>
    </tr>
  </tbody>
</table>
&nbsp;
<p>Make sure after executing the code, you have a result as in figure 3. If you
  get it, it means everything is fine, and we have the data that will be used
  for the next step.</p><h3>Plotting Airplane on the Map</h3>
<p>
  After getting the data, now let's plot the location of all airplanes on a
  map.&nbsp; For plotting purpose, we are using Bokeh library. Therefore we need
  to import the library first. Additionally we also need to import NumPy library
  that will be used in coordinate conversion.
</p>
<p>
  The conversion of coordinate system is implemented in a function which is
  called <i>wgs84_web_mercator</i>_. As it's name this function will be used to
  transform WGS84 coordinate into web Mercator coordinate system. This
  transformation is required because we are using a
  <i>STAMEN_TERRAIN</i> basemap in a web browser that has web Mercator
  projection (EPSG: 3857).
</p>
<p>
  After creating coordinate conversion function and perform the transformation
  for data frame and extent coordinates. Next we set up plotting figure settings
  by specifying plotting area extent based on the range of x and y coordinates.
  The aircraft will be plotted on the basemap based on x and y coordinates with
  Points and also with airplane icon image. Why both point and image are used to plot
  the aircraft? Image will give a better visualization by using an airplane
  image and it can be rotated with the respective track angle. But unfortunately it
  can't&nbsp; high light a selected object and display more information with
  hover tool. To overcome this issue we use both image and point in circle
  object to get nice a visualization and enable selection and hovering tool.
  &nbsp; <br>
</p>
<p>
  The following is the code until this step. If it is
  executed we will get a result as in figure 4.&nbsp; <br>
</p>
<!--HTML generated using hilite.me-->
<div>
  <table>
    <tbody>
      <tr>
        <td>
          <pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre>
        </td>
        <td>
          <pre><span>#IMPORT PLOTTING LIBRARIES</span>
<span>from</span> <span>bokeh.plotting</span> <span>import</span> <span>figure,</span> <span>show</span>
<span>from</span> <span>bokeh.tile_providers</span> <span>import</span> <span>get_provider,STAMEN_TERRAIN</span>
<span>from</span> <span>bokeh.models</span> <span>import</span> <span>HoverTool,LabelSet,ColumnDataSource</span>
<span>import</span> <span>numpy</span> <span>as</span> <span>np</span>

<span>#FUNCTION TO CONVERT GCS WGS84 TO WEB MERCATOR</span>
<span>#POINT</span>
<span>def</span> <span>wgs84_web_mercator_point(lon,lat):</span>
    <span>k</span> <span>=</span> <span>6378137</span>
    <span>x</span><span>=</span> <span>lon</span> <span>*</span> <span>(k</span> <span>*</span> <span>np</span><span>.</span><span>pi</span><span>/</span><span>180.0</span><span>)</span>
    <span>y</span><span>=</span> <span>np</span><span>.</span><span>log(np</span><span>.</span><span>tan((</span><span>90</span> <span>+</span> <span>lat)</span> <span>*</span> <span>np</span><span>.</span><span>pi</span><span>/</span><span>360.0</span><span>))</span> <span>*</span> <span>k</span>
    <span>return</span> <span>x,y</span>

<span>#DATA FRAME</span>
<span>def</span> <span>wgs84_to_web_mercator(df,</span> <span>lon</span><span>=</span><span>"long"</span><span>,</span> <span>lat</span><span>=</span><span>"lat"</span><span>):</span>
    <span>k</span> <span>=</span> <span>6378137</span>
    <span>df[</span><span>"x"</span><span>]</span> <span>=</span> <span>df[lon]</span> <span>*</span> <span>(k</span> <span>*</span> <span>np</span><span>.</span><span>pi</span><span>/</span><span>180.0</span><span>)</span>
    <span>df[</span><span>"y"</span><span>]</span> <span>=</span> <span>np</span><span>.</span><span>log(np</span><span>.</span><span>tan((</span><span>90</span> <span>+</span> <span>df[lat])</span> <span>*</span> <span>np</span><span>.</span><span>pi</span><span>/</span><span>360.0</span><span>))</span> <span>*</span> <span>k</span>
    <span>return</span> <span>df</span>

<span>#COORDINATE CONVERSION</span>
<span>xy_min</span><span>=</span><span>wgs84_web_mercator_point(lon_min,lat_min)</span>
<span>xy_max</span><span>=</span><span>wgs84_web_mercator_point(lon_max,lat_max)</span>
<span>wgs84_to_web_mercator(flight_df)</span>
<span>flight_df[</span><span>'rot_angle'</span><span>]</span><span>=</span><span>flight_df[</span><span>'true_track'</span><span>]</span><span>*-</span><span>1</span> <span>#Rotation angle</span>
<span>icon_url</span><span>=</span><span>'https://.....' </span><span>#Icon url</span>
<span>flight_df[</span><span>'url'</span><span>]</span><span>=</span><span>icon_url</span>


<span>#FIGURE SETTING</span>
<span>x_range,y_range</span><span>=</span><span>([xy_min[</span><span>0</span><span>],xy_max[</span><span>0</span><span>]],</span> <span>[xy_min[</span><span>1</span><span>],xy_max[</span><span>1</span><span>]])</span>
<span>p</span><span>=</span><span>figure(x_range</span><span>=</span><span>x_range,y_range</span><span>=</span><span>y_range,x_axis_type</span><span>=</span><span>'mercator'</span><span>,y_axis_type</span><span>=</span><span>'mercator'</span><span>,sizing_mode</span><span>=</span><span>'scale_width'</span><span>,plot_height</span><span>=</span><span>300</span><span>)</span>

<span>#PLOT BASEMAP AND AIRPLANE POINTS</span>
<span>flight_source</span><span>=</span><span>ColumnDataSource(flight_df)</span>
<span>tile_prov</span><span>=</span><span>get_provider(STAMEN_TERRAIN)</span>
<span>p</span><span>.</span><span>add_tile(tile_prov,level</span><span>=</span><span>'image'</span><span>)</span>
<span>p</span><span>.</span><span>image_url(url</span><span>=</span><span>'url'</span><span>,</span> <span>x</span><span>=</span><span>'x'</span><span>,</span> <span>y</span><span>=</span><span>'y‚Ä¶</span></pre></td></tr></tbody></table></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://www.geodose.com/2020/08/create-flight-tracking-apps-using-python-open-data.html">https://www.geodose.com/2020/08/create-flight-tracking-apps-using-python-open-data.html</a></em></p>]]>
            </description>
            <link>https://www.geodose.com/2020/08/create-flight-tracking-apps-using-python-open-data.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24347545</guid>
            <pubDate>Tue, 01 Sep 2020 21:52:24 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Book Summary: 48 Laws of Power by Robert Greene. The Full List with Notes]]>
            </title>
            <description>
<![CDATA[
Score 20 | Comments 1 (<a href="https://news.ycombinator.com/item?id=24347088">thread link</a>) | @laybak
<br/>
September 1, 2020 | https://knowledgeartist.org/book/48-laws-power-robert-greene | <a href="https://web.archive.org/web/*/https://knowledgeartist.org/book/48-laws-power-robert-greene">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
          <p><h2><span>Overall Thoughts</span></h2></p> <p><span>48 Laws of Power is a collection of tactics for attaining power in various domains in life. It may come off as amoral, and some of the tricks outlined in the book are shady to say the least. It is a tough pill to swallow. But it is an informative and engaging book, if you read it without value judgement. Less of a wholesome guide on how to live life, more of a disappassionate analysis of ways to obtain power. And here's the way the author Robert Greene himself puts it: "I'm not evil. I'm a realist."</span></p>  <p><h2><span>Summary</span></h2></p> <p><span>Below is the the list of the 48 laws detailed in the book, along with any important notes.</span></p> <p><h3><span>Law 1: Never outshine the master</span></h3></p> <p><strong>Make your masters appear more brilliant than they are</strong> <span> and you will attain the heights of power.</span></p> <p><span>As you try to impress your masters, do not go too far in displaying your talents. Otherwise, you will inspire fear and insecurity.</span></p>  <p><h3><span>Law 2: Never put too much trust in friends, learn how to use enemies</span></h3></p> <p><span>Be wary of friends. </span> <strong>You have more to fear from friends than from enemies</strong> <span>. If you have no enemies, find a way to make them.</span></p> <p><span>Friends will betray you more quickly, as envy makes things tricky. But hire a former enemy and he will be more loyal than a friend, because he has more to prove. </span></p>  <p><h3><span>Law 3: Conceal your intentions</span></h3></p> <p><strong>Keep people off-balance and in the dark.</strong> <span> Never reveal the purpose behind your actions. </span></p> <p><span>Hide your intentions not by closing up but&nbsp;</span> <strong>by talking endlessly about your desires and goals (just not your real ones)</strong> <span>. These are smoke screens that can disguise your actions.</span></p> <p><span>If they have no clue what you are up to, they cannot prepare a defense. </span></p>  <p><h3><span>Law 4: Always say less than necessary</span></h3></p> <p><strong>The more you say, the more common you appear</strong> <span>, and the less in control. Even if you are saying something banal, it will seem original if you make it vague, open-ended, and sphinxlike.</span></p> <p><span>You can't take back words once they are out. Keep them under control. The more you say, the more likely you are to say something foolish. </span></p>  <p><h3><span>Law 5: So much depends on reputation. Guard it with your life</span></h3></p> <p><strong>Through reputation alone you can intimidate and win</strong> <span>. It is the foundation of power.</span></p> <p><span>Always be alert to potential attacks and thwart them before they happen. Meanwhile, </span> <strong>learn to destroy your enemies by opening holes in their own reputations</strong> <span>. Then stand aside and let public opinion hang them. Doubt is a powerful weapon.</span></p>  <p><h3><span>Law 6: Court attention at all cost</span></h3></p> <p><strong>Stand out. Be conspicuous, at all cost</strong> <span>. It is better to be attacked than be ignored, for what is unseen counts for nothing. Never let yourself get lost in the crowd or buried in oblivion. Attach your name and reputation to an image larger, more colorful, and mysterious than other people.</span></p>  <p><h3><span>Law 7: Get others to do the work for you, but always take the credit</span></h3></p> <p><strong>Use other people to further your own cause</strong> <span>. It saves you valuable time and resources. Never do yourself what others can do for you. Your helpers wil lbe forgotten, and you will be remembered. </span></p>  <p><h3><span>Law 8: Make other people come to you. Use bait if necessary</span></h3></p> <p><span>It is always wise to </span> <strong>make your opponent come to you</strong> <span>, and have them abandon their own plans in the process. Fight the battle on your turf. When you force the other person to act, you are the one in control. Lure them into your territory with a potential victory, then attack. </span></p>  <p><h3><span>Law 9: Win through your actions, never through an argument</span></h3></p> <p><span>Any short-lived victory you think you gain through argument is an illusion, as resentment builds up. It is more powerful to get other people to agree with you through your actions, instead of your words. </span></p> <p><span>Show, don't tell. </span></p>  <p><h3><span>Law 10: Infection: Avoid the unhappy and unlucky</span></h3></p> <p><strong>The unfortunate sometimes draw misfortune on themselves.</strong> <span> They will also draw it on you. Don't try to help an infector, or you will pay the price. Helping the drowning man only sets you up for a disaster. You can die from someone else‚Äôs misery.</span></p>  <p><h3><span>Law 11: Learn to keep people dependent on you</span></h3></p> <p><span>Make people depend on you for their happiness and prosperity. Teach a man how to&nbsp;fish&nbsp;and you feed him for his life time. Don't. To maintain your independence you must always be needed and wanted. </span></p>  <p><h3><span>Law 12: Use selective honesty and generosity to disarm your victim</span></h3></p> <p><strong>One sincere and honest move will cover over dozens of dishonest ones</strong> <span>. Even the most suspicious people can be disarmed with gestures of generosity and honesty. Once they let their guard down, you can manipulate them at will.</span></p>  <p><h3><span>Law 13: When asking for help, appeal to people‚Äôs self-interest, never to their mercy or gratitude</span></h3></p> <p><span>No notes.</span></p>  <p><h3><span>Law 14: Pose as a friend, work as a spy</span></h3></p> <p><span>Know your enemies. Learn to probe for other people's weaknesses and intentions. Every occasion is an opoprtunity to spy. </span></p>  <p><h3><span>Law 15: Crush your enemy totally</span></h3></p> <p><span>No notes.</span></p>  <p><h3><span>Law 16: Use absence to increase respect and honor</span></h3></p> <p><strong>The more you are seen and heard from, the more common you appear</strong> <span>. You must learn when to leave. Create value through scarcity.</span></p>  <p><h3><span>Law 17: Keep others in suspended terror: Cultivate an air of unpredictability</span></h3></p> <p><strong>Be deliberately unpredictable</strong> <span>. Patterns are powerful, and you can keep others off-balance by disrupting the predictability. They will wear themselves out trying to explain your moves. </span></p>  <p><h3><span>Law 18: Do not build fortresses to protect yourself. Isolation is dangerous</span></h3></p> <p><span>No notes.</span></p>  <p><h3><span>Law 19: Know who you‚Äôre dealing with. Do not offend the wrong person</span></h3></p> <p><span>Not everyone will react to your actions the same way. There are so many different kinds of people after all. Pick your battles, choose your rivals carefully.</span></p>  <p><h3><span>Law 20: Do not commit to anyone</span></h3></p> <p><span>No notes.</span></p>  <p><h3><span>Law 21: Play a sucker to catch a sucker. Seem dumber than your mark</span></h3></p> <p><span>Make your victims feel smart. Make them feel smarter than you are. Once they believe this is true, they will not be able to detect your ulterior motives.</span></p>  <p><h3><span>Law 22: Use the surrender tactic: transform weakness into power</span></h3></p> <p><strong>Surrender first</strong> <span>. Turn the other cheek.  Resist the temptation to fight back for honor's sake. That will throw off the aggressor.</span></p>  <p><h3><span>Law 23: Concentrate your forces</span></h3></p> <p><span>Focus. Intensity is the name of the game. Don't spread your energy too thin.</span></p>  <p><h3><span>Law 24: Play the perfect courtier
</span></h3></p> <p><span>Practice flattery and nonchalance. Yield to those who are more powerful. Assert power over others in the most graceful manner. Master your emotions. Never be the bearer of bad news.</span></p>  <p><h3><span>Law 25: Recreate yourself
</span></h3></p> <p><span>Take control over your own image, or others will. Forge a new identity that commands attention. </span></p>  <p><h3><span>Law 26: Keep your hands clean
</span></h3></p> <p><span>Hide your mistakes, or use a scapegoat to conceal your involvement. You must maintain a flawless appearance.</span></p>  <p><h3><span>Law 27: Play on people‚Äôs need to believe to create a cultlike following
</span></h3></p> <p><span>Keep it vague, but full of promise. Promote passion over rationality. </span></p>  <p><h3><span>Law 28: Enter action with boldness
</span></h3></p> <p><strong>Timidity is dangerous</strong> <span>. People admire the bold.</span></p>  <p><h3><span>Law 29: Plan all the way to the end
</span></h3></p> <p><span>No notes.</span></p>  <p><h3><span>Law 30: Make your accomplishments seem effortless
</span></h3></p> <p><strong>Act effortlessly, as if you could do much more</strong> <span>. </span></p>  <p><h3><span>Law 31: Control the options. Get others to play with the cards you deal
</span></h3></p> <p><span>Rig the game. Change the playing field in your favour. Your opponents will get a false sense of control, but you will come out on top regardless of which option they choose.</span></p>  <p><h3><span>Law 32: Play to people‚Äôs fantasies
</span></h3></p> <p><span>Life is tough. People want to believe there is something or someone to blame. Give them what they want.</span></p>  <p><h3><span>Law 33: Discover each man‚Äôs thumbscrew
</span></h3></p> <p><strong>Everyone has a weakness, a gap in the castle wall</strong> <span>. Once you find it, you can turn it to your advantage. What other people can't control, you control for them.</span></p>  <p><h3><span>Law 34: Be royal in your own fashion: Act like a king to be treated like one
</span></h3></p> <p><span>No notes.</span></p>  <p><h3><span>Law 35: Master the art of timing
</span></h3></p> <p><span>Always appear patient and in control. You never want to be seen to be in a hurry. </span></p>  <p><h3><span>Law 36: Disdain things you cannot have: Ignoring them is the best revenge
</span></h3></p> <p><span>No notes.</span></p>  <p><h3><span>Law 37: Create compelling spectacles
</span></h3></p> <p><span>Create spectacles for the people around you. This creates the aura of power around you.</span></p>  <p><h3><span>Law 38: Think as you like but behave like others
</span></h3></p> <p><span>No notes.</span></p>  <p><h3><span>Law 39: Stir up waters to catch fish
</span></h3></p> <p><span>Never be angry or emotionally stirred, for they are counter-productive. However, if you can make your rivals angry while remaining calm yourself, it is a huge advantage. </span></p>  <p><h3><span>Law 40: Despise the free lunch
</span></h3></p> <p><strong>Pay the full price, as there is no cutting corners with excellence.</strong></p>  <p><h3><span>Law 41: Avoid stepping into a great man‚Äôs shoes
</span></h3></p> <p><span>Getting lost in a great man's shadow is a dangerous trap. Build a name for yourself, on your terms. Tread your own path.</span></p>  <p><h3><span>Law 42: Strike the shepherd and the sheep will scatter
</span></h3></p> <p><span>Trouble can usually be traced to a single source. If you let them be, they will infect the group with their ill will. Get rid of them before giving them the chance to do so.</span></p>  <p><h3><span>Law 43: Work on the hearts and minds of others
</span></h3></p> <p><span>Play on what people fear, and dropping their guards by playing on what they hold dear. Don't coerce. Go along with what others' emotions.</span></p>  <p><h3><span>Law 44: Disarm and infuriate with the mirror effect
</span></h3></p> <p><span>The mirror effect: </span> <strong>By holding up a mirror to their psyches, you seduce them with the illusion that you share their values</strong> <span>. This is powerful, and few can resist it.</span></p>  <p><h3><span>Law 45: Preach the need for change, but never reform too much at once
</span></h3></p> <p><span>No notes.</span></p>  <p><h3><span>Law 46: Never appear too perfect
</span></h3></p> <p><span>Envy is dangerous. One way to to eliminate envy is to </span> <strong>appear human and relatable</strong> <span>. It is wise to appear vulnerable and admit to defects occasionally.</span></p>  <p><h3><span>Law 47: Do not go past the mark you aimed for. In victory, learn when to stop
</span></h3></p> <p><span>Leave on a high note. Don't let hubris blind you and trap you into pushing past what you had aimed for. When you reach a goal, stop. "Stop gain" is just as important as "stop loss".</span></p>  <p><h3><span>Law 48: Assume formlessness
</span></h3></p> <p><strong>By taking a shape, you open yourself to attack</strong> <span>. Instead, remain adaptable, remain on your toes. Accept that change is the only constant. Be like water. </span></p>        


          
          <p><em>Each week, I send out a newsletter where I share my learnings, new ways to see things, and new ways to feel.</em></p>
          <p><em>Enter your ‚Ä¶</em></p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://knowledgeartist.org/book/48-laws-power-robert-greene">https://knowledgeartist.org/book/48-laws-power-robert-greene</a></em></p>]]>
            </description>
            <link>https://knowledgeartist.org/book/48-laws-power-robert-greene</link>
            <guid isPermaLink="false">hacker-news-small-sites-24347088</guid>
            <pubDate>Tue, 01 Sep 2020 21:09:13 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Transit Costs Project]]>
            </title>
            <description>
<![CDATA[
Score 108 | Comments 40 (<a href="https://news.ycombinator.com/item?id=24346681">thread link</a>) | @plc95
<br/>
September 1, 2020 | https://transitcosts.com/about/ | <a href="https://web.archive.org/web/*/https://transitcosts.com/about/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to retrieve article]]>
            </description>
            <link>https://transitcosts.com/about/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24346681</guid>
            <pubDate>Tue, 01 Sep 2020 20:30:27 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Best Practices for Testing in Java (2019)]]>
            </title>
            <description>
<![CDATA[
Score 92 | Comments 64 (<a href="https://news.ycombinator.com/item?id=24346195">thread link</a>) | @moks
<br/>
September 1, 2020 | https://phauer.com/2019/modern-best-practices-testing-java/ | <a href="https://web.archive.org/web/*/https://phauer.com/2019/modern-best-practices-testing-java/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><section>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#tldr">TL;DR</a></li>
    <li><a href="#general">General</a>
      <ul>
        <li><a href="#given-when-then">Given, When, Then</a></li>
        <li><a href="#use-the-prefixes-actual-and-expected">Use the Prefixes ‚Äúactual*‚Äù and ‚Äúexpected*‚Äù</a></li>
        <li><a href="#use-fixed-data-instead-of-randomized-data">Use Fixed Data Instead of Randomized Data</a></li>
      </ul>
    </li>
    <li><a href="#write-small-and-specific-tests">Write Small and Specific Tests</a>
      <ul>
        <li><a href="#heavily-use-helper-functions">Heavily Use Helper Functions</a></li>
        <li><a href="#dont-overuse-variables">Don‚Äôt Overuse Variables</a></li>
        <li><a href="#dont-extend-existing-tests-to-just-test-one-more-tiny-thing">Don‚Äôt Extend Existing Tests To ‚ÄúJust Test One More Tiny Thing‚Äù</a></li>
        <li><a href="#assert-only-what-you-want-to-test">Assert Only What You Want to Test</a></li>
      </ul>
    </li>
    <li><a href="#self-contained-tests">Self-Contained Tests</a>
      <ul>
        <li><a href="#dont-hide-the-relevant-parameters-in-helper-functions">Don‚Äôt Hide the Relevant Parameters (in Helper Functions)</a></li>
        <li><a href="#insert-test-data-right-in-the-test-method">Insert Test Data Right In The Test Method</a></li>
        <li><a href="#favor-composition-over-inheritance">Favor Composition Over Inheritance</a></li>
      </ul>
    </li>
    <li><a href="#dumb-tests-are-great-compare-the-output-with-hard-coded-values">Dumb Tests Are Great: Compare the Output with Hard-Coded Values</a>
      <ul>
        <li><a href="#dont-reuse-production-code">Don‚Äôt Reuse Production Code</a></li>
        <li><a href="#dont-rewrite-production-logic">Don‚Äôt Rewrite Production Logic</a></li>
        <li><a href="#dont-write-too-much-logic">Don‚Äôt Write Too Much Logic</a></li>
      </ul>
    </li>
    <li><a href="#test-close-to-the-reality">Test Close To The Reality</a>
      <ul>
        <li><a href="#focus-on-testing-a-complete-vertical-slide">Focus on Testing A Complete Vertical Slide</a></li>
        <li><a href="#dont-use-in-memory-databases-for-tests">Don‚Äôt Use In-Memory Databases For Tests</a></li>
      </ul>
    </li>
    <li><a href="#javajvm">Java/JVM</a>
      <ul>
        <li><a href="#use--noverify--xxtieredstopatlevel1">Use -noverify -XX:TieredStopAtLevel=1</a></li>
        <li><a href="#use-assertj">Use AssertJ</a></li>
        <li><a href="#avoid-asserttrue-and-assertfalse">Avoid assertTrue() and assertFalse()</a></li>
        <li><a href="#use-junit5">Use JUnit5</a>
          <ul>
            <li><a href="#use-parameterized-tests">Use Parameterized Tests</a></li>
            <li><a href="#group-the-tests">Group the Tests</a></li>
            <li><a href="#readable-test-names-with-displayname-or-kotlins-backticks">Readable Test Names with @DisplayName or Kotlin‚Äôs Backticks</a></li>
          </ul>
        </li>
        <li><a href="#mock-remote-service">Mock Remote Service</a></li>
        <li><a href="#use-awaitility-for-asserting-asynchronous-code">Use Awaitility for Asserting Asynchronous Code</a></li>
        <li><a href="#no-need-to-bootstrap-di-spring">No Need to Bootstrap DI (Spring)</a></li>
      </ul>
    </li>
    <li><a href="#make-the-implementation-testable">Make The Implementation Testable</a>
      <ul>
        <li><a href="#dont-use-static-access-never-ever">Don‚Äôt Use Static Access. Never. Ever.</a></li>
        <li><a href="#parameterize">Parameterize</a></li>
        <li><a href="#use-constructor-injection">Use Constructor Injection</a></li>
        <li><a href="#dont-use-instantnow-or-new-date">Don‚Äôt Use Instant.now() or new Date()</a></li>
        <li><a href="#separate-asynchronous-execution-and-actual-logic">Separate Asynchronous Execution and Actual Logic</a></li>
      </ul>
    </li>
    <li><a href="#kotlin">Kotlin</a></li>
  </ul>
</nav>


              <p>Maintainable and readable test code is crucial to establish a good test coverage which in turn enables implementing new features and performing refactorings without the fear of breaking something. This post contains many best practices that I collected over the years of writing unit tests and integration tests in Java. It involves modern technologies like JUnit5, AssertJ, Testcontainers, and Kotlin. Some recommendations might be obvious to you, but some might conflict with what you‚Äôve read in books about software development and testing.</p>

              
              <p>
                <img src="https://phauer.com/blog/2019/06-modern-best-practices-testing-java/featured-image-large.png" alt="Modern Best Practices for Testing in Java">
              </p>
              

              
              

<ul>
<li><strong>Write small and specific tests</strong> by heavily using helper functions, parameterized tests, AssertJ‚Äôs powerful assertions, not overusing variables, asserting only what‚Äôs relevant and avoiding one test for all corner cases.</li>
<li><strong>Write self-contained tests</strong> by revealing all relevant parameters, insert data right in the test and prefer composition over inheritance.</li>
<li><strong>Write dumb tests</strong> by avoiding the reuse of production code and focusing on comparing output values with hard-coded values.</li>
<li><strong>KISS &gt; DRY</strong></li>
<li><strong>Test close to production</strong> by focusing on testing a complete vertical slide and avoiding in-memory databases.</li>
<li>JUnit5 and AssertJ are a very good choice.</li>
<li>Invest in a testable implementation by avoiding static access, using constructor injection, using <code>Clocks</code> and separating business logic from asynchronous execution.</li>
</ul>

<h2 id="given-when-then">Given, When, Then</h2>
<p>A test should contain three blocks which are separated by one empty line. Each block of code should be as short as possible. Use subfunctions to shorten these blocks.</p>
<ul>
<li>Given (Input): Test preparation like creating data or configure mocks</li>
<li>When (Action): Call the method or action that you like to test</li>
<li>Then (Output): Execute assertions to verify the correct output or behavior of the action.</li>
</ul>
<div><pre><code data-lang="java"><span>// Do
</span><span></span><span>@Test</span>
<span>public</span> <span>void</span> <span>findProduct</span><span>(</span><span>)</span> <span>{</span>
    <span>insertIntoDatabase</span><span>(</span><span>new</span> <span>Product</span><span>(</span><span>100</span><span>,</span> <span>"Smartphone"</span><span>)</span><span>)</span><span>;</span>

    <span>Product</span> <span>product</span> <span>=</span> <span>dao</span><span>.</span><span>findProduct</span><span>(</span><span>100</span><span>)</span><span>;</span>

    <span>assertThat</span><span>(</span><span>product</span><span>.</span><span>getName</span><span>(</span><span>)</span><span>)</span><span>.</span><span>isEqualTo</span><span>(</span><span>"Smartphone"</span><span>)</span><span>;</span>
<span>}</span>
</code></pre></div><h2 id="use-the-prefixes-actual-and-expected">Use the Prefixes ‚Äúactual*‚Äù and ‚Äúexpected*‚Äù</h2>
<div><pre><code data-lang="java"><span>// Don't
</span><span></span><span>ProductDTO</span> <span>product1</span> <span>=</span> <span>requestProduct</span><span>(</span><span>1</span><span>)</span><span>;</span>

<span>ProductDTO</span> <span>product2</span> <span>=</span> <span>new</span> <span>ProductDTO</span><span>(</span><span>"1"</span><span>,</span> <span>List</span><span>.</span><span>of</span><span>(</span><span>State</span><span>.</span><span>ACTIVE</span><span>,</span> <span>State</span><span>.</span><span>REJECTED</span><span>)</span><span>)</span>
<span>assertThat</span><span>(</span><span>product1</span><span>)</span><span>.</span><span>isEqualTo</span><span>(</span><span>product2</span><span>)</span><span>;</span>
</code></pre></div><p>If you are going to use variables in an equals assertion, prefix the variables with ‚Äúactual‚Äù and ‚Äúexpected‚Äù. This increases the readability and clearifies the intention of the variable. Moreover, it‚Äôs harder to mix them up in the equals assertion.</p>
<div><pre><code data-lang="java"><span>// Do
</span><span></span><span>ProductDTO</span> <span>actualProduct</span> <span>=</span> <span>requestProduct</span><span>(</span><span>1</span><span>)</span><span>;</span>

<span>ProductDTO</span> <span>expectedProduct</span> <span>=</span> <span>new</span> <span>ProductDTO</span><span>(</span><span>"1"</span><span>,</span> <span>List</span><span>.</span><span>of</span><span>(</span><span>State</span><span>.</span><span>ACTIVE</span><span>,</span> <span>State</span><span>.</span><span>REJECTED</span><span>)</span><span>)</span>
<span>assertThat</span><span>(</span><span>actualProduct</span><span>)</span><span>.</span><span>isEqualTo</span><span>(</span><span>expectedProduct</span><span>)</span><span>;</span> <span>// nice and clear.
</span></code></pre></div><h2 id="use-fixed-data-instead-of-randomized-data">Use Fixed Data Instead of Randomized Data</h2>
<p>Avoid randomized data as it can lead to toggling tests which can be hard to debug and omit error messages that make tracing the error back to the code harder.</p>
<div><pre><code data-lang="java"><span>// Don't
</span><span></span><span>Instant</span> <span>ts1</span> <span>=</span> <span>Instant</span><span>.</span><span>now</span><span>(</span><span>)</span><span>;</span> <span>// 1557582788
</span><span></span><span>Instant</span> <span>ts2</span> <span>=</span> <span>ts1</span><span>.</span><span>plusSeconds</span><span>(</span><span>1</span><span>)</span><span>;</span> <span>// 1557582789
</span><span></span><span>int</span> <span>randomAmount</span> <span>=</span> <span>new</span> <span>Random</span><span>(</span><span>)</span><span>.</span><span>nextInt</span><span>(</span><span>500</span><span>)</span><span>;</span> <span>// 232
</span><span></span><span>UUID</span> <span>uuid</span> <span>=</span> <span>UUID</span><span>.</span><span>randomUUID</span><span>(</span><span>)</span><span>;</span> <span>// d5d1f61b-0a8b-42be-b05a-bd458bb563ad
</span></code></pre></div><p>Instead, use fixed values for everything. They will create highly reproducible tests, which are easy to debug and create error messages that can be easily traced back to the relevant line of code.</p>
<div><pre><code data-lang="java"><span>// Do
</span><span></span><span>Instant</span> <span>ts1</span> <span>=</span> <span>Instant</span><span>.</span><span>ofEpochSecond</span><span>(</span><span>1550000001</span><span>)</span><span>;</span>
<span>Instant</span> <span>ts2</span> <span>=</span> <span>Instant</span><span>.</span><span>ofEpochSecond</span><span>(</span><span>1550000002</span><span>)</span><span>;</span>
<span>int</span> <span>amount</span> <span>=</span> <span>50</span><span>;</span>
<span>UUID</span> <span>uuid</span> <span>=</span> <span>UUID</span><span>.</span><span>fromString</span><span>(</span><span>"00000000-000-0000-0000-000000000001"</span><span>)</span><span>;</span>
</code></pre></div><p>You can avoid the increased typing effort by <a href="#heavily-use-helper-functions">using helper functions</a>.</p>

<h2 id="heavily-use-helper-functions">Heavily Use Helper Functions</h2>
<p>Extract details or repetitive code into subfunctions and give them a descriptive name. This is a powerful mean to keep the tests short and the essentials of the test easy to grasp at first glance.</p>
<div><pre><code data-lang="java"><span>// Don't
</span><span></span><span>@Test</span>
<span>public</span> <span>void</span> <span>categoryQueryParameter</span><span>(</span><span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    <span>List</span><span>&lt;</span><span>ProductEntity</span><span>&gt;</span> <span>products</span> <span>=</span> <span>List</span><span>.</span><span>of</span><span>(</span>
            <span>new</span> <span>ProductEntity</span><span>(</span><span>)</span><span>.</span><span>setId</span><span>(</span><span>"1"</span><span>)</span><span>.</span><span>setName</span><span>(</span><span>"Envelope"</span><span>)</span><span>.</span><span>setCategory</span><span>(</span><span>"Office"</span><span>)</span><span>.</span><span>setDescription</span><span>(</span><span>"An Envelope"</span><span>)</span><span>.</span><span>setStockAmount</span><span>(</span><span>1</span><span>)</span><span>,</span>
            <span>new</span> <span>ProductEntity</span><span>(</span><span>)</span><span>.</span><span>setId</span><span>(</span><span>"2"</span><span>)</span><span>.</span><span>setName</span><span>(</span><span>"Pen"</span><span>)</span><span>.</span><span>setCategory</span><span>(</span><span>"Office"</span><span>)</span><span>.</span><span>setDescription</span><span>(</span><span>"A Pen"</span><span>)</span><span>.</span><span>setStockAmount</span><span>(</span><span>1</span><span>)</span><span>,</span>
            <span>new</span> <span>ProductEntity</span><span>(</span><span>)</span><span>.</span><span>setId</span><span>(</span><span>"3"</span><span>)</span><span>.</span><span>setName</span><span>(</span><span>"Notebook"</span><span>)</span><span>.</span><span>setCategory</span><span>(</span><span>"Hardware"</span><span>)</span><span>.</span><span>setDescription</span><span>(</span><span>"A Notebook"</span><span>)</span><span>.</span><span>setStockAmount</span><span>(</span><span>2</span><span>)</span>
    <span>)</span><span>;</span>
    <span>for</span> <span>(</span><span>ProductEntity</span> <span>product</span> <span>:</span> <span>products</span><span>)</span> <span>{</span>
        <span>template</span><span>.</span><span>execute</span><span>(</span><span>createSqlInsertStatement</span><span>(</span><span>product</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>

    <span>String</span> <span>responseJson</span> <span>=</span> <span>client</span><span>.</span><span>perform</span><span>(</span><span>get</span><span>(</span><span>"/products?category=Office"</span><span>)</span><span>)</span>
            <span>.</span><span>andExpect</span><span>(</span><span>status</span><span>(</span><span>)</span><span>.</span><span>is</span><span>(</span><span>200</span><span>)</span><span>)</span>
            <span>.</span><span>andReturn</span><span>(</span><span>)</span><span>.</span><span>getResponse</span><span>(</span><span>)</span><span>.</span><span>getContentAsString</span><span>(</span><span>)</span><span>;</span>

    <span>assertThat</span><span>(</span><span>toDTOs</span><span>(</span><span>responseJson</span><span>)</span><span>)</span>
            <span>.</span><span>extracting</span><span>(</span><span>ProductDTO</span><span>:</span><span>:</span><span>getId</span><span>)</span>
            <span>.</span><span>containsOnly</span><span>(</span><span>"1"</span><span>,</span> <span>"2"</span><span>)</span><span>;</span>
<span>}</span>
</code></pre></div><div><pre><code data-lang="java"><span>// Do
</span><span></span><span>@Test</span>
<span>public</span> <span>void</span> <span>categoryQueryParameter2</span><span>(</span><span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    <span>insertIntoDatabase</span><span>(</span>
            <span>createProductWithCategory</span><span>(</span><span>"1"</span><span>,</span> <span>"Office"</span><span>)</span><span>,</span>
            <span>createProductWithCategory</span><span>(</span><span>"2"</span><span>,</span> <span>"Office"</span><span>)</span><span>,</span>
            <span>createProductWithCategory</span><span>(</span><span>"3"</span><span>,</span> <span>"Hardware"</span><span>)</span>
    <span>)</span><span>;</span>

    <span>String</span> <span>responseJson</span> <span>=</span> <span>requestProductsByCategory</span><span>(</span><span>"Office"</span><span>)</span><span>;</span>

    <span>assertThat</span><span>(</span><span>toDTOs</span><span>(</span><span>responseJson</span><span>)</span><span>)</span>
            <span>.</span><span>extracting</span><span>(</span><span>ProductDTO</span><span>:</span><span>:</span><span>getId</span><span>)</span>
            <span>.</span><span>containsOnly</span><span>(</span><span>"1"</span><span>,</span> <span>"2"</span><span>)</span><span>;</span>
<span>}</span>
</code></pre></div><ul>
<li>Use helper functions for creating data (objects) (<code>createProductWithCategory()</code>) and complex assertions. Only pass those parameters to the helper functions that are relevant for your tests. Use reasonable defaults for the other values. In Kotlin, this is easy by using default arguments. In Java, you have to use method chaining and overloading to simulate default arguments.</li>
<li>varargs can make your test code even more concise (<code>√¨nsertIntoDatabase()</code>).</li>
<li>Helper functions can also be used to create simple values more easily. This is even nicer in Kotlin where you can use extension functions for this.</li>
</ul>
<div><pre><code data-lang="java"><span>// Do (Java)
</span><span></span><span>Instant</span> <span>ts</span> <span>=</span> <span>toInstant</span><span>(</span><span>1</span><span>)</span><span>;</span> <span>// Instant.ofEpochSecond(1550000001)
</span><span></span><span>UUID</span> <span>id</span> <span>=</span> <span>toUUID</span><span>(</span><span>1</span><span>)</span><span>;</span> <span>// UUID.fromString("00000000-0000-0000-a000-000000000001")
</span></code></pre></div><div><pre><code data-lang="kotlin"><span>// Do (Kotlin)
</span><span></span><span>val</span> <span>ts</span> <span>=</span> <span>1.</span><span>toInstant</span><span>(</span><span>)</span>
<span>val</span> <span>id</span> <span>=</span> <span>1.</span><span>toUUID</span><span>(</span><span>)</span>
</code></pre></div><p>The helper functions could be implemented in Kotlin like this:</p>
<div><pre><code data-lang="kotlin"><span>fun</span> <span>Int</span><span>.</span><span>toInstant</span><span>(</span><span>)</span><span>:</span> <span>Instant</span> <span>=</span> <span>Instant</span><span>.</span><span>ofEpochSecond</span><span>(</span><span>this</span><span>.</span><span>toLong</span><span>(</span><span>)</span><span>)</span>

<span>fun</span> <span>Int</span><span>.</span><span>toUUID</span><span>(</span><span>)</span><span>:</span> <span>UUID</span> <span>=</span> <span>UUID</span><span>.</span><span>fromString</span><span>(</span><span>"00000000-0000-0000-a000-${this.toString().padStart(11, '0')}"</span><span>)</span>
</code></pre></div><h2 id="dont-overuse-variables">Don‚Äôt Overuse Variables</h2>
<p>A usual reflex of a developer is to extract values that are used multiple times to variables.</p>
<div><pre><code data-lang="java"><span>// Don't
</span><span></span><span>@Test</span>
<span>public</span> <span>void</span> <span>variables</span><span>(</span><span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    <span>String</span> <span>relevantCategory</span> <span>=</span> <span>"Office"</span><span>;</span>
    <span>String</span> <span>id1</span> <span>=</span> <span>"4243"</span><span>;</span>
    <span>String</span> <span>id2</span> <span>=</span> <span>"1123"</span><span>;</span>
    <span>String</span> <span>id3</span> <span>=</span> <span>"9213"</span><span>;</span>
    <span>String</span> <span>irrelevantCategory</span> <span>=</span> <span>"Hardware"</span><span>;</span>
    <span>insertIntoDatabase</span><span>(</span>
            <span>createProductWithCategory</span><span>(</span><span>id1</span><span>,</span> <span>relevantCategory</span><span>)</span><span>,</span>
            <span>createProductWithCategory</span><span>(</span><span>id2</span><span>,</span> <span>relevantCategory</span><span>)</span><span>,</span>
            <span>createProductWithCategory</span><span>(</span><span>id3</span><span>,</span> <span>irrelevantCategory</span><span>)</span>
    <span>)</span><span>;</span>

    <span>String</span> <span>responseJson</span> <span>=</span> <span>requestProductsByCategory</span><span>(</span><span>relevantCategory</span><span>)</span><span>;</span>

    <span>assertThat</span><span>(</span><span>toDTOs</span><span>(</span><span>responseJson</span><span>)</span><span>)</span>
            <span>.</span><span>extracting</span><span>(</span><span>ProductDTO</span><span>:</span><span>:</span><span>getId</span><span>)</span>
            <span>.</span><span>containsOnly</span><span>(</span><span>id1</span><span>,</span> <span>id2</span><span>)</span><span>;</span>
<span>}</span>
</code></pre></div><p>Unfortunately, this significantly bloats the test code. Moreover, given a test failure message, it‚Äôs harder to trace the value back to the relevant line of code.</p>
<blockquote>
<p>KISS &gt; DRY</p>
</blockquote>
<div><pre><code data-lang="java"><span>// Do
</span><span></span><span>@Test</span>
<span>public</span> <span>void</span> <span>variables</span><span>(</span><span>)</span> <span>throws</span> <span>Exception</span> <span>{</span>
    <span>insertIntoDatabase</span><span>(</span>
            <span>createProductWithCategory</span><span>(</span><span>"4243"</span><span>,</span> <span>"Office"</span><span>)</span><span>,</span>
            <span>createProductWithCategory</span><span>(</span><span>"1123"</span><span>,</span> <span>"Office"</span><span>)</span><span>,</span>
            <span>createProductWithCategory</span><span>(</span><span>"9213"</span><span>,</span> <span>"Hardware"</span><span>)</span>
    <span>)</span><span>;</span>

    <span>String</span> <span>responseJson</span> <span>=</span> <span>requestProductsByCategory</span><span>(</span><span>"Office"</span><span>)</span><span>;</span>

    <span>assertThat</span><span>(</span><span>toDTOs</span><span>(</span><span>responseJson</span><span>)</span><span>)</span>
            <span>.</span><span>extracting</span><span>(</span><span>ProductDTO</span><span>:</span><span>:</span><span>getId</span><span>)</span>
            <span>.</span><span>containsOnly</span><span>(</span><span>"4243"</span><span>,</span> <span>"1123"</span><span>)</span><span>;</span>
<span>}</span>
</code></pre></div><p>If you keep the tests short (which is highly recommended anyway), it‚Äôs no problem to see where the same values are used. Plus, the method is even shorter and therefore easier to understand. And finally, failure messages are easier to trace back to the code.</p>
<h2 id="dont-extend-existing-tests-to-just-test-one-more-tiny-thing">Don‚Äôt Extend Existing Tests To ‚ÄúJust Test One More Tiny Thing‚Äù</h2>
<div><pre><code data-lang="java"><span>// Don't
</span><span></span><span>public</span> <span>class</span> <span>ProductControllerTest</span> <span>{</span>
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>happyPath</span><span>(</span><span>)</span> <span>{</span>
        <span>// a lot of code comes here...
</span><span></span>    <span>}</span>
<span>}</span>
</code></pre></div><p>It‚Äôs tempting to add a corner case test to an existing (happy path) test. But this test becomes bigger and harder to understand. It becomes hard to grasp all relevant test cases that are covered by this big test. You can spot those tests by generic names like ‚Äúhappy path test‚Äù. If this test fails, it‚Äôs hard to see what exactly is broken.</p>
<div><pre><code data-lang="java"><span>// Do
</span><span></span><span>public</span> <span>class</span> <span>ProductControllerTest</span> <span>{</span>
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>multipleProductsAreReturned</span><span>(</span><span>)</span> <span>{</span><span>}</span>
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>allProductValuesAreReturned</span><span>(</span><span>)</span> <span>{</span><span>}</span>
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>filterByCategory</span><span>(</span><span>)</span> <span>{</span><span>}</span>
    <span>@Test</span>
    <span>public</span> <span>void</span> <span>filterByDateCr‚Ä¶</span></code></pre></div></section></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://phauer.com/2019/modern-best-practices-testing-java/">https://phauer.com/2019/modern-best-practices-testing-java/</a></em></p>]]>
            </description>
            <link>https://phauer.com/2019/modern-best-practices-testing-java/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24346195</guid>
            <pubDate>Tue, 01 Sep 2020 19:49:19 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Flying-V]]>
            </title>
            <description>
<![CDATA[
Score 14 | Comments 3 (<a href="https://news.ycombinator.com/item?id=24346194">thread link</a>) | @wim
<br/>
September 1, 2020 | https://www.tudelft.nl/en/ae/flying-v/ | <a href="https://web.archive.org/web/*/https://www.tudelft.nl/en/ae/flying-v/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
		<div>
			<!--TYPO3SEARCH_begin-->
			<div id="c463930"><div>

    
            <div>
                
        <div>
            <div>
                
                    <p id="c463241">
<h2>Flying long distances energy-efficiently</h2></p><p id="c463504">
<h2>Flying long distances energy-efficiently</h2></p><p id="c463505">
<h2>Flying long distances energy-efficiently</h2></p>
                
            </div>
        </div>
    
            </div>
        

    
</div></div><div id="c463667"><div>

    
            <div>
                
        <div>
            <div>
                
                    <p><strong>The Flying-V is a design for a highly energy-efficient long-distance aeroplane. The aircraft‚Äôs design integrates the passenger cabin, the cargo hold and the fuel tanks in the wings, creating a spectacular v-shape. Its improved aerodynamic shape and reduced weight will mean it uses 20% less fuel than the Airbus A350, today‚Äôs most advanced aircraft.&nbsp;</strong></p><div id="c650621"><div>

    
            <div>
                
        <div>
            <div>
                
                    <div id="c650622"><h3>Successful maiden flight for the TU Delft Flying-V</h3>
<p>In the summer of 2020 the scaled flight model of the Flying-V completed a successful maiden flight. Read all the details about the <a href="https://www.tudelft.nl/en/ae/flying-v/flying-scale-model/">flight test</a>.</p></div>
                
            </div>
        </div>
    
            </div>
        

    
</div></div><div id="c463261"><p>In the Flying-V ‚Äì originally an idea of TU Berlin student Justus Benad during his thesis project at Airbus Hamburg ‚Äì the passenger cabin, cargo hold and fuel tanks are integrated in its wing structure. The design is not as long as an Airbus A350, but it has the same wing span. This allows the Flying-V to use the present infrastructure at airports, such as gates and runways. The Flying-V carries about the same number of passengers -&nbsp; 314 in the standard configuration ‚Äì and the same amount of cargo, 160 m<sup>3</sup>. Project leader at TU Delft, Dr. Roelof Vos: ‚ÄúThe Flying-V is smaller than the A350 and has less inflow surface area compared to the available amount of volume. The result is less resistance. That means the Flying-V needs less fuel for the same distance.‚Äù</p></div><div id="c463506"><div data-namespace-typo3-fluid="true">

    
            
        
            <div>
                
                <div>
                    
                        <div id="c463511"><div id="c463266">


		<p><a href="https://d1rkab7tlqy5f1.cloudfront.net/_processed_/5/4/csm_FlyingV_Top_5954f7eaf4.png" data-imagezoom="" data-width="1659" data-height="1822">
							
	
			
	
			<img src="https://d1rkab7tlqy5f1.cloudfront.net/_processed_/5/4/csm_FlyingV_Top_5954f7eaf4.png" width="1659" height="1822" alt="">
		

		

						</a>
					
			
	

	

				
		</p>
	








</div></div>
                    
                </div>
            </div>
        
    
        

    
</div></div>
                
            </div>
        </div>
    
            </div>
        

    
</div></div><div id="c463718"><div>

    
            
        <div>
            <div>
                
                    <div id="c463676">


		<p><img src="https://d1rkab7tlqy5f1.cloudfront.net/LR/Subsites/Flying%20V/Mei2019/GS_V%20019.jpg" width="5184" height="3114" alt="">
		

		

					
			
	

	

				
		</p>
	








</div><div id="c463739"><div>

    
            
        <div>
            <div>
                
                    <div id="c463611"><div><h3>Stretching out in economy class </h3><p>Professor of Applied Ergonomics and Design <a href="https://www.tudelft.nl/en/ide/about-ide/people/vink-p/">Peter Vink</a> and industrial design engineer Thomas Rotte made the designs for the new, oval shaped cabin. The Flying-V can be fitted with a traditional cabin, but Vink and Rotte designed an experimental cabin that is lightweight, comfortable for passengers and that still holds the same number of passengers as an Airbus A350. It contains four different seating options: lounge chairs, group seating, individual seats and collapsible beds.</p> </div></div>
                
            </div>
        </div>
    
        

    
</div></div><div id="c463742"><div id="c463611"><div><h3>Stretching out in economy class </h3><p>Professor of Applied Ergonomics and Design <a href="https://www.tudelft.nl/en/ide/about-ide/people/vink-p/">Peter Vink</a> and industrial design engineer Thomas Rotte made the designs for the new, oval shaped cabin. The Flying-V can be fitted with a traditional cabin, but Vink and Rotte designed an experimental cabin that is lightweight, comfortable for passengers and that still holds the same number of passengers as an Airbus A350. It contains four different seating options: lounge chairs, group seating, individual seats and collapsible beds.</p> </div></div></div>
                
            </div>
        </div>
    
        

    
</div></div><div id="c463894"><div>

    
            <div>
                
        <div>
            <div>
                
                    <div id="c463612"><p>The Flying-V is one of TU Delft's lines of research into making aviation more sustainable. Dean Henri&nbsp;<a href="https://www.tudelft.nl/en/ae/organisation/dean-faculty-of-aerospace-engineering/">Henri Werij</a>: "Ultimately, we have to fly entirely on sustainable energy. CO2-neutral. If CO2 is still released during the flight, for example because we then fly on synthetic kerosene, the same amount of CO2 will be used to produce those fuels. At Delft University of Technology, we are investigating how we are going to achieve this. For example, we are investigating new forms of propulsion, such as electric and electric hybrid, the climate impact of aviation and air traffic operations, such as airports.</p></div>
                
            </div>
        </div>
    
            </div>
        

    
</div></div><div id="c463885"><div>

    
            <div>
                
        <div>
            <div>
                
                    <div id="c463886"><div data-namespace-typo3-fluid="true">

    
            
        
            <div>
                <div>
                    
                        <div id="c464590">


		<p><a href="http://klm.nl/" target="_blank">
					
	
			
	
			<img src="https://d1rkab7tlqy5f1.cloudfront.net/_processed_/0/9/csm_KLM_logo_aca1a5be6e.png" width="200" height="117" alt="">
		

		

				</a>
			
	

	

				
		</p>
	








</div>
                    
                </div>
                
                <div>
                    
                        <div id="c650635">


		<p><a href="https://d1rkab7tlqy5f1.cloudfront.net/LR/Subsites/Flying%20V/AIRBUS_RGB.jpg" data-imagezoom="" data-width="2392" data-height="886">
							
	
			
	
			<img src="https://d1rkab7tlqy5f1.cloudfront.net/LR/Subsites/Flying%20V/AIRBUS_RGB.jpg" width="2392" height="886" alt="">
		

		

						</a>
					
			
	

	

				
		</p>
	








</div>
                    
                </div>
            </div>
        
    
        

    
</div></div><div id="c463616"><p><strong>About the aircraft design and the scale model (faculty of Aerospace Engineering):&nbsp;</strong><br><a href="mailto:R.Vos@tudelft.nl">Roelof Vos</a>, researcher Flight Performance and Propulsion: +31 (0)15 278 5643<br><a href="mailto:i.boneschansker@tudelft.nl">Ineke Boneschansker</a>, communication manager: +31 (0)15 278 5361&nbsp; &nbsp;
</p>
<p><strong>About the cabin design and passenger experience (faculty of Industrial Design Engineering):</strong><strong>&nbsp;</strong><br><a href="mailto:A.J.M.deKool@tudelft.nl">Marc de Kool</a>, press officer: +31 (0)15 278 3723,&nbsp;
</p>
<p>Press office TU Delft: +31 (0)15 278 9111.</p></div>
                
            </div>
        </div>
    
            </div>
        

    
</div></div>
			<!--TYPO3SEARCH_end-->
		</div>
		
	</div></div>]]>
            </description>
            <link>https://www.tudelft.nl/en/ae/flying-v/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24346194</guid>
            <pubDate>Tue, 01 Sep 2020 19:49:13 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Sony ‚ÄúStar Eater‚Äù (2017)]]>
            </title>
            <description>
<![CDATA[
Score 87 | Comments 36 (<a href="https://news.ycombinator.com/item?id=24344512">thread link</a>) | @mjamm95
<br/>
September 1, 2020 | http://www.markshelley.co.uk/Astronomy/SonyA7S/sonystareater.html | <a href="https://web.archive.org/web/*/http://www.markshelley.co.uk/Astronomy/SonyA7S/sonystareater.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to extract article]]>
            </description>
            <link>http://www.markshelley.co.uk/Astronomy/SonyA7S/sonystareater.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24344512</guid>
            <pubDate>Tue, 01 Sep 2020 17:46:50 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[TypeScript is weakening the JavaScript ecosystem]]>
            </title>
            <description>
<![CDATA[
Score 21 | Comments 41 (<a href="https://news.ycombinator.com/item?id=24344506">thread link</a>) | @timdaub
<br/>
September 1, 2020 | https://timdaub.github.io/2020/09/01/typescript/ | <a href="https://web.archive.org/web/*/https://timdaub.github.io/2020/09/01/typescript/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div itemprop="articleBody">
    <p>In recent months, I've noticed a dramatic increase in TypeScript packages on GitHub. I usually come across them when checking repositories of the people I follow like. Or, when I'm looking for dependencies to solve a problem in my projects. And the more TypeScript packages I'm encountering, the more often I get reminded of this little annoyance towards the project.</p>
<p>My context is that I've not looked into TypeScript yet. That means I have no idea how it works. Unfortunately, this is now starting to become kind of a problem when searching for dependencies. It does, when I either willingly or accidentally include a TypeScript package into my projects. Mainly because my package-choosing criteria include:</p>
<ul>
<li>picking packages that I potentially can contribute to (e.g., a lesser-known package that contains well-written code); or</li>
<li>picking packages that are well-maintained by a large community but may include code that I'd not be able to easily contribute to (e.g., a popular package using a C library internally)</li>
</ul>
<p>I've put these criteria in place willingly to achieve a certain quality standard when building applications. Either because I can fix bugs myself quickly, or because I'm able to rely on a strong community to fix them. However, with TypeScript packages in npm, there's now this opaque problem of not knowing the language or quickly telling a package's language and its community size. Also, TypeScript could be just another CoffeeScript.</p>
<p>So essentially, the problem is that TypeScript authors publish their packages on npm, the package manager for Node.js. And to me, that's what is weakening the JavaScript ecosystem. Since its inception, and throughout trends like Coffeescript, npm has mostly held the promise of only hosting JavaScript packages. However, this promise is <code>rejected()</code> (lol) by many authors publishing their TypeScript-to-JavaScript transpiled packages.</p>
<p>Indeed, it makes sense considering that Microsoft markets TypeScript as a "superset of JavaScript" and since it "compiles" to JavaScript, why not publish packages to npm? But in terms of equality and identity, TypeScript is not JavaScript. After all, you'd not consider C and Objective-C the same either, or would you? In both examples, the languages are subsets/supersets but were conceived with different goals in mind to solve other problems.</p>
<p>Therefore, TypeScript authors should, in my opinion, do something along the following lines:</p>
<ul>
<li>namespacing their TypeScript packages; or</li>
<li>build and publish their packages to their package manager.</li>
</ul>
<p>However, continuing to publish TypeScript packages to npm is, in my opinion weakening the JavaScript ecosystem as it's splitting its community and polluting the npm namespace.</p>
<h2 id="controversy">Controversy</h2>
<ul>
<li>For a short time, there was an <a href="https://news.ycombinator.com/item?id=24344506" target="_blank" rel="noopener">intense conversation</a> on Hacker News. But for unknown reasons, my post got marked as <code>[flagged]</code>. I've written an email to the operators.</li>
</ul>

  </div></div>]]>
            </description>
            <link>https://timdaub.github.io/2020/09/01/typescript/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24344506</guid>
            <pubDate>Tue, 01 Sep 2020 17:46:15 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[CERN at Home: Building a Particle Detector]]>
            </title>
            <description>
<![CDATA[
Score 138 | Comments 23 (<a href="https://news.ycombinator.com/item?id=24344382">thread link</a>) | @kasbah
<br/>
September 1, 2020 | https://clanhouse.com/cern-at-home-building-a-particle-detector | <a href="https://web.archive.org/web/*/https://clanhouse.com/cern-at-home-building-a-particle-detector">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>	
	<p><img width="2048" height="1536" src="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0947.jpeg" alt="CERN DIY electron detector and connected laptop" loading="lazy" srcset="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0947.jpeg 2048w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0947-1024x768.jpeg 1024w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0947-768x576.jpeg 768w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0947-1536x1152.jpeg 1536w" sizes="(max-width: 2048px) 100vw, 2048px"></p><p>What do you do when you‚Äôre stuck at home with a 16-year-old son during a pandemic lockdown? Well, the first answer is that you build a gaming PC. That was a good project with a lot of incentives to complete, but that also meant it was soon over.  So, what next? I spotted a post about an outreach project from CERN to <a rel="noreferrer noopener" href="https://github.com/ozel/DIY_particle_detector" target="_blank">build your own particle detector</a> for under ¬£30. Sounded like fun, so here‚Äôs how we got on.</p>



<p>Firstly, a bit about ourselves: I‚Äôve just retired from an IT architecture role at a major UK bank, a brave decision when you still have a child at secondary school and there‚Äôs a global pandemic looming. My son, Sam, has just completed his GCSEs and is about to enter the sixth form.  I have a degree in Physics and Sam has a keen interest in scientific things. We both suffer from hypermobility of the finger joints, meaning that we have limited fine motor skills (translation: we are both klutzes. Even klutzes can successfully build this detector.) I haven‚Äôt picked up a soldering iron in anger for a long time and Sam has only done two or three connections for a school project so we are effectively total noobs to this sort of project.</p>



<p>Anyway, here is a write-up of our experience and lessons learned rfom building the electron detector. If you‚Äôre planning on building one yourself then you may find this useful</p>



<h2>Buying the components</h2>



<p>The great thing about the CERN kit is that you can order most of the parts easily using <a rel="noreferrer noopener" href="https://kitspace.org/boards/github.com/ozel/diy_particle_detector/electron-detector/" target="_blank">kitspace</a>. Can you really build it for under ‚Ç¨30 (about ¬£27) as claimed? Well, yes and no. The exchange rates have all moved, which doesn‚Äôt help. The individual components certainly cost less than ‚Ç¨30 but you cannot just buy individual components. You have to buy 10 resistors at a time but they are dirt cheap and you‚Äôll just end up spending 30p instead of 3p for the parts you need. The biggest surprise was that you have to buy a minimum of three circuit boards, but this turned out to be a blessing in disguise. It‚Äôs handy to have a spare board if your soldering skills are questionable, plus the alpha detector variant uses the same board so you have an incentive to build that model too. All-in-all, the cost of all the electronic components same to just under ¬£40. If you were buying for a class project ‚Äì a dozen or so boards ‚Äì I think the bulk  price would be closer to ¬£33/‚Ç¨37 per board.</p>



<p>There are some optional costs too that you may want to take into account. We bought a BNC to audio jack cable for about ¬£8 on Amazon as this was quicker, easier and ultimately cheaper than building one from scratch. We also had to buy some tools that we needed but didn‚Äôt have in our existing toolbox. You may prefer to buy a metal case or project box for around ¬£6, however I would recommend using an old sweet tin or similar. We used a presentation case off a Fossil watch that my wife received one Christmas.  To mount the board in the case, you‚Äôll need some sort of metal standoff. We bought a box of M3 brass standoffs of assorted lengths with all the necessary screws and bolts for about ¬£11 on Amazon. (120 components when you need only one!) You‚Äôll also need some small lengths of connecting wire ‚Äì about 30cm in total. (Tip: Amazon Prime is well worth the cost if you need to order all these things as you go along.)</p>



<p>Finally, you are going to need some sort of radioactive source to try out the detector. We bought 100g of analytical quality <a href="https://en.wikipedia.org/wiki/Potassium-40" target="_blank" rel="noreferrer noopener">potassium chloride</a> (KCl) on Amazon for under ¬£5. This is a better price than that of the potassium-rich salt substitutes that are also on Amazon and has a higher proportion of potassium to boot.</p>



<h2>Tools that you‚Äôll need</h2>



<figure><img loading="lazy" width="2048" height="1536" src="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0949.jpeg" alt="" srcset="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0949.jpeg 2048w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0949-1024x768.jpeg 1024w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0949-768x576.jpeg 768w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0949-1536x1152.jpeg 1536w" sizes="(max-width: 2048px) 100vw, 2048px"></figure>



<p>Before you start, make sure that you have all the tools that you‚Äôre going to need, Here‚Äôs a list of what we found necessary:</p>



<ul><li>A soldering iron with a small tip suitable for the components and board</li><li>A de-soldering pump and braid for when you mess things up</li><li>Small cutting pliers for tidying up excess wires when you‚Äôve soldered a component</li><li>Wire strippers for the ends of the connecting wires</li><li>A small multi-meter for testing joints and checking the board</li><li>A nail punch to make holes in your old tin box</li><li>A file to file down the sharp edges on the holes that you‚Äôve just punched</li><li>Some things to hold the board and components in position while you solder them. We used an old wall tile and a hexagonal pencil.</li></ul>



<h2>Constructing the detector</h2>



<p>We spent about three elapsed hours over about 3 weeks building the board and maybe another hour building the case and mounting the board into it. Why so long? Well, this project didn‚Äôt have the same appeal to a 16 year old as does building a gaming PC. Plus, use of said gaming PC frequently took priority over this project. We decided to solder the components in groups, doing the resistors first, then the capacitors then the semiconductors. The build instructions in the wiki are pretty good and easy to follow. </p>



<p>We tested every joint as we soldered it, making sure to test from another point on the circuit board so as to prove the connection was good. My son did all the soldering on one of the PCBs. I started work on a second board partly as a backup and partly to have something that could form the basis of the alpha detector. (I discovered the hard way that the two variants begin to differ at the third component, R3!)</p>



<p>Here are some shots of the board at different stages of construction:</p>



<h3>Stage 1</h3>



<div><figure><img loading="lazy" width="2560" height="1920" src="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0890-scaled.jpg" alt="" srcset="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0890-scaled.jpg 2560w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0890-1024x768.jpg 1024w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0890-768x576.jpg 768w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0890-1536x1152.jpg 1536w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0890-2048x1536.jpg 2048w" sizes="(max-width: 2560px) 100vw, 2560px"><figcaption>Resisitors from the bottom</figcaption></figure></div>



<div><figure><img loading="lazy" width="2560" height="1920" src="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0891-scaled.jpg" alt="" srcset="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0891-scaled.jpg 2560w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0891-1024x768.jpg 1024w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0891-768x576.jpg 768w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0891-1536x1152.jpg 1536w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0891-2048x1536.jpg 2048w" sizes="(max-width: 2560px) 100vw, 2560px"><figcaption>Resistors from the top</figcaption></figure></div>



<h3>Stage 2</h3>



<figure><img loading="lazy" width="2048" height="1536" src="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0899-1-rotated.jpeg" alt="" srcset="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0899-1-rotated.jpeg 2048w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0899-1-1024x768.jpeg 1024w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0899-1-768x576.jpeg 768w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0899-1-1536x1152.jpeg 1536w" sizes="(max-width: 2048px) 100vw, 2048px"><figcaption>Capacitors bottom view</figcaption></figure>



<figure><img loading="lazy" width="2048" height="1536" src="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0900-1-rotated.jpeg" alt="" srcset="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0900-1-rotated.jpeg 2048w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0900-1-1024x768.jpeg 1024w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0900-1-768x576.jpeg 768w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0900-1-1536x1152.jpeg 1536w" sizes="(max-width: 2048px) 100vw, 2048px"><figcaption>Capacitors top view</figcaption></figure>



<h3>Stage 3</h3>



<figure><img loading="lazy" width="2560" height="1920" src="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0921-scaled.jpg" alt="" srcset="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0921-scaled.jpg 2560w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0921-1024x768.jpg 1024w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0921-768x576.jpg 768w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0921-1536x1152.jpg 1536w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0921-2048x1536.jpg 2048w" sizes="(max-width: 2560px) 100vw, 2560px"><figcaption>Completed board, tbottom view</figcaption></figure>



<figure><img loading="lazy" src="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0920-1-scaled.jpg" alt="" width="580" height="435" srcset="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0920-1-scaled.jpg 2560w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0920-1-1024x768.jpg 1024w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0920-1-768x576.jpg 768w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0920-1-1536x1152.jpg 1536w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0920-1-2048x1536.jpg 2048w" sizes="(max-width: 580px) 100vw, 580px"><figcaption>Completed board, top view</figcaption></figure>



<h3>Stage 4</h3>



<figure><img loading="lazy" width="2048" height="1536" src="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0948.jpeg" alt="" srcset="https://clanhouse.com/wp-content/uploads/2020/09/IMG_0948.jpeg 2048w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0948-1024x768.jpeg 1024w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0948-768x576.jpeg 768w, https://clanhouse.com/wp-content/uploads/2020/09/IMG_0948-1536x1152.jpeg 1536w" sizes="(max-width: 2048px) 100vw, 2048px"><figcaption>The completed detector in its case with switch, battery and connector</figcaption></figure>



<h2>Testing the detector</h2>



<p>The first thing to do when testing the detector was to make sure that there were no shorts by measuring resistance across the power connectors. (Tick! A satisfactory 9.8 kilo-ohms) and make sure that power was reaching the board. Then we plugged it into a PC and switched it on. We were using the pulse detector JavaScript to check that it was working. I flicked the switch and‚Ä¶nothing. So, we examined the board. We knew we were novice constructors and some of the joints looked potentially to be dry and on one or two others we could not be 100% sure that we had an air gap between adjacent joints so we de-soldered and remade about 3 joints. Again we connected to the PC and we saw the satisfying pulses when the device was turned on and off. We also saw quite a bit of microphony being picked up when the tin was moved or when one of us spoke near it.</p>



<p>Ok, so next step was to try it with a radiation source. I weighed out roughly 10g of KCl into a plastic lid and positioned it under the diodes in the detector. We hadn‚Äôt made a radiation window in the lid of the tin and the diodes were about 1.5cm above the surface of the KCl. I switched on the detector and‚Ä¶nothing, not even the on/off pulses. The detector seemed dead.  I took the device apart and retested very connection with the multi-meter and made sure all the case connections were good and that the case was properly wired to earth. I checked that power from the battery was reaching all the necessary parts and that the battery power was good. I could find nothing wrong. </p>



<p>It quickly became apparent that there was an intermittent problem. Sometimes, the JavaScript detector would see a pulse when the device was switched on or off and sometimes ‚Äì usually ‚Äì there was nothing. Sometimes you would see noise on the web oscilloscope and sometimes not. I was scratching my head as to what the problem was. Eventually, it occurred to me to try actually listening to the audio output, a trivial thing to do under Windows. BINGO! I could hear white noise when the device was switched on and, just audible over the noise, a soft click every 20-30 seconds. Clearly the detector was working and therefore what I was facing was a software problem.</p>



<h2>The importance of sound cards, and repurposing yet again an ancient laptop</h2>



<p>I have to say that <a rel="noreferrer noopener" href="https://github.com/ozel" target="_blank">Oliver Keller</a> was an enormous help while I was trying to get the detector working and I cannot stress enough how important it is to listen to his advice about audio connections and sound cards. The problem seems to be that sound cards (or chips) in modern PCs are too clever for their own good. They are designed to optimise microphone input for Skype and Zoom and that means removing the noise and extraneous clicks that are exactly the signal that the detector puts out. </p>



<p>Modern technology was assuming the detector signal was unwanted noise so I needed some primitive technology. I have an old notebook laptop, an Asus EeePC 901. I bought this about 10 years ago and it has been the subject of several hobbyist projects over the years. I upgraded it‚Äôs memory to 2GB. I replaced it‚Äôs laughably small 4GB SSD with a 32GB one.  I upgraded it from Windows XP Home, via several versions of Ubuntu, to Windows 10 Home. You may be surprised that such a machine can run Windows 10 and MS Office but it can do so, just not well. I backed it up (virtualized it for VMWare) and installed a fresh copy of Lubuntu. I fired up the web oscilloscope under FireFox and now I have a working detector:</p>



<figure><img loading="lazy" width="1024" height="600" src="https://clanhouse.com/wp-content/uploads/2020/09/2020-09-01-105609_1024x600_scrot.png" alt="" srcset="https://clanhouse.com/wp-content/uploads/2020/09/2020-09-01-105609_1024x600_scrot.png 1024w, https://clanhouse.com/wp-content/uploads/2020/09/2020-09-01-105609_1024x600_scrot-768x450.png 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>You can quite clearly see a detector pulse in the screenshot. The noise sometimes peaks and can give a false reading but these are fairly easy to spot. The false pulses are one sided and lack the rebound peak of a true pulse. From around 25g of KCl, I‚Äôm seeing two or three pulses per minute in the detector</p>



<h2>So what comes next?</h2>



<p>OK, now that the detector is working, what comes next? Our first plan is to try out the python script to make sure that we can see and correctly analyze the energy spectrum from the KCl.  Step three will be to try various things to reduce the electrical noise. I have a suspicion that the tin leaks a little light into its interior but that can be remedied with black tape. Step three will be trying out various samples from my small mineral collection in the ‚Ä¶</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://clanhouse.com/cern-at-home-building-a-particle-detector">https://clanhouse.com/cern-at-home-building-a-particle-detector</a></em></p>]]>
            </description>
            <link>https://clanhouse.com/cern-at-home-building-a-particle-detector</link>
            <guid isPermaLink="false">hacker-news-small-sites-24344382</guid>
            <pubDate>Tue, 01 Sep 2020 17:36:34 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Raspberry Pi Secondary Memory Interface (SMI)]]>
            </title>
            <description>
<![CDATA[
Score 38 | Comments 0 (<a href="https://news.ycombinator.com/item?id=24343768">thread link</a>) | @segfaultbuserr
<br/>
September 1, 2020 | https://iosoft.blog/2020/07/16/raspberry-pi-smi/ | <a href="https://web.archive.org/web/*/https://iosoft.blog/2020/07/16/raspberry-pi-smi/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article id="post-1936">
	<!-- .entry-header -->

	
	
	<div>
		
<figure><img data-attachment-id="2066" data-permalink="https://iosoft.blog/2020/07/16/raspberry-pi-smi/adc_test4/" data-orig-file="https://iosoftblog.files.wordpress.com/2020/07/adc_test4.png" data-orig-size="420,240" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="adc_test4" data-image-description="" data-medium-file="https://iosoftblog.files.wordpress.com/2020/07/adc_test4.png?w=300" data-large-file="https://iosoftblog.files.wordpress.com/2020/07/adc_test4.png?w=420" src="https://iosoftblog.files.wordpress.com/2020/07/adc_test4.png?w=420" alt="" srcset="https://iosoftblog.files.wordpress.com/2020/07/adc_test4.png 420w, https://iosoftblog.files.wordpress.com/2020/07/adc_test4.png?w=150 150w, https://iosoftblog.files.wordpress.com/2020/07/adc_test4.png?w=300 300w" sizes="(max-width: 420px) 85vw, 420px"><figcaption>Colour video signal captured at 25 MS/s</figcaption></figure>



<p>The Secondary Memory Interface (SMI) is a parallel I/O interface that is included in all the Raspberry Pi versions. It is rarely used due to the acute lack of publicly-available documentation; the only information I can find is in the source code to an external memory device driver <a href="https://github.com/Ysurac/raspberry_kernel_mptcp/blob/master/include/linux/broadcom/bcm2835_smi.h">here</a>, and an experimental IDE interface <a href="https://github.com/fenlogic/IDE_trial">here</a>.</p>



<p>However, it is a very useful general-purpose high-speed parallel interface, that deserves wider usage; in this post I‚Äôm testing it with digital-to-analogue and analogue-to-digital converters (DAC and ADC) but there are many other parallel-bus devices that would be suitable.</p>



<figure><img data-attachment-id="1937" data-permalink="https://iosoft.blog/2020/07/16/raspberry-pi-smi/smi/" data-orig-file="https://iosoftblog.files.wordpress.com/2020/07/smi.png" data-orig-size="467,225" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="smi" data-image-description="" data-medium-file="https://iosoftblog.files.wordpress.com/2020/07/smi.png?w=300" data-large-file="https://iosoftblog.files.wordpress.com/2020/07/smi.png?w=467" src="https://iosoftblog.files.wordpress.com/2020/07/smi.png?w=467" alt="" srcset="https://iosoftblog.files.wordpress.com/2020/07/smi.png 467w, https://iosoftblog.files.wordpress.com/2020/07/smi.png?w=150 150w, https://iosoftblog.files.wordpress.com/2020/07/smi.png?w=300 300w" sizes="(max-width: 467px) 85vw, 467px"></figure>



<p>To take advantage of the high data rates, I‚Äôll be using the C language, and Direct Memory Access (DMA); if you are unfamiliar with DMA on the RPi, I suggest you read my previous 2 posts on the subject, <a href="https://iosoft.blog/raspberry-pi-dma-programming/">here</a> and <a href="https://iosoft.blog/fast-data-capture-raspberry-pi/">here</a>.</p>



<h2>Parallel interface</h2>



<figure><img data-attachment-id="1941" data-permalink="https://iosoft.blog/2020/07/16/raspberry-pi-smi/smi2/" data-orig-file="https://iosoftblog.files.wordpress.com/2020/07/smi2.png" data-orig-size="447,123" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="smi2" data-image-description="" data-medium-file="https://iosoftblog.files.wordpress.com/2020/07/smi2.png?w=300" data-large-file="https://iosoftblog.files.wordpress.com/2020/07/smi2.png?w=447" src="https://iosoftblog.files.wordpress.com/2020/07/smi2.png?w=447" alt="" srcset="https://iosoftblog.files.wordpress.com/2020/07/smi2.png 447w, https://iosoftblog.files.wordpress.com/2020/07/smi2.png?w=150 150w, https://iosoftblog.files.wordpress.com/2020/07/smi2.png?w=300 300w" sizes="(max-width: 447px) 85vw, 447px"><figcaption>Raspberry Pi SMI signals</figcaption></figure>



<p>The SMI interface has up to 18 bits of data, 6 address lines, read &amp; write select lines. Transfers can be initiated internally, or externally via read &amp; write request lines, which can take over the uppermost 2 bits of the data bus. Transfer data widths are 8, 9, 16 or 18 bits, and are fully supported by First In First Out (FIFO) buffers, and DMA; this makes for efficient memory usage when driving an 8-bit peripheral, since a single 32-bit DMA transfer can automatically be converted into four 8-bit accesses.</p>



<p>If you have ever worked with the classic bus-interfaces of the original microprocessors, you‚Äôll feel quite at home with SMI, but no need to worry about timing problems, because the setup, strobe &amp; hold times are fully programmable with 4 nanosecond resolution; what luxury!</p>



<p>The SMI functions are assigned to specific GPIO pins:</p>



<figure><img data-attachment-id="1947" data-permalink="https://iosoft.blog/2020/07/16/raspberry-pi-smi/rpi_smi_pins-2/" data-orig-file="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pins-2.png" data-orig-size="611,631" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="rpi_smi_pins" data-image-description="" data-medium-file="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pins-2.png?w=290" data-large-file="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pins-2.png?w=611" src="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pins-2.png?w=611" alt="" srcset="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pins-2.png 611w, https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pins-2.png?w=145 145w, https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pins-2.png?w=290 290w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px"></figure>



<p>The GPIO pins to be included in the parallel interface are selected by setting their mode to ALT1; there is no requirement to set all the SMI pins in this way, so the I2C, SPI and PWM interfaces are still quite usable.</p>



<figure><img data-attachment-id="2040" data-permalink="https://iosoft.blog/2020/07/16/raspberry-pi-smi/rpi_smi_pinout/" data-orig-file="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pinout.png" data-orig-size="470,149" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="rpi_smi_pinout" data-image-description="" data-medium-file="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pinout.png?w=300" data-large-file="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pinout.png?w=470" src="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pinout.png?w=470" alt="" srcset="https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pinout.png 470w, https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pinout.png?w=150 150w, https://iosoftblog.files.wordpress.com/2020/07/rpi_smi_pinout.png?w=300 300w" sizes="(max-width: 470px) 85vw, 470px"></figure>



<h2>Parallel DAC</h2>



<figure><img data-attachment-id="2009" data-permalink="https://iosoft.blog/2020/07/16/raspberry-pi-smi/exif_jpeg_picture-19/" data-orig-file="https://iosoftblog.files.wordpress.com/2020/07/pizero_ladder_dac2.jpg" data-orig-size="681,460" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;3.7&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;CX2&quot;,&quot;caption&quot;:&quot;Exif_JPEG_PICTURE&quot;,&quot;created_timestamp&quot;:&quot;1562320537&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;5.4&quot;,&quot;iso&quot;:&quot;200&quot;,&quot;shutter_speed&quot;:&quot;0.1&quot;,&quot;title&quot;:&quot;Exif_JPEG_PICTURE&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Exif_JPEG_PICTURE" data-image-description="" data-medium-file="https://iosoftblog.files.wordpress.com/2020/07/pizero_ladder_dac2.jpg?w=300" data-large-file="https://iosoftblog.files.wordpress.com/2020/07/pizero_ladder_dac2.jpg?w=681" src="https://iosoftblog.files.wordpress.com/2020/07/pizero_ladder_dac2.jpg?w=681" alt="" srcset="https://iosoftblog.files.wordpress.com/2020/07/pizero_ladder_dac2.jpg 681w, https://iosoftblog.files.wordpress.com/2020/07/pizero_ladder_dac2.jpg?w=150 150w, https://iosoftblog.files.wordpress.com/2020/07/pizero_ladder_dac2.jpg?w=300 300w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px"></figure>



<h4>Hardware</h4>



<p>The simplest device to drive from the parallel bus is a digital-to-analogue converter (DAC), using resistors from each data line to a common output. This arrangement is commonly known as an R-2R ladder, due to the resistor values needed.</p>



<p>I‚Äôve used a pre-built device from Digilent (details <a href="https://store.digilentinc.com/r2r-module-retired/">here</a>, or newer version <a href="https://store.digilentinc.com/pmod-r2r-resistor-ladder-d-a-converter/">here</a>) but it is easy to make your own using discrete resistors; the least-significant is connected to GPIO8 (SD0), and the most-significant to GPIO15 (SD7).</p>



<h4>Software</h4>



<p>I‚Äôll be making extensive use of the dma_utils functions that were created for my previous DMA projects, but before diving into the complication of SMI, it is helpful to test the hardware using simpler GPIO commands:</p>


<pre title="">#define DAC_D0_PIN      8
#define DAC_NPINS       8

extern MEM_MAP gpio_regs;
map_periph(&amp;gpio_regs, (void *)GPIO_BASE, PAGE_SIZE);

// Output value to resistor DAC (without SMI)
void dac_ladder_write(int val)
{
    *REG32(gpio_regs, GPIO_SET0) = (val &amp; 0xff) &lt;&lt; DAC_D0_PIN;
    *REG32(gpio_regs, GPIO_CLR0) = (~val &amp; 0xff) &lt;&lt; DAC_D0_PIN;
}

// Initialise resistor DAC
void dac_ladder_init(void)
{
    int i;
    
    for (i=0; i&lt;DAC_NPINS; i++)
        gpio_mode(DAC_D0_PIN+i, GPIO_OUT);
}

// Output sawtooth waveform
dac_ladder_init();
while (1)
{
    i = (i + 1) % 256;
    dac_ladder_write(i);
    usleep(10);
}
</pre>


<p>This is less-than-ideal because we have to use one command to set some I/O pins to 1, and another command to clear the rest to 0, so in the gap between them the I/O state will be incorrect; also we won‚Äôt get accurate timing with the usleep command.</p>



<p>To my surprise, when I ran this code on a Pi Zero, and viewed the output on an oscilloscope, it didn‚Äôt look too bad; however, as soon as I moved the mouse, there were very significant gaps in the output, so clearly we need to do better.</p>



<h4>SMI register definitions</h4>



<p>To use SMI, we first need to define the control registers, and the bit-values within them. The primary reference is bcm2835_smi.h from the Broadcom external memory driver, but I found this difficult to use in my code, so converted the definitions into C bitfields; this makes the code a bit less portable, but a lot simpler and easier to read.</p>



<p>Also, when learning about a new peripheral, it is helpful if the bitfield values can be printed on the console. This normally requires the tedious copying of register field names into string constants, but with a small amount of macro processing, this can be done with a single definition, for example the SMI CS register:</p>


<pre title="">#define REG_DEF(name, fields) typedef union {struct {volatile uint32_t fields;}; volatile uint32_t value;} name

#define SMI_CS_FIELDS \
    enable:1, done:1, active:1, start:1, clear:1, write:1, _x1:2,\
    teen:1, intd:1, intt:1, intr:1, pvmode:1, seterr:1, pxldat:1, edreq:1,\
    _x2:8, _x3:1, aferr:1, txw:1, rxr:1, txd:1, rxd:1, txe:1, rxf:1  
REG_DEF(SMI_CS_REG, SMI_CS_FIELDS);

volatile SMI_CS_REG  *smi_cs;

smi_cs  = (SMI_CS_REG *) REG32(smi_regs, SMI_CS);
</pre>


<p>The last bit of code is needed so that smi_cs points to the register in virtual memory; if you don‚Äôt understand why, I suggest you read my post on RPi DMA programming <a href="https://iosoft.blog/raspberry-pi-dma-programming/">here</a>. Anyway, the upshot of all this code is that we can access the whole 32-bit value of the register as smi_cs-&gt;value, and also individual bits such as smi_cs-&gt;enable, smi_cs-&gt;done, etc.</p>



<p>To print out the bit values, we use macros to convert the register definition to a string, then have a simple C parser:</p>


<pre title="">#define STRS(x)     STRS_(x) ","
#define STRS_(...)  #__VA_ARGS__

char *smi_cs_regstrs = STRS(SMI_CS_FIELDS);

// Display bit values in register
void disp_reg_fields(char *regstrs, char *name, uint32_t val)
{
    char *p=regstrs, *q, *r=regstrs;
    uint32_t nbits, v;
    
    printf("%s %08X", name, val);
    while ((q = strchr(p, ':')) != 0)
    {
        p = q + 1;
        nbits = 0;
        while (*p&gt;='0' &amp;&amp; *p&lt;='9')
            nbits = nbits * 10 + *p++ - '0';
        v = val &amp; ((1 &lt;&lt; nbits) - 1);
        val &gt;&gt;= nbits;
        if (v &amp;&amp; *r!='_')
            printf(" %.*s=%X", q-r, r, v);
        while (*p==',' || *p==' ')
            p = r = p + 1;
    }
    printf("\n");
}
</pre>


<p>Now we can display all the non-zero bit values using:</p>


<pre title="">disp_reg_fields(smi_cs_regstrs, "CS", *REG32(smi_regs, SMI_CS));
</pre>


<p>..which produces a display like..</p>


<pre title="">CS 54000025 enable=1 active=1 write=1 txw=1 txd=1 txe=1
</pre>


<h4>SMI registers</h4>



<p>The SMI registers are:</p>


<pre title="">CS:  control and status
L:   data length (number of transfers)
A:   address and device number
D:   data FIFO
DMC: DMA control
DSR: device settings for read
DSW: device settings for write
DCS: direct control and status
DCA: direct control address and device number
DCD: direct control data
</pre>


<p>You can specify up to 4 unique timing settings for read &amp; write, making 8 settings in total. The settings are specified by giving a 2-bit device number for each transaction; this selects 1 of the 4 descriptors for read or write. I‚Äôve only used one pair of settings, and the ADC &amp; DAC don‚Äôt have address lines, so the address &amp; device register remains at zero.</p>



<p>Direct mode is a simple way of doing accesses using the appropriate timings, but without DMA; it has separate address, data and control registers.</p>



<p>Some notable fields in the control &amp; status register are:</p>



<p><strong>Enable</strong>: it is obvious that this bit must be set for SMI to work, but it is less obvious when that should be done. Initially, I assumed it was necessary to enable the interface before any other initialisation, but then it responded with the ‚Äòsettings error‚Äô bit set. So now I do most of the configuration with the device disabled, then enable it before clearing the FIFOs and enabling DMA, otherwise the transfers go through immediately.</p>



<p><strong>Start</strong>: set this bit to start the transfer; the SMI controller will perform the number of transfers in the length register, using the timing parameters specified in DSR (for read) or DSW (for write). If there is a backlog of data (FIFO is full) the transaction may stall.</p>



<p><strong>Pxldat</strong>: when this ‚Äòpixel data‚Äô bit is set, the 8- or 16-bit data is packed into 32-bit words.</p>



<p><strong>Pvmode</strong>: I have no idea what this ‚Äòpixel valve‚Äô mode should do; any information would be gratefully received.</p>



<h4>Direct Mode</h4>



<p>As the name implies, SMI Direct Mode allows you to perform a single I/O transfer without DMA. However, it is still necessary to specify the timing parameters of the transfer, specifically:</p>



<ul><li>The clock period, that will be used for the following timing:<ul><li>The setup time, that is used by the peripheral to decode the address value</li><li>The width of the strobe pulse, that triggers the transfer</li><li>The hold time, that keeps the signals stable after the transfer</li></ul></li></ul>



<p>To add to the complication, the SMI controller can drive 4 peripheral devices, each with its own individual read &amp; write settings, so there are a total of 8 timing registers. I‚Äôm keeping this simple by always using the first register pair (for device zero) but it is worth remembering that you can define more than one set of timings, and quickly switch between them by setting the device number.</p>



<p>Likewise, I‚Äôm ignoring the address field since it is also redundant for my DAC; for safety, I clear all the SMI registers on startup, in case there are any residual unwanted values.</p>



<p>As it happens, this setup/strobe/hold timing is largely redundant for our simple resistor DAC (since it doesn‚Äôt latch the data) but we still need to specify something, for example if we want the overall cycle time to be 1 microsecond, this can be achieved with a clock period of 10 nanoseconds, setup 25, strobe 50, and hold 25, since (25 + 50 + 25) * 10 = 1000 nanoseconds. This is the code I use to set the timing:</p>


<pre title="">// Width values
#define SMI_8_BITS  0
#define SMI_16_BITS 1
#define SMI_18_BITS 2
#define SMI_9_BITS  3

// Initialise SMI interface, given time step, and setup/hold/strobe counts
// Clock period is in nanoseconds: even numbers, 2 to 30
void ‚Ä¶</pre></div></article></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://iosoft.blog/2020/07/16/raspberry-pi-smi/">https://iosoft.blog/2020/07/16/raspberry-pi-smi/</a></em></p>]]>
            </description>
            <link>https://iosoft.blog/2020/07/16/raspberry-pi-smi/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24343768</guid>
            <pubDate>Tue, 01 Sep 2020 16:49:37 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Daddy, did you need to buy an electric car?]]>
            </title>
            <description>
<![CDATA[
Score 53 | Comments 21 (<a href="https://news.ycombinator.com/item?id=24342495">thread link</a>) | @ZeljkoS
<br/>
September 1, 2020 | https://svedic.org/tech/daddy-did-you-really-need-electric-car | <a href="https://web.archive.org/web/*/https://svedic.org/tech/daddy-did-you-really-need-electric-car">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><p><em>I made a mistake: I bought an electric car. EV articles I have read on Hacker News and Reddit didn‚Äôt prepare me for a dozen EV infrastructure problems in my part of the EU. Anecdotes below explain lessons I learned the hard way.</em></p><p>When I see a cool new gadget, my rationality goes away. I tell myself, ‚ÄúDon‚Äôt buy another device that will somehow be discharged when you need it,‚Äù but to no avail. The siren call would sing, ‚ÄúIt has USB-C!‚Äù until my wallet opens wider than the Spielberg‚Äôs ‚ÄúJaws‚Äù.</p><p>This time, the siren call was a government incentive of 10,600 EUR ($12,100) for a new electric vehicle purchase. ‚ÄúGreat,‚Äù I thought, ‚ÄúI need to replace my old car.‚Äù My experience of driving electric car-shares in Oxford and Berlin was great. So, I purchased a 1.5-ton gadget, with no USB-C ports included, called <a href="https://ev-database.org/car/1204/Hyundai-Kona-Electric-64-kWh" target="_blank" rel="noopener noreferrer">Hyundai Kona EV</a>:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/EV-database-Kona-EV-small.jpg"><img title="Hyundai Kona EV, Credits: https://ev-database.org/car/1204/Hyundai-Kona-Electric-64-kWh" src="https://svedic.org/wp-content/uploads/2020/08/EV-database-Kona-EV-small-1024x540.jpg" alt="" width="584" height="308" srcset="https://svedic.org/wp-content/uploads/2020/08/EV-database-Kona-EV-small-1024x540.jpg 1024w, https://svedic.org/wp-content/uploads/2020/08/EV-database-Kona-EV-small-300x158.jpg 300w, https://svedic.org/wp-content/uploads/2020/08/EV-database-Kona-EV-small-768x405.jpg 768w, https://svedic.org/wp-content/uploads/2020/08/EV-database-Kona-EV-small-500x264.jpg 500w, https://svedic.org/wp-content/uploads/2020/08/EV-database-Kona-EV-small.jpg 1179w" sizes="(max-width: 584px) 100vw, 584px"></a></p><p>Why not a Tesla Model 3, you ask? Fun fact: <a href="https://en.wikipedia.org/wiki/Nikola_Tesla" target="_blank" rel="noopener noreferrer">Nikola Tesla</a> was a naming inspiration for both <a href="https://en.wikipedia.org/wiki/Tesla,_Inc." target="_blank" rel="noopener noreferrer">Tesla cars</a>&nbsp;and <a href="https://en.wikipedia.org/wiki/Nikola_Corporation" target="_blank" rel="noopener noreferrer">Nikola trucks</a>. Tesla was an ethnic Serbian born in present-day Croatia, but you can‚Äôt officially buy a Tesla or Nikola vehicle in Croatia (where I live) or Serbia. Elon Musk <a href="https://twitter.com/elonmusk/status/1176190550854127616?lang=en" target="_blank" rel="noopener noreferrer">tweeted his hope to open sales in the region early in 2020</a>, but as of August 2020 that didn‚Äôt happen.</p><p>First, the good parts: as soon as I picked up my car in Zagreb, Croatia, I was impressed. EVs are so quiet that EU law requires they produce a buzzing sound when going slower than 30 km/h. Acceleration is instant; torque is strong enough, even in Eco mode, to make tires scream if I pushed the ‚Äúgas‚Äù pedal too fast. There are no vibrations and no jerking when the car shifts gears. EVs use regenerative breaking, again completely silent. EV charging is currently free in Croatia, and depending on rainfall, <a href="http://mecometer.com/whats/croatia/electricity-production-by-source/" target="_blank" rel="noopener noreferrer">44% of that electricity is carbon-free</a>. I was in love with the car.</p><p>The first weekend I drove with a group of friends to a <a href="https://www.toastmasters.org/leadership-central/speech-contests" target="_blank" rel="noopener noreferrer">Toastmaster‚Äôs competition</a> in Ljubljana, Slovenia, <a href="https://goo.gl/maps/A1tH92uEFXTUHuu96" target="_blank" rel="noopener noreferrer">143 km from Zagreb</a> (83 mi). Kona EV with 64 kWh battery has a declared range of 450 km (280 mi), so even with 90% battery, I had enough for a round trip. So I thought. I soon learned the first lesson:</p><p><em>#1: EVs have <a href="https://www.autoweek.com/news/green-cars/a31898441/study-ev-winter-range-loss-averages-19/" target="_blank" rel="noopener noreferrer">20% shorter range</a> in cold weather.</em></p><p>It was November. But still, 450 x 90% x 0.8 = 324 km, round trip is 286 km, we were good. While driving 130 km/h on a highway (80mph, a legal limit), I noticed my range dropping significantly. The car specs sheet lied in the worst possible way: they were technically correct. High torque: true. Range of 450 km: true. But:</p><p><em>#2: EVs can‚Äôt deliver both performance and declared range at the same time, you need to choose one.</em></p><p>I had the wrong intuition that cars have a longer range on the highway than in the city. That is true for gas cars because gas cars are extremely inefficient in cities. All cylinders are running, swallowing gas when accelerating, and that kinetic energy is lost when braking. As EVs use only the energy needed and recuperate that energy when breaking, they really have a declared range when driving in the city. When driving fast, EV range shortens because <a href="https://www.softschools.com/formulas/physics/air_resistance_formula/85/" target="_blank" rel="noopener noreferrer">air resistance is proportional to the square of speed</a>. Gas engines are more efficient when all cylinders are firing at constant, high RPMs. As a result, gas cars have a <a href="https://www.mpgforspeed.com/" target="_blank" rel="noopener noreferrer">maximum range at speeds of 89-97 km/h (55-60 mph)</a>. EVs have a maximum range at <a href="https://cleantechnica.com/2018/07/15/tesla-range-plotted-relative-to-speed-temperature-graphs/" target="_blank" rel="noopener noreferrer">around 55 km/h (35 mph)</a>, and range falls linearly as you drive faster. For example, this is the range decrease for Tesla Model S, depending on speed and temperature:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/model_s100_range_temp_imperial_grande.png"><img title="Tesla Model S100 range vs speed vs temperature, Credits: https://cleantechnica.com/2018/07/15/tesla-range-plotted-relative-to-speed-temperature-graphs/" src="https://svedic.org/wp-content/uploads/2020/08/model_s100_range_temp_imperial_grande.png" alt="" width="600" height="450" srcset="https://svedic.org/wp-content/uploads/2020/08/model_s100_range_temp_imperial_grande.png 600w, https://svedic.org/wp-content/uploads/2020/08/model_s100_range_temp_imperial_grande-300x225.png 300w, https://svedic.org/wp-content/uploads/2020/08/model_s100_range_temp_imperial_grande-400x300.png 400w" sizes="(max-width: 600px) 100vw, 600px"></a></p><p>As I slowed down, the estimated range increased. Unfortunately, part of the highway was closed for construction, and we needed to take a detour. The round trip just got longer, so I decided to park at the EV charging place. But, it was a <a href="https://en.wikipedia.org/wiki/Type_2_connector" target="_blank" rel="noopener noreferrer">Type 2 AC charger</a>, meaning another lesson was coming:</p><p><em>#3: To charge at Type 2 AC plugs in the EU, you need to bring your cable.</em></p><p>Of course, I had none. Fast chargers I used before had attached cables, and I was wondering what was the point of <a href="https://svedic.org/wp-content/uploads/2020/08/Kona-EV-Charging-Auto-Lock.jpg" target="_blank" rel="noopener noreferrer">the cable lock button on Hyundai Kona</a>? It is there because:</p><p><em>#4: Lock your <a href="https://www.evexpert.eu/p/338/duosida-charging-cable-type2-type2-32a-3phase" target="_blank" rel="noopener noreferrer">230 EUR Type 2 cable</a> if you don‚Äôt want it stolen.</em></p><p>Between event sessions, I was Googling ‚Äúfast EV chargers in Slovenia.‚Äù Highway stops by ‚ÄúPetrol‚Äù had them, great. Around 11 PM, we left Ljubljana in high spirits. We arrived at the Petrol station and found a fast charger, with cables. Guess what happened next:</p><p><em>#5: EU fast chargers are activated via a proprietary chip card or smartphone app. Each company in each country uses a different card / app.</em></p><p>Of course, I only had a smartphone charging app for Croatia. Lessons were coming fast:</p><p><em>#5A: Petrol gas stations clerks can‚Äôt sell you a Petrol charging card, and they can‚Äôt activate an EV charging even when you want to pay for it.</em></p><p>‚ÄúDownload and register in the Petrol app,‚Äù the night clerk said. Yes, but:</p><p><em>#5B: Petrol Android app is 50 MB, so if a station is covered by a <a href="https://www.gsmarena.com/glossary.php3?term=edge#:~:text=EDGE%20(also%20known%20as%20Enhanced,order%20to%20conserve%20spectrum%20resources." target="_blank" rel="noopener noreferrer">slow EDGE signal</a>, you can‚Äôt download the app.</em></p><p>We got back to the highway, where my friend caught H+ signal and downloaded the app. At the next Petrol station, we discovered:</p><p><em>#5C: When you hit the ‚ÄúStart charging‚Äù button in the Petrol app, it redirects you to a registration form to enter payment and address.</em></p><p>No problem, I can fill the form, even on EDGE signal. But then:</p><p><em>#5D: To register in the Petrol app, needed for charging, you need a valid address in Slovenia.</em></p><p>It is good the EV charging station was 20 meters away from the gas station because I was cursing Petrol so loud a clerk would have had all rights to call the police. I should have read <a href="https://play.google.com/store/apps/details?id=si.petrol.onecharge&amp;hl=en" target="_blank" rel="noopener noreferrer">Petrol app comments</a> beforehand:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/OneCharge-app-Petrol-comments-1.png"><img title="Petrol app comments" src="https://svedic.org/wp-content/uploads/2020/08/OneCharge-app-Petrol-comments-1-1024x732.png" alt="" width="584" height="417" srcset="https://svedic.org/wp-content/uploads/2020/08/OneCharge-app-Petrol-comments-1-1024x732.png 1024w, https://svedic.org/wp-content/uploads/2020/08/OneCharge-app-Petrol-comments-1-300x214.png 300w, https://svedic.org/wp-content/uploads/2020/08/OneCharge-app-Petrol-comments-1-768x549.png 768w, https://svedic.org/wp-content/uploads/2020/08/OneCharge-app-Petrol-comments-1-420x300.png 420w, https://svedic.org/wp-content/uploads/2020/08/OneCharge-app-Petrol-comments-1.png 1105w" sizes="(max-width: 584px) 100vw, 584px"></a>It was past midnight when we got back on the highway. To extend the range, I slowed down to 75 km/h (46 mph). The limit was 130km/h, so a trailer truck started taking over us. Then I remembered a Tour de France strategy I saw on TV:</p><p><em>#6: In an emergency, you can extend the range of your EV by tailgating a&nbsp; trailer truck, a strategy called <a href="https://en.wikipedia.org/wiki/Drafting_(aerodynamics)" target="_blank" rel="noopener noreferrer">aerodynamic drafting</a>.</em></p><p>Don‚Äôt hold me responsible for traffic tickets or beating by an angry trucker. There I was, hidden behind a trailer truck, to save electricity while driving 90 km/h. The car showed it was using less power, and the range extended. When we entered Zagreb, there was 19 km left:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/Zagreb-low-battery-small.jpg"><img title="Kona EV low battery warning, Credits: Zeljko Svedic" src="https://svedic.org/wp-content/uploads/2020/08/Zagreb-low-battery-small-300x233.jpg" alt="" width="300" height="233" srcset="https://svedic.org/wp-content/uploads/2020/08/Zagreb-low-battery-small-300x233.jpg 300w, https://svedic.org/wp-content/uploads/2020/08/Zagreb-low-battery-small-387x300.jpg 387w, https://svedic.org/wp-content/uploads/2020/08/Zagreb-low-battery-small.jpg 630w" sizes="(max-width: 300px) 100vw, 300px"></a></p><p>I went to a fast-charging station I could actually activate, and I fell asleep in the car.</p><p>I made fun of Petrol for their unfriendliness towards tourists, but at least the EV chargers at Petrol stations are working. In Croatia, you can‚Äôt always count on that. In my modest opinion, that stems from the fact that charging is free. Why is free electricity a problem, you ask? There is no commercial incentive to build and maintain charging stations. Instead, most chargers are built when the EU donates money or when the government is pressed to improve EV infrastructure. Local politicians come when a charging station is finished to deliver speeches: ‚ÄúThis is an example of Croatia using EU funds wisely, for a green and sustainable future.‚Äù After the journalists leave, there is no economic interest in sustaining chargers in the future.</p><p>For example, this city-provided Type 2 charger has been broken for three months:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/Garage-broken-charger-2-small.jpg"><img title="Broken charger 1, Credits: Zeljko Svedic" src="https://svedic.org/wp-content/uploads/2020/08/Garage-broken-charger-2-small.jpg" alt="" width="641" height="873" srcset="https://svedic.org/wp-content/uploads/2020/08/Garage-broken-charger-2-small.jpg 641w, https://svedic.org/wp-content/uploads/2020/08/Garage-broken-charger-2-small-220x300.jpg 220w" sizes="(max-width: 641px) 100vw, 641px"></a></p><p>In front of the Zagreb city hall, one charging station displays an error:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/City-charger-error-1.jpg"><img title="Broken charger 2, Credits: Zeljko Svedic" src="https://svedic.org/wp-content/uploads/2020/08/City-charger-error-1.jpg" alt="" width="704" height="455" srcset="https://svedic.org/wp-content/uploads/2020/08/City-charger-error-1.jpg 704w, https://svedic.org/wp-content/uploads/2020/08/City-charger-error-1-300x194.jpg 300w, https://svedic.org/wp-content/uploads/2020/08/City-charger-error-1-464x300.jpg 464w" sizes="(max-width: 704px) 100vw, 704px"></a></p><p>While other just states it is out of order:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/City-charger-error-2.jpg"><img title="Broken charger 3, Credits: Zeljko Svedic" src="https://svedic.org/wp-content/uploads/2020/08/City-charger-error-2.jpg" alt="" width="535" height="145" srcset="https://svedic.org/wp-content/uploads/2020/08/City-charger-error-2.jpg 535w, https://svedic.org/wp-content/uploads/2020/08/City-charger-error-2-300x81.jpg 300w, https://svedic.org/wp-content/uploads/2020/08/City-charger-error-2-500x136.jpg 500w" sizes="(max-width: 535px) 100vw, 535px"></a></p><p>What I learned is:</p><p><em>#7: Free chargers are often unmaintained, and you are better with a commercial provider you can hold accountable.</em></p><p>‚ÄúBut, there is nothing to break on a charging station!‚Äù I thought. Boy, I was wrong. EV charging stations use internal computer for authorization, and for controlling the display and the charging protocol. Before charging starts, a car locks the cable with the mechanical pin and signals that back to the charger. When a car is unlocked, it signals a charger to drop the voltage to zero, so the mechanical pin holding cable can be released. Guess what?</p><p><em>#8: Some chargers are not compatible with some EVs and refuse to stop charging, resulting in the ‚ÄúHotel California effect.‚Äù You can check out in the app, but you can never leave.</em></p><p>For example, Croatian Telecom chargers. The first time their cable got stuck in my car I panicked. Their app was not working, the charger was not responding to car signals, and their charging stations don‚Äôt have the stop button:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/HT-charger-cable-locked.jpg"><img title="HT charger cable locked, Credits: Zeljko Svedic" src="https://svedic.org/wp-content/uploads/2020/08/HT-charger-cable-locked.jpg" alt="" width="899" height="585" srcset="https://svedic.org/wp-content/uploads/2020/08/HT-charger-cable-locked.jpg 899w, https://svedic.org/wp-content/uploads/2020/08/HT-charger-cable-locked-300x195.jpg 300w, https://svedic.org/wp-content/uploads/2020/08/HT-charger-cable-locked-768x500.jpg 768w, https://svedic.org/wp-content/uploads/2020/08/HT-charger-cable-locked-461x300.jpg 461w" sizes="(max-width: 899px) 100vw, 899px"></a></p><p>They have the contact phone, but it was Sunday afternoon. I called them, expecting three levels of menus and ‚Äúwe are not working on weekends‚Äù message. To my great surprise, a female voice answered after two rings. ‚ÄúI have a big problem with your EV charging station: I can‚Äôt get my car out because‚Ä¶‚Äù My explanation was stopped by ‚ÄúWhat is the serial number written on the station?‚Äù As I dictated the serial, I could hear fast typing. A few seconds later charging station stopped buzzing, display went blank for a moment, and I could unplug my car. ‚ÄúWow, that was fast, thank you very much!‚Äù I said. Although they currently don‚Äôt charge for electricity, Croatian Telekom is a commercial operation. They have a direct 24/7 support line where a representative can reset any charging station in Croatia, provided the serial number. It seems that such a solution was easier than fixing charging stations or the charging app. I now just call them and say, ‚ÄúCan you reset the station with serial X?‚Äù If you work there, let me know, I would like to buy a box of chocolates for the team.</p><p>Unfortunately, EV charges are not the only thing broken here. Our driving culture is also broken:</p><p><em>#9: It is common to find a gas car parked at the EV charging spot, the practice called <a href="https://twitter.com/ivebeeniced?lang=en" target="_blank" rel="noopener noreferrer">ICEing</a> (internal combustion engine-ing).</em></p><p>One time I urgently needed to charge, and this was the charging spot:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/EV-parking.jpg"><img title="Blocking EV parking, Credits: Zeljko Svedic" src="https://svedic.org/wp-content/uploads/2020/08/EV-parking.jpg" alt="" width="717" height="785" srcset="https://svedic.org/wp-content/uploads/2020/08/EV-parking.jpg 717w, https://svedic.org/wp-content/uploads/2020/08/EV-parking-274x300.jpg 274w" sizes="(max-width: 717px) 100vw, 717px"></a></p><p>ICEing is common around the world. Tesla <a href="https://electrek.co/2019/01/14/tesla-sollution-avoid-gas-cars-icing-superchargers/" target="_blank" rel="noopener noreferrer">implemented parking locks in China</a>. German police are <a href="https://www.driven.co.nz/news/german-police-take-drastic-action-when-truck-parks-in-ev-charging-bay/" target="_blank" rel="noopener noreferrer">lifting cars instead of giving parking tickets</a>. Croatian EV owners decided to stage a short protest, where they <a href="https://www.thedrive.com/news/31422/now-its-ev-owners-who-are-blocking-gas-pumps-in-revenge-for-being-iced" target="_blank" rel="noopener noreferrer">blocked access to a gas station with EVs</a>, for five minutes:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/what-led-croatian-ev-owners-to-plan-the-revenge-of-evs.jpg"><img title="EV owners protest, Credits: Tesla Owners Croatia" src="https://svedic.org/wp-content/uploads/2020/08/what-led-croatian-ev-owners-to-plan-the-revenge-of-evs-1024x576.jpg" alt="" width="584" height="329" srcset="https://svedic.org/wp-content/uploads/2020/08/what-led-croatian-ev-owners-to-plan-the-revenge-of-evs-1024x576.jpg 1024w, https://svedic.org/wp-content/uploads/2020/08/what-led-croatian-ev-owners-to-plan-the-revenge-of-evs-300x169.jpg 300w, https://svedic.org/wp-content/uploads/2020/08/what-led-croatian-ev-owners-to-plan-the-revenge-of-evs-768x432.jpg 768w, https://svedic.org/wp-content/uploads/2020/08/what-led-croatian-ev-owners-to-plan-the-revenge-of-evs-1536x864.jpg 1536w, https://svedic.org/wp-content/uploads/2020/08/what-led-croatian-ev-owners-to-plan-the-revenge-of-evs-500x281.jpg 500w, https://svedic.org/wp-content/uploads/2020/08/what-led-croatian-ev-owners-to-plan-the-revenge-of-evs.jpg 1920w" sizes="(max-width: 584px) 100vw, 584px"></a></p><p>Online reactions were not sympathetic:</p><p><a href="https://svedic.org/wp-content/uploads/2020/08/Protest-comments-1.png"><img title="Comments from https://www.thedrive.com/news/31422/now-its-ev-owners-who-are-blocking-gas-pumps-in-revenge-for-being-iced" src="https://svedic.org/wp-content/uploads/2020/08/Protest-comments-1.png" alt="" width="712" height="430" srcset="https://svedic.org/wp-content/uploads/2020/08/Protest-comments-1.png 712w, https://svedic.org/wp-content/uploads/2020/08/Protest-comments-1-300x181.png 300w, https://svedic.org/wp-content/uploads/2020/08/Protest-comments-1-497x300.png 497w" sizes="(max-width: 712px) 100vw, 712px"></a></p><p>I find Paul‚Äôs ‚Äúthey‚Äôre blocking poor people‚Äù comment particularly insightful. EV owners are currently perceived as rich geeks. There was a similar dilemma in the early 1900s: why ‚Ä¶</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://svedic.org/tech/daddy-did-you-really-need-electric-car">https://svedic.org/tech/daddy-did-you-really-need-electric-car</a></em></p>]]>
            </description>
            <link>https://svedic.org/tech/daddy-did-you-really-need-electric-car</link>
            <guid isPermaLink="false">hacker-news-small-sites-24342495</guid>
            <pubDate>Tue, 01 Sep 2020 15:01:05 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[How to resume a SSH encrypted and x11 forwarded session]]>
            </title>
            <description>
<![CDATA[
Score 56 | Comments 4 (<a href="https://news.ycombinator.com/item?id=24342148">thread link</a>) | @ZnZirconium
<br/>
September 1, 2020 | https://dwaves.org/2019/01/21/how-to-resume-a-ssh-encrypted-and-x11-forwarded-session/ | <a href="https://web.archive.org/web/*/https://dwaves.org/2019/01/21/how-to-resume-a-ssh-encrypted-and-x11-forwarded-session/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
				
<p>‚ÄúXpra is a tool which allows you to run X programs ‚Äî usually on a remote host ‚Äî and then direct their display to your local machine, disconnect from these programs, and reconnect from<br>
the same or another machine, all without losing any state. It differs from standard X forwarding in that it allows disconnection and reconnection without disrupting the forwarded<br>
application; it differs from VNC and similar remote display technologies in that xpra is rootless: i.e., applications forwarded by xpra appear on your desktop as normal windows managed<br>
by your window manager, rather than being all ‚Äútrapped in a box together‚Äù. Xpra also uses a custom protocol that is self-tuning and relatively latency-insensitive, and thus is usable<br>
over network connections that are too slow or unreliable for standard X forwarding. Xpra can also be used to shadow an existing X11 display.‚Äù</p>
<p><a href="https://dwaves.de/wp-content/uploads/2019/11/xpra.man_-1.txt">src: manpage: xpra.man.txt</a></p>
<p>By default the Xpra server announces available sessions (username and display number) via mDNS to the local network. Use mdns=no to disable it.</p>
<p><a href="https://xpra.org/">xpra</a> developed by <a href="https://en.wikipedia.org/wiki/Xpra">Nathaniel Smith, Antoine Martin</a> as seen on <a href="https://superuser.com/questions/249391/how-to-resume-disconnected-ssh-x11-forwarded-applications">superuser.com</a>, <a href="https://xpra.org/trac/wiki/Download#Linux">https://xpra.org/trac/wiki/Download#Linux</a></p>
<p><a href="http://devloop.org.uk/">Antoine Martin http://devloop.org.uk/</a></p>
<p><a href="https://www.pobox.com/">Nathaniel Smith https://www.pobox.com/</a></p>
<p><a href="https://www.serviware.com/">Arthur Huillet https://www.serviware.com/</a></p>
<p>is a pretty cool ‚Äúrun my gui app on server but display window locally‚Äù x11 window forwarding tool.</p>
<p>tested 2018-11-21:</p>
<pre><span>hostnamectl</span>
  Operating System: CentOS Linux 7.5 (Core) (client and server)
      Architecture: x86-64

# on client and server install xpra package
# ubuntu/debian apt based
<span>apt update</span>
<span>apt install xpra</span>
# fedora/centos/redhat rpm based
<span>cd /etc/yum.repos.d/ &amp;&amp;  sudo wget https://xpra.org/repos/CentOS/xpra.repo
yum update
yum search xpra</span>

ffmpeg-xpra.x86_64 : ffmpeg libraries for xpra
ffmpeg-xpra-debuginfo.x86_64 : Debug information for package ffmpeg-xpra
libvpx-xpra.x86_64 : vpx library for xpra
libwebp-xpra.x86_64 : WebP library and conversion tools for xpra
libwebp-xpra-debuginfo.x86_64 : Debug information for package libwebp-xpra
python2-xpra.x86_64 : python2 build of xpra
python2-xpra-audio.x86_64 : python2 build of xpra audio support
python2-xpra-client.x86_64 : python2 build of xpra client
python2-xpra-server.x86_64 : python2 build of xpra server
x264-xpra.x86_64 : x264 library for xpra
x264-xpra-debuginfo.x86_64 : Debug information for package x264-xpra
xpra.x86_64 : Xpra gives you "persistent remote applications" for X.
xpra-common.noarch : Common files for xpra packages
xpra-common-client.noarch : Common files for xpra client packages
xpra-common-server.noarch : Common files for xpra server packages
xpra-debuginfo.x86_64 : Debug information for package xpra
xpra-html5.noarch : Xpra HTML5 client
ffmpeg-xpra-devel.x86_64 : Development package for ffmpeg
libvpx-xpra-devel.x86_64 : Development files for the vpx library
libwebp-xpra-devel.x86_64 : Development files for the webp library
x264-xpra-devel.x86_64 : Development files for the x264 library

<span>yum install xpra xeyes xclock

</span># restart server and client

# still on client testrun (ssh on default port 22 (can leave this out))<span>
xpra start ssh/user@server.com:22 --start-child=xeyes
</span>
<a href="https://dwaves.de/wp-content/uploads/2018/11/xpra.png"><img loading="lazy" src="https://dwaves.de/wp-content/uploads/2018/11/xpra.png" alt="" width="948" height="471" srcset="https://dwaves.de/wp-content/uploads/2018/11/xpra.png 948w, https://dwaves.de/wp-content/uploads/2018/11/xpra-300x149.png 300w, https://dwaves.de/wp-content/uploads/2018/11/xpra-768x382.png 768w" sizes="(max-width: 948px) 100vw, 948px"></a>
# now in the terminal window
# if you hit Ctrl+C (Cancel)
# it will disconnect, but leave xeyes running on the server
# to reconnect
<span>xpra attach ssh:user@server.com:22</span>

# amazing! stuff! well done :)

# <a href="https://xpra.org/trac/wiki/Clients/HTML5">html5 client</a>
<span>xpra start --bind-tcp=0.0.0.0:14500 --html=on --start=xterm</span>
# You can then point your browser to
# ‚Äãhttp://localhost:14500/
# and the xterm should appear in your browser window. 
</pre>


<p><a href="https://dwaves.de/wp-content/uploads/2019/11/xpra.man_.txt">xpra.man.txt</a></p>

<p><a href="https://dwaves.de/wp-content/uploads/2019/11/xpra_menu.png"><img loading="lazy" src="https://dwaves.de/wp-content/uploads/2019/11/xpra_menu.png" alt="" width="265" height="506" srcset="https://dwaves.de/wp-content/uploads/2019/11/xpra_menu.png 265w, https://dwaves.de/wp-content/uploads/2019/11/xpra_menu-157x300.png 157w" sizes="(max-width: 265px) 100vw, 265px"></a></p>
<p>#OMG! It even allows file upload into the user‚Äôs home directory!</p>
<p>holy cow üôÇ</p>
<p>it also tries to implement remote-print‚Ä¶ meaning: if you open a document on the server, it shall allow you to print locally. (untested)</p>
<p>‚Äú2018-11-22 14:00:32,372 Error: printing disabled:<br>
2018-11-22 14:00:32,372 No module named cups‚Äù</p>

<p>very well done statistics dialogue</p>
<p><a href="https://dwaves.de/wp-content/uploads/2019/11/xpra_graphs_statistics.png"><img loading="lazy" src="https://dwaves.de/wp-content/uploads/2019/11/xpra_graphs_statistics.png" alt="" width="734" height="453" srcset="https://dwaves.de/wp-content/uploads/2019/11/xpra_graphs_statistics.png 734w, https://dwaves.de/wp-content/uploads/2019/11/xpra_graphs_statistics-300x185.png 300w" sizes="(max-width: 734px) 100vw, 734px"></a></p>

<p><a href="https://xpra.org/trac/wiki/Usage" target="_blank" rel="noopener noreferrer">https://xpra.org/trac/wiki/Usage</a></p>
				
									<!--/aboutauthor-->
				

								
			</div></div>]]>
            </description>
            <link>https://dwaves.org/2019/01/21/how-to-resume-a-ssh-encrypted-and-x11-forwarded-session/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24342148</guid>
            <pubDate>Tue, 01 Sep 2020 14:31:59 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Ger√§t 32620: the machine that powered numerous number stations]]>
            </title>
            <description>
<![CDATA[
Score 172 | Comments 62 (<a href="https://news.ycombinator.com/item?id=24342120">thread link</a>) | @fanf2
<br/>
September 1, 2020 | https://blog.ardy.io/2020/8/geraet-32620/ | <a href="https://web.archive.org/web/*/https://blog.ardy.io/2020/8/geraet-32620/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div class="page">
    
  
  <div>
      <div>
      
        
      
      
        <p>The machine that powered numerous Number Stations</p>
      
        <p>
          uberardy ‚Äî 2020-08-29
        </p>
      </div>
  
  <div>
    <p>A few years ago, I first stumbled over some recordings of number stations and started reading up on their history. For most of them, we have pretty good guesses who ran them and for what purpose. One example is the <a href="https://www.youtube.com/watch?v=wxlrnAC7Y7Q">Gongs and Chimes Station</a>, known for its melody that got increasingly creepy over the years, the more worn down the tape got. What always seemed mysterious to me is the kinds of devices used to actually generate the spoken messages. Were they similar to electromechanical devices used for time announcements over the telephone, <a href="https://youtu.be/4aMqKr0D-7o?t=47">with multiple play heads</a> or <a href="https://www.youtube.com/watch?v=lESMfh72RJg">complicated tape mechanisms</a>?</p>
<p>Then, I stumbled over <a href="https://www.youtube.com/watch?v=4buFLqjvTjA">this video</a>. And... It's <em>the actual voice</em> used by the <em>Gongs and Chimes</em> Station? What surprised me was how rather small, polished and complex the machine seemed. There definitely was a microcontroller in there, it had an LED display, and just in general seemed like a rather fancy device.</p>

</div>

<div>
    
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/sprach-morse-generator.jpg" alt="Grey box-shaped machine with a tilted front panel. There are a paper punch tape reader, LED display and numeric keyboard with some extra buttons on the front."> 
    </p>
    
</div>

<div>
    <p>The most important thing however was, I finally knew what to look for. Searching for "Sprach-Morse-Generator" (Speech-Morse-Generator) quickly got me to <a href="https://www.cryptomuseum.com/spy/owvl/32620/index.htm">a page about it at the crypto museum</a> which also mentions its official name: "Ger√§t 32620" (Device 32620). The page also has some great information about the history of the device and the voice behind it.</p>
<p>What exited me the most was... There are actually links to technical documentation about the Speech generator and its companion device, Ger√§t 32621, which could be used for digitizing voice recordings and writing them to EPROM cartridges to use with Ger√§t 32620.</p>

</div>

<div>
    <h3><a href="https://www.cryptomuseum.com/spy/owvl/32620/files/MfS_OTS_4061.pdf">The 32620 Guide</a></h3>
<p>I don't want to go over everything mentioned in these guides; if you speak German I'd recommend giving it a read yourself; but I do want to mention some things I found notable.</p>
<p>As input, either paper punch tapes, the keyboard, or a serial interface (RS-232) can be used. The last one is a bit unclear, it is mentioned in the beginning, but later parts of the document mention it as a possible future addition. Either way, the messages are transferred to RAM, from where they can later be transmitted. It can hold up to 3791 characters.</p>
<p>The language samples are loaded from an exchangeable cartridge which can hold up to 96 kByte, where they are stored as uncompressed <a href="https://en.wikipedia.org/wiki/Pulse-code_modulation">PCM</a> . They proudly mention the cartridges can be swapped in 10 seconds.</p>

</div>

<div>
    
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/sprachgenerator.png" alt="Table which shows which settings correspond to how many words per minute, and that the pitch can be varied up or down by 10%."> 
    </p>
    <p>The number of words per minute and pitch of the voice can be varied, which explains why some recordings of number stations with the same voice sound a bit different.</p>
</div>

<div>
    <p>Technical drawing of the display and keyboard. The display can show which message, group and digit is played right now.</p>
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/tastatur.png" alt="Technical drawing of display and keyboard: Display showing three groups of digits. Keyboard with numeric buttons, &quot;RES&quot;, &quot;STA/STP&quot;, &quot;<&quot;, &quot;>&quot;, &quot;MODE&quot;, &quot;INP&quot;, &quot;EX&quot;, &quot;OUT&quot;, &quot;CLR&quot; buttons."> 
    </p>
    
</div>

<p>What I find quite surprising: The keyboard and output of the device mostly uses English words. A bit unexpected for a device developed in eastern Germany for use in the Soviet Union; I would rather have expected Russian there.</p>

<div>
    
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/flowchart.png" alt="Chart showing which buttons to press and what will appear on the display for inputting morse code."> 
    </p>
    <p>There are some pretty charming charts in the documentation showing some interactions with the device.</p>
</div>

<div>
    <p>Bus chart of the whole system. Interestingly, it shows a second language module, although the final device only supports one language module at a time.</p>
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/bus_chart.png" alt="Bus and component chart of the system, showing how the microcontroller (z80) is connected to program memory, RAM, IO devices. like keyboard and display, a digital to analogue converter for sound output and the language module for the speech samples."> 
    </p>
    
</div>

<div>
    
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/backside.png" alt="Technical drawing of the back of the device, with power and data inputs and line output."> 
    </p>
    <p>On the back are a speaker, output to the transmitter and some status outputs and remote control inputs. These were probably used so the chimes and speech wouldn't overlap.</p>
</div>

<p>There are also pretty detailed schematic drawings and lists of component at the end of the document.</p>

<div>
    <h3><a href="https://www.cryptomuseum.com/spy/owvl/32620/files/MfS_OTS_4062b.pdf">The 32621 Guide</a></h3>
<p>This is the companion device used for digitizing voices and writing them to cartridges for the 32620. It's quite astounding how complicated this device really is: It can either record words separately or all of them in one go, it automatically recognizes the beginning and end of the words, it can duplicate cartridges and it even has a UV chamber for clearing the EEPROMS on a cartridge to reuse it.</p>
<p>What's interesting: There are no photos of this device. It's unclear how many were produced, there may just have been one or two. The only things we know about it are from this document.</p>
<p>In its architecture, it is quite similar to the 32620, it has a very similar keyboard and probably the same display.</p>

</div>

<div>
    <p>One interesting difference: It uses German labels on the keyboard. Also, all of the text it shows on the display is in German.</p>
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/tastatur2.png" alt=""> 
    </p>
    
</div>

<div>
    <p>The documentation mentions recording up to 20 words. This also came up in the 32620's documentation, although only 13 words were ever used: digits 0-9, "Achtung" (Attention), "Trennung" (Seperation) and "Ende" (End).</p>
<p>It has controls for adjusting the 0-level of the recordings and amplification. LEDs show whether it senses an audio signal and whether it's clipping. The amplification for single words can also be adjusted later, from a value of 0 to 7. It seems like this doesn't actually change the recorded samples but controls the amplification level in the digital to analogue converter. This feature is intended for making all the digits similar in volume.</p>
<p>I find this a bit surprising, all of this is something that could be done with other equipment, especially since only two different voices for these machines are known: German and Spanish.</p>
<p>In order to check the recording, either all recorded digits or just combinations of them can be played back.</p>
<p>When programming to an EPROM, it transfers the start address and amplification for each word and the samples from RAM to the ROM and checks whether the values it reads back after programming are as expected.</p>

</div>

<div>
    
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/cartridge.png" alt="Technical drawing of an EPROM cartridge with the chips numbered from left to right."> 
    </p>
    <p>Numbering of the EPROMs on the cartridge. If the read back values don't match, the operator can switch out the offending EPROM chip.</p>
</div>

<p>There is a separate mode for deleting cartridges where the time to expose them to UV can be typed in via the keyboard. If the rom cartridge is double sided, the cartridge has to be turned around to delete the chips on the other side.</p>

<div>
    <p>For all of the different modes of the 32621, flow charts for the interface are provided.</p>
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/record-flowchart.png" alt="Flow chart that shows keypresses and the displayed text for recording words."> 
    </p>
    
</div>

<div>
    
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/front.png" alt="Technical drawing of the front of the device, with keyboard, display and slots for programming and deleting cartridges."> 
    </p>
    <p>The front also features various other indicators, e.g. for the different voltages in the device.</p>
</div>

<p>This manual also includes schematics for the device.</p>

<div>
    <h3>The EPROMS</h3>
<p>The crypto museum also provides dumps of the EPROMS for both the German and Spanish cartridges.</p>
<p>Having read the manuals, decoding them is actually not that hard: The data is stored as PCM, and the 32621 Guide mentions the time between samples is 125Œºs, which adds up to a sample rate of 8000Hz.
Loading the roms into Audacity with File&gt;Import&gt;Raw Data, you can actually already listen to them!</p>
<p>[Edit: Here are the dumps as WAVs, if you're interested: <a href="https://blog.ardy.io/2020/8/geraet-32620/2620_ger.wav">german</a>, <a href="https://blog.ardy.io/2020/8/geraet-32620/2620_span.wav">spanish</a>]</p>
<h4>The Header</h4>
<p>In the very beginning of the first EPROM, there are 64 byte of header information, containing the start address for each word and its amplification factor. For 20 words, that leaves just over 3 bytes per word, although they seem to just stick to 3.</p>
<p>Decoding the rest of the header took a lot longer than anticipated. I found the 3 bits for the amplification value pretty quickly in the last byte for each word. The rest somehow had to be the start address or some offset, and possibly the length. For accessing the values in each of the 8K chips, 13 Bits for the address are needed. To select one of the up to 12 EPROMs, another 4 Bit are required. This adds up to 17 Bits, so one more than in two bytes.</p>
<p>To get around this, there are two obvious solutions: Stuff the one extra bit into the byte which holds the amplification level, or throw away the least significant bit for the start address, so just every other sample can be used as the start sample.</p>
<p>Two things made this really hard to pin down: The z80 is a <a href="https://en.wikipedia.org/wiki/Endianness">little endian machine</a>, meaning for 16 bit values, the less significant byte is stored before the more significant byte, but this doesn't mean they would <em>have</em> to store the values in this order. Also, the binary chip select value for the first EPROM isn't 0, but 2. I only stumbled upon that when looking at the schematic for the EPROM cartridge (p. 38 in the 32620 manual). There's also a really cute demultiplexer built from discrete AND and NAND gates for translating the chip address to the actual chip select lines!</p>

</div>

<div>
    <p>Isn't it gorgeous! Note how it only <em>suggests</em> the presence of the fourth address line for the chip select with that not connected NAND.</p>
    <p><img src="https://blog.ardy.io/2020/8/geraet-32620/demux.png" alt="The schematic for the demultiplexer built out of discreet components."> 
    </p>
    
</div>

<div>
    <p>My best guess to why is the case is the chip select address values 0 and 1 are already used to select some other components. But, at last, I think I found out how it works:</p>
<p>For each word, the second byte contains the 3 least significant bits for the chip select and 5 of the address bits. The first byte contains the remaining 8 address bits. The end of each word is the beginning address for the next word. That's why there are two extra bytes after the last word. This would have worked for up to twenty words, as there would still be 4 spare bytes to contain the end address of the last word. The third byte contains the remaining chip select bit, some mysterious bits, and 3 bits for the amplification level.</p>
<p>The remaining chip select bit is still a bit confusing to me: The German recordings don't use it, since they fit on just 6 EPROMs. The Spanish one has to use it for the last two words, but there's something odd happening with the values in the one before the last two words.</p>
<p>Another thing worth noting: The German words all use the default amplification level of 3, whereas the Spanish ones use lower and higher values for some words. To be <em>really</em> authentic, you'd have to take that into account when playing the samples.</p>
<p>One last thing I was interested in: The Spanish voice uses the same word for "Trennung" and "Ende"&amp;em;"final", and they sure <em>sound</em> the same. So, is ‚Ä¶</p></div></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://blog.ardy.io/2020/8/geraet-32620/">https://blog.ardy.io/2020/8/geraet-32620/</a></em></p>]]>
            </description>
            <link>https://blog.ardy.io/2020/8/geraet-32620/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24342120</guid>
            <pubDate>Tue, 01 Sep 2020 14:30:18 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[From Hello World to a production app in 5 days: The magic of Blitz.js]]>
            </title>
            <description>
<![CDATA[
Score 12 | Comments 0 (<a href="https://news.ycombinator.com/item?id=24341970">thread link</a>) | @flybayer
<br/>
September 1, 2020 | https://kitze.io/posts/launching-fungarzione-with-blitz | <a href="https://web.archive.org/web/*/https://kitze.io/posts/launching-fungarzione-with-blitz">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><div><div><p>You already know that I'm pretty frustrated with the way we do things on the web. In order to fetch a list of things and display them as rectangles on a webpage, we need to jump through 1938137 hoops. What is this, Circus Charlie? Anyone? Remember that game??? I'm old üò≠</p>&nbsp;<h2>The problem with our current stack</h2><p>The process of making a web app is so unnecessarily complex and so many people are going for a SPA even when it's not needed. GraphQL makes working with an API easy, but it still involves building that API, and writing a lot of boilerplate. You might not mind all of that until someone removes the layer for you. And that's <a href="https://blitzjs.com/" target="_blank" rel="noopener noreferrer">Blitz</a>.</p>&nbsp;<p>"Damn, I just want to fetch some data directly from the database and display it!" - You, probably</p>&nbsp;<p>"You can do that with PHP and raw SQL..." - Someone on HN, probably</p>&nbsp;<p>"LMAO" - You</p>&nbsp;<p>"Well, why don't you use Rails?" - Someone on Reddit, probably</p>&nbsp;<p>"I only know JavaScript and I want to use React" - You, probably</p>&nbsp;<p>"Welp, too bad there's nothing similar to Rails in the React world..." - Someone on Twitter, probably</p>&nbsp;<p>"Hey, what if there was a Fullstack React framework, similar to Ruby on Rails?" - Blitz, if it could talk, probably</p>&nbsp;<p><em>Meteor crying in the corner, probably</em></p>&nbsp;<h2>What is Blitz?</h2><p>Blitz "removes" the API layer in a very clever way so you can directly call functions from your backend, which completely changes the game. Actually, this is not the best way to describe what it does, so you better <a href="https://blitzjs.com/" target="_blank" rel="noopener noreferrer">read the docs</a>. TL;DR: it's magic.</p>&nbsp;<p>What I like about Blitz is that it builds on top of already solid solutions like <a href="https://nextjs.org/" target="_blank" rel="noopener noreferrer">Next.js</a>, <a href="https://react-query.tanstack.com/" target="_blank" rel="noopener noreferrer">react-query</a>, and <a href="https://prisma.io/" target="_blank" rel="noopener noreferrer">Prisma</a>. I already used them in other projects, but I love the way Blitz glues all of them together and it magically works. </p>&nbsp;<p>The ability to get whatever you want directly from the database, with the nicely typed API from Prisma, and then just display it, is a pretty wonderful experience. It makes me feel that for years we had no frickin' clue why we did things the way we did them, until finally someone realized that we don't have to do them that way.</p>&nbsp;<p>When generating a new Blitz app you get all the authentication boilerplate generated for you and I all I have to say is <em>fucking finally</em>.  It's 2020, I don't want to build the authentication layer again, and again, and again, and again. Hey frameworks, just let me get me the current user with <code>const user = useCurrentUser()</code> and don't bother me with anything else.</p>&nbsp;<p>I can't even describe how fast you can ship a product when there is no API layer and boilerplate involved. </p>&nbsp;<p>There are similar frameworks to Blitz which go in a completely different direction by rebuilding most of the stack. Personally, I'm tired of the React community constantly reinventing things that don't need reinventing. Next.js is already amazing, so just imagine how much code we'd be able to reuse if we all agree on using it by default. More reusing, less reinventing, please.</p>&nbsp;<h2>Launching a production app in a few days</h2><p>I already did <a href="https://www.youtube.com/watch?v=RiLYvLNDeKA" target="_blank" rel="noopener noreferrer">two</a> <a href="https://www.youtube.com/watch?v=Qr-7Z9Grvfw" target="_blank" rel="noopener noreferrer">streams</a> with <a href="https://twitter.com/flybayer" target="_blank" rel="noopener noreferrer">Brandon</a>, the creator of Blitz, and I couldn't wait to actually try Blitz on a real project. The problem is, I needed a real project because I didn't want to waste my time on some demo gibberish which is never going to see the light of day.</p>&nbsp;<p>I got frustrated by the app that I was using for writing changelogs for <a href="https://sizzy.co/" target="_blank" rel="noopener noreferrer">Sizzy</a>, so I decided to sit down and write <a href="https://fungarzione.com/sizzy" target="_blank" rel="noopener noreferrer">my own tool</a> with some more advanced features that will make the process easier. </p>&nbsp;<p>I <a href="https://twitch.tv/thekitze" target="_blank" rel="noopener noreferrer">livestreamed the entire process</a> from "hello world" to deployment and I couldn't believe that it only took me only 5 days. </p>&nbsp;<p>Actually, the majority of the work was done in only 2 days, which is crazy. Someone commented "my boss shouldn't see this" on the stream and the credit for that goes to Blitz. You can definitely ship faster than a team of people who would argue about the modeling of the API, raw SQL queries, and whether to use redux-saga or RxJS for fetching the data.</p>&nbsp;<p>Hey Kitze, if you finished most of the things in 2 days, why did it take you 5 days?</p>&nbsp;<p>Great question, reader.</p>&nbsp;<ul><li><svg viewBox="0 0 14 14" focusable="false" role="presentation"><g fill="currentColor"><polygon points="5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"></polygon></g></svg>Day 3: Polishing the design and adding extra features</li><li><svg viewBox="0 0 14 14" focusable="false" role="presentation"><g fill="currentColor"><polygon points="5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"></polygon></g></svg>Day 4: Deployment. I deployed the database to DigitalOcean without a problem, but I had a problem with deploying the Blitz app to Vercel. Turns out, the problem wasn't with Blitz or Vercel and it was ... TypeScript. Yup, I couldn't deploy the app because TS was being a pain in the ass, and the Vercel logs didn't show that. I had to dive deep, find the problematic files, and fix everything, so that took most of the day.</li><li><svg viewBox="0 0 14 14" focusable="false" role="presentation"><g fill="currentColor"><polygon points="5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"></polygon></g></svg>Day 5: CSS. Of course. You can put as many layers as you want on top of CSS, it's still CSS at the end of the day. I literally lost an entire day on centering things and making sure the fixed header and sticky footer layouts work in Safari on iOS. Oh, by the way, fuck Safari. We finally got rid of the pain that's IE pain, but Safari is here to replace it.</li></ul><h2>Why another changelog app?</h2><p>I would never make an app if there wasn't an actual need for it. There are tons of Saas products for making changelogs, but I had something different in mind.</p>&nbsp;<p>I was using a popular solution for writing the Sizzy changelogs for 1.5 years. However, the changelog was a huge markdown document, so we had to use Notion boards to plan the work as individual cards, and then collaborate on them with the Sizzy team. When we were done, we'd export markdown from all the cards and merge them in a giant markdown document. In the past 3 months, I'm working on the changelog alone, so I decided to directly write the giant markdown document. Aside from being an overwhelming experience, I also lost my 3 hours of progress by accidentally closing the tab.</p>&nbsp;<p>So I said: fuck it, I'd rather build a proper changelog app instead of writing this changelog again.</p>&nbsp;<p>I wanted to improve the process of collaborating and publishing a changelog, and in the process, I came up with a bunch of ideas that will hopefully change the changelog game. Wait... was there ever a <em>changelog game</em>? If not, there is now. Boom üé§</p>&nbsp;<p>Wait, the mic should actually drop.</p>&nbsp;<p>üé§  </p>&nbsp;<p>There.</p>&nbsp;<h2>Introducing <a href="https://fungarzione.com/" target="_blank" rel="noopener noreferrer">Fungarzione</a> - The Changelog Of The Future</h2><p>Instead of publishing a giant markdown document, a team of collaborators would start working on individual entries. The editor supports Markdown, but also MDX, with a set of custom components that would make the changelogs way better. </p>&nbsp;<p>Creating a changelog entry is super simple, and it's not as overwhelming as starting a giant markdown document.</p>&nbsp;&nbsp;<p>Individual entries can then progress from Draft to Ready For Review, to Published. Team collaboration features like assigning people and commenting on the entries will be available when registration is open to everyone.</p>&nbsp;&nbsp;<p>After creating a bunch of entries, a changelog is created by combininig individual entries, as well as adding a list of small bug fixes and improvements, which will appear grouped at the end of the document.</p>&nbsp;&nbsp;<p>Then, the draft changelog is moved to "Ready for Review" and it cannot be published, unless all of the entries in that changelog area already published.</p>&nbsp;&nbsp;<p>Users can leave feedback individually for each changelog, as well as subscribe to get an email when a new changelog is published.</p>&nbsp;&nbsp;<h2>Fungarzione is live</h2><p>I already ported <a href="http://fungarzione.com/sizzy" target="_blank" rel="noopener noreferrer">the last 10 changelogs for Sizzy</a> to Fungarzione and I'm already in love with the publishing experience. It's not that overwhelming and I can work on the changelog in chunks.</p>&nbsp;<p><em>self high-five</em></p>&nbsp;<p>Also, to be honest, even with my mediocre design skills, it already looks better than some of the popular changelog apps out there üôà </p>&nbsp;<p><em>taps myself on the back a bit more</em> </p>&nbsp;<p>If you're interested in signing up you can <a href="https://fungarzione.com/" target="_blank" rel="noopener noreferrer">leave your email here</a> and you'll get a notification when public access is available (hopefully soon).</p>&nbsp;<p>I'm also looking for people who'd like to port their changelog <em>now</em>, so I can get some feedback on the editor experience. You just need to have a production app with an established user base, as well as an existing changelog. Just <a href="mailto:kristijan.mkd@gmail.com" target="_blank" rel="noopener noreferrer">shoot me an email</a> and we can discuss.</p>&nbsp;<h2>Conclusion on Blitz</h2><p>I still have to explore Blitz a bit more to figure out all the downsides, but I think that I'd definitely pick Blitz for most of my future apps, unless I have a really specific reason not to. Brandon said there will be a way to reuse the same Blitz client in React Native apps, so you won't miss the actual API layer.</p>&nbsp;<h2>Fungarzione</h2><p>I know what you're thinking right now.</p>&nbsp;<p>Fungarzione?!</p>&nbsp;<p>FUNGARZIONE?!?! What the hell does the name mean, Kitze?</p>&nbsp;<p>Fungarzione comes from the word Fungangarzione. And the origin of Fungangarzione is really a long story, so I guess you'll have to <a href="https://twitch.tv/thekitze" target="_blank" rel="noopener noreferrer">hang out in my stream</a> to find out üòú I'm planning to live stream the rest of the work on this app, and trust me, there are too way too many things that I'd like to do. If you have any ideas or suggestions you're more welcome to join my stream! üôå</p>&nbsp;<p>I want to give another shout-out to all the people on Twitch who helped me while I was building this app (even though they're credited in the footer of the page).</p>&nbsp;<p>There's no way I would've shipped it in such a short time without your help üíú</p>&nbsp;</div></div></div></div>]]>
            </description>
            <link>https://kitze.io/posts/launching-fungarzione-with-blitz</link>
            <guid isPermaLink="false">hacker-news-small-sites-24341970</guid>
            <pubDate>Tue, 01 Sep 2020 14:19:43 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Why Privacy Matters]]>
            </title>
            <description>
<![CDATA[
Score 250 | Comments 84 (<a href="https://news.ycombinator.com/item?id=24341079">thread link</a>) | @Clo_S
<br/>
September 1, 2020 | https://thistooshallgrow.com/blog/privacy-security-roundup | <a href="https://web.archive.org/web/*/https://thistooshallgrow.com/blog/privacy-security-roundup">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div data-block-type="2" id="block-0690890445953831c024"><div><p><em>Trigger warning: authoritarianism, state surveillance, the Holocaust. If you want to avoid these topics, please jump to the last paragraph of this introduction, starting with ‚ÄòEnough about the depressing stuff.‚Äô</em></p><p>Before we start, I feel like I need to give a bit of background on why I care so deeply about privacy. It‚Äôs partly historical. Being Ashkenazi, I learnt from a very young age about the importance of sensitive information, and who you give that information to. My grandfather broke the law by not going to the police station to register himself as a Jew. The Holocaust saw 76,000 Jews deported to death camps from France alone - around 1/4th of the country‚Äôs Jewish population at the time. There‚Äôs a chance that not being part of the Jewish census saved his life. Lesson: be careful who you give sensitive information to.</p><p>That grandfather and two of his brothers left Paris in the middle of the war, and took a train south with no plan, no luggage, no contact, and no destination other than, well, heading south. They were helped by strangers and survived. Their mother however, along with two other siblings, had a plan. They had a deal with a smuggler to reach unoccupied France. The smuggler informed the Nazis, and all 3 of them died in deportation. Lesson: each person who has information on you represents an additional chance for it to be leaked.</p><p>And yes, we can raise the irony of mentioning my Jewish grandpa to warn you against sharing sensitive information online. There, I just did.&nbsp;</p><p>While this happened in the 1940‚Äôs, a data point‚Äôs lifespan is drastically different today. It‚Äôs possible that you posted something online 10 years ago, and it was fine back then, but 20 years from now you will hope that no one finds it. My message is: the Internet never forgets, cultures change, and retroactive laws exist. People can get screwed over digital data. Let‚Äôs take the obvious example: China‚Äôs state surveillance has an eye on literally each and every move of its inhabitants, whether physical or digital. The state uses extensive data to allocate social scores, which can have a <a href="https://www.abc.net.au/news/2018-09-18/china-social-credit-a-model-citizen-in-a-digital-dictatorship/10200278?nw=0" target="_blank">drastic impact</a> on Chinese people‚Äôs life, including banning them from purchasing train or plane tickets, providing them with lower Internet speed, and denying them visas and loans. China also makes use of this surveillance system <a href="https://edition.cnn.com/interactive/2020/02/asia/xinjiang-china-karakax-document-intl-hnk/" target="_blank">against its Uyghur population</a>, detaining between 1 and 2 million people - the estimates vary - in concentration camps, where prisoners suffer <a href="https://en.wikipedia.org/wiki/Xinjiang_re-education_camps#Testimonies_of_treatment" target="_blank">extensively reported torture, brainwashing and forced labour</a>.&nbsp;</p><p>Apart from governmental issues, there‚Äôs also the topic of pervasive <a href="https://www.youtube.com/watch?v=iFTWM7HV2UI" target="_blank">tracking and ads</a>, championed by Facebook and Google. I‚Äôm yet to see the difference between today‚Äôs digital advertising and individually-customised mass manipulation. Maybe because there is none. Please try and change my mind if you have any conclusive elements.</p><p>Enough about the depressing stuff. I‚Äôve explained why your privacy matters, and we‚Äôre now about to dive into a few security concepts. I wrote this article with <a href="https://twitter.com/lp1eu" target="_blank">lp1</a>, as he knows much more about these concepts than I do. So here‚Äôs my first pro tip for you, unrelated to privacy or security: date people you admire. Now, let‚Äôs get into the technical aspects.</p><h2>CIA</h2><p>The CIA ‚Äòtriad‚Äô is a summary of the main concepts of information security. There are 3 aspects regarding information which are targeted by infosec:</p><ul data-rte-list="default"><li><p><strong>Confidentiality</strong>:<strong> </strong>the assurance that a piece of information can only be observed by authorised third parties.</p></li><li><p><strong>Integrity</strong>:<strong> </strong>the assurance that a piece of information is and stays accurate over time.</p></li><li><p><strong>Availability</strong>: the assurance that a piece of information can be accessed by an authorised user when they need it.</p></li></ul><h2>Encryption: Server-side vs. Client-side</h2><p>Encryption secures data and aims to maintain its confidentiality and integrity.</p><p>We differentiate server-side from client-side encryption. Server-side means that only information stored on said server is encrypted. This means that the company has the encryption key, and therefore can access your communication (yes, including your nudes). However, server-side encryption doesn‚Äôt apply to the <strong>transmission </strong>of your communication. The data you share is not necessarily encrypted, only the storage is, which is why you should favour platforms that use <a href="https://en.wikipedia.org/wiki/HTTPS" target="_blank">https</a>.</p><p>Client-side ‚Äì or end-to-end ‚Äì encryption means that the transmission of your information is encrypted, and that <strong>only your device</strong> has the key. If you log in from a different device, you won‚Äôt be able to see the exchanges. Since the company <strong>does not have the key</strong>,<strong> </strong>they cannot access your messages. As a result, even if they were to store your exchanges, said exchanges would automatically be encrypted. However, this also means that you won‚Äôt be able to recover your messages, should you lose the key.</p><p>In the case of a communication service, this means that the nudes you're sending to <strong>someone you trust</strong> are encrypted from your device to the company's server, as well as from their server to your trusted partner's device. Without encryption however, anyone on your network can see and tamper with all your communications. By 'tamper with', we mean any kind of modification by an unauthorised third-party. Examples include someone changing your password and email address on a platform to take over your account, deleting your private files on a cloud file storage service, replacing software in your online backups with malware, etc.</p></div></div><div data-block-type="2" id="block-yui_3_17_2_1_1598877921511_5282"><div><p>A recent example is the July Twitter hack, during which <a href="https://twitter.com/TwitterSupport/status/1286088135525318656" target="_blank">hackers managed to read users' messages from Twitter's admin control panel</a>. &nbsp;With end-to-end encrypted DMs, no one at Twitter would have been able to access them.</p><h2>Encryption vs. Hashing</h2><p>A distinction has to be made between two important notions: encryption and hashing. Encrypting information means that you turn it into scrambled text which can be decoded with a key. For instance, it's useful to make sure a communication between two peers cannot be read by an unauthorised person.&nbsp;</p><p>Hashing a piece of data on the other hand means that you turn it into a <strong>unique signature</strong> which <strong>cannot be reversed</strong> into its original readable state. The only way for someone to obtain the original input based on the hashing output, is to try inputs themselves until their output matches. Hashing is not intended as a cypher to decrypt, which is why encryption and hashing serve different purposes and are used in different cases. Hashing is noticeably useful to store passwords, because you avoid storing the actual easy-to-steal-and-reuse passwords. Instead, you compare the hashing output that you store to the hashing output of what a user entered while trying to log in. If you get the same hash that you‚Äôve stored, then the password is correct.</p></div></div><div data-block-type="2" id="block-yui_3_17_2_1_1598877921511_7990"><div><h2>100% secure does not exist</h2><p>Flaws and vulnerabilities can always be found. However, the sturdier your tools, the safer you'll be. And contrary to <a href="https://www.youtube.com/watch?v=djV11Xbc914" target="_blank">what A-ha used to sing</a>, it is better to be safe than sorry.</p><h2>Free vs. Open source</h2><p>Free and open source software are specific philosophies, based on specific values. Free software specifically refers to the notion of users' freedom, which isn't the case in open-source software. As <a href="https://www.gnu.org/philosophy/free-sw.en.html" target="_blank">the GNU website</a> puts it: 'To understand the concept, you should think of ‚Äúfree‚Äù as in ‚Äúfree speech,‚Äù not as in ‚Äúfree beer‚Äù'.</p><p>There are 4 criteria for software to be free:</p><ul data-rte-list="default"><li><p>Freedom 0: The freedom to run the programme as you wish, for any purpose.</p></li><li><p>Freedom 1: The freedom to study how the programme works, and change it so it does your computing as you wish. This entails having access to the source code.</p></li><li><p>Freedom 2: The freedom to redistribute copies so you can help others.</p></li><li><p>Freedom 3: The freedom to distribute copies of your modified versions to others.</p></li></ul><p>On the other hand, open-source software has a <a href="https://opensource.org/osd" target="_blank">less strict definition</a>, and a different philosophy. You can also see the source code, amongst other things.</p><p>If you want to get into the political aspect of these terminologies, <a href="https://www.gnu.org/philosophy/floss-and-foss.en.html" target="_blank">here</a>‚Äôs a good explanation.</p><h2>Credential stuffing attack</h2><p>Credential stuffing is a popular attack whose goal is to automatically test a user‚Äôs known credentials on multiple platforms on a large scale. Nowadays, it is widely used by malicious intruders because of the online accessibility of billions of credentials gathered from data leaks (<a href="https://www.troyhunt.com/dating-the-ginormous-myspace-breach/" target="_blank">MySpace</a>, <a href="https://www.bleepingcomputer.com/news/security/dailymotion-allegedly-hacked-85-million-user-accounts-stolen/" target="_blank">Dailymotion</a>, <a href="https://www.troyhunt.com/the-dropbox-hack-is-real/" target="_blank">Dropbox</a> to name some of the biggest).</p><p>And there you have it, a roundup of the main security concepts. Feel free to reach out to <a href="https://twitter.com/lp1eu" target="_blank">lp1</a> or <a href="https://twitter.com/this2shallgrow" target="_blank">me</a> on Twitter. Part 2 will be available next week, with a list of the privacy and security tools we frequently use and recommend.</p><p>If you‚Äôre looking for a UX researcher or UX designer to work in the privacy and security sphere, I‚Äôd love to have a chat with you! </p></div></div></div>]]>
            </description>
            <link>https://thistooshallgrow.com/blog/privacy-security-roundup</link>
            <guid isPermaLink="false">hacker-news-small-sites-24341079</guid>
            <pubDate>Tue, 01 Sep 2020 12:31:40 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[How much does a bad hire cost?]]>
            </title>
            <description>
<![CDATA[
Score 26 | Comments 6 (<a href="https://news.ycombinator.com/item?id=24340634">thread link</a>) | @saadalem
<br/>
September 1, 2020 | https://josh.works/how-to-write-a-letter-of-recommendation-for-yourself#how-much-does-a-bad-hire-cost | <a href="https://web.archive.org/web/*/https://josh.works/how-to-write-a-letter-of-recommendation-for-yourself#how-much-does-a-bad-hire-cost">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
  

  <time datetime="2020-08-06T13:00:00+00:00">August 2020</time>

  <p>tag(s): <a href="https://josh.works/tags#career" title="Posts tagged career" rel="tag">career</a> ‚Ä¢ <a href="https://josh.works/tags#jobs" title="Posts tagged jobs" rel="tag">jobs</a></p>
  
  <h2>Article Table of Contents</h2>
<ul>
  <li><a href="#how-much-does-a-bad-hire-cost">How much does a bad hire cost?</a></li>
  <li><a href="#a-primary-goal-for-an-early-career-software-developer-telegraph-low-liability">A Primary-goal for an early-career software developer: Telegraph Low Liability</a></li>
  <li><a href="#six-steps-to-draft-a-self-promotional-letter-of-recommendation-that-a-friendly-boss-requested">Six Steps To Draft A Self-Promotional Letter Of Recommendation That A Friendly Boss Requested</a>
    <ul>
      <li><a href="#1-draft-the-openingclosing">1. Draft the opening/closing</a></li>
      <li><a href="#2-provide-1-general-introductioncontext-sentence">2. Provide 1 general introduction/context sentence</a></li>
      <li><a href="#3-say-a-complementary-thing-about-yourself">3. Say a complementary thing about yourself</a></li>
      <li><a href="#4-share-an-anecdote-that-touches-on-the-potential-you-show">4. Share an anecdote that touches on the potential you show</a></li>
      <li><a href="#5-add-a-sentence-offering-to-speak-further-about-you">5. Add a sentence offering to speak further about you</a></li>
    </ul>
  </li>
  <li><a href="#give-this-letter-to-your-boss-for-them-to-edit-it-to-their-liking">Give this letter to your boss for them to edit it to their liking</a></li>
</ul>
  <p>I meet regularly with early-career software developers. A few recurring meetings, 1x/week, plus ad-hoc calls as needed with others.</p>

<p>A question came up recently:</p>

<blockquote>
  <p>My three-month internship is close to wrapping up. The Co-founder/CEO/lead developer of the consulting company I‚Äôm at likes me, said he wishes he could hire me but cannot, because they don‚Äôt have enough work in the pipeline.</p>

  <p>He said he‚Äôd write me a letter of recommendation, and asked me to draft it for him.</p>

  <p>How do I write my own letter of recommendation, for my first real software development job?</p>
</blockquote>

<p>Feels like a trap, huh?</p>

<p><img src="https://josh.works/images/office-hours-tufts.jpeg" alt="who are you?"></p>

<p><a href="https://admissions.tufts.edu/blogs/jumbo-talk/post/the-office-hours/"><em>source</em></a></p>

<p>Or, maybe they know you. They know you <em>too well</em></p>

<p><img src="https://josh.works/images/recommendation-warning.jpg" alt="untrustworthy"></p>

<p><a href="https://blacklawyermagic.wordpress.com/"><em>source</em></a></p>

<p>I explained a few concepts that we wanted to ‚Äúspeak to‚Äù in the letter. I‚Äôll explain.</p>

<p>The software developer that I meet with mentioned that the CEO‚Äôs advice on the next job included ‚Äúbe able to speak to low liability‚Äù.</p>

<p>I wanted to dig into this ‚Äúliability‚Äù piece.</p>
      <h2 id="how-much-does-a-bad-hire-cost">
        
        
          How much does a bad hire cost? <a href="#how-much-does-a-bad-hire-cost">#</a>
        
        
      </h2>
    

<p>What‚Äôs the biggest risk in hiring?</p>

<p>It‚Äôs <em>the risk of a bad hire</em>.</p>

<p>How much does it cost to make a bad hire?</p>

<p>I would conservatively estimate that it costs $100,000 and nine months of your life. Here‚Äôs how the math works from a hiring manager‚Äôs point of view:</p>

<ol>
  <li>Spend a month and 25 hours of labor dev team manager labor to find/interview the candidate(s) and winnow the applicants down to someone to make an offer.  (the hiring manager would prefer to be doing <em>literally anything else but hiring</em>.)</li>
  <li>Extend an offer, wait 2-6 more weeks before the new candidate starts. It can be painful to wait another six weeks, because the team is currently short-staffed, and has been for a long time. That‚Äôs why they‚Äôre hiring!</li>
  <li>Start date! Start paying $150,000/yr or $3000/week for your shiny new employee.</li>
  <li>Pay $12,000 for the first month of them working, figuring out your dev environment, ticket management, who knows what parts of the codebase, and a few easy bug fixes.</li>
  <li>Start getting nervous. Employee not batting it out of the park like you‚Äôd hoped. Maybe still onboarding, give it another month (and $12,000 in payroll expense).</li>
  <li>OK. Three months in and another $36,000 in payroll later, you‚Äôre pretty sure there‚Äôs a problem.</li>
  <li>Start the pre-Performance Improvement Plan work. Talk to their team, their manager, them. Why is it not working? Why is the team <em>working slower</em> with this new team member, instead of working faster? <em>Not only are you wasting five figures of payroll, the rest of your expensive dev team is producing less as well!</em></li>
  <li>Pre-PIP work is over. Another $5k in payroll gone forever. Now it‚Äôs time to give the formal PIP, which everyone knows is ‚Äúbeginning the firing process‚Äù</li>
  <li>Two more months and $24,000 in payroll later, you fire the employee.</li>
  <li>You feel relief with having gotten rid of the bad employee. You‚Äôre thrilled that you can get back to normal work.</li>
  <li>Check the clock and balance sheet. It took you nine months and $100k to get to where you were at step 1.</li>
</ol>

<p>Add up the time/expense:</p>

<ol>
  <li>1-2 months to to find/hire a candidate.</li>
  <li>7-8 months (and $84K-$96k) to hire, trial them, try to help them be successful, give up on that plan, and fire them.</li>
  <li>Many hours spent thinking about this specific problem, talking with others about it.</li>
</ol>

<p>There‚Äôs nine months of your life. That‚Äôs 9 months of time, sure, but it‚Äôs also 9 months of <a href="https://en.wikipedia.org/wiki/Opportunity_cost">opportunity cost</a>. What if you‚Äôd hired a great candidate? They‚Äôd be rapidly approaching their first year on the job, and everyone would be happy about it, instead of this disaster you‚Äôve had to deal with.</p>

<p>Here‚Äôs the really scary part: To large organizations (1000+ employees), <em>wasting $100k is meaningless compared to the wasted time and mis-directed effort</em>. The entire organization is more annoyed at having <em>lost the time of a productive software developer</em>. They don‚Äôt care that they lit a giant pile of money on fire, <em>they‚Äôre annoyed that their competitor is getting new features out the door and gaining marketshare and the future of their $x,000,000 company hangs in the balance</em>.</p>

<p>Oh, and the good managers, not only do they want to be wise with money and build features/gain market-share‚Ä¶</p>

<p>They want to see their team flourish.</p>

<p>Being fired is a life-defining moment. (I speak from experience)</p>

<p>If you‚Äôre a kind and empathetic person, <em>it‚Äôs particularly unpleasent to fire someone and it feels like a personal failure</em>.</p>

<p>You want to work for a kind and empathetic manager. (They‚Äôre not common, but they‚Äôre not impossible to find.)</p>

<p>So, tailor your letter to speak to the concerns of a kind and empathetic manager. This manager would:</p>

<ul>
  <li>Want to see you do well</li>
  <li>Want to see you develop your skills and competencies</li>
  <li>Want you to make meaningful contributions to the product</li>
  <li>Want a healthy team dynamic</li>
  <li>Want you to voice concerns and observations as relevant</li>
</ul>

<p>And much more</p>
      <h2 id="a-primary-goal-for-an-early-career-software-developer-telegraph-low-liability">
        
        
          A Primary-goal for an early-career software developer: Telegraph Low Liability <a href="#a-primary-goal-for-an-early-career-software-developer-telegraph-low-liability">#</a>
        
        
      </h2>
    

<p>First, when I say <code>telegraph low liability</code> I mean it in the <a href="https://en.wikipedia.org/wiki/Telegraphing_(sports)">sports definition</a>:</p>

<blockquote>
  <p>In sporting terminology, to <strong>telegraph</strong> is to unintentionally alert an opponent to one‚Äôs immediate situation or intentions. The sporting use of the term <em>telegraph</em> draws a direct comparison with the communication device of the same name. ‚ÄúTelegraphing‚Äù always refers to a reflexive physical action rather than a protracted or intellectual give-away. For example, a boxer rotating his shoulders to throw a hook would be telegraphing.</p>
</blockquote>

<p>You should aim to ‚Äútelegraph‚Äù that you‚Äôre a low-liability hire <em>without ever saying it so explicitely</em>. It‚Äôs a subtle thing, best communicated incidentally, not directly.</p>

<p>Five years ago, I wrote <a href="https://josh.works/so-you-want-to-work-remotely">So you want to work remotely‚Ä¶</a></p>

<p>Quoting myself:</p>

<blockquote>
  <p>First, there‚Äôs the matter of framing how you go about working remotely. Obviously you want to work remotely, but put yourself in the shoes of a prospective employer. They don‚Äôt care if you work remotely or not - they want you to do great work for them and make them an effective, profitable organization.</p>

  <p>Companies that hire remotely tend to be younger, agile-er, and smaller. So every employee matters. Making a bad hire can be catastrophic in terms of money and <a href="https://en.wikipedia.org/wiki/Opportunity_cost">opportunity cost</a>. Your job is to make it very, very obvious that hiring YOU is a great decision. In fact, you want to be so good at what you do that passing up on you is a terrible decision.</p>

  <p>[‚Ä¶]</p>

  <p>When you can walk someone down the path from ‚ÄúHire me‚Äù to ‚ÄúI‚Äôll help you make <code>$x00,000/year</code> more than you would otherwise‚Äù, <em>you‚Äôre talking their language</em>. You‚Äôre <em>telegraphing</em> that you understand their concerns without ever stating their concern explicitly.</p>
</blockquote>

<p>To bring it full circle, here‚Äôs how I would go about <em>drafting</em> a CEO‚Äôs Letter of Recommendation <em>for me</em>. If you find this idea uncomfortable, don‚Äôt worry about it. That‚Äôs a sign of psychological health, that you don‚Äôt love putting flattering words <em>about yourself</em> into other people‚Äôs mouths.</p>
      
    

<p>Normally, that‚Äôs a good aversion to have. For this particular situation, you‚Äôll have to bite the bullet and move on. I‚Äôm not going to give you the actual words (how could I?) but I‚Äôll explain my process. I‚Äôll include comments throughout:</p>
      <h3 id="1-draft-the-openingclosing">
        
        
          1. Draft the opening/closing <a href="#1-draft-the-openingclosing">#</a>
        
        
      </h3>
    

<div><div><pre><code>Hi there,         
# I find it easier to strike a natural tone when thinking relatively
# informally. So, I draft documents, even if they'll end up being 
# formal, informally. 
             
             
Sincerely, 
- Boss's name, Title, Company
# Yes, I write the closing right after the opening.
</code></pre></div></div>
      <h3 id="2-provide-1-general-introductioncontext-sentence">
        
        
          2. Provide 1 general introduction/context sentence <a href="#2-provide-1-general-introductioncontext-sentence">#</a>
        
        
      </h3>
    

<div><div><pre><code>Hi there,

# Establish the relationship. This helps readers contextualize 
# what comes next
I met {person I am recommending} {n months ago} because 
 {internship|coffee meeting|event|etc}.

Sincerely,
- Boss's name, Title, Company
</code></pre></div></div>
      <h3 id="3-say-a-complementary-thing-about-yourself">
        
        
          3. Say a complementary thing about yourself <a href="#3-say-a-complementary-thing-about-yourself">#</a>
        
        
      </h3>
    

<p>This is the first uncomfortable sentence you‚Äôll have to write:</p>

<div><div><pre><code>Hi there,

I met {Zaniyah} {a few months ago} because {she and I crossed paths
at a local Ruby meetup}.

# No gushing required. A claim of "I would hire this 
# person if I could" is plenty strong social signaling. 
I wish I could hire them myself, but don't have the budget and work
lined up to utilize them to their full potential. 

Sincerely,
- Boss's name, Title, Company
</code></pre></div></div>
      
    

<p>This can be hard to think of an anecdote. It might take a few attempts to feel good about the one you‚Äôve chosen and how you speak of it. Just write something down, see how you feel, delete it, write something else down, etc.</p>

<div><div><pre><code>Hi there,

I met {Zaniyah} {a few months ago} because {she and I crossed paths 
at a local Ruby meetup}.

I wish I could hire her myself, but don't have the budget and work 
lined up to utilize her to their full potential. 

# add a punchy positive story
When she started at {company}, one of the first things she did was 
make many updates to our onboarding documentation. 

It was rather out-of-date, and the team hadn't had new hires in a 
while. 

Any time she ran into friction or trouble, she would hunt down the 
answer, and immediately update the documentation so the next 
person would have a smoother process.

Sure enough, the next hire spent half the time she ‚Ä¶</code></pre></div></div></article></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://josh.works/how-to-write-a-letter-of-recommendation-for-yourself#how-much-does-a-bad-hire-cost">https://josh.works/how-to-write-a-letter-of-recommendation-for-yourself#how-much-does-a-bad-hire-cost</a></em></p>]]>
            </description>
            <link>https://josh.works/how-to-write-a-letter-of-recommendation-for-yourself#how-much-does-a-bad-hire-cost</link>
            <guid isPermaLink="false">hacker-news-small-sites-24340634</guid>
            <pubDate>Tue, 01 Sep 2020 11:28:13 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Threat modelling case study: bicycles]]>
            </title>
            <description>
<![CDATA[
Score 22 | Comments 8 (<a href="https://news.ycombinator.com/item?id=24340190">thread link</a>) | @mjohn
<br/>
September 1, 2020 | http://calpaterson.com/bicycle-threat-model.html | <a href="https://web.archive.org/web/*/http://calpaterson.com/bicycle-threat-model.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
        
        <p>August 2020</p>
        <p id="article-description">How to avoid buying your bike again every 6-12
        months and tips for how to apply the same reasoning to other things, like
        computers</p>
        <hr>
        <figure>
            <img src="http://calpaterson.com/assets/solitary-wheel.jpeg" alt="a solitary wheel left behind after the rest of the bike was nicked">
            <figcaption>
                Rucksack Rupert strikes again
            </figcaption>
        </figure>
        <p>Some very commonly repeated advice on preventing someone from nicking your
        bike:</p>
        <blockquote>
            <p>Buy a good [~10% of bicycle value] lock, ideally one with a high
            "SoldSecure" rating and lock your bicycle somewhere inside the rear
            triangle and the rear wheel.</p>
        </blockquote>
        <p>I've seen this advice repeated in cycling magazines, in quality newspapers,
        sometimes even by the police and of course on internet forums.</p>
        <p>The above would imply that if you own a ¬£400 bicycle (<a href="https://www.statista.com/statistics/395884/bicycle-average-prices-in-the-european-union-eu-by-country/">a
        typical price in the UK</a>) you'd buy a ¬£40 lock and put it in the right
        place.</p>
        <p>However, it is a cold fact that a cordless angle grinder can defeat any
        bicycle lock, no matter how expensive (<a href="https://www.youtube.com/watch?v=pywN558dJaU&amp;t=198">see this video for a
        demonstration</a>). You can buy a used cordless angle grinder on eBay for less
        than ¬£100. Even U-locks - traditionally thought to be the strongest type of
        lock - are opened in seconds with a sub-¬£100 angle grinder.</p>
        <p>There is other advice floating around of doubtful value, for example:</p>
        <blockquote>
            <p>Add your bicycle to a national register</p>
        </blockquote>
        <p>But cases where BikeRadar manage to reunite bicycles with their owners seem
        to be the exception rather than the rule. Probably this is because, as with
        cars, the first thing you do with a stolen bicycle is take it across a border
        to somewhere different.</p>
        <blockquote>
            <p>Lock your bicycle inside a secure building or place, away from sight</p>
        </blockquote>
        <p>This prevents opportunistic theft but if this space is shared with others
        (apartment blocks and offices) it in fact serves to increase the economies of
        scale for prepared thieves who break into your storage area late at night with
        a van. It's not uncommon for office bicycle stores (with many fancy, expensive
        bikes inside) to be emptied out completely overnight by professional
        thieves.</p>
        <h2>A threat model, by user persona</h2>
        <p>I think the advice above is poor because it doesn't come from a systematic
        consideration of the problem <em>from the point of view of thieves</em>.</p>
        <p>To come up with better advice requires a threat model, which is a piece of
        jargon for taking a holistic view of the danger posed by attackers. I think one
        of the simplest and most straightforward ways to do threat modelling is by
        <em>user persona</em>, whereby you consider each kind of attacker in turn,
        making some reasonable assumptions about their level of motivation and
        methods.</p>
        <p>As far as bicycle theft is concerned there are three basic types of
        thief.</p>
        <h3>"No-tools Nigel", the rank opportunist</h3>
        <p>Nigel has just his two hands and is simply looking for a ride home or maybe
        something he can sell to a friend for some quick cash.</p>
        <p>Nigel will steal any unlocked bicycle.</p>
        <p>Nigel is also able to take any bicycle parts that can be removed without
        tools. That means any quick-release wheels or thumbscrew saddles. In an urban
        area your parked bicycle may be passed by a Nigel as often as a few times an
        hour so anything that is not bolted down won't last very long.</p>
        <h3>"Rucksack Rupert", the thief with a few hand tools</h3>
        <p>Rupert has a small pair of shears; 4, 5 and 6mm Allen keys and a 15mm
        spanner for wheel nuts.</p>
        <p>Rupert will make his way through cable locks with his shears. If there is a
        valuable part that can be removed with hand tools he will take it. He is
        particularly keen on premium saddles and name brand wheels.</p>
        <h3>"Powertool Percy", the professional with a complete set of tools</h3>
        <p>Percy has a small collection of electric and air tools including an angle
        grinder as well as bolt-cutters and an air-jack. He has access to <a href="https://en.wikipedia.org/wiki/Fence_(criminal)">criminal fences</a> which he
        can use to sell stolen bicycles quickly. Percy often arrives in his van and
        this allows him to steal multiple bikes at once.</p>
        <p>No bicycle is safe from Percy. No lock can hold against his angle grinder.
        Often he finds if he's wearing a hi-vis jacket he can even get away with using
        his power tools in broad daylight. He's willing to chance that if the bicycle
        seems valuable enough.</p>
        <h2>Coming up with better advice based on Nigel, Rupert and Percy</h2>
        <p>In order to keep your bicycle safe you need to take steps against all three
        levels of imaginary thieves.</p>
        <p>"No-tools Nigel" will be warded off simply by:</p>
        <ul>
            <li>Locking your bicycle whenever you leave it - even if just for a
            minute</li>
            <li>Ensuring you leave nothing on your bicycle that can be removed without
            tools
                <ul>
                    <li>replace quick-release wheel skewers with bolts</li>
                    <li>take your lights with you when you park in public</li>
                    <li>make sure your saddle is not on a thumbscrew</li>
                </ul>
            </li>
        </ul>
        <p>"Rucksack Rupert" will be deterred by:</p>
        <ul>
            <li>Not using a cable lock!</li>
            <li>Making sure that nothing good can be removed from your bicycle with
            hand tools
                <ul>
                    <li>Lock both wheels <em>and the frame</em> to the bike stand -
                    don't rely on bolts</li>
                </ul>
            </li>
        </ul>
        <p>"Powertool Percy" will be kept at bay by:</p>
        <ul>
            <li>Nothing, save ensuring that your bicycle doesn't look valuable enough
            to be worth his time
                <ul>
                    <li>this probably means keeping its value down below a few hundred
                    pounds</li>
                </ul>
            </li>
        </ul>
        <h2>The virtue of the "bicycle shaped object"</h2>
        <p>Valuable bicycles (&gt;¬£1000) have an extremely short half-life in urban
        areas. The sad truth is that the Percys of the world are common enough and
        resourceful enough that a bicycle worth over a thousand pounds isn't really
        safe anywhere in a large town. <strong>This includes most e-bikes.</strong> You
        might notice that cycle couriers who have e-bikes tend to eat lunch while
        looking directly at their locked e-bike, so that it never goes out of their
        sight. Few people in other lines of work can do the same.</p>
        <p>If the tyres are inflated, my own commuter bicycle is probably worth ¬£30 to
        the right buyer. My bicycle is so low-end that cycling snobs refer to it as a
        mere "bicycle shaped object". Rather selfishly I am glad that such snobs exist
        as having a lot of more valuable bicycles around provides me with good ambient
        security. No thief is going to bother cutting my locks when there is a
        Campagnolo on the next rack.</p>
        <p>One father I know had his primary-school-age daughter "decorate" his
        commuting bicycle with girly stickers and pink glitter. If anyone examines his
        bicycle closely he looks like a complete loon but I think his motivation is
        right: it's going to be much less appealing to steal when it's covered in Miffy
        stickers.</p>
        <h3>Insurance - not usually worth it</h3>
        <p>What about bicycle insurance? It's fairly expensive here in the UK, usually
        10-15% of the bicycle's value annually and insurers typically only pay out when
        the whole bicycle is taken (so if if your front wheel is nicked, you're on your
        own) and when you can demonstrate that it was locked to their standards. Often
        these standards require that it is locked up indoors which means you're
        chancing it whenever you park away from your home or office.</p>
        <h2>Lists of "best practices" vs having your own threat model</h2>
        <p>The same thing goes for securing your bicycle as for securing other things:
        pat, concrete pieces of security advice are something to treat with a bit of
        doubt.</p>
        <p>In bicycles the common mantra is "spend 10% on a lock" but in computing the
        mantras are slogans such as "use a strong password", "back up your important
        data" or "use encryption" but these can all be just as vapid.</p>
        <p>"Strong passwords!" as a slogan fails to address the fact that the average
        internet user has hundreds of logins for various sites (my own password manager
        has over 700 sites recorded). The majority of internet users decide on a single
        "strong password" and then use it everywhere. They are only a single bad
        sysadmin or javascript injection away from losing access to every account on
        every website they have.</p>
        <p>Backing up your important data is only an aid to your security if the backup
        is stored as securely as the original. Much user data is stolen or exposed
        through poorly secured backups on shared fileservers. A huge number of people
        have passport and utility bill scans in their Dropbox - again, behind the same
        email and password they use everywhere. Companies can be surprisingly sloppy
        with backups too: often dumped into cloud storage somewhere once before the Big
        Migration and never removed.</p>
        <p>Encryption is troublesome as it can give undue confidence that can backfire
        spectacularly: a quarter of a million American diplomatic cables were
        inadvertantly published in unredacted form when a Guardian journalist <a href="https://en.wikipedia.org/wiki/WikiLeaks:_Inside_Julian_Assange%27s_War_on_Secrecy">
        included the password for an widely-distributed encrypted file in his book</a>.
        Apparently he thought the file's password was somehow temporary. It wasn't.</p>
        <p>Instead of following such "best practices" it's much more intellectually
        robust to <strong>come up with your own threat model</strong> - then you can
        decide your own concrete steps instead of just following the security steps of
        others which might be inapplicable or even wrong.</p>
        <h2>Some hints on coming up with your own ‚Ä¶</h2></article></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="http://calpaterson.com/bicycle-threat-model.html">http://calpaterson.com/bicycle-threat-model.html</a></em></p>]]>
            </description>
            <link>http://calpaterson.com/bicycle-threat-model.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24340190</guid>
            <pubDate>Tue, 01 Sep 2020 10:23:00 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[First Impressions of GitHub Codespaces]]>
            </title>
            <description>
<![CDATA[
Score 106 | Comments 92 (<a href="https://news.ycombinator.com/item?id=24339118">thread link</a>) | @legostormtroopr
<br/>
August 31, 2020 | https://www.aristotlemetadata.com/blog/2020/08/first-impressions-github-codespaces.html | <a href="https://web.archive.org/web/*/https://www.aristotlemetadata.com/blog/2020/08/first-impressions-github-codespaces.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
                                <p>Github recently launched their new <a href="https://github.com/features/codespaces">Github codespaces</a> service - an online, in-browser Integrated Development Environment powered by <a href="https://code.visualstudio.com/">Visual Studio Code</a>. This environment allows someone to quickly load a virtual machine and a complete code editing interface, that is all accessible within the browser without having to install anything on the users machine. If you are familiar with products like <a href="https://aws.amazon.com/cloud9/">Amazon Web Services‚Äôs Cloud 9 IDE</a> or its predecessor C9.io this will probably feel very familiar.</p>

<p>As one of the lucky few who were given access to the GitHub Codespaces beta program I had the opportunity to test it out and offer my thoughts on behalf of the Aristotle team below.</p>

<h2 id="first-impressions">First impressions</h2>
<p>There were a few small changes that needed to be done to the <a href="https://www.aristotlemetadata.com/">Aristotle Metadata home page</a>, (including making this blogpost) and it was easy opening a Codespace to start working. Opening a code space for a project is literally as easy as GitHub says - click ‚ÄúOpen in Codespace‚Äù on a repository and it does the rest - no need to configuring or decommission a server, its all handled for you.</p>

<p><img src="https://www.aristotlemetadata.com/aristotle/images/blog/codespaces/codespaces-opening-project.png" alt="How to open Codespaces" title="How to open Codespaces"></p>

<p><a href="https://www.aristotlemetadata.com/">Our website</a> is a basic <a href="https://jekyllrb.com/">Jekyll</a> static site, and offers a great basic test of whats available in Codespaces already. Loading a fresh Codespace took less than 2 minutes, which is comparable to AWS Cloud9. As someone who used Cloud9 when it was still C9.io, Codespaces reminded me a lot of that - its a simple way to open an editor and a virtual machine for a GitHub project.</p>

<p>The <a href="https://docs.github.com/en/github/developing-online-with-codespaces/about-codespaces">documentation for Codespaces</a> is also great. What I didn‚Äôt know is that GitHub can also <a href="https://docs.github.com/en/github/developing-online-with-codespaces/personalizing-codespaces-for-your-account">load your dotfiles directly into each new Codespace</a>, so your preferences (<code>.bashrc</code> and similar files) will follow you across Codespaces.</p>

<h2 id="editing-files">Editing files</h2>
<p>Being based on Visual Studio Code, <strong>Yes, Codespaces has a Dark Mode</strong>.</p>

<p><img src="https://www.aristotlemetadata.com/aristotle/images/blog/codespaces/codespaces-dark-editor.png" alt="Default Codespaces Editor" title="Default Codespaces Editor"></p>

<p>Although if you are using different browsers to open your workspace (which I had to do for reasons below), your colour scheme preferences won‚Äôt follow you across browsers. I‚Äôm not a regular user of Visual Studio Code, but it seems to includes all the standard features you expect from a browser, such as syntax highlighting, VIm and Emac keybindings (which work very well in browser), and autosave which is enabled by default, and I promptly disabled.</p>

<p>You can also drag-and-drop files from your local machine into Codespaces filesystem, and preview and edit certain non-text files in the browser, such as images, both of which are really handy for web development.</p>

<h2 id="terminal-emulator">Terminal emulator</h2>
<p>Codespaces includes a powerful terminal editor that seems to be based on a stock Debian image. The only thing I didn‚Äôt like is that separate terminals are accessed using a dropdown instead of with tabs, but this is a minor detail.</p>

<p><strong>Big news: Docker is here</strong>, and it works well.</p>

<p><img src="https://www.aristotlemetadata.com/aristotle/images/blog/codespaces/codespaces-docker.png" alt="Docker in Codespaces" title="Docker in Codespaces"></p>

<p>One of my biggest issues with C9.io was the lack of Docker support, which was solved when AWS bought Cloud9 but comes with the extra complexity of configuring your Amazon machine. So being able to simply run Docker in the browser is great. Docker-compose isn‚Äôt installed by default, and I haven‚Äôt had a chance to see how that works.</p>

<p>The only issue I found with the terminal emulator was you can only paste with right-click into Chromium-based browsers like Chrome or Edge, <em>Firefox users beware</em>.</p>

<h2 id="serving-sites">Serving sites</h2>
<p><a href="https://docs.github.com/en/github/developing-online-with-codespaces/developing-in-a-codespace">Codepsaces does a great job of handling port forwarding for you </a>, so you can simply start you server process (on a non-Port 80 port) and if GitHub detects a <code>localhost:PORT</code> combination it makes it accessible for you by clicking on the URL, as shown below:</p>

<p><img src="https://www.aristotlemetadata.com/aristotle/images/blog/codespaces/codespaces-jekyll.png" alt="Jekyll in Codespaces" title="Jekyll in Codespaces"></p>

<p>Loading and reloading Jekyll was fast, and by the time I clicked the forwarded link or switched tabs to preview changes to the site, it was already refreshed. 
<del><strong>However, this is another Chromium-only feature the clikcable port forward links don‚Äôt work in Firefox</strong></del>  this seems to be fixed now in Firefox.</p>

<p>One other minor issue is you can‚Äôt open your site in a private window or different browser to view the server without logging into GitHub. This isn‚Äôt a huge issue, but if you are trying to view what your site looks like under different browser or when logged out it can be troublesome.</p>

<p><img src="https://www.aristotlemetadata.com/aristotle/images/blog/codespaces/codespaces-final-site.png" alt="Aristotle Home Page in Codespaces" title="Aristotle Home Page in Codespaces"></p>

<h2 id="final-thoughts">Final thoughts</h2>

<p><strong>This is amazing</strong> and may become my default IDE - as a co-founder who is spending less time as a developer, and more time in meetings, writing emails, strategy papers, letters and tenders, <em>this is just amazing</em>! Most of my daily tools are Windows based, so I‚Äôve been spending a lot of time getting Windows Subsystem for Linux working alongside the rest of my daily workflow, which comes with its own headaches. So being able to quickly checkout a branch, make changes and take some load of my local machine seems very promising.</p>

<p>There are a lot of features here to review that I haven‚Äôt had a chance to look at, including collaborative workspaces, Git integration and connecting with a local version of Visual Studio, but from a quick glance everything works smoothly.</p>

<p>Overall, it‚Äôs an extremely quick way to get started on a project, and I look forward to writing an update after I‚Äôve had a chance getting the Aristotle Metadata Registry software, with all its many dependencies, running in codespaces under Docker-compose.</p>

<p><strong>The Aristotle Metadata Registry is no stranger to cloud innovation</strong>. If you want to learn how to access a cloud-hosted metadata registry as simple as Github‚Äôs Codespaces <a href="https://www.aristotlemetadata.com/contact.html">get in contact with us</a>.</p>

<p>Discuss this post on our community forum: https://community.aristotlemetadata.com/</p>

                                                            
                            </div></div>]]>
            </description>
            <link>https://www.aristotlemetadata.com/blog/2020/08/first-impressions-github-codespaces.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24339118</guid>
            <pubDate>Tue, 01 Sep 2020 06:37:41 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The database I wish I had]]>
            </title>
            <description>
<![CDATA[
Score 362 | Comments 211 (<a href="https://news.ycombinator.com/item?id=24337244">thread link</a>) | @todsacerdoti
<br/>
August 31, 2020 | https://euandre.org/2020/08/31/the-database-i-wish-i-had.html | <a href="https://web.archive.org/web/*/https://euandre.org/2020/08/31/the-database-i-wish-i-had.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
  
  
    
  
  <section>
    <p>I watched the talk
‚Äú<a href="https://vimeo.com/230142234">Platform as a Reflection of Values: Joyent, Node.js and beyond</a>‚Äù
by Bryan Cantrill, and I think he was able to put into words something I already
felt for some time: if there‚Äôs no piece of software out there that reflects your
values, it‚Äôs time for you to build that software<sup id="fnref:talk-time" role="doc-noteref"><a href="#fn:talk-time">1</a></sup>.</p>

<p>I kind of agree with what he said, because this is already happening to me. I
long for a database with a certain set of values, and for a few years I was just
waiting for someone to finally write it. After watching his talk, Bryan is
saying to me: ‚Äútime to stop waiting, and start writing it yourself‚Äù.</p>

<p>So let me try to give an overview of such database, and go over its values.</p>



<p>I want a database that allows me to create decentralized client-side
applications that can sync data.</p>

<p>The best one-line description I can give right now is:</p>

<blockquote>
  <p>It‚Äôs sort of like PouchDB, Git, Datomic, SQLite and Mentat.</p>
</blockquote>

<p>A more descriptive version could be:</p>

<blockquote>
  <p>An embedded, immutable, syncable relational database.</p>
</blockquote>

<p>Let‚Äôs go over what I mean by each of those aspects one by one.</p>



<p>I think the server-side database landscape is diverse and mature enough for
my needs (even though I end up choosing SQLite most of the time), and what I‚Äôm
after is a database to be embedded on client-side applications itself, be it
desktop, browser, mobile, etc.</p>

<p>The purpose of such database is not to keep some local cache of data in case of
lost connectivity: we have good solutions for that already. It should serve as
the source of truth, and allow the application to work on top of it.</p>

<p><a href="https://sqlite.org/index.html"><strong>SQLite</strong></a> is a great example of that: it is a very powerful
relational database that runs <a href="https://sqlite.org/whentouse.html">almost anywhere</a>. What I miss
from it that SQLite doesn‚Äôt provide is the ability to run it on the browser:
even though you could compile it to WebAssembly, <del>it assumes a POSIX filesystem
that would have to be emulated</del><sup id="fnref:posix-sqlite" role="doc-noteref"><a href="#fn:posix-sqlite">2</a></sup>.</p>

<p><a href="https://pouchdb.com/"><strong>PouchDB</strong></a> is another great example: it‚Äôs a full reimplementation of
<a href="https://couchdb.apache.org/">CouchDB</a> that targets JavaScript environments, mainly the browser and
Node.js. However I want a tool that can be deployed anywhere, and not limit its
applications to places that already have a JavaScript runtime environment, or
force the developer to bundle a JavaScript runtime environment with their
application. This is true for GTK+ applications, command line programs, Android
apps, etc.</p>

<p><a href="https://github.com/mozilla/mentat"><strong>Mentat</strong></a> was an interesting project, but its reliance on SQLite
makes it inherit most of the downsides (and benefits too) of SQLite itself.</p>

<p>Having such a requirement imposes a different approach to storage: we have to
decouple the knowledge about the intricacies of storage from the usage of
storage itself, so that a module (say query processing) can access storage
through an API without needing to know about its implementation. This allows
the database to target a POSIX filesystems storage API and an IndexedDB storage
API, and make the rest of the code agnostic about storage. PouchDB has such
mechanism (called <a href="https://pouchdb.com/adapters.html">adapters</a>) and Datomic has them too (called
<a href="https://docs.datomic.com/on-prem/storage.html">storage services</a>).</p>

<p>This would allow the database to adapt to where it is embedded: when targeting
the browser the IndexedDB storage API would provide the persistence layer
that the database requires, and similarly the POSIX filesystem storage API would
provide the persistence layer when targeting POSIX systems (like desktops,
mobile, etc.).</p>

<p>But there‚Äôs also an extra restriction that comes from by being embedded: it
needs to provide and embeddable artifact, most likely a binary library object
that exposes a C compatible FFI, similar to
<a href="https://www.sqlite.org/amalgamation.html">how SQLite does</a>. Bundling a full runtime environment is
possible, but doesn‚Äôt make it a compelling solution for embedding. This rules
out most languages, and leaves us with C, Rust, Zig, and similar options that
can target POSIX systems and WebAssembly.</p>



<p>Being immutable means that only new information is added, no in-place update
ever happens, and nothing is ever deleted.</p>

<p>Having an immutable database presents us with similar trade-offs found in
persistent data structures, like lack of coordination when doing reads, caches
being always coherent, and more usage of space.</p>

<p><a href="https://www.datomic.com/"><strong>Datomic</strong></a> is the go to database example of this: it will only add
information (datoms) and allows you to query them in a multitude of ways. Stuart
Halloway calls it ‚Äúaccumulate-only‚Äù over ‚Äúappend-only‚Äù<sup id="fnref:accumulate-only" role="doc-noteref"><a href="#fn:accumulate-only">3</a></sup>:</p>

<blockquote>
  <p>It‚Äôs accumulate-only, it is not append-only. So append-only, most people when
they say that they‚Äôre implying something physical about what happens.</p>
</blockquote>

<p>Also a database can be append-only and overwrite existing information with new
information, by doing clean-ups of ‚Äústale‚Äù data. I prefer to adopt the
‚Äúaccumulate-only‚Äù naming and approach.</p>

<p><a href="https://git-scm.com/"><strong>Git</strong></a> is another example of this: new commits are always added on top
of the previous data, and it grows by adding commits instead of replacing
existing ones.</p>

<p>Git repositories can only grow in size, and that is not only an acceptable
condition, but also one of the reasons to use it.</p>

<p>All this means that no in-place updates happens on data, and the database will
be much more concerned about how compact and efficiently it stores data than how
fast it does writes to disk. Being embedded, the storage limitation is either a)
how much storage the device has or b) how much storage was designed for the
application to consume. So even though the database could theoretically operate
with hundreds of TBs, a browser page or mobile application wouldn‚Äôt have access
to this amount of storage. SQLite even <a href="https://sqlite.org/limits.html">says</a> that it does
support approximately 280 TBs of data, but those limits are untested.</p>

<p>The upside of keeping everything is that you can have historical views of your
data, which is very powerful. This also means that applications should turn this
off when not relevant<sup id="fnref:no-history" role="doc-noteref"><a href="#fn:no-history">4</a></sup>.</p>



<p>This is a frequent topic when talking about offline-first solutions. When
building applications that:</p>

<ul>
  <li>can fully work offline,</li>
  <li>stores data,</li>
  <li>propagates that data to other application instances,</li>
</ul>

<p>then you‚Äôll need a conflict resolution strategy to handle all the situations
where different application instances disagree. Those application instances
could be a desktop and a browser version of the same application, or the same
mobile app in different devices.</p>

<p>A three-way merge seems to be the best approach, on top of which you could add
application specific conflict resolution functions, like:</p>

<ul>
  <li>pick the change with higher timestamp;</li>
  <li>if one change is a delete, pick it;</li>
  <li>present the diff on the screen and allow the user to merge them.</li>
</ul>

<p>Some databases try to make this ‚Äúeasy‚Äù, by choosing a strategy for you, but I‚Äôve
found that different applications require different conflict resolution
strategies. Instead, the database should leave this up to the user to decide,
and provide tools for them to do it.</p>

<p><a href="https://en.wikipedia.org/wiki/Merge_(version_control)"><strong>Three-way merges in version control</strong></a> are the best example,
performing automatic merges when possible and asking the user to resolve
conflicts when they appear.</p>

<p>The unit of conflict for a version control system is a line of text. The
database equivalent would probably be a single attribute, not a full entity or a
full row.</p>

<p>Making all the conflict resolution logic be local should allow the database to
have encrypted remotes similar to how <a href="https://spwhitton.name/tech/code/git-remote-gcrypt/">git-remote-gcrypt</a>
adds this functionality to Git. This would enable users to sync the application
data across devices using an untrusted intermediary.</p>



<p>I want the power of relational queries on the client applications.</p>

<p>Most of the arguments against traditional table-oriented relational databases
are related to write performance, but those don‚Äôt apply here. The bottlenecks
for client applications usually aren‚Äôt write throughput. Nobody is interested in
differentiating between 1 MB/s or 10 MB/s when you‚Äôre limited to 500 MB total.</p>

<p>The relational model of the database could either be based on SQL and tables
like in SQLite, or maybe <a href="https://docs.datomic.com/on-prem/query.html">datalog</a> and <a href="https://docs.datomic.com/cloud/whatis/data-model.html#datoms">datoms</a> like in
Datomic.</p>



<p>Now let‚Äôs try to translate the aspects above into values, as suggested by Bryan
Cantrill.</p>



<p>Being able to target so many different platforms is a bold goal, and the
embedded nature of the database demands portability to be a core value.</p>



<p>When the local database becomes the source of truth of the application, it must
provide consistency guarantees that enables applications to rely on it.</p>



<p>The database should empower applications to slice and dice the data in any way
it wants to.</p>



<p>Since I can‚Äôt find any database that fits these requirements, I‚Äôve finally come
to terms with doing it myself.</p>

<p>It‚Äôs probably going to take me a few years to do it, and making it portable
between POSIX and IndexedDB will probably be the biggest challenge. I got myself
a few books on databases to start.</p>

<p>I wonder if I‚Äôll ever be able to get this done.</p>



<p>See discussions on <a href="https://www.reddit.com/r/programming/comments/ijwz5b/the_database_i_wish_i_had/">Reddit</a>, <a href="https://lobste.rs/s/m9vkg4/database_i_wish_i_had">lobsters</a>, <a href="https://news.ycombinator.com/item?id=24337244">HN</a> and
<a href="https://lists.sr.ht/~euandreh/public-inbox/%3C010101744a592b75-1dce9281-f0b8-4226-9d50-fd2c7901fa72-000000%40us-west-2.amazonses.com%3E">a lengthy email exchange</a>.</p>



  </section>
  
</article></div>]]>
            </description>
            <link>https://euandre.org/2020/08/31/the-database-i-wish-i-had.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24337244</guid>
            <pubDate>Tue, 01 Sep 2020 00:21:01 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[I sold my side-project for $30k]]>
            </title>
            <description>
<![CDATA[
Score 242 | Comments 97 (<a href="https://news.ycombinator.com/item?id=24336925">thread link</a>) | @marckohlbrugge
<br/>
August 31, 2020 | https://marc.io/tweet-photo-acquired | <a href="https://web.archive.org/web/*/https://marc.io/tweet-photo-acquired">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div itemprop="articleBody">
    <p><strong>TL;DR: <a href="https://tweet.photo/">Tweet Photo</a> is a software service to automatically post your Instagram photos to Twitter. It started out as a Medium post, turned into a software product, and eventually got acquired for $30,000.</strong></p>

<p>Continue reading for the full story on how I validated the idea, built a simple product, grew it to thousands of active users, tried monetizing it, and eventually sold it.</p>

<hr>

<h3 id="-blog-post-as-an-mvp">üìù Blog post as an MVP</h3>

<p>People always tell you: start with an MVP, prove there‚Äôs demand for your product
before investing all your time into something nobody wants. In my experience
that‚Äôs good advice, but it seems many successful products often start out as
accidental MVPs. Tweet Photo is a perfect example of this.</p>

<p>If you‚Äôve ever tried posting an Instagram photo to Twitter, you might have noticed it looks like this:</p>



<p>Just a link. No photo. Useless. I don‚Äôt know the politics behind this, but I believe Facebook is the one that disabled the photo previews at some point. So now we‚Äôre stuck with useless tweets.</p>

<p>You can find many workarounds using automation services like <a href="https://ifttt.com/">IFTTT</a> and <a href="https://zapier.com/">Zapier</a>. Because I was unhappy with all solutions, I decided to write my own article in May 2017:</p>

<p><strong><a href="https://medium.com/@marckohlbrugge/a-better-way-to-post-your-instagram-photos-to-twitter-7f3a04a37d89">A better way to post your Instagram photos to Twitter</a></strong></p>

<p>Turns out I struck a chord. To this date that post has been read 70,000 times. Over three years later it continues to get over a 1,000 hits per month.</p>

<p><img src="https://marc.io/images/tweet-photo-acquired/medium.png#full" alt=""></p>

<p>If you read the post though, you will notice how complicated the setup is. So I figured there might be an opportunity for a product here. I knew there was an interest, but I didn‚Äôt know if I could monetize it.</p>

<p>It wasn‚Äôt until <a href="https://hi.yuko.im/">Yuko</a> posted <a href="https://wip.chat/questions/what-is-the-best-way-to-repost-instagram-contents-to-twitter">this question</a> on WIP:</p>

<p><a href="https://wip.chat/questions/what-is-the-best-way-to-repost-instagram-contents-to-twitter"><img src="https://marc.io/images/tweet-photo-acquired/wip.png" alt=""></a></p>

<p>She mentioned she‚Äôd happily pay $20/mo for Zapier to tweet her photos. That got me thinking, maybe it‚Äôs a product that can be monetized after all. Plus, I already got the leads coming in via the blog post. I could funnel them through to this new service instead.</p>

<p>Rather than further validating the business model, I challenged myself to build a prototype over the next couple of days.</p>

<h3 id="-building-the-product">üõ† Building the Product</h3>

<p>I believe in using the tools you‚Äôre familiar with, so I used Ruby on Rails to build the product.</p>

<p>Tweet Photo is technically quite simple. I‚Äôm basically glueing together the Instagram and Twitter APIs. I was able to do most of the work with open-source libraries.</p>

<p>I finished the product in just over a week during my spare time.</p>

<p>I initially went with the <strong>tweetphoto.icu</strong> domain name because it was only $1. That‚Äôs how much faith I had in the product I guess. But shortly after I decided if I‚Äôm going to do this, I might as well do it right and purchased <strong>tweet.photo for $130</strong>. It might not seem like a lot of money, but with all the projects I start things thing start to add up üòÖ. In hindsight I‚Äôm really glad I got this domain name‚Ä¶</p>

<p>I wouldn‚Äôt realize it until later, but the key feature I added was appending <em>‚Äúvia tweet.photo‚Äù</em> to every tweet. This single piece of text would prove to be the driving factor of Tweet Photo‚Äôs growth.</p>



<h3 id="-time-to-launch">üöÄ Time to launch</h3>

<p>December 12th, 2018, 11 days after Yuko‚Äôs post, I launched:</p>

<div><blockquote><div lang="en" dir="ltr"><p>üñºüëâüê¶ I made a new thing called <a href="https://t.co/LMVsrPNaFV">https://t.co/LMVsrPNaFV</a> ‚ú®</p><p>Automagically post your Instagram photos and videos to your Twitter account. Your media will be embedded in the tweet, unlike Instagram's built-in feature.</p></div>‚Äî Marc (@marckohlbrugge) <a href="https://twitter.com/marckohlbrugge/status/1072869470866034688?ref_src=twsrc%5Etfw">December 12, 2018</a></blockquote>

</div>

<p>It got featured on <a href="https://betalist.com/startups/tweet-photo">BetaList</a> and
<a href="https://www.producthunt.com/posts/tweet-photo">Product Hunt</a>.</p>

<p>At the end day of the launch over 100 accounts were created with combined total of over 100 published tweets.</p>

<p>The product worked! ü•≥</p>

<h3 id="-growth">üìà Growth</h3>

<p>As time went on the userbase continued growing.</p>

<p>Unlike most software services, the retention of Tweet Photo was basically 100%. Meaning that anyone that signed up, was likely to continue using it for a long time. Once signed up, everything was automated after all.</p>

<p>Combine that with the ‚Äúvia tweet.photo‚Äù in every tweet and you‚Äôve got steady growth:</p>

<p><img src="https://marc.io/images/tweet-photo-acquired/growth.png" alt=""></p>

<p>Here‚Äôs a screenshot of the <a href="https://simpleanalytics.com/">Simple Analytics</a> dashboard showing how tweets are driving new leads to the homepage:</p>

<p><img src="https://marc.io/images/tweet-photo-acquired/tweets.png" alt=""></p>

<p>We even got some major Hollywood celebrities using the service. In fact, Tweet
Photo came a hot topic amongst her fans. Driving even more sign ups.</p>



<h3 id="-monetization">üí∏ Monetization</h3>

<p>Okay, so we‚Äôve got decent growth. But what about the revenue?</p>

<p>This was a lot harder. When I launched Tweet Photo I included a $19/year PRO subscription that would remove the ‚Äúvia tweet.photo‚Äù branding. I figured if people care enough about their Twitter profile to not want to show that link, they might be willing to pay.</p>

<p>People with more Twitter followers would pay more. After all if someone has a million Twitter followers it‚Äôs worth a lot more to me if they promote Tweet Photo in every tweet.</p>

<p><img src="https://marc.io/images/tweet-photo-acquired/stripe.png" alt=""></p>

<p>I eventually switched to monthly pricing starting at $5/mo. I figured churn rate would be really low anyway, so it would be better to charge monthly. Paying $5/mo instead $19 for a year upfront is a lower commitment for the customer, but ultimately 3x the revenue for me.</p>

<p>Unfortunately MRR grew very slowly. It‚Äôs about $135 MRR right now.</p>

<p>I think the main problem is that the the free plan is already very compelling. So it‚Äôs hard to convince people to upgrade.</p>

<h3 id="-now-what">ü§î Now what?</h3>

<p>While I had plenty of ideas for improving monetization, including removing the free plan altogether, it didn‚Äôt seem worth my time trying to grow a product that‚Äôs only doing $135 MRR. Even if I could 10x that, it‚Äôs still a low amount compared to my other products.</p>

<p>So over time I spent less time and attention on Tweet Photo. It continued to grow organically.</p>

<p>Another reason I didn‚Äôt want to invest too much time is the inherent platform-risk of building an API-powered product. I was dependent on both Twitter and Facebook continuing to provide me access to their API. They could revoke it at any time and Tweet Photo might be doomed.</p>

<p>Earlier this year Facebook did actually deprecate one of their APIs I was relying on, requiring me to upgrade my integration to use a different API.</p>

<h3 id="-acquisition-offer">üí¨ Acquisition offer</h3>

<p>In April, <a href="https://twitter.com/kevntz">Kevin</a> reached out to me asking if I was interested in selling Tweet Photo. He had a strategic interest with his other products <a href="https://creatorkit.com/">CreatorKit</a> and <a href="https://topnine.co/">Top Nine</a>.</p>

<p><img src="https://marc.io/images/tweet-photo-acquired/dm.png" alt=""></p>

<p>Of course the question of valuation quickly came up. Typically a SaaS product is sold for 3-4x annual revenue. In Tweet Photo‚Äôs case that would be around $5,000. But that didn‚Äôt factor in the many free users that required almost zero customer support, but drove continued growth.</p>

<p>If I were to sell it, it would need to be in the $xx,xxx range. Otherwise I‚Äôd prefer to just keep the service and see what happens. There‚Äôs always the possibility of another celebrity using it and it going viral.</p>

<h3 id="-valuation-of-30000">üí∞ Valuation of $30,000</h3>

<p>After some negotiation we ultimate settled on a purchase price of $30,000.</p>

<p>The first $10,000 is cash upfront with no strings attached. The remaining $20,000 is contingent on Tweet Photo making that much (or more) in revenue within 24 months of the acquisition.</p>

<p>We both ran the numbers and we believe that with the full weight of <a href="https://creatorkit.com/">CreatorKit</a> behind it, it seems very likely Tweet Photo will cross that revenue goal.</p>

<p>But you never know how things turn out, so this was a way to de-risk the acquisition for the buyer while still allowing for a higher purchase than you‚Äôd typically see for a $135 MRR business.</p>

<p>Ask me in a few months how things are going üôÇ</p>

<h3 id="-whats-next">üëÄ What‚Äôs next</h3>

<p>The $10,000 is in the bank and we‚Äôre now finalizing the asset transfer.</p>

<p>In the coming months CreatorKit will likely start marketing it to their existing userbase and possibly improving the service as well. Since we still have a shared interest in growing Tweet Photo me and the CreatorKit team will keep in touch to see how things are going.</p>

<p>Personally, I will continue to focus on <a href="https://wip.chat/">WIP</a>, <a href="https://betalist.com/">BetaList</a>, and <a href="https://startup.jobs/">Startup Jobs</a>.</p>

<p>If you want to hear how the remaining $20,000 plays out subscribe to my newsletter below üíå</p>


  </div></div>]]>
            </description>
            <link>https://marc.io/tweet-photo-acquired</link>
            <guid isPermaLink="false">hacker-news-small-sites-24336925</guid>
            <pubDate>Mon, 31 Aug 2020 23:25:58 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Understanding How the Time-Based One-Time Password Algorithm Works]]>
            </title>
            <description>
<![CDATA[
Score 107 | Comments 34 (<a href="https://news.ycombinator.com/item?id=24336785">thread link</a>) | @aryamansharda
<br/>
August 31, 2020 | https://blog.digitalbunker.dev/2020/08/27/how-do-time-based-one-time-password-totp-services-work/ | <a href="https://web.archive.org/web/*/https://blog.digitalbunker.dev/2020/08/27/how-do-time-based-one-time-password-totp-services-work/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div itemprop="mainEntityOfPage">
		
<p>Cybersecurity has always been a weak point for me and after setting up Authy for the n-th time, it seemed as good a time as any to take a deep dive and figure out exactly how these time-based one-time password algorithms worked.</p>



<figure><img src="https://lh5.googleusercontent.com/L93OYxu_Tn62xRpz0FsJyBeFNl8sp79Q4O-Wq2SPIC8rabc82VqubJNThDYX-vFl8TwOQSZwf7bDVzwyAxSD28jkRq0jiOtmFGmYhULpW8G8_vrGN89Z3NuOUC27z9pgyuQ8OuCT" alt="" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><figcaption>Examples of different time-based one-time password algorithm implementations</figcaption></figure>



<h2>Basic Overview</h2>



<p>At the highest level, the passcodes you see on these apps are created using a TOTP (time-based one-time password) algorithm. The passcode is generated by combining a secret key from the service you‚Äôre authenticating with and the current time. That‚Äôs why the codes always expire after a few seconds.&nbsp;</p>



<p>If you‚Äôve set up these apps yourselves, you‚Äôll probably remember having to scan a QR code somewhere along the way. That was the transfer of the secret key to your device‚Äôs secure keychain storage. This algorithm is agnostic of your SIM card, cellular network provider, or the make/model of your phone which makes it preferable to texting the user an authentication code. The algorithm‚Äôs only considerations are the current time and the shared secret key.&nbsp;</p>



<p>Whenever you create a new account on a service that supports TOTP, they‚Äôll generate a unique secret code for your user account. Then, the next time you‚Äôre logging in, the website will run the same algorithm the client runs to generate a passcode. If the passcode from the client matches the one generated by the server, the user is authenticated and the two-factor authentication process is complete.</p>



<h2>Algorithm Overview</h2>



<p>I‚Äôve always found it easier to understand concepts like this by looking directly at the code. Let‚Äôs see what we‚Äôd need to do to implement a TOTP service from scratch.&nbsp;</p>



<p>TOTP is built off of a foundational algorithm called the HMAC-based One-time Password algorithm (HOTP), which we‚Äôll need to understand first.&nbsp;</p>



<p>HMAC (hash-based message authentication code) is simply an algorithm that uses</p>



<ul><li>a cryptographic hash function (commonly <code>SHA1</code>)</li><li>a secret cryptographic key</li><li>a counter property (used to keep the client and server TOTP processes in sync)&nbsp;</li></ul>



<p>to generate a unique time based authentication code.&nbsp;</p>



<p>If the distinction between TOTP and HOTP/HMAC isn‚Äôt totally clear yet, don‚Äôt worry. The main difference between TOTP and HOTP implementations involve the counter property. </p>



<p>HOTP‚Äôs counter is generally event-driven ‚Äì for example, a button press would change the counter value. </p>



<figure><img loading="lazy" width="600" height="298" src="https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/hardware-token.jpg?resize=600%2C298&amp;ssl=1" alt="" srcset="https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/hardware-token.jpg?w=600&amp;ssl=1 600w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/hardware-token.jpg?resize=300%2C149&amp;ssl=1 300w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/hardware-token.jpg?resize=370%2C184&amp;ssl=1 370w" sizes="(max-width: 600px) 100vw, 600px" data-recalc-dims="1" data-lazy-srcset="https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/hardware-token.jpg?w=600&amp;ssl=1 600w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/hardware-token.jpg?resize=300%2C149&amp;ssl=1 300w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/hardware-token.jpg?resize=370%2C184&amp;ssl=1 370w" data-lazy-src="https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/hardware-token.jpg?resize=600%2C298&amp;is-pending-load=1#038;ssl=1" data-old-srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><figcaption>An example device implementing the HOTP algorithm</figcaption></figure>



<p>Instead, in TOTP, the counter value is set based on the current timestamp. </p>



<p>Let‚Äôs take a look at the end to end flow.</p>



<p>First, we‚Äôll create a counter from the timestamp. To avoid any additional complexity, we‚Äôll just use time since epoch which is agnostic of timezones.&nbsp;</p>



<figure><img src="https://lh5.googleusercontent.com/qnUpYNJC6jzwQHRa7fLcOSSX9Np-J4fUQLJujxqQ4SCIY79rLF_1OCVkt4Zv1yjAicMLlNriMRNxzkotqWDNO56eRxudqQvqmmRvxfRLUnUAECK0Lx9nvQY0npKNOObClF6rld0T" alt="" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><figcaption>We need the number of Tx intervals to provide as input into the HOTP algorithm.</figcaption></figure>



<p>Simply put, the result of this calculation is to figure out how many Tx intervals away from the Unix epoch the user is. </p>



<figure><img loading="lazy" width="924" height="863" src="https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=924%2C863&amp;ssl=1" alt="" srcset="https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?w=924&amp;ssl=1 924w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=300%2C280&amp;ssl=1 300w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=768%2C717&amp;ssl=1 768w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=370%2C346&amp;ssl=1 370w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=760%2C710&amp;ssl=1 760w" sizes="(max-width: 924px) 100vw, 924px" data-recalc-dims="1" data-lazy-srcset="https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?w=924&amp;ssl=1 924w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=300%2C280&amp;ssl=1 300w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=768%2C717&amp;ssl=1 768w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=370%2C346&amp;ssl=1 370w, https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=760%2C710&amp;ssl=1 760w" data-lazy-src="https://i2.wp.com/blog.digitalbunker.dev/wp-content/uploads/2020/08/Screen-Shot-2020-08-27-at-12.16.56-AM-1.png?resize=924%2C863&amp;is-pending-load=1#038;ssl=1" data-old-srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><figcaption>Full TOTP Flow</figcaption></figure>



<h2>Implementation</h2>



<p>Here‚Äôs the Swift code thus far:&nbsp;</p>



<pre><code> let secretKey = "digitalbunker"
 let counter = "53283545"
 let hmacResult: String = secretKey.hmac(algorithm: .SHA1,  counter: counter)</code></pre>



<p>Now, <code>hmacResult</code> is equal to the following hashed value <code>1OyZRjbfhe+8womld8xldXo5V9M=</code>.</p>



<p>Next, Let‚Äôs convert this hashed value to a hexadecimal string:&nbsp;</p>



<pre><code>let data = Data(hmacResult.utf8)
let hexString = data.map{String(format:"%02x ", $0)}</code></pre>



<p><code>hexString</code> is now equal to <code>31 4f 79 5a 52 6a 62 66 68 65 2b 38 77 6f 6d 6c 64 38 78 6c 64 58 6f 35 56 39 4d 3d</code>.</p>



<p>This isn‚Äôt something we can ask the user to type in every single time they need to authenticate. Let‚Äôs see if we can find an easier way of representing this ‚Äì a 6 digit code would be a great user-friendly alternative. </p>



<p>We‚Äôll convert this hashed value to a shorter code through a process called dynamic truncation.&nbsp;</p>



<p>Dynamic truncation involves taking the lower 4 bits of the last byte of the hexadecimal string and using that as an offset into the string to help us create a 6 digit code while still remaining secure.&nbsp;</p>



<p>The last byte is <code>3d</code> which means the last 4 bits belong to the hexadecimal value for <code>d</code>  (decimal <code>13</code>).</p>



<p>Starting at an offset of <code>13</code>, we‚Äôll grab the next 4 bytes:&nbsp;</p>



<p><code>31 4f 79 5a 52 6a 62 66 68 65 2b 38 77 <strong>6f 6d 6c 64</strong> 38 78 6c 64 58 6f 35 56 39 4d 3d</code></p>



<p>These bit operations are all part of the dynamic truncation process. We‚Äôre doing all of these manipulations to find a 6 digit code that is still as secure as possible.&nbsp;</p>



<p>Now, we‚Äôll convert <code>0x6f6d6c64</code> to decimal giving us <code>1869442148</code>. Since we just need a 6 digit code, we can take the last 6 digits <code>442148</code> and return that to the user.&nbsp;</p>



<p>Now, the server will do the exact same sequence of steps. More accurately, it‚Äôll check the current 30-second interval, the previous one, and the next one to account for clock drift. If the server‚Äôs code matches the code the user entered, the user is authenticated.</p>



<h2>Closing Thoughts</h2>



<p>TOPT and HOPT are both well-respected algorithms, but it‚Äôs important to mention the limitations. TOTP values can be phished like other passwords, but the attacker would have to be stealing the credentials in near real-time. </p>



<p>If this is a concern, you can shorten the TTL of the code. Standard TTL‚Äôs of TOTP codes can range from 10 ‚Äì 30 seconds to account for latency (both client and server-side), unsynchronized clocks, and for user usability ‚Äì feel free to tweak the TTL to suit your needs. However, if the attacker was able to find the shared secret key, they‚Äôd be able to create valid TOTP codes at will.&nbsp;</p>



<p>Hope you‚Äôve enjoyed this closer look at the TOTP algorithm and its nuances! If you like contact like this, please join our mailing list. If there‚Äôs any article requests or comments, please feel free to reach out.&nbsp;&nbsp;</p>
			
				</div></div>]]>
            </description>
            <link>https://blog.digitalbunker.dev/2020/08/27/how-do-time-based-one-time-password-totp-services-work/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24336785</guid>
            <pubDate>Mon, 31 Aug 2020 23:08:46 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Are apps even that relevant anymore?]]>
            </title>
            <description>
<![CDATA[
Score 54 | Comments 44 (<a href="https://news.ycombinator.com/item?id=24335703">thread link</a>) | @stokesyio
<br/>
August 31, 2020 | https://tinyprojects.dev/posts/are_apps_even_that_relevant_anymore | <a href="https://web.archive.org/web/*/https://tinyprojects.dev/posts/are_apps_even_that_relevant_anymore">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page">
	
	<nav>
		<a href="https://tinyprojects.dev/">Home</a>
		<a href="https://tinyprojects.dev/projects">Projects</a>
		<a href="https://tinyprojects.dev/guides">Guides</a>
		<a href="https://tinyprojects.dev/blog">Blog</a>
	</nav>
	
	<p><i>August 31st 2020</i></p>

	<p>Are apps even that relevant anymore? This is a question that's been on my mind for a while, but has particularly come to the forefront with the recent Epic vs. Apple saga.</p>

	<p>Sure, video games like Fortnite and software requiring native APIs make sense as an app (for now). But, if you're not a tilt-your-phone rolling-ball maze game, why not just make your software a great mobile-optimised website instead of an app?</p>

	<p>Sometimes I feel that there's a mentality amongst new developers and naive businesses that mobile software must be in the form of an app. I can see why.</p>

	<p>When the iPhone launched in 2007, apps were such a step up from the clunky text-based websites on our tiny manual-buttoned phones, who could blame anyone for wanting to develop a beautiful full-screen app? However, with that excitement, I feel the idea of making great software for the mobile web got left behind.</p>

	<p>Developing an app is so much harder than building software optimised for the mobile web. Not only do you have the monetary cost of developer licenses and equipment (iOS devices) when developing apps, you also have a sigificant time cost involved for maintaining separate iOS and Android codebases, building &amp; deploying to real test devices, and the delay and scrutiny your app goes under before updates go live onto an app store.</p>

	<p>Once your app is live, you have the significant barrier of a user having to find it, then use their precious storage space to install it. Oh, and the app stores take a juicy 30% cut of your profits.</p>

	<p>Who is actually winning here?</p>

	<p>Increasingly, a trend I've caught myself doing is using the mobile website equivalent of an app. Instagram &amp; Facebook's mobile websites for example have almost every feature of their app counterparts, without taking up massive storage space on my phone and draining battery with their background processes.</p>

	<p>Even now with my own <a href="https://tinyprojects.dev/projects" target="_blank">projects</a>, a well optimised mobile website beats an app most times. Who needs push notifications (and the effort they require to set up) when email notifications do the job just fine?</p>

	<p>In most cases, a great mobile website does the trick. You don't need an app, or the app store. We already have a pretty great app store and you're browsing it right now.</p>

	
	
	
	
	
	

</div>]]>
            </description>
            <link>https://tinyprojects.dev/posts/are_apps_even_that_relevant_anymore</link>
            <guid isPermaLink="false">hacker-news-small-sites-24335703</guid>
            <pubDate>Mon, 31 Aug 2020 20:39:45 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Price collapsing ‚Äì Audi e-tron Forum]]>
            </title>
            <description>
<![CDATA[
Score 11 | Comments 6 (<a href="https://news.ycombinator.com/item?id=24335273">thread link</a>) | @evo_9
<br/>
August 31, 2020 | https://www.e-tronforum.com/threads/price-collapsing.1580/ | <a href="https://web.archive.org/web/*/https://www.e-tronforum.com/threads/price-collapsing.1580/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to extract article]]>
            </description>
            <link>https://www.e-tronforum.com/threads/price-collapsing.1580/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24335273</guid>
            <pubDate>Mon, 31 Aug 2020 19:50:27 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Physics-Based Differentiable Rendering: A Comprehensive Introduction]]>
            </title>
            <description>
<![CDATA[
Score 21 | Comments 1 (<a href="https://news.ycombinator.com/item?id=24334173">thread link</a>) | @adamnemecek
<br/>
August 31, 2020 | https://shuangz.com/courses/pbdr-course-sg20/ | <a href="https://web.archive.org/web/*/https://shuangz.com/courses/pbdr-course-sg20/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
<p><img alt="teaser" src="https://shuangz.com/courses/pbdr-course-sg20/pbdr_teaser.png">

</p>
<p><span>Abstract</span></p>
<p>
Physics-based rendering algorithms generate photorealistic images by simulating the flow of light through a detailed mathematical representation of a virtual scene. In contrast, <b>physics-based differentiable rendering</b> algorithms focus on computing derivative of images exhibiting complex light transport effects (e.g., soft shadows, interreflection, and caustics) with respect to arbitrary scene parameters such as camera pose, object geometry (e.g., vertex positions) as well as spatially varying material properties expressed as 2D textures and 3D volumes. This new level of generality has made physics-based differentiable rendering a key ingredient for solving many challenging inverse-rendering problems, that is, the search of scene configurations optimizing user-specified objective functions, using gradient-based methods
</p>
<p>
Further, these techniques can be incorporated into probabilistic inference and machine learning pipelines. For instance, differentiable renderers allow "rendering losses" to be computed with complex light transport effects captured. Additionally, they can be used as generative models that synthesize photorealistic images.
</p>
<p>
<u><b>Challenges.</b></u> Compared to its "ordinary" counterpart, physics-based differentiable rendering introduces unique theoretical and practical challenges. For instance, practical problems can involve many (e.g., 10<sup>6</sup>--10<sup>10</sup>) parameters, making simple techniques for differentiation such as finite differences impractical. More advanced tools for automatic differentiation (e.g., <tt>PyTorch</tt> or <tt>Tensorflow</tt>) record a graph of intermediate computation steps that tends to become prohibitively large. Lastly, geometric derivatives involve a unique challenge: boundaries of objects introduce troublesome discontinuities during the computation of shadows and interreflections that lead to incorrect gradients if precautions are not taken. Thankfully, recent advances in physics-based differentiable rendering theory have enabled the differentiation of radiometric measurements with respect to arbitrary scene parameters as well as unbiased Monte Carlo estimators. <b>In this course, we provide an in-depth introduction to general-purpose physics-based differentiable rendering.</b>
</p>
<p><span>Course Recording</span></p>
<video width="920" height="518" src="https://shuangz.com/courses/pbdr-course-sg20/downloads/pbdr-course-sg20.mp4" poster="https://shuangz.com/courses/pbdr-course-sg20/pbdr-course-sg20-title.jpg" controls="">
Your browser does not support the video tag.
</video>
<p><span>Resources</span></p>
<ul>
<li>
<b>Course recording:</b> <a href="https://shuangz.com/courses/pbdr-course-sg20/downloads/pbdr-course-sg20.mp4">mp4</a> (2.4 GB)
</li>
<li>
<b>Course notes:</b> <a href="https://shuangz.com/courses/pbdr-course-sg20/downloads/pbdr-course-sg20-notes.pdf">pdf</a> (9 MB, work in progress)
</li>
<li>
<b>Slides:</b> <a href="https://shuangz.com/courses/pbdr-course-sg20/downloads/pbdr-course-sg20-slides.key">key</a> (548 MB), <a href="https://shuangz.com/courses/pbdr-course-sg20/downloads/pbdr-course-sg20-slides.pdf">pdf</a> (122 MB)
</li>
<li>
<b>Demo code:</b> <a href="https://github.com/BachiLi/diffrender_tutorials">github</a>
</li>
</ul>
</div><p>
¬© 2020. All Rights Reserved.
</p></div>]]>
            </description>
            <link>https://shuangz.com/courses/pbdr-course-sg20/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24334173</guid>
            <pubDate>Mon, 31 Aug 2020 18:04:28 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Cracking Phobos UUID]]>
            </title>
            <description>
<![CDATA[
Score 52 | Comments 14 (<a href="https://news.ycombinator.com/item?id=24333545">thread link</a>) | @tux1968
<br/>
August 31, 2020 | https://breakpoint.purrfect.fr/article/cracking_phobos_uuid.html | <a href="https://web.archive.org/web/*/https://breakpoint.purrfect.fr/article/cracking_phobos_uuid.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
      <div id="cracking-phobos-uuid">

<div id="tl-dr-for-busy-people">
<h2>tl;dr for busy people</h2>
<ul>
<li><p>Contrary to other languages, D's current standard implementation of UUID4
isn't cryptographically secure and shouldn't be used to generate secrets
This is supported by the RFC which discourages people to use UUIDs for
secrets.</p></li>
<li><p>Of course lots of people, projects and frameworks use them to generate
secrets such as session cookies, password reset token and more because it's
easy, looks like it should work and does work in virtually any other
language.</p></li>
<li><p>Legitimately, people will ask "OK, it's bad in theory, but how hard is it
in practice". I show in this article that it is possible to guess the next
UUID to be generated with a maximum of 8192 requests after having gathered
156 UUIDs: a very practical attack indeed compared to the original 2¬π¬≤‚Å∏
possibilities.</p></li>
<li><p>This should be viewed as a call for action: Phobos must provide a secure
random number generator. It's too basic and important a component not to
provide it in a standard way.</p></li>
<li><p>If your project uses <strong>randomUUID()</strong>, make sure its value isn't supposed
to be secret. Otherwise change for a token built from cryptographically
secure randomness.</p></li>
</ul>
</div>
<div id="context">
<h2>Context</h2>
<p>Some time ago I had a nice chat with a library's maintainer about Random
Number Generation and their relation to security. It reminded me that the
topic is not obvious and I decided to have a look at the state of things in
<a href="https://dlang.org/">D</a> since that's become my topic of open-source
research these last years.</p>
<p>In particular, I knew that D's standard library, Phobos, does not currently
propose any standard way to get cryptographically secure random numbers. Not
too many projects use the default and insecure <strong>uniform()</strong> to generate
secrets such as session tokens. However I decided to have a look at UUIDs
since they are often for security purpose. And sure enough, many projects
that I will not list use insecure UUIDs.</p>
<p>The thing is, while they should not do so, I cannot fault them for thinking
that it is correct. In most languages UUIDs are generated from secure
randomness and are a reasonable way to generate secure secrets. But that is
not the case in D and this means that these projects are vulnerable.</p>
<p>In this post we'll see how we can predict future UUIDs from previous
ones. It's a bit of work certainly, but it's not that hard. Here's our
road map:</p>
<ul>
<li><p><a href="#identify">Identify</a>: see how random UUIDs are made in Phobos</p></li>
<li><p><a href="#prepare">Prepare</a>: crack raw MT19937</p></li>
<li><p><a href="#attack">Attack</a>: predict future UUIDs from past ones</p></li>
<li><p><a href="#defend">Defend</a>: see how to fix this in your project and in Phobos</p></li>
</ul>
<p>This will be quite the long and technical post, but come along anyway, it is
sure to be interesting!</p>
<div id="a-word-on-randomness">
<h3>A word on randomness</h3>
<p>Before going further we need to be clear about what we mean by
cryptographically secure randomness and how it differs from regular
randomness.</p>
<p>Normal randomness is generally defined by only one assumption: to have no or
low bias. This means that if you were to generate lots of numbers, the number
of times you see each specific output should be evenly matched. This property
is sufficient for most applications, from a random dog name generator to
Monte-Carlo simulations.</p>
<p>However cryptographic randomness requires more:</p>
<ul>
<li><p>It must not have any bias</p></li>
<li><p>It must not be possible to predict future outputs from old ones</p></li>
<li><p>It must not be possible to recover past outputs from current ones</p></li>
</ul>
<p>(The proper <a href="https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator#Definitions">definition</a> is a bit stronger than this, but this will suffice
in the context of our article.)</p>
<p>If there's a bias, then I have information about what numbers are generated
without having to gather a single number. I do not think I need to explain
how predicting future numbers can be an issue for a system generating secrets
such as session tokens. The last item though can surprise, but consider this:
if it is possible to recover past outputs from current ones and you use these
random numbers for password reset tokens (for example), then I can ask a
reset of another user's password, then ask a reset of mine and determine what
the previous entry was, disclosing that user's password reset token.</p>
<p>Why aren't cryptographically secure pseudo-random number generators (CSPRNG)
used for everything if they're more secure? Because enforcing these
conditions also makes them much slower than conventional PRNGs and many
applications don't need these guarantees.</p>
<p>MT19937 is not a cryptographically secure pseudo-random number generator and
can't be used as one. It's not a matter of choosing the right seed, or
reseeding often (actually, reseeding often would be a benefit to us as we'll
see at the end). It has some bias (not much admittedly), but most importantly
it's both possible to predict the future and recover the past from just a few
outputs.</p>
<p><img alt="../image/chibi_cat_hurry_up.png" src="https://breakpoint.purrfect.fr/image/chibi_cat_hurry_up.png">
</p></div>
</div>
<div id="structure-of-a-uuid">
<h2>Structure of a UUID</h2>
<div id="the-standard">
<h3>The standard</h3>
<p>Universally Unique Identifiers (UUID) are a category of identifiers defined
in <a href="https://tools.ietf.org/html/rfc4122.html">RFC 4122</a>. Their goal is, as
the name suggests, to provide a way got generate IDs that are guaranteed to
be different even across systems that can't communicate together. You've
probably seen them, they look like this:
<strong>0d3120f8-f209-43f2-949d-e70dcf228403</strong></p>
<p>There are different types of UUIDs, but the most common one is Type 4: random
UUIDs. These are described in section 4.4 of the RFC as such:</p>
<ul>
<li><p>bits 6 and 7 must be set to 0 and 1</p></li>
<li><p>bits 12 to 15 must be set to the UUID version number: 4 in this case (0100)</p></li>
<li><p>all 122 other bits must be set to random values</p></li>
</ul>
<p>In practice, libraries generally choose 4 32-bit random numbers, concatenate
them and then change bits 6,7 and 12 to 15. This means that some information
about these random numbers is lost in the process, we don't get a clean PRNG
output.</p>
<p>Note that the RFC does not require the use of cryptographically secure random
numbers, but it does warn against using UUIDs for sensitive values if normal
randomness is used.</p>
</div>
<div id="phobos-implementation">
<h3>Phobos implementation</h3>
<p>Phobos' <strong>randomUUID()</strong> follows these lines perfectly, using non-secure
randomness.</p>
<pre><code><span>UUID</span> <span>randomUUID</span><span>(</span><span>RNG</span><span>)(</span><span>ref</span> <span>RNG</span> <span>randomGen</span><span>)</span>
<span>if</span> <span>(</span><span>isInputRange</span><span>!</span><span>RNG</span> <span>&amp;&amp;</span> <span>isIntegral</span><span>!</span><span>(</span><span>ElementType</span><span>!</span><span>RNG</span><span>))</span>
<span>{</span>
    <span>import</span> <span>std.random</span> <span>:</span> <span>isUniformRNG</span><span>;</span>
    <span>static</span> <span>assert</span><span>(</span><span>isUniformRNG</span><span>!</span><span>RNG</span><span>,</span> <span>"randomGen must be a uniform RNG"</span><span>);</span>

    <span>alias</span> <span>E</span> <span>=</span> <span>ElementEncodingType</span><span>!</span><span>RNG</span><span>;</span>
    <span>enum</span> <span>size_t</span> <span>elemSize</span> <span>=</span> <span>E</span><span>.</span><span>sizeof</span><span>;</span>
    <span>static</span> <span>assert</span><span>(</span><span>elemSize</span> <span>&lt;=</span> <span>16</span><span>);</span>
    <span>static</span> <span>assert</span><span>(</span><span>16</span> <span>%</span> <span>elemSize</span> <span>==</span> <span>0</span><span>);</span>

    <span>UUID</span> <span>u</span><span>;</span>
    <span>foreach</span> <span>(</span><span>ref</span> <span>E</span> <span>e</span> <span>;</span> <span>u</span><span>.</span><span>asArrayOf</span><span>!</span><span>E</span><span>())</span>
    <span>{</span>
        <span>e</span> <span>=</span> <span>randomGen</span><span>.</span><span>front</span><span>;</span>
        <span>randomGen</span><span>.</span><span>popFront</span><span>();</span>
    <span>}</span>

    <span>//set variant
</span>    <span>//must be 0b10xxxxxx
</span>    <span>u</span><span>.</span><span>data</span><span>[</span><span>8</span><span>]</span> <span>&amp;=</span> <span>0b10111111</span><span>;</span>
    <span>u</span><span>.</span><span>data</span><span>[</span><span>8</span><span>]</span> <span>|=</span> <span>0b10000000</span><span>;</span>

    <span>//set version
</span>    <span>//must be 0b0100xxxx
</span>    <span>u</span><span>.</span><span>data</span><span>[</span><span>6</span><span>]</span> <span>&amp;=</span> <span>0b01001111</span><span>;</span>
    <span>u</span><span>.</span><span>data</span><span>[</span><span>6</span><span>]</span> <span>|=</span> <span>0b01000000</span><span>;</span>

    <span>return</span> <span>u</span><span>;</span>
<span>}</span></code></pre>
<p>It generates 4 32-bit uint values using the default random number generator
of std.random: MT19937. If that PRNG's state is too small, it falls back on
Xorshift192 (<a href="https://github.com/dlang/phobos/blob/v2.093.0/std/uuid.d#L1200">code here</a>).</p>
<p>So our main target is Mersenne Twister 19937, possibly the most common PRNG
in use.</p>
<p><img alt="../image/chibi_cat_me_want.png" src="https://breakpoint.purrfect.fr/image/chibi_cat_me_want.png">
</p></div>
</div>
<div id="cracking-mt19937">
<h2>Cracking MT19937</h2>
<div id="previous-work">
<h3>Previous work</h3>
<p>So, <a href="https://en.wikipedia.org/wiki/Mersenne_Twister">MT19937</a> is
well-known, used a lot, and insecure. Surely other people have written about
cracking it in the past?</p>
<p>Indeed, there is a profusion of <a href="https://jazzy.id.au/2010/09/22/cracking_random_number_generators_part_3.html">articles</a>
but the most interesting one was definitely <a href="https://www.ambionics.io/blog/php-mt-rand-prediction">this article</a> by Ambionics that
does something different.</p>
<p>The basic strategy we see in these articles is to recover the internal
624-byte state of the Mersenne Twister by collecting 624 values. From there
it is possible to predict any future value. Of course this isn't immediately
an option for our larger project since some bits are missing from UUIDs due
to how they are built, but it is an important cornerstone.</p>
<p>The Ambionics strategy is very interesting also: they show that since each
output value depends only on two state values, it is possible to recover the
previous value with only two outputs. From there they rebuild the complete
seed by inverting its process. Good stuff. We will not get to use it but it
is definitely worth a read.</p>
<p>In the end all Mersenne Twisters are a bit different so we need to tailor the
approach for Phobos, but we will use two values to predict the next one.</p>
</div>
<div id="how-mt19937-works">
<h3>How MT19937 works</h3>
<p>MT19337's internal state is an array of 624 32-bit integers. That array is
seeded at initialization but we will not discuss seeding in this article. For
all intent and purposes, we start with an array of 624 random integers.</p>
<p>Once seeded, two mechanisms are at play. One outputs a number after
scrambling it (in blue in the figure) while the other updates the next entry
by combining three elements of the state array: the <em>index</em>, the <em>next</em> and
the <em>conjugate</em> (naming is hard). This process is in orange in the figure.</p>
<p><img alt="../image/mt19937_1.png" src="https://breakpoint.purrfect.fr/image/mt19937_1.png"></p><p>The actual values presented are mostly specific to Phobos' implementation,
but let's note the most important ones:</p>
<pre>n = 624    a = 0x9908b0df   c = 0xefc60000
m = 397    b = 0x9d2c5680</pre>
<p>One thing isn't apparent in this diagram, and it is how <em>next</em> and <em>index</em>
are combined to produce <em>y</em>. <em>y</em> is composed of the most significant bit of
<em>index</em> and all bits from <em>next</em> except its most significant one.</p>
<p>Each time a new number is outputted, both of these processes go one step to
the left, walking the state array in reverse order. After <em>n</em> iterations it
loops back to the end of the array.</p>
<p>You can read Phobos's implementation <a href="https://github.com/dlang/phobos/blob/master/std/random.d#L955">here</a> but note
that, in order to improve caching performances, both the blue and orange
processes are interweaved.</p>
<p>And with this we are ready to crack normal MT19937!</p>
</div>
<div id="reversing-the-scrambling">
<h3>Reversing the scrambling</h3>
<p>MT19937 is entirely defined by its internal state. If we can identify all its
624 components then we can just set the state of our own MT19937 PRNG with
these values and it'll output the same numbers. Now, given one output, if we
are able to reverse the scrambling (blue process) then we directly obtain the
corresponding state value. And if we're able to do it once, we can do it for
624 consecutive outputs and have a full internal state. The key part is that
we never need to worry about the updating (orange) process in that scenario.</p>
<p><img alt="../image/mt19937_2.png" src="https://breakpoint.purrfect.fr/image/mt19937_2.png"></p><p>In code, this gives:</p>
<pre><code><span>uint</span> <span>scramble</span><span>(</span><span>uint</span> <span>z</span><span>)</span> <span>{</span>
    <span>immutable</span> <span>b</span> <span>=</span> <span>0x9d2c5680</span><span>;</span>
    <span>immutable</span> <span>c</span> <span>=</span> <span>0xefc60000</span><span>;</span>

    <span>z</span> <span>^=</span>  <span>z</span> <span>&gt;&gt;</span> <span>11</span><span>;</span>
    <span>z</span> <span>^=</span> <span>(</span><span>z</span> <span>&lt;&lt;</span>  <span>7</span><span>)</span> <span>&amp;</span> <span>b</span><span>;</span>
    <span>z</span> <span>^=</span> <span>(</span><span>z</span> <span>&lt;&lt;</span> <span>15</span><span>)</span> <span>&amp;</span> <span>c</span><span>;</span>
    <span>z</span> <span>^=</span> <span>(</span><span>z</span> <span>&gt;&gt;</span> <span>18</span><span>);</span>
    <span>retur‚Ä¶</span></code></pre></div></div></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://breakpoint.purrfect.fr/article/cracking_phobos_uuid.html">https://breakpoint.purrfect.fr/article/cracking_phobos_uuid.html</a></em></p>]]>
            </description>
            <link>https://breakpoint.purrfect.fr/article/cracking_phobos_uuid.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24333545</guid>
            <pubDate>Mon, 31 Aug 2020 17:10:11 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Intel MKL on AMD Zen]]>
            </title>
            <description>
<![CDATA[
Score 142 | Comments 50 (<a href="https://news.ycombinator.com/item?id=24332825">thread link</a>) | @todsacerdoti
<br/>
August 31, 2020 | https://danieldk.eu/Posts/2020-08-31-MKL-Zen.html | <a href="https://web.archive.org/web/*/https://danieldk.eu/Posts/2020-08-31-MKL-Zen.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div role="main">
    <h2>Intel MKL on AMD Zen</h2>

<p><i>Aug 31, 2020</i></p>


  
  <p>
  <b>Tags:</b>
    
      <a href="https://danieldk.eu/Posts/tag/dev">dev</a>,
    
      <a href="https://danieldk.eu/Posts/tag/linux">linux</a>
    
  </p>


<h2 id="introduction">Introduction</h2>

<p><strong>Disclaimer:</strong> this post investigates how recent MKL versions behave
on Zen CPUs. You should read the MKL license before using MKL. I shall
not be held responsible for how you use MKL.</p>

<p>Intel MKL has been known to use a SSE code paths on AMD CPUs that
support newer SIMD instructions such as those that use the Zen
microarchitecture. A (by now) well-known trick has been to set the
<code>MKL_DEBUG_CPU_TYPE</code> environment variable to the value <code>5</code> to <a href="https://www.pugetsystems.com/labs/hpc/How-To-Use-MKL-with-AMD-Ryzen-and-Threadripper-CPU-s-Effectively-for-Python-Numpy-And-Other-Applications-1637/">force
the use of AVX2
kernels</a>
on AMD Zen CPUs. Unfortunately, this <a href="https://old.reddit.com/r/matlab/comments/dxn38s/howto_force_matlab_to_use_a_fast_codepath_on_amd/fm2j83e/">variable has been
removed</a>
from Intel MKL 2020 Update 1 and later. This can be confirmed easily
by running a program that uses MKL with <code>ltrace -e getenv</code>.</p>

<h2 id="good-news-intel-seems-to-be-adding-zen-kernels">Good news: Intel seems to be adding Zen kernels</h2>

<p>However, it seems that Intel removed this option because they are
adding Zen kernels to MKL. For instance, if we run the <a href="https://www.lanl.gov/projects/crossroads/benchmarks-performance-analysis.php">ACES
dgemm</a>
benchmark with MKL 2020.2.254 on a Ryzen 3700X, performance is good:</p>

<div><div><pre><code><span>$ </span>./mt-dgemm 4000 | <span>grep </span>GF    
GFLOP/s rate:         382.756063 GF/s
</code></pre></div></div>

<p>A quick inspection with <code>perf</code> shows that most cycles are spent
in a Zen-optimized kernel:</p>

<div><div><pre><code>79.95%  mt-dgemm  libmkl_def.so           [.] mkl_blas_def_dgemm_kernel_zen
</code></pre></div></div>

<h2 id="bad-news-sgemm-is-not-yet-implemented">Bad news: <code>sgemm</code> is not yet implemented</h2>

<p>However, it seems that they have not yet implemented Zen kernels
for every BLAS function yet. I modified the ACES benchmark to
use the <code>sgemm</code> BLAS function and the results aren‚Äôt quite as
good:</p>

<div><div><pre><code><span>$ </span>./mt-sgemm 4000 | <span>grep </span>GF
GFLOP/s rate:         237.352720 GF/s
</code></pre></div></div>

<p>And indeed, <code>perf</code> reveals that MKL does not use a Zen kernel:</p>

<div><div><pre><code>88.90%  mt-sgemm  libmkl_def.so           [.] LM_LOOPgas_1
</code></pre></div></div>

<h2 id="a-temporary-workaround">A temporary workaround</h2>

<p>Some quick tracing shows that MKL uses a single function
<code>mkl_serv_intel_cpu_true</code> to detect whether it is dealing
with a genuine Intel CPU. Fortunately, the function is
rather trivial, so we can replace it by our own function:</p>

<div><div><pre><code><span>int</span> <span>mkl_serv_intel_cpu_true</span><span>()</span> <span>{</span>
  <span>return</span> <span>1</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>And compile it as a shared library:</p>

<div><div><pre><code><span>$ </span>gcc <span>-shared</span> <span>-fPIC</span> <span>-o</span> libfakeintel.so fakeintel.c
</code></pre></div></div>

<p>And ensure that the library gets preloaded:</p>

<div><div><pre><code><span>$ </span><span>export </span><span>LD_PRELOAD</span><span>=</span>libfakeintel.so
</code></pre></div></div>

<p>Now the <code>sgemm</code> benchmark shows good performance:</p>

<div><div><pre><code><span>$ </span>./mt-sgemm 4000 | <span>grep </span>GF
GFLOP/s rate:         851.541946 GF/s
</code></pre></div></div>

<p>And indeed, an AVX2-optimized code path is used:</p>

<div><div><pre><code>82.73%  mt-sgemm  libmkl_avx2.so          [.] mkl_blas_avx2_sgemm_kernel_0
</code></pre></div></div>

<p>The only minor downside is that MKL will also use AVX2 kernels for
other functions such as <code>dgemm</code>. But this does not seem to impact
performance negatively. In fact, for the <code>dgemm</code> benchmark performance
is slightly better on my machine (430 GF/s).</p>

<h2 id="making-it-permanent">Making it permanent</h2>

<p>Setting <code>LD_PRELOAD</code> everytime on a machine can get weary and one can
easily forget it. An easy solution is to add our small library to the
ELF dynamic section of your program using
<a href="https://github.com/NixOS/patchelf">patchelf</a> with the <code>DT_NEEDED</code>
tag. For example:</p>

<div><div><pre><code><span>$ </span>patchelf <span>--add-needed</span> libfakeintel.so yourbinary
</code></pre></div></div>



  </div></div>]]>
            </description>
            <link>https://danieldk.eu/Posts/2020-08-31-MKL-Zen.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24332825</guid>
            <pubDate>Mon, 31 Aug 2020 16:10:10 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Padding Oracles: An Animated Primer]]>
            </title>
            <description>
<![CDATA[
Score 24 | Comments 5 (<a href="https://news.ycombinator.com/item?id=24332435">thread link</a>) | @dpindur
<br/>
August 31, 2020 | https://dylanpindur.com/blog/padding-oracles-an-animated-primer/ | <a href="https://web.archive.org/web/*/https://dylanpindur.com/blog/padding-oracles-an-animated-primer/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
        <header>
            
            <span>Thu, Aug 27, 2020</span>
        </header>
        <section>
            <h2>A Bit of Background</h2>
            <p>
                I recently encountered a fun little padding oracle attack as part of a CTF and found surprisingly few articles online outlining the attack. Of the articles I did find, most either discussed specific instances of the attack (<a href="https://en.wikipedia.org/wiki/POODLE">POODLE</a>) or described a lengthy sequence of mathematical operations which were difficult to follow. In this post I want to present a different, more visual description of the attack in the hope that some may find it useful and easier to understand.
            </p>
        </section>
        <section>
            <h2>Cipher Modes</h2>
            <p>
                Before talking about padding oracles, we need to talk about cipher modes and block ciphers. The cipher we will be using in our examples is the Rijndael block cipher which forms part of the <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">Advanced Encryption Standard</a> (AES). A block cipher is an algorithm which operates on fixed-length groups of bits (blocks). Contrast this with a stream cipher where each bit is encrypted one at a time. As a block cipher is only suitable for a single fixed-length message, additional steps are required to encrypt or decrypt messages longer (or shorter) than one block. A cipher mode algorithm describes how to apply the single-block operation repeatedly to securely encrypt or decrypt a message larger than a single block.
            </p>
            <p>
                Padding oracles are commonly associated with block ciphers operating in <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_block_chaining_(CBC)">Cipher Block Chaining</a> (CBC) mode. In CBC mode each block of plaintext is mixed with the previous block before encryption. This prevents information leakage associated with the simpler <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_codebook_(ECB)">Electronic Codebook</a> (ECB) mode. In ECB mode each block is encrypted with the same key and so the same plaintext is always encrypted to the same ciphertext. This means patterns present in the plaintext will likely still be present in the ciphertext. We can see this in the images below comparing ECB and CBC modes.
            </p>
            <figure>
                <figure>
                    <img src="https://dylanpindur.com/blog/padding-oracles-an-animated-primer/img/001-plain.jpg" alt="Unencrypted Image">
                    <figcaption>Original image</figcaption>
                </figure>
                <figure>
                    <img src="https://dylanpindur.com/blog/padding-oracles-an-animated-primer/img/002-ecb.jpg" alt="Image Encrypted using ECB Mode">
                    <figcaption>Encrypted using ECB mode</figcaption>
                </figure>
                <figure>
                    <img src="https://dylanpindur.com/blog/padding-oracles-an-animated-primer/img/003-cbc.jpg" alt="Image Encrypted using CBC Mode">
                    <figcaption>Encrypted using CBC mode</figcaption>
                </figure>
                <figcaption>From <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">Wikipedia - Block cipher mode of operation</a>.</figcaption>
            </figure>
        </section>
        <section>
            <h2>AES Encryption</h2>
            <p>
                Now that we understand the different encryption modes we can begin exploring how a message is encrypted and then onto the decryption stage where our padding oracle will enable us to decrypt the message without knowing the key.
            </p>
            <svg id="animation-1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 600 340"></svg>
            
            
            
        </section>
        <section>
            <h2>Padding Oracles</h2>
            <p>
                Onto the padding oracle. An oracle is simply a mechanism to determine whether a test has passed or failed. So in our case a padding oracle is a weakness which enables us (the attacker) to determine if a message is successfully padded. The particular padding oracle we will be looking at occurs during decryption. The decryption process for CBC mode ciphers is to decrypt all blocks, validate and remove the padding then return the plaintext. How the server responds based on invalid padding will determine whether or not we can perform the attack.
            </p>
            <p>
                A padding oracle attack exploits the padding validation step of decryption in order to decrypt the message without knowing the key. The attack relies on having a padding oracle which reveals whether or not a message is correctly padded. Typically this will be the decryption server responding with a verbose error message indicating the padding is invalid. However, other channels are also possible. For example a server may take longer to reply if a message is incorrectly padded, as long as it can be inferred whether or not a message is correctly padded the attack can be performed.
            </p>
            <p>
                Now that we know what we‚Äôre looking for in a padding oracle we can walk through the decryption of our message and perform a padding oracle attack.
            </p>
            <svg id="animation-2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 600 340"></svg>
            
            
            
        </section>
        <section>
            <h2>Mitigations</h2>
            <p>
                So what can we do to prevent this attack? The obvious fix is to not reveal whether or not a message is correctly padded. However, this is easier said than done. Providing a generic error if a message fails to decrypt will eliminate any obvious padding oracles. But timing-based padding oracles are much harder to detect and prevent. In a timing-based padding oracle, rather than an error message indicating invalid padding a server may take a noticibly different amount of time to process a correctly padded message from an incorrectly padded message. How long it takes the server to respond can then be used to determine if a message is correctly padded or not.
            </p>
            <p>
                A much better approach is to encrypt the message and then append a Message Authentication Code (MAC) to verify the integrity of the ciphertext. The MAC is then validated by the server before any decryption occurs. If the validation fails, it indicates the message has been tampered with. The server can then refuse to continue decrypting the message. This ensures that there is no padding oracle, regardless of implementation details such as timings and error messages.
            </p>
        </section>
        <section>
            <h2>Closing Thoughts</h2>
            <p>
                Hopefully this has helped explain padding oracles a little better, as well as illustrate how important it is to understand how to correctly implement cryptographic code as one small mistake can very quickly bring it tumbling down. An interesting takeaway is that this technique is not just limited to decryption. Padding oracles can also be exploited to forge valid ciphertext without knowing the key, but I'll leave that as an exercise for the reader. If you ever see a system which assumes that an encrypted value cannot be tampered with (session tokens are good ones), don't forget to check for padding oracles.
            </p>
            <p>
                If you're interested in learning more please check out the links below. They really helped me while I was writing this article.
            </p>
            <ul>
                <li><a href="https://blog.skullsecurity.org/2013/padding-oracle-attacks-in-depth">Padding oracle attacks: in depth</a></li>
                <li><a href="https://en.wikipedia.org/wiki/HMAC">Hashed Message Authentication Codes</a></li>
                <li><a href="https://animejs.com/">Anime.js</a> - used to create the animations above</li>
            </ul>
        </section>
    </article></div>]]>
            </description>
            <link>https://dylanpindur.com/blog/padding-oracles-an-animated-primer/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24332435</guid>
            <pubDate>Mon, 31 Aug 2020 15:28:40 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Show HN: ML From Scratch ‚Äì free online textbook]]>
            </title>
            <description>
<![CDATA[
Score 252 | Comments 52 (<a href="https://news.ycombinator.com/item?id=24332303">thread link</a>) | @dafrdman
<br/>
August 31, 2020 | https://dafriedman97.github.io/mlbook/content/introduction.html | <a href="https://web.archive.org/web/*/https://dafriedman97.github.io/mlbook/content/introduction.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="main-content">
        <div>
        
              <div>
                
  <div id="introduction">

<p><img alt="" src="https://dafriedman97.github.io/mlbook/_images/logo_light.png"></p>
<div id="what-this-book-covers">
<h2>What this Book Covers<a href="#what-this-book-covers" title="Permalink to this headline">¬∂</a></h2>
<p>This book covers the building blocks of the most common methods in machine learning. This set of methods is like a toolbox for machine learning engineers. Those entering the field of machine learning should feel comfortable with this toolbox so they have the right tool for a variety of tasks. Each chapter in this book corresponds to a single machine learning method or group of methods. In other words, each chapter focuses on a single tool within the ML toolbox.</p>
<p>In my experience, the best way to become comfortable with these methods is to see them derived from scratch, both in theory and in code. The purpose of this book is to provide those derivations. Each chapter is broken into three sections. The <em>concept</em> sections introduce the methods conceptually and derive their results mathematically. The <em>construction</em> sections show how to construct the methods from scratch using Python. The <em>implementation</em> sections demonstrate how to apply the methods using packages in Python like <code><span>scikit-learn</span></code>, <code><span>statsmodels</span></code>, and <code><span>tensorflow</span></code>.</p>
</div>
<div id="why-this-book">
<h2>Why this Book<a href="#why-this-book" title="Permalink to this headline">¬∂</a></h2>
<p>There are many great books on machine learning written by more knowledgeable authors and covering a broader range of topics. In particular, I would suggest <a href="http://faculty.marshall.usc.edu/gareth-james/ISL/">An Introduction to Statistical Learning</a>, <a href="https://web.stanford.edu/~hastie/ElemStatLearn/">Elements of Statistical Learning</a>, and <a href="https://www.microsoft.com/en-us/research/publication/pattern-recognition-machine-learning/">Pattern Recognition and Machine Learning</a>, all of which are available online for free.</p>
<p>While those books provide a conceptual overview of machine learning and the theory behind its methods, this book focuses on the bare bones of machine learning algorithms. Its main purpose is to provide readers with the ability to construct these algorithms independently. Continuing the toolbox analogy, this book is intended as a user guide: it is not designed to teach users broad practices of the field but rather how each tool works at a micro level.</p>
</div>
<div id="who-this-book-is-for">
<h2>Who this Book is for<a href="#who-this-book-is-for" title="Permalink to this headline">¬∂</a></h2>
<p>This book is for readers looking to learn new machine learning algorithms or understand algorithms at a deeper level. Specifically, it is intended for readers interested in seeing machine learning algorithms derived from start to finish. Seeing these derivations might help a reader previously unfamiliar with common algorithms understand how they work intuitively. Or, seeing these derivations might help a reader experienced in modeling understand how different algorithms create the models they do and the advantages and disadvantages of each one.</p>
<p>This book will be most helpful for those with practice in basic modeling. It does not review best practices‚Äîsuch as feature engineering or balancing response variables‚Äîor discuss in depth when certain models are more appropriate than others. Instead, it focuses on the elements of those models.</p>
</div>
<div id="what-readers-should-know">
<h2>What Readers Should Know<a href="#what-readers-should-know" title="Permalink to this headline">¬∂</a></h2>
<p>The <em>concept</em> sections of this book primarily require knowledge of calculus, though some require an understanding of probability (think maximum likelihood and Bayes‚Äô Rule) and basic linear algebra (think matrix operations and dot products). The appendix reviews the <a href="https://dafriedman97.github.io/mlbook/content/appendix/methods.html"><span>math</span></a> and <a href="https://dafriedman97.github.io/mlbook/content/appendix/methods.html"><span>probability</span></a>needed to understand this book. The concept sections also reference a few common machine learning <a href="https://dafriedman97.github.io/mlbook/content/appendix/methods.html"><span>methods</span></a>, which are introduced in the appendix as well. The concept sections do not require any knowledge of programming.</p>
<p>The <em>construction</em> and <em>code</em> sections of this book use some basic Python. The construction sections require understanding of the corresponding content sections and familiarity creating functions and classes in Python. The code sections require neither.</p>









</div>
</div>


              </div>
              
        </div>
    </div></div>]]>
            </description>
            <link>https://dafriedman97.github.io/mlbook/content/introduction.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24332303</guid>
            <pubDate>Mon, 31 Aug 2020 15:16:32 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Effective testing for machine learning systems]]>
            </title>
            <description>
<![CDATA[
Score 94 | Comments 2 (<a href="https://news.ycombinator.com/item?id=24332202">thread link</a>) | @brzozowski
<br/>
August 31, 2020 | https://www.jeremyjordan.me/testing-ml/ | <a href="https://web.archive.org/web/*/https://www.jeremyjordan.me/testing-ml/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="site-main">
    <div>

        <article>

            


            <section>
                <div>
                    <p><em>Working as a core maintainer for <a href="https://github.com/PyTorchLightning/pytorch-lightning">PyTorch Lightning</a>, I've grown a strong appreciation for the value of tests in software development. As I've been spinning up a new project at work, I've been spending a fair amount of time thinking about how we should test machine learning systems. A couple weeks ago, one of my coworkers sent me <a href="https://homes.cs.washington.edu/~marcotcr/acl20_checklist.pdf">a fascinating paper</a> on the topic which inspired me to dig in, collect my thoughts, and write this blog post.</em> </p><p>In this blog post, we'll cover what testing looks like for traditional software development, why testing machine learning systems can be different, and discuss some strategies for writing effective tests for machine learning systems. We'll also clarify the distinction between the closely related roles of evaluation and testing as part of the model development process. By the end of this blog post, I hope you're convinced of both the extra work required to effectively test machine learning systems and the value of doing such work.</p><h2 id="what-s-different-about-testing-machine-learning-systems">What's different about testing machine learning systems?</h2><p>In traditional software systems, humans write the logic which interacts with data to produce a desired behavior. Our software tests help ensure that this <strong>written logic</strong> aligns with the actual expected behavior.</p><figure><img src="https://www.jeremyjordan.me/content/images/2020/08/Screen-Shot-2020-08-09-at-4.45.29-PM.png" alt="" srcset="https://www.jeremyjordan.me/content/images/size/w600/2020/08/Screen-Shot-2020-08-09-at-4.45.29-PM.png 600w, https://www.jeremyjordan.me/content/images/size/w1000/2020/08/Screen-Shot-2020-08-09-at-4.45.29-PM.png 1000w, https://www.jeremyjordan.me/content/images/size/w1600/2020/08/Screen-Shot-2020-08-09-at-4.45.29-PM.png 1600w, https://www.jeremyjordan.me/content/images/2020/08/Screen-Shot-2020-08-09-at-4.45.29-PM.png 1850w" sizes="(min-width: 720px) 720px"></figure><p>However, in machine learning systems, humans provide desired behavior as examples during training and the model optimization process produces the logic of the system. How do we ensure this <strong>learned logic</strong> is going to consistently produce our desired behavior?</p><figure><img src="https://www.jeremyjordan.me/content/images/2020/08/Screen-Shot-2020-08-09-at-4.47.06-PM.png" alt="" srcset="https://www.jeremyjordan.me/content/images/size/w600/2020/08/Screen-Shot-2020-08-09-at-4.47.06-PM.png 600w, https://www.jeremyjordan.me/content/images/size/w1000/2020/08/Screen-Shot-2020-08-09-at-4.47.06-PM.png 1000w, https://www.jeremyjordan.me/content/images/size/w1600/2020/08/Screen-Shot-2020-08-09-at-4.47.06-PM.png 1600w, https://www.jeremyjordan.me/content/images/2020/08/Screen-Shot-2020-08-09-at-4.47.06-PM.png 1850w" sizes="(min-width: 720px) 720px"></figure><p>Let's start by looking at the best practices for testing traditional software systems and developing high-quality software. </p><p>A typical software testing suite will include:</p><ul><li><strong>unit tests</strong> which operate on atomic pieces of the codebase and can be run quickly during development,</li><li><strong>regression tests</strong> replicate bugs that we've previously encountered and fixed,</li><li><strong>integration tests</strong> which are typically longer-running tests that observe higher-level behaviors that leverage multiple components in the codebase,</li></ul><p>and follow conventions such as:</p><ul><li>don't merge code unless all tests are passing,</li><li>always write tests for newly introduced logic when contributing code,</li><li>when contributing a bug fix, be sure to write a test to capture the bug and prevent future regressions.</li></ul><figure><img src="https://www.jeremyjordan.me/content/images/2020/08/Group-5-1.jpg" alt="" srcset="https://www.jeremyjordan.me/content/images/size/w600/2020/08/Group-5-1.jpg 600w, https://www.jeremyjordan.me/content/images/size/w1000/2020/08/Group-5-1.jpg 1000w, https://www.jeremyjordan.me/content/images/size/w1600/2020/08/Group-5-1.jpg 1600w, https://www.jeremyjordan.me/content/images/2020/08/Group-5-1.jpg 2348w" sizes="(min-width: 720px) 720px"><figcaption>A typical workflow for software development.</figcaption></figure><p>When we run our testing suite against the new code, we'll get a report of the specific behaviors that we've written tests around and verify that our code changes don't affect the expected behavior of the system. If a test fails, we'll know which specific behavior is no longer aligned with our expected output. We can also look at this testing report to get an understanding of how extensive our tests are by looking at metrics such as <strong><a href="https://en.wikipedia.org/wiki/Code_coverage">code coverage</a></strong>.</p><figure><img src="https://www.jeremyjordan.me/content/images/2020/08/Group-1.png" alt="" srcset="https://www.jeremyjordan.me/content/images/size/w600/2020/08/Group-1.png 600w, https://www.jeremyjordan.me/content/images/size/w1000/2020/08/Group-1.png 1000w, https://www.jeremyjordan.me/content/images/2020/08/Group-1.png 1149w" sizes="(min-width: 720px) 720px"><figcaption>An example output from a traditional software testing suite.</figcaption></figure><p>Let's contrast this with a typical workflow for developing machine learning systems. After training a new model, we'll typically produce an evaluation report including:</p><ul><li>performance of an established metric on a validation dataset,</li><li>plots such as precision-recall curves,</li><li>operational statistics such as inference speed,</li><li>examples where the model was most confidently incorrect,</li></ul><p>and follow conventions such as:</p><ul><li>save all of the hyper-parameters used to train the model,</li><li>only promote models which offer an improvement over the existing model (or baseline) when evaluated on the same dataset. </li></ul><figure><img src="https://www.jeremyjordan.me/content/images/2020/08/Group-3-1.png" alt="" srcset="https://www.jeremyjordan.me/content/images/size/w600/2020/08/Group-3-1.png 600w, https://www.jeremyjordan.me/content/images/size/w1000/2020/08/Group-3-1.png 1000w, https://www.jeremyjordan.me/content/images/2020/08/Group-3-1.png 1174w" sizes="(min-width: 720px) 720px"><figcaption>A typical workflow for model development.</figcaption></figure><p>When reviewing a new machine learning model, we'll inspect metrics and plots which summarize model performance over a validation dataset. We're able to compare performance between multiple models and make relative judgements, but we're not immediately able to characterize specific model behaviors. For example, figuring out <em>where</em> the model is failing usually requires additional investigative work; one common practice here is to look through a list of the top most egregious model errors on the validation dataset and manually categorize these failure modes.</p><p>Assuming we write behavioral tests for our models (discussed below), there's also the question of whether or not we have enough tests! While traditional software tests have metrics such as the lines of code covered when running tests, this becomes harder to quantify when you shift your application logic from lines of code to parameters of a machine learning model. Do we want to quantify our test coverage with respect to the input data distribution? Or perhaps the possible activations inside the model?</p><p><a href="http://proceedings.mlr.press/v97/odena19a/odena19a.pdf">Odena et al</a>. introduce one possible metric for coverage where we track the model logits for all of the test examples and quantify the area covered by radial neighborhoods around these activation vectors. However, my perception is that as an industry we don't have a well-established convention here. In fact, it feels like that testing for machine learning systems is in such early days that this question of test coverage isn't really being asked by many people.</p><h2 id="what-s-the-difference-between-model-testing-and-model-evaluation">What's the difference between model testing and model evaluation?</h2><p>While reporting evaluation metrics is certainly a good practice for quality assurance during model development, I don't think it's sufficient. Without a granular report of specific behaviors, we won't be able to immediately understand the nuance of how behavior may change if we switch over to the new model. Additionally, we won't be able to track (and prevent) behavioral regressions for specific failure modes that had been previously addressed.</p><p>This can be especially dangerous for machine learning systems since often times failures happen silently. For example, you might improve the overall evaluation metric but introduce a regression on a critical subset of data. Or you could unknowingly add a gender bias to the model through the inclusion of a new dataset during training. We need more nuanced reports of model behavior to identify such cases, which is exactly where model testing can help.</p><p>For machine learning systems, we should be running model evaluation and model tests in parallel. </p><ul><li><strong>Model evaluation</strong> covers metrics and plots which summarize performance on a validation or test dataset.</li><li><strong>Model testing</strong> involves explicit checks for behaviors that we expect our model to follow.</li></ul><p>Both of these perspectives are instrumental in building high-quality models. </p><p>In practice, most people are doing a combination of the two where evaluation metrics are calculated automatically and some level of model "testing" is done <a href="https://www.coursera.org/learn/machine-learning-projects/lecture/GwViP/carrying-out-error-analysis">manually through error analysis</a> (i.e. classifying failure modes). Developing model tests for machine learning systems can offer a systematic approach towards error analysis.</p><h2 id="how-do-you-write-model-tests">How do you write model tests?</h2><p>In my opinion, there's two general classes of model tests that we'll want to write.</p><ul><li><strong>Pre-train</strong> <strong>tests</strong> allow us to identify some bugs early on and short-circuit a training job.</li><li><strong>Post-train tests</strong> use the trained model artifact to inspect behaviors for a variety of important scenarios that we define.</li></ul><h3 id="pre-train-tests">Pre-train tests</h3><p>There's some tests that we can run without needing trained parameters. These tests include:</p><ul><li>check the shape of your model output and ensure it aligns with the labels in your dataset</li><li>check the output ranges and ensure it aligns with our expectations (eg. the output of a classification model should be a distribution with class probabilities that sum to 1)</li><li>make sure a single gradient step on a batch of data yields a decrease in your loss</li><li>make <a href="https://greatexpectations.io/">assertions about your datasets</a></li><li>check for label leakage between your training and validation datasets</li></ul><p>The main goal here is to identify some errors early so we can avoid a wasted training job.</p><h3 id="post-train-tests">Post-train tests</h3><p>However, in order for us to be able to understand model behaviors we'll need to test against trained model artifacts. These tests aim to <strong>interrogate the logic learned during training</strong> and provide us with a behavioral report of model performance.</p><blockquote><strong>Paper highlight</strong>: <a href="https://homes.cs.washington.edu/~marcotcr/acl20_checklist.pdf">Beyond Accuracy: Behavioral Testing of NLP Models with CheckList</a></blockquote><p>The authors of the above paper present three different types of model tests that we can use to understand behavioral attributes. </p><p><strong>Invariance Tests</strong></p><p>Invariance tests allow us to describe a set of perturbations we should be able to make to the input <em>without</em> affecting the model's output. We can use these perturbations to produce pairs of input examples (original and perturbed) and <strong>check for consistency</strong> in the model predictions. This is closely related to the concept of data augmentation, where we apply perturbations to inputs during training and preserve the original label. </p><p>For example, imagine running a sentiment analysis model on the following two sentences:</p><ul><li><u>Mark</u> was a great instructor.</li><li><u>Samantha</u> was a great instructor.</li></ul><p>We would expect that simply changing the name of the subject doesn't affect the model predictions. </p><p><strong>Directional Expectation Tests</strong></p><p>Directional expectation tests, on the other hand, allow us to define a set of perturbations to the input which <em>should</em> have a <em>predictable</em> effect on the model output. </p><p>For example, if we had a housing price prediction model we might assert:</p><ul><li>Increasing the number of bathrooms (holding all other features constant) should not cause a drop in price.</li><li>Lowering the square footage of the house (holding all other features constant) should not cause an increase in price.</li></ul><p>Let's consider a scenario where a model fails the second test - taking a random row from our validation dataset and decreasing the feature <code>house_sq_ft</code> yields a higher predicted price than the original label. This is surprising as it doesn't match our intuition, so we decide to look further into it. We realize that, without having a feature for the house's neighborhood/location, our model has learned that smaller units tend to be more expensive; this is due to the fact that smaller units from our dataset are more prevalent in cities where prices are generally higher. In this case, the <em>selection</em> of our dataset has influenced the model's logic in unintended ways - this isn't something ‚Ä¶</p></div></section></article></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://www.jeremyjordan.me/testing-ml/">https://www.jeremyjordan.me/testing-ml/</a></em></p>]]>
            </description>
            <link>https://www.jeremyjordan.me/testing-ml/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24332202</guid>
            <pubDate>Mon, 31 Aug 2020 15:07:28 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[As above, so below, part 2. Bare metal Rust generics]]>
            </title>
            <description>
<![CDATA[
Score 80 | Comments 12 (<a href="https://news.ycombinator.com/item?id=24332187">thread link</a>) | @M2Ys4U
<br/>
August 31, 2020 | https://www.ecorax.net/as-above-so-below-2/ | <a href="https://web.archive.org/web/*/https://www.ecorax.net/as-above-so-below-2/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
            <p>During <a href="https://www.ecorax.net/as-above-so-below-1/">last episode</a>, we went on a tour of the
pleasantly boring world of flash memory, drafted some driver interfaces, and
toyed with the idea of generics at both levels of crate visibility. What's
conspicuously absent is, well, <em>working code.</em> It's one thing to lay down data
structures, and another entirely to weave generics between the raw ones and
zeros of bare metal firmware. Today we'll gaze long into the void*, and,
hopefully, the void* won't gaze back into us.</p>

<p>In the <a href="https://www.ecorax.net/as-above-so-below-1/#what-is-flash-memory">section about flash
memory</a> we
explored, with the help of a dodgy analogy, how it's possible to directly
overwrite a <code>1</code> with a <code>0</code> but not the reverse. This quirk is what makes
writing efficient flash writers a bit tricky. When asked to write over a memory
range, a naive driver would simply erase every sector overlapped by it, then
write back the original data "merged" with the desired bytes. We want our driver
a bit smarter than that; it should first check whether it's possible to write
the bytes directly. In other words, we want to ensure that every <code>1</code> in our
intended write is also a <code>1</code> in the target space.</p>
<pre><code><span>pub trait </span><span>BitSubset {
    </span><span>/// Check that every '1' bit is a '1' on the right hand side.
</span><span>    </span><span>fn </span><span>is_subset_of</span><span>(</span><span>&amp;</span><span>self</span><span>, </span><span>rhs</span><span>: </span><span>&amp;</span><span>Self</span><span>) -&gt; </span><span>bool</span><span>;
}
</span></code></pre>
<p>That looks like a straightforward, simple trait to express the condition we want
to check. Here comes the unnecessary part: We're going to implement it
generically. Let's be honest, we <em>both</em> know we want to implement this for
<code>[u8]</code>. There shouldn't be much use for it other than slices of bytes. However,
doing it this way will help flex our generic muscles and illustrate a couple of
important points.</p>
<pre><code><span>impl</span><span>&lt;T: </span><span>Copy </span><span>+ </span><span>Eq </span><span>+ </span><span>BitOr&lt;Output=T&gt;&gt; BitSubset </span><span>for</span><span> [T] {
    </span><span>fn </span><span>is_subset_of</span><span>(</span><span>&amp;</span><span>self</span><span>, </span><span>rhs</span><span>: </span><span>&amp;</span><span>Self</span><span>) -&gt; </span><span>bool </span><span>{
        </span><span>if </span><span>self.</span><span>len</span><span>() </span><span>&gt;</span><span> rhs.</span><span>len</span><span>() {
            </span><span>false
        </span><span>} </span><span>else </span><span>{
            self.</span><span>iter</span><span>().</span><span>zip</span><span>(rhs.</span><span>iter</span><span>()).</span><span>all</span><span>(|(</span><span>a</span><span>, </span><span>b</span><span>)| (</span><span>*</span><span>a </span><span>| *</span><span>b) </span><span>== *</span><span>b)
        }
    }
}
</span></code></pre>
<p>Yes, I feel that dread too. There are enough sigils up there to summon half
the <a href="https://en.wikipedia.org/wiki/The_Lesser_Key_of_Solomon">Lesser Key of
Solomon</a>. We have
<strong>five</strong> types of brackets (<code>&lt;(|[{</code>) and we're barely getting started.
Fortunately symbols are much like ant invasions‚Äîlive with them long enough and
you'll stop noticing. They can even be endearing.</p>
<p>When I started playing with Rust generics a few years ago, it often helped me to
approach functions by parts; focusing first on the constraints, moving to
the implementation only when I've painted a clear picture of the elements involved.
I find there's a bit of ritual in deciphering constraints, not unlike the
infamous <a href="http://c-faq.com/decl/spiral.anderson.html">spiral rule</a> for C
declarations. For me, it takes the form of describing them in a
manner of plain English pseudocode. For the above it would look like this:</p>
<ul>
<li>We have <em>something</em> that can be copied and compared.</li>
<li>It can be bitwise or'd with itself.</li>
<li>We are implementing over an array of it.</li>
</ul>
<p>For more complex lists I'd sing these conditions in my head a few times until
the abstract types coalesce into something more manageable, at which point it
becomes possible to push the sigil soup away and focus on behaviour.</p>
<blockquote>
<p><strong>All</strong> the behaviour of these type parameters is summarized in these
constraints. Nothing is implicit. That's <em>very cool</em>.</p>
</blockquote>
<p>In this case, all that's left is a bit of iterator magic and bit wrangling.
<code>self.iter().zip(rhs.iter()).all(Condition)</code> "zips" two iterators together in
pairs, then verifies that every pair satisfies a condition. In our case the
condition is the closure <code>|(a, b)| (*a | *b) == *b</code>. For the condition to hold,
all <code>1</code> bits in element <code>*a</code> must also be <code>1</code> in <code>*b</code>.</p>
<p>We'll use this later to compare, as we anticipated, slices of bytes. What have
we gained from doing it generically?</p>
<ul>
<li>
<p>Even though <code>T: Copy + Eq + BitOr&lt;Output=T&gt;</code> is certainly a lot wordier
than <code>u8</code>, it's also <strong>purer</strong> in some sense, because it more accurately
summarizes what we care about. Weirdly,
the shorter <code>u8</code> carries a lot more extraneous, distracting baggage:</p>
<ul>
<li>It is 8 bits long, which is a hardware detail we don't care about.</li>
<li>It is unsigned, which is a mathematical detail we don't care about.</li>
</ul>
<p>In contrast, our platonic <code>T</code> is refreshingly simple: only does the things
that the implementation needs. And as such, the implementation <em>will be
correct now and forever after</em>, which leads to the next point:</p>
</li>
<li>
<p>When our constraints match the requirements of the implementation so tightly,
we can resort to blanket implementations, knowing that future users will opt
into this behaviour automatically if they define a type that matches these
requirements. Crates like the impressively elegant
<a href="https://bevyengine.org/">Bevy</a> take this idea further, using their prelude to
bring blanket implementations over a wide range of types without exposing the
user to the trait. This leads, I think, to very ergonomic APIs.</p>
</li>
<li>
<p>Not that we'd have any reason to suspect otherwise, but the
<a href="https://godbolt.org/z/5abac4">concrete</a> and
<a href="https://godbolt.org/z/nxMW57">generic</a> versions produce identical assembly.</p>
</li>
<li>
<p>We've increased our sigil count, getting closer to summoning
<a href="https://en.wikipedia.org/wiki/Kimaris">Kimaris</a>, Marquis of Hell, ruler of 20
demonic legions, teacher of grammar, logic and rhetoric. Maybe he'll finally
produce an intuitive definition of a
<a href="https://en.wikipedia.org/wiki/Monad_(functional_programming)">monad</a>.</p>
</li>
</ul>

<p>At <a href="https://www.ecorax.net/as-above-so-below-1/#taking-a-step-back">the end of the last
entry</a>, we sketched out the
constraints on our minimal concept of address and region:</p>
<pre><code><span>pub trait </span><span>Address: Ord + Copy + Add&lt;usize, Output = Self&gt; {}
</span><span>pub trait </span><span>Region&lt;A: Address&gt; {
    </span><span>fn </span><span>contains</span><span>(</span><span>&amp;</span><span>self</span><span>, </span><span>address</span><span>: A) -&gt; </span><span>bool</span><span>;
}
</span></code></pre>
<p><em>But cuervo</em>, you ask, <em>that's not how it looked like last week. You added an</em>
<code>Add</code> <em>constraint.</em> Okay, hypothetical attentive reader, you got me. I may have
forgotten to copy that as I was curating the code examples. Yes, the
<code>core::ops::Add</code> bound will be necessary, as we'll see in a bit. This gives us
an excuse to sing the generics song, which works just as well for supertrait
definitons:</p>
<ul>
<li>An <code>Address</code> is <em>something</em> that can be sorted and copied. It can be added
together with an offset, yielding another address.</li>
<li>A <code>Region</code> is <em>something</em> that may contain an address.</li>
</ul>
<p>What can we build with this? We know that one of the goals of our flash driver
is to smartly negotiate the different write and erase granularities, so that for
any given buffer write, only the required regions are erased. In order to do
this, there's a requirement we can accurately summarize in this way:</p>
<p><strong>For a buffer of given length, and for a base address in the target memory map,
we need to relate each buffer segment to every region it overlaps with.</strong></p>
<p>Here rendered through the power of ASCII:</p>
<pre><code><span>0    5    10   15   20   25   30   35
-----|ooooooooooooooooooooooooooooo|------ : Buffer of length 30 at address 5
----------|====|====|====|====|----------- : Four regions of length 5 at address 10
</span></code></pre>
<p>Given the two inputs above, we need to produce the following four views into the
buffer:</p>
<pre><code><span>
0    5      10      15      20      25      30   35
-----|ooooo [ooooo] [ooooo] [ooooo] [ooooo] ooooo|-----
             view1   view2   view3   view4
</span></code></pre>
<p>Our goal in this section is to <em>define such operation generically</em>, and
<em>implement it generically</em>, in such a way that it will work with
last week's sectors, subsectors and pages from both drivers.</p>
<p>Now, if you're allergic to symbols, be warned: Here be dragons. Henceforth be
dragon turtles, all the way down. We are about to reach <em>ancient Egyptian
shopping in <a href="https://www.ecorax.net/as-above-so-below-2/akihabara.jpeg">Akihabara</a></em> levels of symbol overload. Believe me
that after some time none of them will feel superfluous or overwrought. As
with human language, precise definitions lead to better understanding.</p>
<p>Okay, let's take a deep breath.</p>
<pre><code><span>/// Iterator producing block-region pairs,
/// where each memory block maps to each region
</span><span>pub struct </span><span>OverlapIterator&lt;</span><span>'a</span><span>, A, R, I&gt;
where
    A: Address,
    R: Region&lt;A&gt;,
    I: Iterator&lt;Item = R&gt;,
{
    memory: </span><span>&amp;</span><span>'a</span><span> [</span><span>u8</span><span>],
    regions: I,
    base_address: A,
}

</span><span>pub trait </span><span>IterableByOverlaps&lt;'a, A, R, I&gt;
where
    A: Address,
    R: Region&lt;A&gt;,
    I: Iterator&lt;Item = R&gt;,
{
    </span><span>fn </span><span>overlaps</span><span>(</span><span>self</span><span>, </span><span>block</span><span>: </span><span>&amp;</span><span>'a</span><span> [</span><span>u8</span><span>], </span><span>base_address</span><span>: A) -&gt; OverlapIterator&lt;A, R, I&gt;;
}
</span></code></pre>
<p>Hmm. Not too bad thus far. We have the tools necessary to break down the <em>where</em>
clause, which is identical for both the struct and the trait. We are dealing
with:</p>
<ul>
<li><em>Some</em> address <code>A</code>.</li>
<li><em>Some</em> region <code>R</code> which contains such addresses.</li>
<li><em>Some</em> iterator <code>I</code> that yields such regions.</li>
</ul>
<p>The explicit lifetime, a requisite of all structs containing references, simply
denotes that the <code>memory</code> field is a reference to data stored elsewhere, and
guarantees said data will exist <strong>at least</strong> as long as our struct.</p>
<p>What we've defined above is an iterator struct, and a trait for types that can
be iterated in a certain way. If you come from C, iterators can be a bit of a
mind bender. They <em>feel</em> heavy, but ultimately they're very
simple. I like to think of iterator structs as bookmarks for physical books;
progress trackers with just enough state to find your position in a sequence.</p>
<p>Looking at our iterator struct above, we see we can track our progress through
the inner <code>regions</code> iterator, until we run out of regions. We also have a means
of producing this kind of iterator‚Äîthe <code>overlaps</code> function in the
<code>IterableByOverlaps</code> trait‚Äîso all that's left is to define the <em>rules</em> of
iteration. The implementation I'm going to show you can do with some manual
optimization, and indeed it doesn't look exactly like this in the final
<code>Loadstone</code> code. I went with the slightly more readable option to better
illustrate the points in this article.</p>
<pre><code><span>impl</span><span>&lt;</span><span>'a</span><span>, A, R, I&gt; Iterator </span><span>for </span><span>OverlapIterator&lt;</span><span>'a</span><span>, A, R, I&gt;
</span><span>where</span><span>
    A: Address,
    R: Region&lt;A&gt;,
    I: </span><span>Iterator</span><span>&lt;Item = R&gt;,
{
    </span><span>type </span><span>Item </span><span>= </span><span>(</span><span>&amp;</span><span>'a </span><span>[</span><span>u8</span><span>], R, A);

    </span><span>fn </span><span>next</span><span>(</span><span>&amp;</span><span>mut </span><span>self</span><span>) -&gt; </span><span>Option</span><span>&lt;</span><span>Self::</span><span>Item&gt; {
        </span><span>while let </span><span>Some</span><span>(region) </span><span>= </span><span>self.regions.</span><span>next</span><span>() {
            </span><span>let mut</span><span> block_range </span><span>= </span><span>(</span><span>0</span><span>..</span><span>self.memory.</span><span>len</span><span>())
                .</span><span>skip_while</span><span>(|</span><span>index</span><span>| </span><span>!</span><span>region.</span><span>contains</span><span>(self.base_address </span><span>+ *</span><span>index))
                .</span><span>take_while</span><span>(|</span><span>index</span><span>| region.</span><span>contains</span><span>(self.base_address </span><span>+ *</span><span>index));
            </span><span>if let </span><span>Some</span><span>(start) </span><span>=</span><span> block_range.</span><span>next</span><span>() {
                </span><span>let</span><span> end </span><span>=</span><span> block_range.</span><span>last</span><span>().</span><span>unwrap_or</span><span>(start) </span><span>+ </span><span>1</span><span>;
                </span><span>return </span><span>Some</span><span>((</span><span>&amp;</span><span>self.memory[start</span><span>..</span><span>end], region, self.base_address </span><span>+</span><span> start));
            }
        }
        </span><span>None
    </span><span>}
}

</span><span>impl</span><span>&lt;</span><span>'a</span><span>, A, R, I&gt; ‚Ä¶</span></code></pre></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://www.ecorax.net/as-above-so-below-2/">https://www.ecorax.net/as-above-so-below-2/</a></em></p>]]>
            </description>
            <link>https://www.ecorax.net/as-above-so-below-2/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24332187</guid>
            <pubDate>Mon, 31 Aug 2020 15:06:36 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Motivation ‚Äì Keli Language]]>
            </title>
            <description>
<![CDATA[
Score 283 | Comments 287 (<a href="https://news.ycombinator.com/item?id=24331635">thread link</a>) | @azhenley
<br/>
August 31, 2020 | https://keli-language.gitbook.io/doc/ | <a href="https://web.archive.org/web/*/https://keli-language.gitbook.io/doc/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><div><div><div data-editioncontainer="true"><div data-slate-editor="true" data-key="4" autocorrect="on" spellcheck="true" data-gramm="false"><p data-key="897a985a86cc4278b06ee2367236de5a"><span><span data-key="18568aa2ade34dcf81ff08476e0b0772"><span data-offset-key="18568aa2ade34dcf81ff08476e0b0772:0">A user from Quora asked: </span></span></span></p><blockquote data-key="69783191aed44c8c99cfcfbbf5fb418b"><p data-key="42fffa898e7d4cfab7bda3c5aa1876fd"><span><span data-key="f2cad49fcd004710a8b79e77417a0f72"><span data-offset-key="f2cad49fcd004710a8b79e77417a0f72:0"><span data-slate-zero-width="z">‚Äã</span></span></span><a href="https://www.quora.com/Why-isnt-functional-programming-that-popular-even-though-its-so-beneficial" target="_blank" rel="noopener noreferrer" data-key="24fb50b6b71e452288b87f2ca8e9e707"><span data-key="ab47b806c4a4469a8767843f865b9384"><span data-offset-key="ab47b806c4a4469a8767843f865b9384:0">Why isn't functional programming that popular even though it's so beneficial?</span></span></a><span data-key="27b008a81d68439fa2a11e5f87afb644"><span data-offset-key="27b008a81d68439fa2a11e5f87afb644:0"><span data-slate-zero-width="z">‚Äã</span></span></span></span></p></blockquote><p data-key="353e366d50d94fbbb9145756cf92834f"><span><span data-key="ea16ded4dd07432bbb4a736b3243b91c"><span data-offset-key="ea16ded4dd07432bbb4a736b3243b91c:0">One of the top answer says: </span></span></span></p><blockquote data-key="f442b5154acc415790599c554a6f585d"><p data-key="c84fbbd36b62498ab531ba7ad121cddd"><span><span data-key="6bb3bf85692941b3974cba42c816f26c"><span data-offset-key="6bb3bf85692941b3974cba42c816f26c:0">The user experiences of functional programming languages sucks.</span></span></span></p></blockquote><p data-key="df00ff40225c4481ab4b679fba62168b"><span><span data-key="f5da13623e4843768fcae1f7e98c2f4c"><span data-offset-key="f5da13623e4843768fcae1f7e98c2f4c:0">No doubt, this is a sad but true story for most functional programming  (FP) languages. I personally thought that FP languages like Haskell offers a very unified and pure programming concepts (</span><span data-offset-key="f5da13623e4843768fcae1f7e98c2f4c:1"><em data-slate-leaf="true">i.e. everything are functions, and functions and compose well, etc</em></span><span data-offset-key="f5da13623e4843768fcae1f7e98c2f4c:2">). However, Haskell syntax is a mess (</span></span><a href="https://www.haskell.org/onlinereport/syntax-iso.html" target="_blank" rel="noopener noreferrer" data-key="c2042c06c32c4516a8fd4b5e7e28a162"><span data-key="20d8508c88354fca87c0cbff422512b4"><span data-offset-key="20d8508c88354fca87c0cbff422512b4:0">take a look at the grammar</span></span></a><span data-key="6f6e8f688d734782a153bf5918c51ee0"><span data-offset-key="6f6e8f688d734782a153bf5918c51ee0:0">), there are a lot of edge cases (e.g. </span></span><a href="https://github.com/haskell/haskell-mode/wiki/Why-TAB-cycle-indentation-for-Haskell-is-a-hard-problem" target="_blank" rel="noopener noreferrer" data-key="95044b6c0c574f2d929c7a346f42ec67"><span data-key="5c60b4b35add407bb6273bae9a53e2da"><span data-offset-key="5c60b4b35add407bb6273bae9a53e2da:0">weird indentation rules</span></span></a><span data-key="9da68936fb284fce8190d8fd8b8c5e7f"><span data-offset-key="9da68936fb284fce8190d8fd8b8c5e7f:0">). Of course this problem is not only limited to Haskell, similar problems can also be found in other FP languages like Erlang, F#, OCaml etc.  Thus, I believe that these are also the primal reason that most people felt FP languages are hard. </span></span></span></p><blockquote data-key="444c20d31f07450d82fe4e4a393b5e4b"><p data-key="2e8ede7447e1425a9bf12e51fc60d5c7"><span><span data-key="d0b01956d02e49c6800c1df1af4d6db6"><span data-offset-key="d0b01956d02e49c6800c1df1af4d6db6:0">I wanted more people to adopt FP. </span></span></span></p></blockquote><p data-key="fd022cfd71d1440481cf9b6b342bbd9c"><span><span data-key="be00defcb46b42edb54efcfaf80543d1"><span data-offset-key="be00defcb46b42edb54efcfaf80543d1:0">That is what I wished for, therefore I'm motivated to create a language called Keli (named after my girlfriend), which hopes to an FP language with good user experience (UX). </span></span></span></p><p data-key="734c706e1d9f4669a3453b2582087686"><span><span data-key="d9cd55bdf12447068a38da641de552f8"><span data-offset-key="d9cd55bdf12447068a38da641de552f8:0">In the following section, I will describe the UX problems of FP languages and how they are solved in other programming languages.</span></span></span></p><h2 id="1-ambiguous-functions-argument-positions" data-key="04052a38274f400ea45ec6130d0313ef"><p><span><span data-key="af49270742cc4c589e4b648f1dcf78a1"><span data-offset-key="af49270742cc4c589e4b648f1dcf78a1:0">1. Ambiguous functions argument positions</span></span></span><a href="#1-ambiguous-functions-argument-positions" contenteditable="false"><span><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor"><g><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></g></svg></span></a></p></h2><p data-key="abed90c7e63e4c658ec38c7fa2540ef9"><span><span data-key="e89bcae79a974df4a8061319d18b1d42"><span data-offset-key="e89bcae79a974df4a8061319d18b1d42:0">This is a problem where the user cannot properly tell where to place function arguments properly without looking at documentation. This problem is actually prevalent for every programming languages that favors </span><span data-offset-key="e89bcae79a974df4a8061319d18b1d42:1"><em data-slate-leaf="true">prefix function invocations , </em></span><span data-offset-key="e89bcae79a974df4a8061319d18b1d42:2">for example C, Bash, Assembly, and most FP languages. </span></span></span></p><p data-key="7e8e1f5e25c4488aa0fcb3dff6608361"><span><span data-key="20e9af9b922545caba02b355f10d1a11"><span data-offset-key="20e9af9b922545caba02b355f10d1a11:0">For example, without referring to documentation or previous experiences, a user can never tell which of the following will yield intended result, even though the user have the domain knowledge (in this case, basic English).</span></span></span></p><div><pre data-key="17e021d0bcff41f09ff3ae0a7dfc68ed" spellcheck="false"><p><span data-key="d2e4ddfd2e324dba9b5b78f14850e85e"><span data-offset-key="d2e4ddfd2e324dba9b5b78f14850e85e:0"><span>splitBy</span></span><span data-offset-key="d2e4ddfd2e324dba9b5b78f14850e85e:1"><span> </span></span><span data-offset-key="d2e4ddfd2e324dba9b5b78f14850e85e:2"><span>","</span></span><span data-offset-key="d2e4ddfd2e324dba9b5b78f14850e85e:3"><span>  </span></span><span data-offset-key="d2e4ddfd2e324dba9b5b78f14850e85e:4"><span>"1,2,3,4,5"</span></span></span></p><p><span data-key="91d75d0d9c544b02beab1e287a564158"><span data-offset-key="91d75d0d9c544b02beab1e287a564158:0"><span data-slate-zero-width="n">‚Äã</span></span></span></p><p><span data-key="ac60595e4a384c70a69e5ee1361a9511"><span data-offset-key="ac60595e4a384c70a69e5ee1361a9511:0"><span>splitBy</span></span><span data-offset-key="ac60595e4a384c70a69e5ee1361a9511:1"><span> </span></span><span data-offset-key="ac60595e4a384c70a69e5ee1361a9511:2"><span>"1,2,3,4,5"</span></span><span data-offset-key="ac60595e4a384c70a69e5ee1361a9511:3"><span>  </span></span><span data-offset-key="ac60595e4a384c70a69e5ee1361a9511:4"><span>","</span></span></span></p></pre></div><p data-key="819c8ab5145646748f5db7f6bbf6e901"><span><span data-key="86b35daddacd4679a911238ad8c0fe6a"><span data-offset-key="86b35daddacd4679a911238ad8c0fe6a:0">This problem is slightly mitigated in object-oriented programming(OOP) languages due to their </span><span data-offset-key="86b35daddacd4679a911238ad8c0fe6a:1"><em data-slate-leaf="true">infix function invocation</em></span><span data-offset-key="86b35daddacd4679a911238ad8c0fe6a:2"> nature. For example, in Java or Scala, the code above can be rewritten in a more comprehensible manner:</span></span></span></p><div><pre data-key="8b5bbbca43254f9d9e6c898cfb2fd36e" spellcheck="false"><p><span data-key="911153d975fa45f9be7f2dde82e28d43"><span data-offset-key="911153d975fa45f9be7f2dde82e28d43:0"><span>","</span></span><span data-offset-key="911153d975fa45f9be7f2dde82e28d43:1"><span>.</span></span><span data-offset-key="911153d975fa45f9be7f2dde82e28d43:2"><span>splitBy</span></span><span data-offset-key="911153d975fa45f9be7f2dde82e28d43:3"><span>(</span></span><span data-offset-key="911153d975fa45f9be7f2dde82e28d43:4"><span>"1,2,3,4,5"</span></span><span data-offset-key="911153d975fa45f9be7f2dde82e28d43:5"><span>)</span></span></span></p><p><span data-key="9254f3da1727457aa4702cacb885f823"><span data-offset-key="9254f3da1727457aa4702cacb885f823:0"><span data-slate-zero-width="n">‚Äã</span></span></span></p><p><span data-key="175af9f4b0714d6f916d135830a59afe"><span data-offset-key="175af9f4b0714d6f916d135830a59afe:0"><span>"1,2,3,4,5"</span></span><span data-offset-key="175af9f4b0714d6f916d135830a59afe:1"><span>.</span></span><span data-offset-key="175af9f4b0714d6f916d135830a59afe:2"><span>splitBy</span></span><span data-offset-key="175af9f4b0714d6f916d135830a59afe:3"><span>(</span></span><span data-offset-key="175af9f4b0714d6f916d135830a59afe:4"><span>","</span></span><span data-offset-key="175af9f4b0714d6f916d135830a59afe:5"><span>)</span></span></span></p></pre></div><p data-key="2379c8bf6fc94665a1cec7bcfaebcf42"><span><span data-key="c1e029fd3029494caedc7fd1d31d09b9"><span data-offset-key="c1e029fd3029494caedc7fd1d31d09b9:0">However, OOP languages also suffers the same problem whenever the number of function/method arguments get more than two, for example:</span></span></span></p><div><pre data-key="550ac5fe769b4b039804506515ba8e4e" spellcheck="false"><p><span data-key="553635cdaf4c4677a94a8fd5158fbf5a"><span data-offset-key="553635cdaf4c4677a94a8fd5158fbf5a:0"><span>"Hello world"</span></span><span data-offset-key="553635cdaf4c4677a94a8fd5158fbf5a:1"><span>.</span></span><span data-offset-key="553635cdaf4c4677a94a8fd5158fbf5a:2"><span>replace</span></span><span data-offset-key="553635cdaf4c4677a94a8fd5158fbf5a:3"><span>(</span></span><span data-offset-key="553635cdaf4c4677a94a8fd5158fbf5a:4"><span>"Hello"</span></span><span data-offset-key="553635cdaf4c4677a94a8fd5158fbf5a:5"><span>,</span></span><span data-offset-key="553635cdaf4c4677a94a8fd5158fbf5a:6"><span> </span></span><span data-offset-key="553635cdaf4c4677a94a8fd5158fbf5a:7"><span>"Bye"</span></span><span data-offset-key="553635cdaf4c4677a94a8fd5158fbf5a:8"><span>)</span></span></span></p><p><span data-key="66a80816accd4c7da6114bdda6743742"><span data-offset-key="66a80816accd4c7da6114bdda6743742:0"><span>"Hello world"</span></span><span data-offset-key="66a80816accd4c7da6114bdda6743742:1"><span>.</span></span><span data-offset-key="66a80816accd4c7da6114bdda6743742:2"><span>replace</span></span><span data-offset-key="66a80816accd4c7da6114bdda6743742:3"><span>(</span></span><span data-offset-key="66a80816accd4c7da6114bdda6743742:4"><span>"Bye"</span></span><span data-offset-key="66a80816accd4c7da6114bdda6743742:5"><span>,</span></span><span data-offset-key="66a80816accd4c7da6114bdda6743742:6"><span> </span></span><span data-offset-key="66a80816accd4c7da6114bdda6743742:7"><span>"Hello"</span></span><span data-offset-key="66a80816accd4c7da6114bdda6743742:8"><span>)</span></span></span></p></pre></div><p data-key="da8e06dea9674ad79879e5faab153880"><span><span data-key="499ec0148d7f46de8e3bc3a3d12ab97f"><span data-offset-key="499ec0148d7f46de8e3bc3a3d12ab97f:0">Fortunately, this problem is actually solved by a languages called Smalltalk, which is designed by Alan Kay and intended to be used by children of all ages. Smalltalk solves this by using its message syntax, for example:</span></span></span></p><div><pre data-key="96cea94a4b604ea7a17043642f4e8d36" spellcheck="false"><p><span data-key="719babccff1c480eb9672c86204a7d3f"><span data-offset-key="719babccff1c480eb9672c86204a7d3f:0"><span>'Hello world'</span></span><span data-offset-key="719babccff1c480eb9672c86204a7d3f:1"><span> replace</span></span><span data-offset-key="719babccff1c480eb9672c86204a7d3f:2"><span>:</span></span><span data-offset-key="719babccff1c480eb9672c86204a7d3f:3"><span> </span></span><span data-offset-key="719babccff1c480eb9672c86204a7d3f:4"><span>'Hello'</span></span><span data-offset-key="719babccff1c480eb9672c86204a7d3f:5"><span> with</span></span><span data-offset-key="719babccff1c480eb9672c86204a7d3f:6"><span>:</span></span><span data-offset-key="719babccff1c480eb9672c86204a7d3f:7"><span> </span></span><span data-offset-key="719babccff1c480eb9672c86204a7d3f:8"><span>'Bye'</span></span></span></p></pre></div><p data-key="5f057424e95c4e658c2392ec1e777227"><span><span data-key="4217098b9cc047989413e787727277a0"><span data-offset-key="4217098b9cc047989413e787727277a0:0">And the good thing of such syntax is that it scales, no matter how many arguments your function is taking, for example:</span></span></span></p><div><pre data-key="0494404f37e642a8a204156efc1d68e6" spellcheck="false"><p><span data-key="036fa5bc8adc4f6a8e74df935207cc73"><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:0"><span>'Hello world'</span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:1"><span> replaceFromIndex</span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:2"><span>:</span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:3"><span> </span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:4"><span>0</span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:5"><span> toIndex</span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:6"><span>:</span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:7"><span> </span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:8"><span>4</span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:9"><span> with</span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:10"><span>:</span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:11"><span> </span></span><span data-offset-key="036fa5bc8adc4f6a8e74df935207cc73:12"><span>'Bye'</span></span></span></p></pre></div><p data-key="6158d699b8644329a044624ede002b4b"><span><span data-key="eb4373b5828f486290c9ebcd91e88a8a"><span data-offset-key="eb4373b5828f486290c9ebcd91e88a8a:0">Therefore, Keli shall adopts the message syntax from Smalltalk.</span></span></span></p><h2 id="2-not-intellisense-friendly" data-key="72733da2d0a749b7ba9e498913a7964a"><p><span><span data-key="a7eaddbb57b84cbbbe61d1f9bdf0bd20"><span data-offset-key="a7eaddbb57b84cbbbe61d1f9bdf0bd20:0">2. Not Intellisense friendly</span></span></span><a href="#2-not-intellisense-friendly" contenteditable="false"><span><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor"><g><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></g></svg></span></a></p></h2><p data-key="3faf2bfe243e460691e58f1aad5b86f3"><span><span data-key="5b7932b0caac483c8203df2cceef48ba"><span data-offset-key="5b7932b0caac483c8203df2cceef48ba:0">The other problem of FP languages is that they are not Intellisense friendly, in another word, they don't integrate well with integrated development environment (IDE). </span></span></span></p><p data-key="9a967c53a5ca4c059ca5cf5fc32dbaca"><span><span data-key="d94b1c8b93db47c98a5cad80f0812464"><span data-offset-key="d94b1c8b93db47c98a5cad80f0812464:0">This is also due to their prefix function invocation nature, which does not allow Intellisense to provide good code completions suggestion. The best they can do is to provide some low-level Intellisense such as:</span></span></span></p><ul data-key="c4475599ccfb4b9a87112ee7652c8158"><li><p data-key="5af8c436307d4dc1ae16e662d4403696"><span><span data-key="283d8096008d4d9d91ca7964f4f19897"><span data-offset-key="283d8096008d4d9d91ca7964f4f19897:0">Naively suggesting variable or function names </span></span></span></p></li><li><p data-key="ef5e25045a014ebc94cb97b20558e286"><span><span data-key="a19f48a4741e44ee8f6671060dfe1940"><span data-offset-key="a19f48a4741e44ee8f6671060dfe1940:0">Suggesting function when typing out a module name</span></span></span></p></li></ul><p data-key="b87b7145461f41068920e5c326709168"><span><span data-key="4217fa8e7fa94686a73764b6a264622a"><span data-offset-key="4217fa8e7fa94686a73764b6a264622a:0">This kind of Intellisense are dwarfed when compared to those of OOP languages, which provide higher-level Intellisense, which is:</span></span></span></p><ul data-key="c9e62d55b6544266bcba1fc1994e7d37"><li><p data-key="9c11af111cac46ea924d902f0e44d239"><span><span data-key="42c30f325ad849d98df1cc3ef0edf2bc"><span data-offset-key="42c30f325ad849d98df1cc3ef0edf2bc:0">Suggesting related method based on type of the object</span></span></span></p></li></ul><div data-slate-void="true" data-key="7b1d87fd083947bf98a79c8695001eca"><div><figure data-key="7b1d87fd083947bf98a79c8695001eca" contenteditable="false"><div><p><img tabindex="0" src="https://gblobscdn.gitbook.com/assets%2F-LVJCs7dNBHSuAiiNeWI%2F-LVMN3Tzu7mlzhwZYNO2%2F-LVMT-n_UoBA86gA2Ob-%2Fintellisense.gif?alt=media&amp;token=0e616f08-ba15-4e90-91e9-c943b7a98a13" loading="lazy"></p></div><p><figcaption><span>Higher-level IntelliSense in action</span></figcaption></p></figure></div></div><p data-key="db7a0a3883f34262b7d239c0a89ab887"><span><span data-key="42cb0c28b23948718f51d9fd22359908"><span data-offset-key="42cb0c28b23948718f51d9fd22359908:0"><span data-slate-zero-width="n">‚Äã</span></span></span></span></p><h2 id="conclusion" data-key="e616bbbc45384e34a75638427c0fa586"><p><span><span data-key="54dbac6debdf4bd082c08bfe2ed74e9a"><span data-offset-key="54dbac6debdf4bd082c08bfe2ed74e9a:0">Conclusion</span></span></span><a href="#conclusion" contenteditable="false"><span><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor"><g><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></g></svg></span></a></p></h2><p data-key="183833ba5ba1433fbab9474fb2f24967"><span><span data-key="74d72f18e9044536a0779ee161cf7cba"><span data-offset-key="74d72f18e9044536a0779ee161cf7cba:0">In a nutshell, Keli strives to fill the hole in the table below, which is to be a functional programming language that is IDE-friendly.</span></span></span></p><p data-key="a21a981c68984b78b5dd6f98bc865d6c"><span><span data-key="d733e8c659474fb0831e15020748a233"><span data-offset-key="d733e8c659474fb0831e15020748a233:0"><span data-slate-zero-width="n">‚Äã</span></span></span></span></p><p data-key="1d8c4a30542f49ed9c01d98ba9c4b9e2"><span><span data-key="f590b96cf30f4861b7c37bee5b2c3a3f"><span data-offset-key="f590b96cf30f4861b7c37bee5b2c3a3f:0"><span data-slate-zero-width="n">‚Äã</span></span></span></span></p></div></div></div></div></div></div>]]>
            </description>
            <link>https://keli-language.gitbook.io/doc/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24331635</guid>
            <pubDate>Mon, 31 Aug 2020 14:14:34 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[How NASA and ISRO discovered water on the Moon]]>
            </title>
            <description>
<![CDATA[
Score 171 | Comments 35 (<a href="https://news.ycombinator.com/item?id=24331408">thread link</a>) | @uncertainquark
<br/>
August 31, 2020 | https://jatan.space/how-nasa-and-chandrayaan-discovered-water-on-the-moon/ | <a href="https://web.archive.org/web/*/https://jatan.space/how-nasa-and-chandrayaan-discovered-water-on-the-moon/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
		
		
	<main id="content" role="main">

	<div>
		<div>
						<article id="post-1176">
				<div>
<p>After decades of work, scientists used Chandrayaan 1 and NASA‚Äôs LCROSS to finally discover water on the Moon in 2009. In the 10 years since, the next step has been to understand the exact nature of and the amount of water the Moon hosts. This is where NASA‚Äôs LRO and <a href="https://jatan.space/chandrayaan-2-is-creating-the-highest-resolution-map-of-the-moon/">ISRO‚Äôs Chandrayaan 2 orbiter</a> come in.</p>



<p>For most of the 20th century, scientists argued the Moon‚Äôs surface was bone-dry. The 382 kg of rock and soil samples the Apollo missions brought from the Moon to Earth attested to this. When they did find traces of water in the samples, scientists dismissed them as contamination. The Moon has a very thin atmosphere, so any water on its surface is exposed directly to the vacuum of space, and evaporates. And due to the Moon‚Äôs low gravity, water vapor quickly escapes into space.</p>



<p>However, there are certain regions on the Moon that haven‚Äôt received sunlight for more than a billion years, and where scientists think the water can be. On the lunar poles, the Sun is very close to the local horizon throughout the day so even a small feature, like a rock, can cast very long shadows. Likewise, large craters with terraced edges can easily block sunlight from entering the crater, so sunlight is blocked a full 360¬∞. Such places are eternally dark and are called permanently shadowed regions (PSRs).</p>



<div><figure><img loading="lazy" src="https://i1.wp.com/jatan.space/wp-content/uploads/2020/01/11556-psrs-nasa-lro.gif?resize=600%2C338&amp;ssl=1" alt="" width="600" height="338" data-recalc-dims="1"><figcaption>Permanently shadowed regions on the lunar south pole, highlighted in blue. <a href="https://svs.gsfc.nasa.gov/4043">Credit: NASA LRO</a></figcaption></figure></div>



<p>But where could the water have come from?</p>



<p>Scientists know that comets and many types of asteroids contain water. For most of the Solar System‚Äôs existence, these objects have been bombarding planets and their moons at a vigorous pace. This is why the Moon is covered in craters, and scientists think the asteroids and comets responsible for them could have deposited water on the Moon. They have proposed that some fraction of this water could have found its way into PSRs, where ‚Äì like sitting inside a refrigerator ‚Äì they could‚Äôve been preserved for billions of years.</p>



<p>In 1994, NASA launched the Clementine lunar orbiter. Its <a href="https://nssdc.gsfc.nasa.gov/nmc/experiment/display.action?id=1994-004A-09">Bistatic Radar Experiment</a> beamed radio signals straight into the PSRs. The signals bounced off the PSRs and were received by ground stations on Earth. Scientists found the nature of the reflected signals to be consistent with water ice, although they couldn‚Äôt be 100% sure.</p>



<p>NASA sent another orbiter in 1998, called the Lunar Prospector, to find out if there was water ice in the PSRs. Its neutron spectrometer found that the number of neutrons in the soil corresponded with the <a href="https://www.nasa.gov/vision/universe/solarsystem/14apr_moonwater.html">presence of hydrogen atoms</a>. Could these hydrogen atoms be part of water molecules?</p>



<p>Armed with Clementine and Lunar Prospector data, scientists were almost certain that there was water on the Moon, but they needed to be absolutely sure.</p>



<h3>Water on the Moon indeed</h3>



<p>In 2008, India forayed into planetary exploration with the Chandrayaan 1 lunar orbiter, for which ISRO <a href="https://www.lpi.usra.edu/meetings/lpsc2006/pdf/1704.pdf">solicited instruments</a> from scientists around the world. NASA pitched and built two of these, named MiniSAR and M3.</p>



<p>The Miniature Synthetic Aperture Radar (Mini-SAR) <a href="https://www.nasa.gov/mission_pages/Mini-RF/multimedia/feature_ice_like_deposits.html">also found</a> that the PSRs reflected signals in patterns consistent with water ice, from more than 40 polar craters. But just like with Clementine, the data wasn‚Äôt 100% certain.</p>



<div><figure><img loading="lazy" width="1200" height="1204" src="https://i0.wp.com/jatan.space/wp-content/uploads/2020/01/c2356-mini-sar-finds-water-ice.jpg?resize=1200%2C1204&amp;ssl=1" alt="" data-recalc-dims="1"><figcaption>Likely water ice on the Moon‚Äôs north pole (marked by green circles) found by Chandrayaan 1 instrument Mini-SAR. <a href="https://www.nasa.gov/mission_pages/Mini-RF/multimedia/feature_ice_like_deposits.html">Credit: NASA</a></figcaption></figure></div>



<p>The Moon Mineralogical Mapper (M3), an infrared spectrometer, would go on to clinch the prize. M3 detected not just water in the PSRs but <a href="https://www.jpl.nasa.gov/news/news.php?feature=7218">could also differentiate between ice, liquid water and water vapor</a> based on how the surface absorbed infrared light. M3 confirmed that the Moon hosted water once and for all.</p>



<figure><img loading="lazy" width="1200" height="675" src="https://i0.wp.com/jatan.space/wp-content/uploads/2020/01/3cc0f-water-ice-moon-map-m3.jpg?resize=1200%2C675&amp;ssl=1" alt="" data-recalc-dims="1"><figcaption>Distribution of water ice on the lunar poles mapped by Chandrayaan 1 instrument M3. <a href="https://www.jpl.nasa.gov/news/news.php?feature=7218">Credit: NASA</a></figcaption></figure>



<p>The Chandrayaan 1 orbiter also carried an impact probe ‚Äì a craft that intentionally crashed near a PSR on the Moon‚Äôs south pole. As it descended, its mass spectrometer instrument <a href="http://www.planetary.org/blogs/emily-lakdawalla/2010/2430.html">detected water molecules</a> in the thin but persistent lunar atmosphere.</p>



<p>However, ISRO didn‚Äôt publish the results until NASA announced that Mini-SAR and M3 had discovered lunar water. ISRO then <a href="https://www.thehindu.com/sci-tech/science/MIP-detected-water-on-Moon-way-back-in-June-ISRO-Chairman/article16883362.ece">claimed</a> that their instrument had detected water on the Moon first.</p>



<h3>Not that dry</h3>



<p>All this time, scientists had been developing ideas about how the Moon could have water on other parts as well, not just at or near the poles. The Sun emits a constant stream of protons, some of which strike the Moon. Most of these protons are reflected into space but some are absorbed. Scientists thought the oxygen in the soil could interact with the absorbed protons to produce water, and that they should be able to detect the water molecules from orbit.</p>



<p>NASA‚Äôs Cassini spacecraft flew by the Moon in 1999, en route to Saturn. Its infrared spectrometer <a href="https://www.nasa.gov/topics/moonmars/features/clark1.html">found water-bearing minerals</a> at most latitudes on the Moon, with a higher concentration at the poles.</p>



<div><figure><img loading="lazy" src="https://i0.wp.com/jatan.space/wp-content/uploads/2020/01/b0d3d-cassini-moon-water.jpg?resize=392%2C295&amp;ssl=1" alt="" width="392" height="295" data-recalc-dims="1"><figcaption>Detection of water-bearing and hydroxyl-bearing minerals on the Moon by Cassini‚Äôs infrared spectrometer. <a href="https://www.nasa.gov/topics/moonmars/features/clark1.html">Credit: NASA</a></figcaption></figure></div>



<p>The results were in stark contrast to the bone-dry Apollo samples. One reason could be that most Apollo landing sites were near the equator, so high daytime temperatures at these sites might have evaporated the water. However, they didn‚Äôt publish the findings for a decade, until Chandrayaan 1 happened.</p>



<p>The European Space Agency‚Äôs instrument onboard Chandrayaan 1, SARA, analyzed protons reflected by the lunar surface. Like Cassini, SARA <a href="https://www.sciencedaily.com/releases/2009/10/091015091605.htm">found water/hydroxyl groups</a> in the lunar soil. The discovery proved timely for ESA‚Äôs BepiColombo mission to study Mercury, which carries two similar instruments for detecting water. Chandrayaan 1‚Äôs M3 detected water and hydroxyl molecules almost everywhere on the Moon too.</p>



<p>In addition to water ice in the PSRs and water molecules in the lunar soil, M3 found a third water source, which came as a surprise. M3 had imaged the Bullialdus crater, one of the many large craters that boast central mountains. These mountains contain material excavated from deep within the Moon‚Äôs crust.</p>







<p>M3 <a href="https://web.archive.org/web/20130220235318/http://lunarscience.nasa.gov/wp-content/uploads/2012/08/38_Klima_NLSI_2012.pdf">found water-bearing minerals</a> in the central mountain but not in the area surrounding it. These traces of water provided informed scientists‚Äô ideas about the Moon‚Äôs interior.</p>



<p>Scientists now knew that the lunar soil does hold trace amounts of water even in the non-polar regions. Note that it‚Äôs still less water than the driest deserts on Earth. However, the PSRs on the lunar poles host appreciably more water.</p>



<h3>LRO and Chandrayaan 2</h3>



<p>In 2009, NASA launched the Lunar Reconnaissance Orbiter (LRO). It also <a href="https://svs.gsfc.nasa.gov/4043">detected water ice on the lunar poles</a> using both the onboard radar and the <a href="https://svs.gsfc.nasa.gov/4057">neutron spectrometer</a>. LRO has been orbiting the Moon for over 10 years now, longer than any other orbiter. The LRO team has published an extensive <a href="http://lroc.sese.asu.edu/psr">atlas of PSRs</a>, laying the groundwork for future exploration and settlement on the Moon.</p>



<p>Like Chandrayaan 1‚Äôs impact probe, LRO carried an impactor too, called LCROSS. In 2009, its upper stage deliberately impacted one of the PSRs on the lunar south pole. The other half of LCROSS followed and studied the plume of moondust the crash kicked up. It was found to <a href="https://ui.adsabs.harvard.edu/abs/2010Sci...330..463C/abstract">contain 155 kg of water</a>.</p>



<div>
<div>
<figure><img loading="lazy" width="1000" height="683" src="https://i1.wp.com/jatan.space/wp-content/uploads/2020/01/c25e5-lcross-impactor.jpeg?resize=1000%2C683&amp;ssl=1" alt="" data-recalc-dims="1"><figcaption>Artist‚Äôs rendering of LCROSS observing its upper stage en route to impact the Moon in 2009. <a href="https://www.nasa.gov/mission_pages/LCROSS/main/prelim_water_results.html">Credit: NASA</a></figcaption></figure>
</div>



<div>
<figure><img loading="lazy" width="529" height="378" src="https://i0.wp.com/jatan.space/wp-content/uploads/2020/01/03d58-lcross_results.jpg?resize=529%2C378&amp;ssl=1" alt="" data-recalc-dims="1"><figcaption>Right: LCROSS camera showing the ejected plume post-impact, which included water. <a href="https://www.nasa.gov/mission_pages/LCROSS/main/prelim_water_results.html">Credit: NASA</a></figcaption></figure>




</div>
</div>



<p>From this result, scientists estimated all the PSRs together contained <a href="https://www.nasa.gov/mission_pages/Mini-RF/multimedia/feature_ice_like_deposits.html">more than 600 billion kg</a> of water ice, equivalent to at least 240,000 Olympic-sized swimming pools.</p>



<p>The <a href="https://jatan.space/chandrayaan-2-is-creating-the-highest-resolution-map-of-the-moon/">Chandrayaan 2 orbiter</a>‚Äôs instruments intend to extend our knowledge of water on the Moon. They include an enhanced infrared spectrometer and an upgraded radar, called the DFSAR.</p>



<p>The infrared spectrometer will build a global, high-resolution map of water concentrations in the lunar soil and determine which water-bearing minerals are present. Chandrayaan 2‚Äôs long-term observations aim to discern how the water content in the lunar soil changes in response to the lunar environment.</p>



<p>The DFSAR will map the water ice in the PSRs. With twice as much penetration depth and higher resolution, DFSAR will quantify the amount of water trapped in these cold regions, something no one has adequately done yet.</p>



<h3>What‚Äôs next?</h3>



<p>The lunar science and exploration communities agree that we can harness water ice on the Moon for future lunar habitats. Using solar power generated by the habitats, we can also split the water ice into hydrogen and oxygen for use as rocket fuel. To that end, Blue Origin, the spaceflight company owned by Jeff Bezos, has <a href="https://www.nasa.gov/press-release/nasa-announces-new-tipping-point-partnerships-for-moon-and-mars-technologies">snagged a $10 million NASA contract</a> for their lunar lander.</p>



<p>But before we plan habitats at the Moon‚Äôs poles, we need to know more about the nature of water ice in these regions. The LRO and the Chandrayaan 2 orbiters are expected to fill these gaps.</p>



<p>ISRO has stated that Chandrayaan 2 will orbit the Moon for seven years and that should be ample time to fully map and quantify water on the lunar surface. However, let‚Äôs not forget that Chandrayaan 1 had a design life of two years but failed after only 10 months.</p>



<p>Surface missions that explore PSRs, like NASA‚Äôs upcoming <a href="https://www.nasa.gov/feature/new-viper-lunar-rover-to-map-water-ice-on-the-moon">VIPER</a> rover, are the next logical step towards sustainable habitats on the Moon. As we develop technologies that tap into water ice, we can <a href="https://jatan.space/the-moon-as-a-rocket-platform/">settle on not just the Moon but the whole solar system</a>. We should be glad our nearest neighbor has plenty of it; we can‚Äôt keep dragging everything out of Earth‚Äôs gravitational pull for eternity.</p>



<hr>



<p><em>Originally published at <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://thewire.in/the-sciences/isro-chandrayaan-2-water-moon-dfsar-class-lcross" target="_blank">The Wire</a>.</em></p>

</div>

			</article>
					</div>
	</div>
</main><!--/.neve-main-->




</div></div>]]>
            </description>
            <link>https://jatan.space/how-nasa-and-chandrayaan-discovered-water-on-the-moon/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24331408</guid>
            <pubDate>Mon, 31 Aug 2020 13:49:39 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Common Mistakes to Avoid in HTML]]>
            </title>
            <description>
<![CDATA[
Score 64 | Comments 77 (<a href="https://news.ycombinator.com/item?id=24330110">thread link</a>) | @iamshadmirza
<br/>
August 31, 2020 | https://iamshadmirza.com/5-common-mistakes-to-avoid-in-html | <a href="https://web.archive.org/web/*/https://iamshadmirza.com/5-common-mistakes-to-avoid-in-html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><section itemprop="articleBody mainEntityOfPage"><meta itemprop="thumbnailUrl image" content="https://cdn.hashnode.com/res/hashnode/image/upload/v1598809849449/ouCF-w_TZ.png?w=1600&amp;h=840&amp;fit=crop&amp;crop=entropy&amp;auto=format&amp;q=60"><div><div itemprop="text"><p>Hello, amazing people. This article will cover few of the common mistakes that we often do while writing HTML. Let's get straight to it.</p>
<h2 id="1-use-of-anchor-elements-lessagreater">1. Use of Anchor Elements: <code>&lt;a&gt;</code></h2>
<p>Anchor elements are used to create a hyperlink to a file or a location of a webpage and should always be used for navigating to a real url. Anchor elements are often misused as fake buttons by setting their <code>href</code> to <code>#</code> to prevent the page from refreshing, then listening for their <code>click</code> events.</p>
<p>When we point <code>href</code> value to <code>#</code>, it breaks the default functionality of a link causing unexpected behavior when opening links in a new tab or window, bookmarking, copying/dragging links, or when JavaScript is loading, errors, or is disabled. They also convey
incorrect semantics to assistive technologies, like screen readers.</p>
<p>If something is supposed to be clickable, it should always be a <code>&lt;button&gt;</code></p>
<p>Using here to add a link is not recommended as it doesn't tell anything about where it's going to navigate. Provide some proper text of where the links point to.</p>
<p>Example:</p>
<p>Read more about anchor tag <a target="_blank" href="https://www.w3schools.com/tags/tag_a.asp">here</a> ‚ùå</p>
<p>Read more about anchor tag on <a target="_blank" href="https://www.w3schools.com/tags/tag_a.asp">w3school guide</a> ‚úÖ</p>
<h2 id="2-use-of-break-element-lessbrgreater">2. Use of Break element: <code>&lt;br&gt;</code></h2>
<p><code>&lt;br&gt;</code> element is used to break the text in an address or while writing poems specifically. Creating separate paragraphs of text using <code>&lt;br&gt;</code> is not only bad practice, but it is also problematic for people who navigate with the aid of screen reading technology. Screen readers can miss the content between two break elements while still announcing the presence of the tag. This can be frustrating for a person using a screen reader.</p>
<p>Use CSS <code>margin</code> property with <code>&lt;p&gt;</code> element to add space instead.</p>
<h2 id="3-use-of-heading-elements-lessh1greater">3. Use of Heading elements: <code>&lt;h1&gt;</code></h2>
<ul>
<li>HTML is a semantic language and anything regarding visuals should be done with CSS only. Avoid using heading tags to resize text. Instead, use the CSS <code>font-size</code> property. Headings use size to indicate their relative importance, but CSS is preferred for general-purpose resizing.</li>
<li>Avoid skipping heading levels: always start from <code>&lt;h1&gt;</code>, next use <code>&lt;h2&gt;</code>, and so on.</li>
<li>You should only use one <code>&lt;h1&gt;</code> per page.</li>
</ul>
<p>This is wrong:</p>
<pre><code><span>&lt;<span>h1</span>&gt;</span>Heading level 1<span>&lt;/<span>h1</span>&gt;</span>
<span>&lt;<span>h3</span>&gt;</span>Heading level 3<span>&lt;/<span>h3</span>&gt;</span>
<span>&lt;<span>h4</span>&gt;</span>Heading level 4<span>&lt;/<span>h4</span>&gt;</span>
</code></pre>
<p>This is appropriate:</p>
<pre><code><span>&lt;<span>h1</span>&gt;</span>Heading level 1<span>&lt;/<span>h1</span>&gt;</span>
<span>&lt;<span>h2</span>&gt;</span>Heading level 2<span>&lt;/<span>h2</span>&gt;</span>
<span>&lt;<span>h3</span>&gt;</span>Heading level 3<span>&lt;/<span>h3</span>&gt;</span>
</code></pre>
<h2 id="4-use-of-paragraph-lesspgreater">4. Use of Paragraph: <code>&lt;p&gt;</code></h2>
<p>Do not use empty <code>&lt;p&gt;</code> elements to add space between
paragraphs and it is problematic for people who navigate with screen-reading
technology. Screen readers may announce the paragraph's presence, but
not any content contained within it ‚Äî because there is none.</p>
<p>If extra space is desired, use CSS properties like <code>margin</code> to create the effect.</p>
<h2 id="5-use-of-aside-lessasidegreater">5. Use of Aside: <code>&lt;aside&gt;</code></h2>
<p>Aside was introduced with HTML5 and represents content that is not directly connected with the main content. Asides are stand-alone, non-essential as part of an article but when used correctly it can be an extra level of information for your content. Example sidebars or call-out boxes.</p>
<p>Do not use aside to tag the parenthesized test as that is part of the main content. Don‚Äôt try to force content into an <code>&lt;aside&gt;</code> if it shouldn't be there.</p>
<p>Example:</p>
<pre><code><span>&lt;<span>p</span>&gt;</span>My family and I visited The Epcot center this summer. The weather was nice, and Epcot was amazing! I had a great summer together with my family!<span>&lt;/<span>p</span>&gt;</span>

<span>&lt;<span>aside</span>&gt;</span>
    <span>&lt;<span>h4</span>&gt;</span>Epcot Center<span>&lt;/<span>h4</span>&gt;</span>
    <span>&lt;<span>p</span>&gt;</span>Epcot is a theme park at Walt Disney World Resort featuring exciting attractions, international pavilions, award-winning fireworks and seasonal special events.<span>&lt;/<span>p</span>&gt;</span>
<span>&lt;/<span>aside</span>&gt;</span>
</code></pre>
<p>Writing semantically correct HTML is the responsibility of every developer. I hope you learned something from this article. That's it for now. Take care and stay safe.<br><a target="_blank" href="https://www.twitter.com/iamshadmirza">Shad</a></p>
<h2 id="resources">Resources</h2>
<ul>
<li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/HTML">MDN Documentation</a></li>
<li><a target="_blank" href="https://www.w3schools.com/html/">W3School Documentation</a></li>
</ul>
<p><em>Illustration on the cover is courtesy of <a target="_blank" href="https://undraw.co/">unDraw</a></em></p>
</div></div></section></div></div>]]>
            </description>
            <link>https://iamshadmirza.com/5-common-mistakes-to-avoid-in-html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24330110</guid>
            <pubDate>Mon, 31 Aug 2020 10:51:28 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Thriverism]]>
            </title>
            <description>
<![CDATA[
Score 20 | Comments 28 (<a href="https://news.ycombinator.com/item?id=24330086">thread link</a>) | @exolymph
<br/>
August 31, 2020 | https://www.sonyasupposedly.com/thriverism/ | <a href="https://web.archive.org/web/*/https://www.sonyasupposedly.com/thriverism/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="site-main">
    <div>

        <article>

            


                <figure>
                    <img srcset="https://www.sonyasupposedly.com/content/images/size/w300/2020/07/DT1539.jpg 300w,
                                https://www.sonyasupposedly.com/content/images/size/w600/2020/07/DT1539.jpg 600w,
                                https://www.sonyasupposedly.com/content/images/size/w1200/2020/07/DT1539.jpg 1000w,
                                https://www.sonyasupposedly.com/content/images/size/w2000/2020/07/DT1539.jpg 2000w" sizes="(max-width: 800px) 400px,
                            (max-width: 1170px) 1170px,
                                2000px" src="https://www.sonyasupposedly.com/content/images/size/w2000/2020/07/DT1539.jpg" alt="Thriverism">
                </figure>
                <section>
                    <div>
                        <p>What is best in life, Sonya? I'll tell you. The ancient Greeks had it right with <a href="https://en.wikipedia.org/wiki/Arete">Arete</a>:</p><blockquote>In the Homeric poems, Arete is frequently associated with bravery, but more often with effectiveness. The person of Arete is of the highest effectiveness; they use all their faculties ‚Äî strength, bravery, and wit ‚Äî to achieve real results. In the Homeric world, then, Arete involves all of the abilities and potentialities available to humans.</blockquote><p>In other words, excellence in action. Excellence is excellent, after all! (Hat tip to my friend <a href="https://morlockpublishing.com/">Travis</a> for Arete specifically.) While I refuse to learn philosophy, I've been told that this is a type of <a href="https://plato.stanford.edu/entries/ethics-virtue/">"virtue ethics."</a> I consider my preference for Arete to be pragmatism: reality is the litmus test, which is fitting since reality <em>is</em> the litmus test.</p><figure><blockquote data-width="550"><p lang="en" dir="ltr">"Vae victis" means: nobody loses who ought to have won.</p>‚Äî uncanny valley girl üî™ (@leaacta) <a href="https://twitter.com/leaacta/status/1143959912537628674?ref_src=twsrc%5Etfw">June 26, 2019</a></blockquote>

<figcaption>Similarly, "to the victor go the spoils" is plain fact.</figcaption></figure><p>What else is best in life?</p><blockquote>I am an extremely passionate person and have a very intense and profound experience of life. I was quite physically strong and capable. I do not think the life of the mind is complete ‚Äî&nbsp;adventure was essential to my happiness. Nutrition and physical activity seem to me necessary underpinnings of full life. Efficiency is extremely important to me and I took a great deal of pride in the facility with which I was able to manage my life on an everyday basis. My goal was to make myself the most complete, beautiful, inspiring, wonderful human being possible. I paid constant attention to the task and it often felt like a very solitary one. I wanted my experience of life to be broad, expansive, profound, and full of triumph. [...] Lofty words and tales of great deeds fire my spirit. I fantasize about great power and influence. I want to be splendid and magnificent. I want to run and jump and fight and laugh and live the most free-spirited, joyous life imaginable. To go all over the world, to the most obscure jungles and landscapes, to work in great cities, to go this way and that. I want to make my person and my life into absolute wonders, spectacular and breathtaking works of art.<p>‚Äî <a href="http://www.2arms1head.com/">Clayton Atreus</a>, <a href="http://claytonschwartz.blogspot.com/2008/11/final-words-upon-suicide-reflection-on.html">2008</a> (<a href="https://advrider.com/f/threads/seattle-to-argentina-on-a-klr650.136505/">see also</a>)</p></blockquote><p>That. That right there: the chance and challenge to express your will, to enact it on the world. The freedom and drive to forge a self that <em>matters</em> ‚Äî to others, but also intrinsically. A self that self-justifies.</p><blockquote>I love because I love without expectation of results or even meaning. I spend time with the people I enjoy having in my world and when they move on, they move on. I act the way I would be proud to act, not to set an example or because I should, but because it pleases me. I like strong people; I will be strong. I like skillful people; I will develop skill. I like people who take care of others; I will protect and defend and if I die doing the job, cool ‚Äî because I am going to die anyway and nothing will ever have mattered.<p>‚Äî <a href="https://amzn.to/3jadcjx"><em>Meditations on Violence</em> by Rory Miller</a></p></blockquote><p>He got the last part wrong. Everything matters, because we feel everything, and thus it matters to us. All of it does ‚Äî everything that we can know intrigues and excites us, even the endeavor of <em>knowing</em> in the first place. Our ability to imagine, to conceptualize, blows open the possibility space such that we can even <a href="https://www.sonyasupposedly.com/impossibility-space/">explore the <em>im</em>possible</a>.</p><p>So, what is the <em>meaning</em> of life, the purpose of all this interminable hustle and bustle? It's a cop-out to say there isn't one; that elides the very <a href="https://meaningness.com/objective-subjective">nature of meaning</a>. "In fact, cynicism is too naive," <a href="https://medium.com/@jsimpkin/art-against-the-cynics-reflections-on-shaun-berkes-winter-and-summer-a-memory-of-nature-and-572b73dcb138">as James Simpkin put it</a>. "It desires a completely faultless ethical world, it can't cope with the compromises of the actual world while nevertheless working towards the good." If nihilism is true, why do you care so fucking much, huh?</p><p>I believe that the ultimate answer is God, and equally God is the ultimate answer. (Tautology is a tragically underutilized source of wisdom!) But for now I'll lay it out in secular terms.</p><p>"The purpose of a system is what it does," <a href="https://web.archive.org/web/20160426001835/http://www.nickgreen.pwp.blueyonder.co.uk/beerWhatisCybernetics.pdf">Stafford Beer said</a>. "This is a basic dictum. It stands for a bald fact, which makes a better starting point in seeking understanding than the familiar attributions of good intentions, prejudices about expectations, moral judgements, or sheer ignorance of circumstances."</p><p>According to Beer's principle, the telos of all creation ‚Äî the totality of happenings and phenomena, including "life" ‚Äî is quite straightforward. It's simply <a href="https://www.sonyasupposedly.com/survivalist-epistemology/">staying in the game</a> until knockout. After knockout? Well, you're out of the game, dissolved back into the rest of existence. None of us have experienced that yet.</p><p>The purpose of a system is what it does ¬Ø\_(„ÉÑ)_/¬Ø</p><figure><blockquote data-width="550"><p lang="en" dir="ltr">i keep re-encountering with a shock the way that most people do not know, at all, that the problem the entire universe is devoted to, that it crashes us into walls, throws us off cliffs, tortures and murders us to try to solve, is that of escaping local maxima</p>‚Äî Chaos (@chaosprime) <a href="https://twitter.com/chaosprime/status/1248861223501942784?ref_src=twsrc%5Etfw">April 11, 2020</a></blockquote>

</figure><!--kg-card-begin: html--><blockquote darkmode="" data-title="Die Gro√üe M√ºdigkeit" data-author="Johannes" cite="https://wordofthefrontier.wordpress.com/2020/06/10/die-grose-mudigkeit/">
The builders' self-conception is one of finitude and limitation. The builder is constantly experiencing <a rel="noreferrer noopener" href="https://www.bloomberg.com/news/features/2018-08-29/miami-s-other-water-problem" target="_blank">the resistance of the real</a> and presence of the gaze. Every wall and tower is meant to stand but is also understood in its being as a tenuous thing. Unlike the swarm, it constitutes a thing in space and time. The appreciation of ruins is the appreciation of the nature of these constructions. The builders struggle to make a society which can provide safety. But they understand that this is possible only insofar as it is allowed by God. Eventually all things are destined to pass out of this abode.

</blockquote><!--kg-card-end: html--><p>Our labor is the same as it ever was. Your job is to pioneer a resilient node in the network of civilization ‚Äî to dodge the punches, roll with the ones that you can't, and live to fight another day. That's what our ancestors did for us and it's what we'll do for those who come next: hold the line, explore when there's surplus, stay steady, and go down swinging when we have to.</p><p>The straightforward answer to "what does it all matter!" is that empirically, we do matter to each other. If your model indicates that this is insufficient, adjust your model. Because, look, it's what we've got and here we are, mattering as hard as we can. Who you gonna believe, your eyes or your own lying mind?</p><p>The point of life is that it continues, in perfect indifference to any sentiment that it ought to have some other justification. </p><figure><blockquote data-width="550"><p lang="en" dir="ltr">We, ridiculous apes with big brains and the ability to cooperate, can listen to the universe shake from billions of light years away, because we learned math, and engineering. Wild.<a href="https://t.co/W3OpQaZcSC">https://t.co/W3OpQaZcSC</a> <a href="https://t.co/Ftr190nlt2">pic.twitter.com/Ftr190nlt2</a></p>‚Äî Aunt Aoife¬π (@durumcrustulum) <a href="https://twitter.com/durumcrustulum/status/1261817842929975298?ref_src=twsrc%5Etfw">May 17, 2020</a></blockquote>

</figure><figure><blockquote data-width="550"><p lang="en" dir="ltr">36. The chief end of man is to glorify God and enjoy him forever.</p>‚Äî nicole (@nwilliams030) <a href="https://twitter.com/nwilliams030/status/1207334839587942400?ref_src=twsrc%5Etfw">December 18, 2019</a></blockquote>

</figure><hr><p>Header image: <a href="https://www.metmuseum.org/art/collection/search/10793"><em>Scene from "Thanatopsis"</em> by Asher Brown Durand</a>, 1850.</p>
                    </div>
                </section>



        </article>

    </div>
</div></div>]]>
            </description>
            <link>https://www.sonyasupposedly.com/thriverism/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24330086</guid>
            <pubDate>Mon, 31 Aug 2020 10:45:54 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Alarm as FDA willing to issue Covid-19 vaccine before stringent safety testing]]>
            </title>
            <description>
<![CDATA[
Score 40 | Comments 103 (<a href="https://news.ycombinator.com/item?id=24329867">thread link</a>) | @rabies94
<br/>
August 31, 2020 | https://mindhive.org/challenges/1273/overview/brief | <a href="https://web.archive.org/web/*/https://mindhive.org/challenges/1273/overview/brief">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to extract article]]>
            </description>
            <link>https://mindhive.org/challenges/1273/overview/brief</link>
            <guid isPermaLink="false">hacker-news-small-sites-24329867</guid>
            <pubDate>Mon, 31 Aug 2020 09:57:47 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Battleshorts, exaptations, and the limits of STAMP]]>
            </title>
            <description>
<![CDATA[
Score 26 | Comments 12 (<a href="https://news.ycombinator.com/item?id=24329591">thread link</a>) | @kiyanwang
<br/>
August 31, 2020 | https://surfingcomplexity.blog/2020/08/16/battleshorts-exapting-and-the-limits-of-stamp/ | <a href="https://web.archive.org/web/*/https://surfingcomplexity.blog/2020/08/16/battleshorts-exapting-and-the-limits-of-stamp/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
		
<p>A couple of threads got me thinking about the limits of <a href="https://surfingcomplexity.blog/2020/08/07/thoughts-on-stamp/">STAMP</a>.</p>



<p>The first thread was sparked by a <a href="https://news.ycombinator.com/item?id=24114720">link to a Hacker News comment</a>, sent to me be a colleague of mine, <a href="https://twitter.com/DannyThomas">Danny Thomas</a>. This introduced me to a concept I hadn‚Äôt of heard of before, a <em>battleshort</em>. There‚Äôs even an official definition in a NATO document:</p>



<blockquote><p>The capability to bypass certain safety features in a system to ensure completion of the mission without interruption due to the safety feature</p><cite><a href="http://www.nato.int/structur/ac/310/pdf/aop-38-3.pdf">AOP-38</a>, Allied Ordnance Publication 38, Edition 3,&nbsp;<em>Glossary of terms and definitions concerning the safety and suitability for service of munitions, explosives and related products</em>, April 2002.</cite></blockquote>



<p>The second thread was sparked by a Twitter exchange between a UK Southern Railway train driver and the official UK Southern Railway twitter account:</p>



<figure><div>
<div><blockquote data-width="550" data-dnt="true"><p lang="en" dir="ltr">People find a way to use the systems they have access to in order to get their work done, in ways never anticipated by the system designers. <a href="https://t.co/D7ll99aeB2">https://t.co/D7ll99aeB2</a></p>‚Äî Lorin Hochstein E_TOO_MANY_FAILURE_MODES (@lhochstein) <a href="https://twitter.com/lhochstein/status/1293577818605936642?ref_src=twsrc%5Etfw">August 12, 2020</a></blockquote></div>
</div></figure>



<p>This is a great example of <em>exapting</em>, a concept introduced by the paleontologists Stephen Jay Gould and Elisabeth Vrba. Exaptation is a solution to the following problem in evolutionary biology: what good is a partially functional wing? Either an animal can fly or it can‚Äôt, and a fully functional wing can‚Äôt evolve in a single generation, so how do the initial evolutionary stages of a wing confer advantage on the organism?</p>



<p>The answer is that: while a partially functional wing might be useless for flight, it might still be useful as a fin. And so, if wings evolved from fins, then the appendage may always confer an advantage at each evolutionary stage. The fin is <em>exapted</em> into a wing; it is repurposed to serve a new function. In the Twitter example above, the railway driver repurposed a social media service for communicating with his own organization. </p>



<p>Which brings us back to STAMP. One of the central assumptions of STAMP is that it is possible to construct an accurate enough control model of the system at the design stage to identify all of the hazards and unsafe control actions. You can see this assumption in action in the <a href="http://psas.scripts.mit.edu/home/get_file4.php?name=CAST_handbook.pdf">CAST handbook  </a>(CAST is STAMP‚Äôs accident analysis process) in the example questions from page 40 of the handbook  (emphasis mine), which uses counterfactual reasoning to try identify flaws in the original hazard analysis.</p>



<p><em>Did the design account for the possibility of this increased pressure? <strong>If not, why not?</strong> Was this risk assessed at the design stage?</em></p>



<p><em><strong>This seems like a predictable design flaw</strong>. Was the unsafe interaction between the two requirements (preventing liquid from entering the flare and the need to discharge gases to the flare) identified in the design or hazard analysis efforts? If so, why was it not handled in the design or in operational procedures? <strong>If it was not identified, why not?</strong></em></p>



<p><em><strong>Why wasn‚Äôt the increasing pressure detected and handled?</strong></em> <em>If there were alerts, why did they not result in effective action to handle the increasing pressure? If there were automatic overpressurization control devices (e.g., relief valves), why were they not effective? <strong>If there were not automatic devices, then why not?</strong> Was it not feasible to provide them?</em></p>



<p><em><strong>Was this type of pressure increase anticipated?</strong> If it was anticipated, then why was it not handled in the design or operational procedures? <strong>If it was not anticipated, why not?</strong></em></p>



<p><em><strong>Was there any way to contain the contents within some controlled area (barrier), at least the catalyst pellets?</strong></em></p>



<p><em><strong>Why was the area around the reactor not isolated during a potentially hazardous operation? Why was there no protection against catalyst pellets flying around?</strong></em></p>



<p>This line of reasoning assumes that all hazards are, in principle, identifiable at the design stage. I think that phenomena like <em>battleshorts </em>and <em>exaptations</em> make this goal unattainable.</p>



<p>Now, in principle, nothing prevents an engineer using STPA (STAMP‚Äôs hazard analysis technique) from identifying scenarios that involve <em>battleshorts</em> and <em>exaptations</em>. After all, STPA is an <em>exploratory</em> technique. But I suspect that many of these kinds of adaptations are literally <em><strong>unimaginable</strong></em> to the designers.</p>
	</div><div>
			<!-- .entry-auhtor -->
		<p><strong>Published</strong>
			<time datetime="2020-08-16T13:55:12-07:00">August 16, 2020</time><time datetime="2020-08-16T13:57:02-07:00">August 16, 2020</time>		</p><!-- .site-posted-on -->
	</div></div>]]>
            </description>
            <link>https://surfingcomplexity.blog/2020/08/16/battleshorts-exapting-and-the-limits-of-stamp/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24329591</guid>
            <pubDate>Mon, 31 Aug 2020 08:51:46 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Visualizing TSNE Maps with Three.js]]>
            </title>
            <description>
<![CDATA[
Score 54 | Comments 15 (<a href="https://news.ycombinator.com/item?id=24328626">thread link</a>) | @polm23
<br/>
August 30, 2020 | https://douglasduhaime.com/posts/visualizing-tsne-maps-with-three-js.html | <a href="https://web.archive.org/web/*/https://douglasduhaime.com/posts/visualizing-tsne-maps-with-three-js.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><p>For the last year or so, Yale‚Äôs DHLab has undertaken a series of experiments organized around analysis of visual culture. Some of those experiments have involved <a href="https://douglasduhaime.com/posts/identifying-similar-images-with-tensorflow.html">identifying similar images</a> and visualizing patterns uncovered in this process. In this post, I wanted to discuss how we used the amazing Three.js library to build a WebGL-powered <a href="https://s3-us-west-2.amazonaws.com/lab-apps/pix-plot/index.html">visualization</a> that can display tens of thousands of images in an interactive 3D environment [click to enter]:</p>

<p><a href="https://s3-us-west-2.amazonaws.com/lab-apps/pix-plot/index.html">
  <img src="https://douglasduhaime.com/assets/posts/tsne-webgl/images/tsne-webgl-preview.jpg" alt="A preview of the WebGL-powered TSNE maps we will build below">
</a></p>

<p>If you‚Äôre interested in creating something similar, feel free to check out the <a href="https://github.com/YaleDHLab/pix-plot">full code</a>.</p>

<h2 id="getting-started-with-threejs">Getting Started with Three.js</h2>

<p>Three.js is a JavaScript library that generates lower-level code for WebGL, the standard API for 3D rendering in a web browser. Using Three.js, one can build complex 3D environments that would take much more code to build in raw WebGL. For a quick sample of the projects others have built with the library, check out the <a href="https://threejs.org/">Three.js homepage</a>.</p>

<p>To get started with Three.js, one needs to provide a bit of boilerplate code with the three essential elements of a Three.js page:</p>

<p><strong>scene</strong>: The scene contains all objects to be rendered:</p>

<figure><pre><code data-lang="javascript"><span>// Create the scene and a camera to view it</span>
<span>var</span> <span>scene</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>Scene</span><span>();</span></code></pre></figure>

<p><strong>camera</strong>: The camera determines the position from which viewers see the scene:</p>

<figure><pre><code data-lang="javascript"><span>// Specify the portion of the scene visiable at any time (in degrees)</span>
<span>var</span> <span>fieldOfView</span> <span>=</span> <span>75</span><span>;</span>

<span>// Specify the camera's aspect ratio</span>
<span>var</span> <span>aspectRatio</span> <span>=</span> <span>window</span><span>.</span><span>innerWidth</span> <span>/</span> <span>window</span><span>.</span><span>innerHeight</span><span>;</span>

<span>// Specify the near and far clipping planes. Only objects</span>
<span>// between those planes will be rendered in the scene</span>
<span>// (these values help control the number of items rendered</span>
<span>// at any given time)</span>
<span>var</span> <span>nearPlane</span> <span>=</span> <span>0.1</span><span>;</span>
<span>var</span> <span>farPlane</span> <span>=</span> <span>1000</span><span>;</span>

<span>// Use the values specified above to create a camera</span>
<span>var</span> <span>camera</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>PerspectiveCamera</span><span>(</span>
  <span>fieldOfView</span><span>,</span> <span>aspectRatio</span><span>,</span> <span>nearPlane</span><span>,</span> <span>farPlane</span>
<span>);</span>

<span>// Finally, set the camera's position in the z-dimension</span>
<span>camera</span><span>.</span><span>position</span><span>.</span><span>z</span> <span>=</span> <span>5</span><span>;</span></code></pre></figure>

<p><strong>renderer</strong>: The renderer renders the scene to a canvas element on an HTML page:</p>

<figure><pre><code data-lang="javascript"><span>// Create the canvas with a renderer and tell the</span>
<span>// renderer to clean up jagged aliased lines</span>
<span>var</span> <span>renderer</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>WebGLRenderer</span><span>({</span><span>antialias</span><span>:</span> <span>true</span><span>});</span>

<span>// Specify the size of the canvas</span>
<span>renderer</span><span>.</span><span>setSize</span><span>(</span> <span>window</span><span>.</span><span>innerWidth</span><span>,</span> <span>window</span><span>.</span><span>innerHeight</span> <span>);</span>

<span>// Add the canvas to the DOM</span>
<span>document</span><span>.</span><span>body</span><span>.</span><span>appendChild</span><span>(</span> <span>renderer</span><span>.</span><span>domElement</span> <span>);</span></code></pre></figure>

<p>The code above creates the scene, adds a camera, and renders the canvas to the DOM. Now all we need to do is add some objects to the scene.</p>

<p>Each item rendered in a Three.js scene has a <strong>geometry</strong> and a <strong>material</strong>. Geometries use vertices (points) and faces (polygons described by vertices) to define the shape of an object, and materials use textures and colors to define the appearance of that shape. A geometry and a material can be combined into a <strong>mesh</strong>, which is a fully composed object ready to be added to a scene.</p>

<p>The example below uses the high-level <a href="https://threejs.org/docs/#api/geometries/BoxGeometry">BoxGeometry</a>, which comes with pre-built vertices and faces:</p>

<figure><pre><code data-lang="javascript"><span>// Create a cube with width, height, and depth set to 1</span>
<span>var</span> <span>geometry</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>BoxGeometry</span><span>(</span> <span>1</span><span>,</span> <span>1</span><span>,</span> <span>1</span> <span>);</span>

<span>// Use a simple material with a specified hex color</span>
<span>var</span> <span>material</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>MeshBasicMaterial</span><span>({</span> <span>color</span><span>:</span> <span>0xffff00</span> <span>});</span>

<span>// Combine the geometry and material into a mesh</span>
<span>var</span> <span>cube</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>Mesh</span><span>(</span> <span>geometry</span><span>,</span> <span>material</span> <span>);</span>

<span>// Add the mesh to the scene</span>
<span>scene</span><span>.</span><span>add</span><span>(</span> <span>cube</span> <span>);</span></code></pre></figure>

<p>Finally, to render the scene on the page, one must call the <code>render()</code> method, passing in the scene and the camera as arguments:</p>

<figure><pre><code data-lang="javascript"><span>renderer</span><span>.</span><span>render</span><span>(</span> <span>scene</span><span>,</span> <span>camera</span> <span>);</span></code></pre></figure>

<p>Combining the snippets above gives the following result:</p>

<p data-height="265" data-theme-id="0" data-slug-hash="WXdYpx" data-default-tab="result" data-user="duhaime" data-embed-version="2" data-pen-title="The Simplest Three.js Scene">See the Pen <a href="https://codepen.io/duhaime/pen/WXdYpx/">The Simplest Three.js Scene</a> by Douglas Duhaime (<a href="https://codepen.io/duhaime">@duhaime</a>) on <a href="https://codepen.io/">CodePen</a>.</p>

<p>This is great, but the scene is static. To add some <strong>animation</strong> to the scene, one can periodically update the cube‚Äôs rotation property, then rerender the scene. To do so, one can replace the <code>renderer.render()</code> line above with a render loop that calls itself recursively. Here is a standard render loop in Three.js:</p>

<figure><pre><code data-lang="javascript"><span>function</span> <span>animate</span><span>()</span> <span>{</span>
  <span>requestAnimationFrame</span><span>(</span> <span>animate</span> <span>);</span>
  <span>renderer</span><span>.</span><span>render</span><span>(</span> <span>scene</span><span>,</span> <span>camera</span> <span>);</span>

  <span>// Rotate the object a bit each animation frame</span>
  <span>cube</span><span>.</span><span>rotation</span><span>.</span><span>y</span> <span>+=</span> <span>0.01</span><span>;</span>
  <span>cube</span><span>.</span><span>rotation</span><span>.</span><span>z</span> <span>+=</span> <span>0.01</span><span>;</span>
<span>}</span>
<span>animate</span><span>();</span></code></pre></figure>

<p>Adding this block at the bottom of the script makes the cube slowly rotate:</p>

<p data-height="265" data-theme-id="0" data-slug-hash="vWpvNL" data-default-tab="result" data-user="duhaime" data-embed-version="2" data-pen-title="Animating the Cube">See the Pen <a href="https://codepen.io/duhaime/pen/vWpvNL/">Animating the Cube</a> by Douglas Duhaime (<a href="https://codepen.io/duhaime">@duhaime</a>) on <a href="https://codepen.io/">CodePen</a>.</p>

<p>Adding <strong>lights</strong> to the scene can make it easier to differentiate the faces of the cube. To add lights to the scene above, we‚Äôll first want to change the cube‚Äôs material, because as the documentation says the <a href="https://threejs.org/docs/#api/materials/MeshBasicMaterial">MeshBasicMaterial</a> is not affected by lights. Let‚Äôs replace the material defined above with a <a href="https://threejs.org/docs/#api/materials/MeshPhongMaterial">MeshPhongMaterial</a>:</p>

<figure><pre><code data-lang="javascript"><span>var</span> <span>material</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>MeshPhongMaterial</span><span>({</span><span>color</span><span>:</span> <span>0xffff00</span><span>})</span></code></pre></figure>

<p>Next let‚Äôs point a light at the cube so that different faces of the cube catch different amounts of light:</p>

<figure><pre><code data-lang="javascript"><span>// Add a point light with #fff color, .7 intensity, and 0 distance</span>
<span>var</span> <span>light</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>PointLight</span><span>(</span><span>0xffffff</span><span>,</span> <span>.</span><span>7</span><span>,</span> <span>0</span><span>);</span>

<span>// Specify the light's position in the x, y, and z dimensions</span>
<span>light</span><span>.</span><span>position</span><span>.</span><span>set</span><span>(</span><span>1</span><span>,</span> <span>1</span><span>,</span> <span>100</span><span>);</span>

<span>// Add the light to the scene</span>
<span>scene</span><span>.</span><span>add</span><span>(</span><span>light</span><span>)</span></code></pre></figure>

<p>Voila!</p>

<p data-height="265" data-theme-id="0" data-slug-hash="mqparr" data-default-tab="result" data-user="duhaime" data-embed-version="2" data-pen-title="Lighting the Cube">See the Pen <a href="https://codepen.io/duhaime/pen/mqparr/">Lighting the Cube</a> by Douglas Duhaime (<a href="https://codepen.io/duhaime">@duhaime</a>) on <a href="https://codepen.io/">CodePen</a>.</p>

<h2 id="adding-images-to-a-scene">Adding Images to a Scene</h2>

<p>The snippets above give a quick overview of the core elements of a Three.js scene. The following section will build upon those ideas to create a TSNE map of images.</p>

<p>To build an image viewer, we‚Äôll need to load some image files into some Three.js materials. We can do so by using the <a href="https://threejs.org/docs/#api/loaders/TextureLoader">TextureLoader</a>:</p>

<figure><pre><code data-lang="javascript"><span>// Create a texture loader so we can load the image file</span>
<span>var</span> <span>loader</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>TextureLoader</span><span>();</span>

<span>// Specify the path to an image</span>
<span>var</span> <span>url</span> <span>=</span> <span>'https://s3.amazonaws.com/duhaime/blog/tsne-webgl/assets/cat.jpg'</span><span>;</span>

<span>// Load an image file into a MeshLambert material</span>
<span>var</span> <span>material</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>MeshLambertMaterial</span><span>({</span>
  <span>map</span><span>:</span> <span>loader</span><span>.</span><span>load</span><span>(</span><span>url</span><span>)</span>
<span>});</span></code></pre></figure>

<p>Now that the material is ready, the remaining steps are to generate a geometry from the image, combine the material and geoemtry into a mesh, and add the mesh to the scene, just like the cube example above. Because images are two-dimensional planes, we can use a simple <a href="https://threejs.org/docs/#api/geometries/PlaneGeometry">PlaneGeometry</a> for this object‚Äôs geometry:</p>

<figure><pre><code data-lang="javascript"><span>// create a plane geometry for the image with a width of 10</span>
<span>// and a height that preserves the image's aspect ratio</span>
<span>var</span> <span>geometry</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>PlaneGeometry</span><span>(</span><span>10</span><span>,</span> <span>10</span><span>*</span><span>.</span><span>75</span><span>);</span>

<span>// combine the image geometry and material into a mesh</span>
<span>var</span> <span>mesh</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>Mesh</span><span>(</span><span>geometry</span><span>,</span> <span>material</span><span>);</span>

<span>// set the position of the image mesh in the x,y,z dimensions</span>
<span>mesh</span><span>.</span><span>position</span><span>.</span><span>set</span><span>(</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>)</span>

<span>// add the image to the scene</span>
<span>scene</span><span>.</span><span>add</span><span>(</span><span>mesh</span><span>);</span></code></pre></figure>

<p>The image will now appear in the scene:</p>

<p data-height="265" data-theme-id="0" data-slug-hash="jaYdLg" data-default-tab="result" data-user="duhaime" data-embed-version="2" data-pen-title="Adding an Image to a Three.js Scene">See the Pen <a href="https://codepen.io/duhaime/pen/jaYdLg/">Adding an Image to a Three.js Scene</a> by Douglas Duhaime (<a href="https://codepen.io/duhaime">@duhaime</a>) on <a href="https://codepen.io/">CodePen</a>.</p>

<p>It‚Äôs worth noting that one can swap out the PlanarGeometry for other geometries and Three.js will automatically wrap the material over the new geometry. The example below, for instance, swaps the PlanarGeometry for a more interesting Icosahedron geometry, and rotates the icosahedron inside the render loop:</p>

<figure><pre><code data-lang="javascript"><span>// use an icosahedron geometry instead of the planar geometry</span>
<span>var</span> <span>geometry</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>IcosahedronGeometry</span><span>();</span>

<span>// spin the icosahedron each animation frame</span>
<span>function</span> <span>animate</span><span>()</span> <span>{</span>
<span>requestAnimationFrame</span><span>(</span> <span>animate</span> <span>);</span>
  <span>renderer</span><span>.</span><span>render</span><span>(</span> <span>scene</span><span>,</span> <span>camera</span> <span>);</span>
  <span>mesh</span><span>.</span><span>rotation</span><span>.</span><span>x</span> <span>+=</span> <span>0.01</span><span>;</span>
  <span>mesh</span><span>.</span><span>rotation</span><span>.</span><span>y</span> <span>+=</span> <span>0.01</span><span>;</span>
  <span>mesh</span><span>.</span><span>rotation</span><span>.</span><span>z</span> <span>+=</span> <span>0.01</span><span>;</span>
<span>}</span>
<span>animate</span><span>();</span></code></pre></figure>

<p>This produces a strange looking cat indeed:</p>

<p data-height="265" data-theme-id="0" data-slug-hash="NwXeoB" data-default-tab="result" data-user="duhaime" data-embed-version="2" data-pen-title="Icosahedron Cat">See the Pen <a href="https://codepen.io/duhaime/pen/NwXeoB/">Icosahedron Cat</a> by Douglas Duhaime (<a href="https://codepen.io/duhaime">@duhaime</a>) on <a href="https://codepen.io/">CodePen</a>.</p>

<h2 id="building-custom-geometries">Building Custom Geometries</h2>

<p>The examples above use a few different geometries built into Three.js. Those geometries are based on the fundamental <a href="https://threejs.org/docs/#api/core/Geometry">THREE.Geometry</a> class, which is a primitive geometry one can use to create custom geometries. THREE.Geometry is lower-level than the prebuilt geometries used above, but it gives performance gains that make it worth the effort.</p>

<p>Let‚Äôs create a custom geometry by calling the THREE.Geometry constructor, which takes no arguments:</p>

<figure><pre><code data-lang="javascript"><span>var</span> <span>geometry</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>Geometry</span><span>();</span></code></pre></figure>

<p>This geometry object doesn‚Äôt do much yet, because it doesn‚Äôt have any vertices with which to ariculate a shape. Let‚Äôs add four vertices to the geometry, one for each corner of the image. Each vertex takes three arguments, which define the vertex‚Äôs x, y, and z positions respectively:</p>

<figure><pre><code data-lang="javascript"><span>// identify the image width and height</span>
<span>var</span> <span>imageSize</span> <span>=</span> <span>{</span><span>width</span><span>:</span> <span>10</span><span>,</span> <span>height</span><span>:</span> <span>7.5</span><span>};</span>

<span>// identify the x, y, z coords where the image should be placed</span>
<span>// inside the scene</span>
<span>var</span> <span>coords</span> <span>=</span> <span>{</span><span>x</span><span>:</span> <span>-</span><span>5</span><span>,</span> <span>y</span><span>:</span> <span>-</span><span>3.75</span><span>,</span> <span>z</span><span>:</span> <span>0</span><span>};</span>

<span>// add one vertex for each image corner in this order:</span>
<span>// lower left, lower right, upper right, upper left</span>
<span>geometry</span><span>.</span><span>vertices</span><span>.</span><span>push</span><span>(</span>
  <span>new</span> <span>THREE</span><span>.</span><span>Vector3</span><span>(</span>
    <span>coords</span><span>.</span><span>x</span><span>,</span>
    <span>coords</span><span>.</span><span>y</span><span>,</span>
    <span>coords</span><span>.</span><span>z</span>
  <span>),</span>
  <span>new</span> <span>THREE</span><span>.</span><span>Vector3</span><span>(</span>
    <span>coords</span><span>.</span><span>x</span><span>+</span><span>imageSize</span><span>.</span><span>width</span><span>,</span>
    <span>coords</span><span>.</span><span>y</span><span>,</span>
    <span>coords</span><span>.</span><span>z</span>
  <span>),</span>
  <span>new</span> <span>THREE</span><span>.</span><span>Vector3</span><span>(</span>
    <span>coords</span><span>.</span><span>x</span><span>+</span><span>imageSize</span><span>.</span><span>width</span><span>,</span>
    <span>coords</span><span>.</span><span>y</span><span>+</span><span>imageSize</span><span>.</span><span>height</span><span>,</span>
    <span>coords</span><span>.</span><span>z</span>
  <span>),</span>
  <span>new</span> <span>THREE</span><span>.</span><span>Vector3</span><span>(</span>
    <span>coords</span><span>.</span><span>x</span><span>,</span>
    <span>coords</span><span>.</span><span>y</span><span>+</span><span>imageSize</span><span>.</span><span>height</span><span>,</span>
    <span>coords</span><span>.</span><span>z</span>
  <span>)</span>
<span>);</span></code></pre></figure>

<p>Now that the vertices are in place, we need to add some faces to the geometry. The code below will model an image as two triangle faces, as triangles are performant primitives in the WebGL world. The first triangle will combine the lower-left, lower-right, and upper-right vertices of the image, and the second will triangulate the lower-left, upper-right, and upper-left vertices of the image:</p>

<figure><pre><code data-lang="javascript"><span>// add the first face (the lower-right triangle)</span>
<span>var</span> <span>faceOne</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>Face3</span><span>(</span>
  <span>geometry</span><span>.</span><span>vertices</span><span>.</span><span>length</span><span>-</span><span>4</span><span>,</span>
  <span>geometry</span><span>.</span><span>vertices</span><span>.</span><span>length</span><span>-</span><span>3</span><span>,</span>
  <span>geometry</span><span>.</span><span>vertices</span><span>.</span><span>length</span><span>-</span><span>2</span>
<span>)</span>

<span>// add the second face (the upper-left triangle)</span>
<span>var</span> <span>faceTwo</span> <span>=</span> <span>new</span> <span>THREE</span><span>.</span><span>Face3</span><span>(</span>
  <span>geometry</span><span>.</span><span>vertices</span><span>.</span><span>length</span><span>-</span><span>4</span><span>,</span>
  <span>geometry</span><span>.</span><span>vertices</span><span>.</span><span>length</span><span>-</span><span>2</span><span>,</span>
  <span>geometry</span><span>.</span><span>vertices</span><span>.</span><span>length</span><span>-</span><span>1</span>
<span>)</span>

<span>// add those faces to the geometry</span>
<span>geometry</span><span>.</span><span>faces</span><span>.</span><span>push</span><span>(</span><span>faceOne</span><span>,</span> <span>faceTwo</span><span>);</span></code></pre></figure>

<p>Awesome, we now have a geometry with four vertices that describe the corners of the image, and two faces that describe the lower-right and upper-left-hand triangles of the image. The next step is to describe which portions of the cat image should appear in each of the faces of the geometry. To do so, one ‚Ä¶</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://douglasduhaime.com/posts/visualizing-tsne-maps-with-three-js.html">https://douglasduhaime.com/posts/visualizing-tsne-maps-with-three-js.html</a></em></p>]]>
            </description>
            <link>https://douglasduhaime.com/posts/visualizing-tsne-maps-with-three-js.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24328626</guid>
            <pubDate>Mon, 31 Aug 2020 04:58:42 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Sum Types in Julia and Rust]]>
            </title>
            <description>
<![CDATA[
Score 122 | Comments 64 (<a href="https://news.ycombinator.com/item?id=24328071">thread link</a>) | @xiaodai
<br/>
August 30, 2020 | https://andreaskroepelin.de/blog/sum_types/ | <a href="https://web.archive.org/web/*/https://andreaskroepelin.de/blog/sum_types/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
            <p>As I have mentioned in other posts on this blog (and surely many would agree here), I strongly believe that a great start for designing a program is figuring out good representations for the real world problem one tries to solve, <em>i.e.</em> defining appropriate types.
One helpful technique for that is what one could call <a href="https://www.reddit.com/r/Julia/comments/ijln21/blog_sum_types_in_julia_and_rust/g3f1gtn/"><em>optionality</em></a> .<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup>
Interestingly, it is expressed completely differently in different programming languages which I would like to briefly demonstrate in this article using Rust and Julia as examples.</p>
<blockquote>
<p><strong>Remark:</strong>
Julia and Rust are my favourite programming languages and they are particularly suited to demonstrate my point.
That should not stop you from reading if you use neither of these languages, though!
First, both have a rather intuitive syntax and the code shown here is really basic, so you should be able to follow along.
Second, you can probably substitute your inheritance-using language for Julia (<em>e.g.</em> Java) or your tagged-union-using language for Rust (<em>e.g.</em> Haskell).
Even if not, you might learn something anyway!</p>
</blockquote>
<h2 id="scenario">Scenario</h2>
<p>Suppose, you are creating an intergalactic game where players can inhabit three different star systems: Our sun (the <em>solarians</em>), the polar star (the <em>polarians</em>) and Alpha Centauri (the <em>centaurians</em>).
An obvious first step would be to define types for each of these three classes:</p>
<p>In Julia:</p>
<div><pre><code data-lang="julia"><span>struct</span> Solarian <span>end</span>
<span>struct</span> Polarian <span>end</span>
<span>struct</span> Centaurian <span>end</span>
</code></pre></div><p>and in Rust (I will stick to this order if not stated otherwise):</p>
<div><pre><code data-lang="rust"><span>struct</span> <span>Solarian</span>;
<span>struct</span> <span>Polarian</span>;
<span>struct</span> <span>Centaurian</span>;
</code></pre></div><p>(You would add some fields to those structs, of course, but that‚Äôs not the point here.)</p>
<p>Now, let‚Äôs say you need to store the player value in another object like a game state:</p>
<div><pre><code data-lang="julia"><span>struct</span> GameState
    daytime<span>::</span><span>UInt</span>
    player<span>::???</span>
<span>end</span>
</code></pre></div><div><pre><code data-lang="rust"><span>struct</span> <span>GameState</span> {
    daytime: <span>u64</span>,
    player: <span>???</span>
}
</code></pre></div><p>What type would you use for <code>player</code> in each case?
And what about</p>
<div><pre><code data-lang="julia"><span>function</span> homestar(player<span>::???</span>)<span>::</span>String
    <span>...</span>
<span>end</span>
</code></pre></div><div><pre><code data-lang="rust"><span>fn</span> <span>homestar</span>(player: <span>???</span>) -&gt; <span>String</span> {
    ...
}
</code></pre></div><p>These are the questions we‚Äôre here for.</p>
<h2 id="strategy-1-inheritance--subtyping">Strategy 1: Inheritance / subtyping</h2>
<h3 id="julia">Julia</h3>
<p>This is very straightforward in Julia.
Define</p>
<p>and make the structs from above subtypes of that:</p>
<div><pre><code data-lang="julia"><span>struct</span> Solarian <span>&lt;:</span> Player <span>end</span>
<span>struct</span> Polarian <span>&lt;:</span> Player <span>end</span>
<span>struct</span> Centaurian <span>&lt;:</span> Player <span>end</span>
</code></pre></div><p>Dynamic dispatch then allows you to write:</p>
<div><pre><code data-lang="julia">homestar(player<span>::</span>Solarian) <span>=</span> <span>"sun"</span>
homestar(player<span>::</span>Polarian) <span>=</span> <span>"polar star"</span>
homestar(player<span>::</span>Centaurian) <span>=</span> <span>"Alpha Centauri"</span>
homestar(player<span>::</span>Player) <span>=</span> <span>"unknown"</span> <span># or `error("Unknown player class")`</span>
</code></pre></div><h3 id="rust">Rust</h3>
<p>Rust does not have subtyping but you can define relations between types via <em>traits</em> (similar to interfaces in other languages).
So, we can try</p>
<div><pre><code data-lang="rust"><span>trait</span> Player {
    <span>fn</span> <span>homestar</span>(<span>&amp;</span>self) -&gt; <span>String</span>;
}
</code></pre></div><p>and then</p>
<div><pre><code data-lang="rust"><span>impl</span> Player <span>for</span> Solarian {
    <span>fn</span> <span>homestar</span>(<span>&amp;</span>self) -&gt; <span>String</span> {
        <span>String</span>::from(<span>"sun"</span>)
    }
}
</code></pre></div><p>But what about the <code>GameState</code> struct?
We can make use of <em>trait objects</em>, about which we only know that they implement a certain trait.
We especially don‚Äôt know the object‚Äôs size so we need to reference to it.
If you‚Äôre familiar with Rust, you know that this either means using a ‚Äúnormal‚Äù reference (<code>&amp;</code> or <code>&amp;mut</code>) and dealing with life time annotations (not my favourite, to be honest) or using a <code>Box</code>ed value.
If you‚Äôre not familiar with that, it doesn‚Äôt really matter here anyway.
<code>GameState</code> could look like this:</p>
<div><pre><code data-lang="rust"><span>struct</span> <span>GameState</span> {
    daytime: <span>u64</span>,
    player: <span>Box</span><span>&lt;</span>dyn Player<span>&gt;</span>
}
</code></pre></div><p>This works, but does restrict us in what we can do with the <code>Player</code> trait, as it needs to be <a href="https://doc.rust-lang.org/reference/items/traits.html#object-safety"><em>object safe</em></a>.
For example, greeting another player of an arbitrary class</p>
<div><pre><code data-lang="rust"><span>trait</span> Player {
    <span>fn</span> <span>homestar</span>(<span>&amp;</span>self) -&gt; <span>String</span>;
    <span>fn</span> <span>greet</span><span>&lt;</span>T: <span>Player</span><span>&gt;</span>(<span>&amp;</span>self, other: <span>&amp;</span><span>T</span>);
}
</code></pre></div><p>would not work anymore.</p>
<p>This would be easy in Julia, though:</p>
<div><pre><code data-lang="julia">greet(self<span>::</span>Polarian, other<span>::</span>Player) <span>=</span> println(<span>"Hi!"</span>)
greet(self<span>::</span>Polarian, other<span>::</span>Solarian) <span>=</span> println(<span>"Your star doesn't even consist of three separate stars? Pathetic!"</span>)
</code></pre></div><h2 id="strategy-1b-constrained-generics">Strategy 1b: Constrained generics</h2>
<p>Both Julia and Rust offer defining generic types with type parameters.
Additionally, one can put constraints on those parameters.
This allows us to do a smiliar thing as in strategy 1 but without hiding the concrete player type in the <code>GameState</code> struct:</p>
<div><pre><code data-lang="julia"><span>abstract type</span> Player <span>end</span>
<span>struct</span> Solarian <span>&lt;:</span> Player <span>end</span>

<span>struct</span> GameState{P <span>&lt;:</span> Player}
    daytime<span>::</span><span>UInt</span>
    player<span>::</span>P
<span>end</span>
</code></pre></div><p>or</p>
<div><pre><code data-lang="rust"><span>trait</span> Player { ... }
<span>struct</span> <span>Solarian</span>;
<span>impl</span> Player <span>for</span> Solarian { ... }

<span>struct</span> <span>GameState</span><span>&lt;</span>P: <span>Player</span><span>&gt;</span> {
    daytime: <span>u64</span>,
    player: <span>P</span>
}
</code></pre></div><p>This approach can be considered more performant in general, as the compiler can emit code for concrete types (<a href="https://doc.rust-lang.org/book/ch10-01-syntax.html#performance-of-code-using-generics"><em>monomorphisation</em></a>) instead of carrying around a clumsy super type that keeps track of subtypes and <a href="https://en.wikipedia.org/wiki/Virtual_method_table">virtual method tables</a>.<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup></p>
<p>However, there is a major concern with this approach: <strong>abstraction leaking</strong>.
Users of the <code>GameState</code> struct now have to decide what concrete type to choose for the parameter <code>P</code>, very strictly so in Rust, not so much in Julia.
This can be okay, but often enough <code>GameState</code> is the right place to deal with that question and really should hide that detail.</p>
<p>So as a rule of thumb: Consider generics for this problem ‚Äúdeep down‚Äù in your code but don‚Äôt miss the abstraction level where it needs to be kept inside.</p>
<h2 id="strategy-2-enumerations">Strategy 2: Enumerations</h2>
<p>So far, the approaches were not really satisfying for Rust.
But enumerations come to the rescue!
Enumerations (or enums) are types that consist of a concrete and explicit list of possible values (so called <em>variants</em>).</p>
<h3 id="rust-1">Rust</h3>
<p>In Rust, those values can even have their own data which is perfect for our situation:</p>
<div><pre><code data-lang="rust"><span>enum</span> <span>PlayerClass</span> {
    Sol(Solarian),
    Pol(Polarian),
    Cent(Centaurian)
}

<span>struct</span> <span>GameState</span> {
    daytime: <span>u64</span>,
    player: <span>PlayerClass</span>
}

<span>impl</span> PlayerClass {
    <span>fn</span> <span>homestar</span>(<span>&amp;</span>self) -&gt; <span>String</span> {
        <span>use</span> PlayerClass::<span>*</span>;
        <span>match</span> self {
            Sol(_) <span>=&gt;</span> <span>String</span>::from(<span>"sun"</span>),
            ...
        }
    }

    <span>fn</span> <span>greet</span>(<span>&amp;</span>self, other: <span>&amp;</span><span>PlayerClass</span>) {
        <span>use</span> PlayerClass::<span>*</span>;
        <span>match</span> (self, other) {
            (Cent(_), Pol(_)) <span>=&gt;</span> println<span>!</span>(<span>"Hello, fellow three-star-systemer!"</span>),
            ...
        };
    }
}
</code></pre></div><p>This indeed solves all our previous problems and is hence the go-to pattern for this situation.</p>
<h3 id="julia-1">Julia</h3>
<p>Julia does technically have enums, but not really.</p>
<div><pre><code data-lang="julia">@enum PlayerClass Sol Pol Cent
</code></pre></div><p>exists and it will give you a type <code>PlayerClass</code> with exactly these three possible values but enums are not a first class citizen.<sup id="fnref:3"><a href="#fn:3" role="doc-noteref">3</a></sup>
But that‚Äôs not even relevant for us, more importantly, enum variants in Julia are <em>not</em> able to carry additional data with them!
So all the information in the fields of the <code>Solarian</code>, <code>Polarian</code>, and <code>Centaurian</code> struct can not be build into the <code>PlayerClass</code> enum.
There is no way to sensibly implement</p>
<div><pre><code data-lang="julia"><span>function</span> takedamage!(player<span>::</span>PlayerClass)
    <span>...</span>
<span>end</span>
</code></pre></div><p>whereas it is trivial in Rust:</p>
<div><pre><code data-lang="rust"><span>impl</span> PlayerClass {
    <span>fn</span> <span>takedamage</span>(<span>&amp;</span><span>mut</span> self) {
        <span>match</span> <span>&amp;</span><span>mut</span> self {
            PlayerClass::Sol(solarian) <span>=&gt;</span> solarian.health <span>-=</span> <span>42</span>,
            ...
        };
    }
}
</code></pre></div><p>assuming the struct <code>Solarian</code> has a field <code>health: u64</code>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>You might have guessed it by now, but the general advice is:
<strong>Use subtyping in Julia and enums in Rust.</strong>
One caveat though: Enums can not be extended from the ‚Äúoutside‚Äù.
If you plan to let users of your library add new type variants, you will have to use some kind of trait approach.</p>
<p>If you are somewhat familiar with Rust or Julia then a large part of this article is probably very obvious to you.
‚ÄúOf course I use subtyping, that‚Äôs what everybody <em>loves</em> Julia for!‚Äù or ‚ÄúOf course I use enums, they‚Äôre one of <em>the</em> key features of Rust!‚Äù you might say.</p>
<p>However, I find it quite surprising that these two ‚Äì seemingly rather different ‚Äì patterns can be used in the same situation.
If you are (without loss of generality) a Julia developer, being aware of the corresponding pattern in Rust might help you design appropriate types faster, should you ever get into that situation; and vice versa.</p>
<section role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>In an earlier version I used the term <em>sum types</em> but as reddit user <code>u/Eigenspace</code> pointed out, that‚Äôs technically not correct.  They also suggested this new choice of words. <a href="#fnref:1" role="doc-backlink">‚Ü©Ô∏é</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>Instances of type <code>Player</code> in Julia and of type <code>Box&lt;dyn Player&gt;</code> in Rust work quite similiarly, as far as I understand. <a href="#fnref:2" role="doc-backlink">‚Ü©Ô∏é</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>It is quite interesting to look at <code>@macroexpand @enum Foo A B C</code> though, to see how enums ‚Äúwork‚Äù in Julia. <a href="#fnref:3" role="doc-backlink">‚Ü©Ô∏é</a></p>
</li>
</ol>
</section>

        </div></div>]]>
            </description>
            <link>https://andreaskroepelin.de/blog/sum_types/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24328071</guid>
            <pubDate>Mon, 31 Aug 2020 02:47:04 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Why are there 5280 feet in a mile?]]>
            </title>
            <description>
<![CDATA[
Score 307 | Comments 436 (<a href="https://news.ycombinator.com/item?id=24327740">thread link</a>) | @ahupp
<br/>
August 30, 2020 | https://petersmagnusson.org/2009/09/15/why-are-there-5280-feet-in-a-mile/ | <a href="https://web.archive.org/web/*/https://petersmagnusson.org/2009/09/15/why-are-there-5280-feet-in-a-mile/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="post-393">

			
			
			<p>
				
				‚ô¶ <a href="https://petersmagnusson.org/2009/09/15/why-are-there-5280-feet-in-a-mile/" rel="bookmark" title="Why are there 5280 feet in a&nbsp;mile?">September 15, 2009</a>

									‚ô¶ <a href="https://petersmagnusson.org/2009/09/15/why-are-there-5280-feet-in-a-mile/#comments">10 Comments</a>							</p>

			<p>The original Roman mile was 1000 paces (<em>milia passuum</em>), or 5000 feet. The modern mile was defined as 5280 feet under Queen Elizabeth at the end of the 16th century in order to reconcile multiple discordant measurement systems already in wide use. In particular, it was convenient to make it an even multiple of the sides of an acre, which since early medieval times was a rectangle 660 feet long and 66 feet wide. 660 divides neatly into 5280, eight ways, allowing a square mile (640 acres or a ‚Äúsection‚Äù) to be conveniently quartered three times over: into quarter sections (160 acres), sixteenth sections (40 acres), and finally the 10 acre squares (660 by 660 feet) that remain at the base of all US land surveys to this day.</p>

<p><em>Background: Many years ago, I became curious as to why, exactly, there are 5280 feet in a mile. The explanations I found online at the time weren‚Äôt very convincing. At the time I tried to make some fixes to parts of the puzzle in Wikipedia, but they frequently rejected as OR (original research). Eventually I wrote this article, since revised and updated several times. Since then, my ‚Äúversion‚Äù of things will occasionally drift to the #1 spot on Google or Bing, or both, when answering the specific question ‚Äúwhy are there 5280 feet in a mile‚Äù. More often some SEO-optimized version will slip ahead, though it seems this article is holding steady in the top 3 or 4 at least. So hopefully pretty much everybody who cares about the details will find this. If you have any comments or questions (or corrections), please add to the comment section, I do (eventually) read all comments.<br>
</em></p>
<p><em>I have yet to find an answer to the question that‚Äôs as thorough and complete as this one is. But I must caution that this article isn‚Äôt really up to academic standards and contains a non-trivial amount of speculation. Caveat Emptor, what follows is my theory of how the mile ended up with 5280 feet.</em></p>
<p>The conventional wisdom on this topic goes something like this: the mile was originally 5000 feet. It was changed to 5280 feet in Elizabethan times around the year 1600 (some point to 1592 and some to 1593) to accommodate the furlong, which was 660 feet. It was easier to fix the mile rather than the furlong for various reasons, hence, eight furlongs and 5280 feet in a mile.</p>
<p>That‚Äôs the standard story. It‚Äôll be fleshed out with bells and whistles, including odd theories about horses etc, but that‚Äôs about it.</p>
<p>The problem with these versions is that they don‚Äôt explain why this collision between furlong and mile occurred around 1600, and not centuries before. It implies, therefore, that people suddenly woke up and realized, hey, wait a second, if there‚Äôs 660 feet in a furlong ‚Ä¶ and eight furlongs in a mile ‚Ä¶ but 5000 feet in a mile ‚Ä¶. wait a second !?!</p>
<p>It somewhat implies that four-digit multiplication was invented ca 1600. Like a lot of rear-view-mirror takes on history, the ‚Äúexplanation‚Äù boils down to: ‚Äúbefore time X people were stupid about topic Y, and at time Z they wizened up.‚Äù</p>
<p>Failing to find a good write-up of the origins, I‚Äôve pieced together my own theory over the years. And it‚Äôs a fun one because the answer (or rather, hypothesis) is simply this: the number 5280 arises out of a collision between organized religion, the military, and taxation. Three powerful historical forces, to be sure, so the fourth pillar to modern society (rationality) obviously has to be the one to compromise!</p>
<p>But wait, there‚Äôs more: naked Greeks are involved, and Jesus, and Vikings. In that order.</p>
<p>Our story starts with the ‚Äúoriginal‚Äù mile, the Roman one (though there is indication the measurement is older still). The Romans were both practical and militant. Their mile was 1000 paces ‚Äì a pace being a double step (left foot, right foot) by a soldier in full battle gear. That was a ‚Äú<em>passus</em>‚Äú, and a mile was a ‚Äú<em>milia passuum</em>‚Äú, hence the word ‚Äúmile‚Äù (for ‚Äúthousand‚Äù, as in the word <em>millennium)</em>.</p>
<p>If you are a runner or a hiker, you‚Äôll know that we still remember this information in our convention of relating pedometers to miles: about 2000 steps to a mile. But we have forgotten that it‚Äôs not a ‚Äútrick‚Äù, it‚Äôs the whole point. Language use changes back and forth over time, and today we‚Äôre more likely to use the word ‚Äústep‚Äù rather than ‚Äúpace‚Äù, hence, we can think of a mile as being defined as 2000 steps.</p>
<p>Furthermore, the Romans had another convention, that you‚Äôve probably heard of, which was to place stones next to their roads to mark the distance from Rome. Called ‚Äú<em>milliarium</em>‚Äú, these stone obelisks were first erected along the Via Appia, where milestones dating as far back as the second century BC still survive. Naturally, quite a large number of these stones survived along roads throughout Europe, providing a natural reference point, explaining why their particular measure of a ‚Äúfoot‚Äù survives with high accuracy. The central stone in Rome, from which the phrase ‚Äúall roads lead to Rome‚Äù derives, wasn‚Äôt erected until some two centuries later in 20 BC, but is since lost.</p>
<p>It‚Äôs worth injecting that the popular notion that Roman roads all had measures of the distance from Rome is a myth: only central Italy and a few exceptions were marked from central Rome, all other roads were measured from the nearest local significant center. The US‚Äô attempt to replicate this myth with the Zero Mile marker in Washington, DC, in 1792 would have a similar destiny, influencing only measurements nearby. Instead a similar variation (measuring from something local and significant) lives on in the mile markers of the interstate highway system, where the numbering typically starts at either the southern or the western state line and increasing as you drive in the other direction.</p>
<p>Curiously, we know very little of the details of how the Roman army used the mile as a practical tool ‚Äì not a single significant military treatise has survived from Roman times. The that has, the <em>Epitoma rei militaris,</em> is unfortunately not considered authoritative. Thus its claims cannot be checked against any other contemporary sources, which is particularly irksome since some of them appear highly dubious ‚Äì such as stating that the army marched 20 miles in 5 summer hours at regular pace and 24 miles at double pace.</p>
<p>You can experiment yourself to realize that the miles per hour measure is practical for a human: casual walking is 2 mph, an easy walk is 3, swift walking is 4. The available number of hours in a day is similarly small, thus making the mental arithmetic simple.</p>
<p>Hence, 5000 feet to the mile, a general measure that survived throughout Europe as roadside reminders of the might of Rome.</p>
<p>Now, switching tracks, about the furlong. It means ‚Äúa furrow long‚Äù (long as a furrow) and is a practical measure in an agrarian society: it is (approximately) the distance an oxen can plow without resting. That distance was standardized to be 40 ‚Äúrods‚Äù, where a rod (or ‚Äúpole‚Äù) is today defined as 5.5 yards (16.5 feet), though it was probably originally 20 feet (we‚Äôll get back to all this).</p>
<p>An ‚Äúacre‚Äù (which means ‚Äúfield‚Äù) was 40 rods long and 4 rods wide (4 rods was also called a ‚Äúchain‚Äù, more on that below). An acre was thus the surface area that one man and a team of oxen could till in one day. It was long and narrow because of the development of the heavy plough around the end of the 10th century, which turned the soil over, revolutionizing agriculture in northern Europe where the clay-heavy soil (vs sandier south European soil) went from being a handicap to an asset, in fact contributing significantly to the eventual inversion of economic power in Europe from the south to the north.</p>
<p>At this point, if you‚Äôre paying close attention, you‚Äôll see that not only do we have the decimal (base 10) concept in the ‚Äúmile‚Äù (one thousand paces), but also in the acre: the proportions of the sides are exactly 10:1. That‚Äôs because ‚Äúacre‚Äù dates back to ‚Äú10 square chains‚Äù, or an area that‚Äôs one ‚Äúchain‚Äù wide and ten long. A ‚Äúchain‚Äù in turn is four rods. The word ‚Äúchain‚Äù comes from how this convenient measurement tool was constructed. Organic materials (wood, rope) have obvious problems in retaining precise dimensions, despite efforts to wax or otherwise treat them. A marked improvement therefore came from carrying a set of thin metal rods, that eventually would be ‚Äúchained‚Äù together. Most surveying in the United States was done in the 1700s and 1800s using a standardized 100-link chain of 66 feet in total length.</p>
<p>But this was a more modern innovation. Going much further back in history it seems likely the basic approach was instead to carry a long, thin, metal ‚Äúrod‚Äù that was 16 feet long, seems likely to me that they were in parts. This is still today a common surveying tool ‚Äì search Amazon for ‚Äúsurveyor rod‚Äù and you‚Äôll find the modern version, now made of telescoping aluminum and generally 16 feet long. We‚Äôll get back to why it was 16 feet (and not 10 or 20), and how it later on became 16.5.</p>
<p>This tradition of the furlong (ten chains) took root in England between the fall of Rome and the Norman conquest of 1066, along the aforementioned adoption of heavy ploughs. With the Normans came the re-introduction of the Roman definition of the foot as 12 inches. A reference foot was thusly carved into one of the pier bases of the new nave in St Paul‚Äôs cathedral in London in 1104 (by the son of a banker, interestingly enough).</p>
<p>The Saxon tradition of measuring land had been established in terms of rods, and as we alluded above, probably based on 20 ‚Äúnatural‚Äù feet ‚Äì i.e. not Roman standard feet but ‚Äúreal‚Äù 9.8-inch feet. The number 20, of course, was the common ‚Äúdecimal‚Äù system prior to the invention of shoes (at which point you can‚Äôt see your toes). Also, the technique of counting to 20 with one hand may have been prevalent. Vestiges of base-20 remain, notably for our story, in Danish and French. For example, in French you say ‚Äúsoixante-dix‚Äù for 70 and in Danish you say ‚Ä¶</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://petersmagnusson.org/2009/09/15/why-are-there-5280-feet-in-a-mile/">https://petersmagnusson.org/2009/09/15/why-are-there-5280-feet-in-a-mile/</a></em></p>]]>
            </description>
            <link>https://petersmagnusson.org/2009/09/15/why-are-there-5280-feet-in-a-mile/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24327740</guid>
            <pubDate>Mon, 31 Aug 2020 01:47:01 GMT</pubDate>
        </item>
    </channel>
</rss>
