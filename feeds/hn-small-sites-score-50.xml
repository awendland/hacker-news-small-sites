<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>
<![CDATA[Hacker News - Small Sites - Score >= 50]]>
        </title>
        <description>
<![CDATA[Hacker News stories from domains that aren't in the top 1M and that have a score of at least 50. Updated nightly via https://github.com/awendland/hacker-news-small-sites]]>
        </description>
        <link>https://news.ycombinator.com</link>
        <generator>RSS for Node</generator>
        <lastBuildDate>Mon, 24 Aug 2020 12:26:30 GMT</lastBuildDate>
        <atom:link href="https://raw.githubusercontent.com/awendland/hacker-news-small-sites/generated/feeds/hn-small-sites-score-50.xml" rel="self" type="application/rss+xml"></atom:link>
        <pubDate>Mon, 24 Aug 2020 12:26:30 GMT</pubDate>
        <language>
<![CDATA[en-US]]>
        </language>
        <managingEditor>
<![CDATA[me@alexwendland.com (Alex Wendland)]]>
        </managingEditor>
        <ttl>240</ttl>
        <item>
            <title>
<![CDATA[Bread, How Did They Make It? Part IV: Markets, Merchants and the Tax Man]]>
            </title>
            <description>
<![CDATA[
Score 69 | Comments 7 (<a href="https://news.ycombinator.com/item?id=24240677">thread link</a>) | @Kednicma
<br/>
August 21, 2020 | https://acoup.blog/2020/08/21/collections-bread-how-did-they-make-it-part-iv-markets-and-non-farmers/ | <a href="https://web.archive.org/web/*/https://acoup.blog/2020/08/21/collections-bread-how-did-they-make-it-part-iv-markets-and-non-farmers/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
		
<p>As the fourth and final part (<a href="https://acoup.blog/2020/07/24/collections-bread-how-did-they-make-it-part-i-farmers/">I</a>, <a href="https://acoup.blog/2020/07/31/collections-bread-how-did-they-make-it-part-ii-big-farms/">II</a>, <a href="https://acoup.blog/2020/08/06/collections-bread-how-did-they-make-it-part-iii-actually-farming/">III</a>) of our look at the basic structure of food production in the pre-modern world (particularly farming grain to make bread), this week we’re going to look at how at least some of the delicious food we made in the last post might make its way into the hands of people who are <em>not</em> <a href="https://acoup.blog/2020/07/24/collections-bread-how-did-they-make-it-part-i-farmers/">farmers </a>or even<a href="https://acoup.blog/2020/07/31/collections-bread-how-did-they-make-it-part-ii-big-farms/"> farm owners</a>.</p>



<p>In the previous three posts, I have mostly just used the magic word ‘markets’ to describe how the food produced in the countryside gets to the cities and people who are not farmers.  As we’ll see in this post, that is a bit of an oversimplifying fib, both in that the phrase ‘markets’ covers a <em>lot </em>of complexity, but also (as we’ll see) some of the major drivers of moving that food from the countryside into towns doesn’t involve money <em>or</em> market interactions.  That said, we’re going to <em>start</em> with market transactions, because while they are actually the minority-type in many of these societies, they are more readily familiar and understandable, I suspect, to modern readers.  Then we’ll move to <em>extraction</em> as the other category.</p>



<p>Speaking of extraction, as always, if you like what you are reading here, you can support me on <a href="https://www.patreon.com/user?u=20122096">Patreo</a>n. And if you want updates whenever a new post appears, you can click the button below for email updates or follow me on twitter (@BretDevereaux) for updates as to new posts, as well as my occasional ancient history, foreign policy or pop-culture thoughts.</p>






<h2>Point of Sale</h2>



<p>I want to start by leaning on (with small modifications for clarity) Paul Erdkamp’s taxonomy of the various options by which food might get into the stream of commerce.  A small farmer might sell their grain (I) directly to city-dwellers, (II) indirectly, via urban middlemen and grain merchants, either in the market or (III) ‘at the gate’ (meaning selling to merchants who come out to the farm in order to buy; the difference being who transports the food to the city), (IV) to itinerant traders at periodic rural markets or (V) to other local small farmers.  As we’ll see, <em>large </em>landholders have a <em>somewhat</em> larger range of options within this taxonomy, but the fundamentals are the same.</p>



<p>While all of these sale methods certainly happened, in every society I have looked at, Option I – selling directly to city-dwellers – is fairly rare for grains and other bulk agricultural goods.  Market <em>gardeners</em>, selling fruits, vegetables (and sometimes flowers) often do sell this way, maintaining a high-intensity garden near town and a shop or stall in the town market.  Likewise, while Option V – small-scale trade between farmers – absolutely happens, it is typically non-monetary: the banqueting of neighbors discussed in the first post.  Where it is monetary, it is typically quite small scale and very short distance.  By and large, small and mid-sized farmers hadn’t the time, expertise or infrastructure to sell their goods directly.  They needed to be farming, not manning a market stall or trying to figure out how to store their goods close to the point of sale.  And of course large landowners, being rich, aren’t going to stand in the market square either (and in many cases don’t want their obvious representative doing so either,  see below).  So while I and V happen, they’re not too common or too large a portion of total trade and we may lay them aside for this discussion.</p>



<p>That leaves Options II, III and IV, all of which involve selling grain to a middle-man merchant of some sort.  The main difference is the location of sale (in town, at the gate, or at periodic rural markets).  Outside of large cities and major ports, markets were likely to be <em>periodic</em>, occurring only on certain days (typically around once per week).  In Roman Italy, these were the <em>nundinae</em> (‘ninth days,’ although it was an 8-day cycle as the Romans count inclusively); the <em>nundinae</em> were minor festivals, days of rest and merrymaking, but they were also the days when the rural markets would be open – the rest-day from agricultural labor enabled farmers to head into local towns to buy or sell whatever they needed (interestingly, at Rome, the <em>nundinae</em> were <em>dies nefasti</em> – state business couldn’t generally be conducted on them – so poor farmers hoping to use their day off to participate politically were out of luck).  Similar periodic markets are common in the Middle Ages (and even today; most ‘farmer’s markets’ in the United States are periodic, <a href="http://www.carrborofarmersmarket.com/">including my town’s</a>).  The periodic nature of these markets is an adaptation to agricultural rhythms; for a market to function there need to be a lot of people together all at once and the small towns that dotted the countryside simply didn’t have the density to do that all of the time.</p>



<figure><img data-attachment-id="4249" data-permalink="https://acoup.blog/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market/" data-orig-file="https://acoupdotblog.files.wordpress.com/2020/08/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market.jpg" data-orig-size="2325,663" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market" data-image-description="" data-medium-file="https://acoupdotblog.files.wordpress.com/2020/08/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market.jpg?w=300" data-large-file="https://acoupdotblog.files.wordpress.com/2020/08/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market.jpg?w=1024" src="https://acoupdotblog.files.wordpress.com/2020/08/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market.jpg?w=1024" alt="" srcset="https://acoupdotblog.files.wordpress.com/2020/08/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market.jpg?w=1024 1024w, https://acoupdotblog.files.wordpress.com/2020/08/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market.jpg?w=2048 2048w, https://acoupdotblog.files.wordpress.com/2020/08/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market.jpg?w=150 150w, https://acoupdotblog.files.wordpress.com/2020/08/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market.jpg?w=300 300w, https://acoupdotblog.files.wordpress.com/2020/08/fresco_from_the_house_of_julia_felix_pompeii_depicting_scenes_from_the_forum_market.jpg?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption><a href="https://en.wikipedia.org/wiki/Merchant#/media/File:Fresco_from_the_House_of_Julia_Felix,_Pompeii_depicting_scenes_from_the_Forum_market.JPG">Via Wikipedia</a>, a fresco showing market activity, with merchants showing off wares of fabric (left) and goods in pots (center) from the House of Julia Felix at Pompeii, first century CE.  Please note: the importance of pottery in modern archaeology has given many students and the general public the idea that the ancients were always shipping pots around for sale, as if there was a vast market in pottery.  <strong>Generally, people were buying what was in the pot, not the pot itself</strong>.</figcaption></figure>



<p>But as noted, our farmers are unlikely to be selling their grain directly to customers.  Instead, they are likely to be using some sort of middle-man merchant, which brings us to:</p>



<h2>Merchants!</h2>



<p>Merchants are a bit of a break from the people we have so far discussed in that they, by definition, live in the realm of the <em>market</em> (in the economic sense, although often also in a physical sense).  As we’ve seen so much of the world of our farmers and even our millers and bakers was governed by <em>non-market</em> interactions: horizontal and vertical social ties that carried expectations that weren’t quite transactional and certainly not monetized.  By contrast, merchants work with transactions and tend to be the <em>first</em> group in any society to attempt to monetize their operations once money becomes available.  I find students are often quick to feel identity with the merchant class, because these folks are more likely to travel, more likely to use money, more likely to employ or be employed in wage-labor; they feel more like modern people.</p>



<p>It thus tends to come as something of a surprise that with <em>stunning</em> consistency, <strong>the merchant class tended to be at best cordially disliked and at worst <em>despised</em> by the broader community</strong> (although not typically to the point of suffering legal disability, as did some other jobs; see S. Bond, <em>Trade and Taboo: Disreputable Professions in the Roman Mediterranean</em> (2016) for this in Rome).  This often strikes students as strange, both because we tend to think rather better of our own modern merchants but also because the image they have of the merchant class certainly looks elite.</p>



<figure><img data-attachment-id="4257" data-permalink="https://acoup.blog/britlibaddms35166apocalypseunkfolio3sealblackhorse/" data-orig-file="https://acoupdotblog.files.wordpress.com/2020/08/britlibaddms35166apocalypseunkfolio3sealblackhorse.jpg" data-orig-size="1134,766" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="britlibaddms35166apocalypseunkfolio3sealblackhorse" data-image-description="" data-medium-file="https://acoupdotblog.files.wordpress.com/2020/08/britlibaddms35166apocalypseunkfolio3sealblackhorse.jpg?w=300" data-large-file="https://acoupdotblog.files.wordpress.com/2020/08/britlibaddms35166apocalypseunkfolio3sealblackhorse.jpg?w=1024" src="https://acoupdotblog.files.wordpress.com/2020/08/britlibaddms35166apocalypseunkfolio3sealblackhorse.jpg?w=1024" alt="" srcset="https://acoupdotblog.files.wordpress.com/2020/08/britlibaddms35166apocalypseunkfolio3sealblackhorse.jpg?w=1024 1024w, https://acoupdotblog.files.wordpress.com/2020/08/britlibaddms35166apocalypseunkfolio3sealblackhorse.jpg?w=150 150w, https://acoupdotblog.files.wordpress.com/2020/08/britlibaddms35166apocalypseunkfolio3sealblackhorse.jpg?w=300 300w, https://acoupdotblog.files.wordpress.com/2020/08/britlibaddms35166apocalypseunkfolio3sealblackhorse.jpg?w=768 768w, https://acoupdotblog.files.wordpress.com/2020/08/britlibaddms35166apocalypseunkfolio3sealblackhorse.jpg 1134w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption><a href="https://en.wikipedia.org/wiki/Merchant#/media/File:BritLibAddMS35166ApocalypseUnkFolio3SealBlackHorse.jpg">Via Wikipedia</a>, a manuscript illustration showing the Horseman of Famine depicted as a grain merchant (from Revalations 6:5-6), holding the scales he would use to measure out grain.</figcaption></figure>



<p>For the farmers who need to sell their crops (for reasons we will get to in a moment) and purchase the things they need that they cannot produce, the merchant feels like an adversary: always pushing his prices to his best advantage.  We expect this, but remember that our pre-modern farmers are just <em>not that exposed to market interactions</em>; most of their relationships are reciprocal, not transactional – the horizontal relationships we discussed before.  The merchant’s ‘money-grubbing’ feels like a betrayal of trust in a society where you banquet your neighbors in the good years so they’ll help you in the bad years.  <strong>The necessary function of a merchant is to transgress the ‘rules’ of village interactions which – and this <em>resounds</em> from the sources – the farmers tend to understand as being ‘cheated.’</strong></p>



<p>At the same time, <strong>while most merchant types are humble, the high-risk and potentially high-reward involved in trade meant that <em>some</em> merchants </strong>(again, a small number) <strong>could become <em>very</em> rich</strong>.  That, as you might imagine, <strong>did not go over well for the traditionally wealthy in these societies</strong>, the large landholders.  Again, the values here often strike modern readers as topsy-turvy compared to our own, but to the elite large landholders (who dominate the literary and political culture of their societies), the <em>morally correct</em> way to earn great wealth is to inherit it (or capture it in war).  The <em>morally correct</em> way to hold that wealth is with large landed estates.  Anything else is <em>morally</em> suspect, and so the idea that a successful merchant could – by a process that again, strikes the large landholder, just like the small farmer, as ‘cheating’ – leap-frog the social pyramid and skip to the top, without putting in the work at either having distinguished wealthy ancestors <em>or</em> tremendous military success was an open insult to elite values.  Often laws were put in place to limit the ability of wealthy non-aristocrats (likely merchants or successful artisans) from displaying their wealth (<a href="https://en.wikipedia.org/wiki/Sumptuary_law">sumptuary laws</a>) so as to keep them from competing with the aristocrats; at Rome, senators were forbidden from owning ships with much the same logic (Roman senators being clever, they still invested in trade through proxies while at the same time disapproving of the activity in public politics).</p>



<p>Such disdain appears, with varying justification, in the sources of every pre-modern agrarian society I’ve studied, to one degree or another.  One commonplace of Greek and Roman thinking – despite these being very active, maritime societies – was that the first production of ships and the first sailing was in some essential way a profanation of the divine realm of the sea, a space humans ought not have ever ventured into – and certainly not for anything as mean as profit (e.g. Euripides, <em>Medea</em> 1-6; Catullus. 64.1-20; Valerius Flaccus, <em>Argonautica</em> 627-632; Seneca, <em>Medea</em> 1-12; 301-379, <em>inter alia</em> – thanks to my old grad school pals <a href="https://www.usf.edu/arts-sciences/departments/world-languages/about-us/hedrick.aspx">Buddy Hedrick</a> and <a href="http://gdrsd.org/gdrhs/faculty/michael-hoffman/">Michael Hoffman </a>for …</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://acoup.blog/2020/08/21/collections-bread-how-did-they-make-it-part-iv-markets-and-non-farmers/">https://acoup.blog/2020/08/21/collections-bread-how-did-they-make-it-part-iv-markets-and-non-farmers/</a></em></p>]]>
            </description>
            <link>https://acoup.blog/2020/08/21/collections-bread-how-did-they-make-it-part-iv-markets-and-non-farmers/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24240677</guid>
            <pubDate>Sat, 22 Aug 2020 01:04:49 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Over three billion people worldwide now play video games, study reports]]>
            </title>
            <description>
<![CDATA[
Score 230 | Comments 247 (<a href="https://news.ycombinator.com/item?id=24239234">thread link</a>) | @Gamermeme
<br/>
August 21, 2020 | https://nintendosmash.com/over-three-billion-people-worldwide-now-play-video-games-study-reports/ | <a href="https://web.archive.org/web/*/https://nintendosmash.com/over-three-billion-people-worldwide-now-play-video-games-study-reports/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article id="the-post">
			
			<p><img width="588" height="330" src="https://nintendosmash.com/wp-content/uploads/2020/08/gamers-588x330.jpg" alt="Three billion people worldwide now play video games, study reports">		</p>
	
		


			<div>

							

						
<p>
		
	
	
		
	<span><i></i>1 week ago</span>	
	<span><i></i><a href="https://nintendosmash.com/category/news/" rel="category tag">News</a></span>
	
	
</p>

			
				<div>
					
					
					
<p>By mid-2020, the number of people playing video games had grown to 3.1 billion, according to <a href="https://www.dfcint.com/product/video-game-consumer-segmentation-2/">DFC Intelligence</a>. Considering that in July the total population of the Earth exceeded 7.8 billion, just under 40% are familiar with games.</p>




<p>Analysts point out that almost half of the accounted three billion are those who play only on smartphones or mobile devices. This segment is also ahead of all others in terms of growth.</p>



<p>However, only about 250 million people are active console users who regularly buy new games for them. Although they represent only 8% of the total number of gamers, this is the group with the highest revenue per person.</p>



<p>1.5 billion are playing on PC – 48% of all gamers. However, this number includes not only regular users but also those who also enjoy video games on consoles and mobile platforms.</p>



<p>More than half of the world’s gamers live in Asia – there are 1.42 billion players there. Moreover, this region also accounts for 53% of people who play only on smartphones. The top four also include Europe (668 million), Latin America (383 million) and North America (261 million).</p>



<ul><li><figure><img src="https://nintendosmash.com/wp-content/uploads/2020/08/smartphome-user.jpg" alt="" data-id="4920" data-link="https://nintendosmash.com/over-three-billion-people-worldwide-now-play-video-games-study-reports/smartphome-user/" srcset="https://nintendosmash.com/wp-content/uploads/2020/08/smartphome-user.jpg 510w, https://nintendosmash.com/wp-content/uploads/2020/08/smartphome-user-300x231.jpg 300w" sizes="(max-width: 510px) 100vw, 510px"></figure></li></ul>

 
















<!-- AI CONTENT END 3 -->
					
									</div><!-- .entry /-->
								
				
				 <!-- .share-post -->				
			</div><!-- .post-inner -->
		</article><section id="check-also-box">
		<a href="#" id="check-also-close"><i></i></a>

		<p>
			<h3>Check Also</h3>
		</p>

				<div>
						
			<p><a href="https://nintendosmash.com/king-zell-claims-that-zelda-skyward-sword-hd-is-coming-to-nintendo-switch/">
					<img width="310" height="165" src="https://nintendosmash.com/wp-content/uploads/2020/08/zelda-skyword-310x165.jpg" alt="King Zell claims that Zelda: Skyward Sword HD is coming to Nintendo Switch">					<span></span>
				</a>
			</p><!-- post-thumbnail /-->
						
			<h2><a href="https://nintendosmash.com/king-zell-claims-that-zelda-skyward-sword-hd-is-coming-to-nintendo-switch/" rel="bookmark">King Zell claims that Zelda: Skyward Sword HD is coming to Nintendo Switch</a></h2>
			<p>In recent days, a rumor has been circulating the network that Zelda: Skyward Sword was …</p>
		</div>
				<div>
						
			<p><a href="https://nintendosmash.com/famous-granny-audie-shows-us-her-animal-crossing-new-horizons-island/">
					<img width="310" height="165" src="https://nintendosmash.com/wp-content/uploads/2020/08/animal-crossing-granny-island-310x165.jpg" alt="FAMOUS GRANNY AUDIE SHOWS US HER ANIMAL CROSSING: NEW HORIZONS ISLAND">					<span></span>
				</a>
			</p><!-- post-thumbnail /-->
						
			<h2><a href="https://nintendosmash.com/famous-granny-audie-shows-us-her-animal-crossing-new-horizons-island/" rel="bookmark">FAMOUS GRANNY AUDIE SHOWS US HER ANIMAL CROSSING: NEW HORIZONS ISLAND</a></h2>
			<p>Animal Crossing fans may remember Audrey, the 89-year-old grandmother who has famously clocked more than …</p>
		</div>
				<div>
						
			<p><a href="https://nintendosmash.com/crysis-remastered-coming-to-pc-and-consoles-on-september-18/">
					<img width="310" height="165" src="https://nintendosmash.com/wp-content/uploads/2020/04/crysis-for-the-switch-310x165.jpg" alt="Crysis Remastered Coming To PC And Consoles On September 18">					<span></span>
				</a>
			</p><!-- post-thumbnail /-->
						
			<h2><a href="https://nintendosmash.com/crysis-remastered-coming-to-pc-and-consoles-on-september-18/" rel="bookmark">Crysis Remastered Coming To PC And Consoles On September 18</a></h2>
			<p>Crytek not only announced the release date of the remaster, but also a teaser comparing …</p>
		</div>
				<div>
						
			<p><a href="https://nintendosmash.com/hitman-3-has-become-a-temporary-egs-exclusive/">
					<img width="310" height="165" src="https://nintendosmash.com/wp-content/uploads/2020/08/hitman3-310x165.jpg" alt="Hitman 3 has become a temporary EGS exclusive">					<span></span>
				</a>
			</p><!-- post-thumbnail /-->
						
			<h2><a href="https://nintendosmash.com/hitman-3-has-become-a-temporary-egs-exclusive/" rel="bookmark">Hitman 3 has become a temporary Epic Game Store exclusive</a></h2>
			<p>The developers decided to make a deal with Epic, since they publish the third part …</p>
		</div>
			</section></div>]]>
            </description>
            <link>https://nintendosmash.com/over-three-billion-people-worldwide-now-play-video-games-study-reports/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24239234</guid>
            <pubDate>Fri, 21 Aug 2020 21:50:01 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[F (2006)]]>
            </title>
            <description>
<![CDATA[
Score 166 | Comments 50 (<a href="https://news.ycombinator.com/item?id=24238846">thread link</a>) | @tosh
<br/>
August 21, 2020 | http://www.nsl.com/k/f/f.htm | <a href="https://web.archive.org/web/*/http://www.nsl.com/k/f/f.htm">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page">



<p><a href="http://www.nsl.com/k/f/f.k">F</a> is a pure functional concatenative 
language originally designed as an extension of <a href="http://www.nsl.com/papers/false.htm">False</a>. F contains the list-operations of <a href="http://www.kx.com/">K3</a> and the <em>dip</em> combinator 
of <a href="http://www.latrobe.edu.au/philosophy/phimvt/joy.html">Joy</a>. Floating-point and symbolic datatypes are supported. One-time assignment
is enforced in syntax. A theory of function-valence and -charge is outlined. F also contains a general continuation
primitive $, and the pattern sublanguage of <a href="http://www.nsl.com/k/xy/xy.htm">XY</a>.  <a href="http://www.nsl.com/k/f/g.k">G</a> is a variant of F in which the K3 adverbs are implemented as primitives.</p>

<h2>0. Introduction</h2>

<p>F has the following properties:</p>

<blockquote>
    <ul>
        <li>The language is concatenative</li>
        <li>The language is purely functional</li>
        <li>All K verbs are implemented</li>
        <li>All primitives are denoted by single symbols</li>
        <li>Primitive symbols are as mnemonic as possible</li>
    </ul>
</blockquote>

<p><em>The language is concatenative.</em> F tokens are words,
words denote functions, and the concatenation of words denotes
the composition of functions. In classical concatenative
languages, everything is a function from stacks to stacks. In F,
everything is a function from triples of
(environment;stack;queue) to triples of
(environment;stack;queue).</p>

<p><em>The language is purely functional.</em> There are no
side-effects. F has assignment, but not reassignment. This means
that you can't use a variable to store dynamic state. F
assignment associates names with values in an environment which
is passed as an argument and returned as a value. F also has
commands for interacting with the run-time environment and the
file-system, but these operations are notationally differentiated
from the operators of F: "h", "r", &amp;c.
They are intended as debugging aids only.</p>

<p><em>All K verbs are implemented.</em> Some K verbs are
implemented as primitives, and some are derived in the F prelude.
For example, the <em>atom</em> primitive @ of K is defined as
[#ints~]; i.e. shape matches the empty integer vector. Where K
provides a pair of functions, one of which is easily defined in
terms of the other, F implements one as a primitive and derives the
other. For example, <em>and</em> is primitive (&amp;) and <em>or</em>
is derived.  The criterion for dividing related pairs is simply
this:  the derived definition must not be egregiously inefficient
when compared to the primitive it supplants.</p>

<p><em>All primitives are denoted by single symbols.</em>
Although list-notation ([x y z]) is supported, any list can be
constructed functionally with ' (<em>quote</em>) and , (<em>join</em>).</p>

<p><em>Primitive symbols are as mnemonic as possible.</em> There
are five ways the mapping of a function to a symbol can be
mnemonic:</p>

<blockquote>
    <ol>
        <li>The symbol is in common use for the mapped function
            (e.g. + for addition)</li>
        <li>The symbol is mapped to that function in K (e.g. ?
            for <em>find</em>) or False (e.g. ! for <em>unquote</em>)</li>
        <li>The name of the symbol is a homonym for the mapped
            function (e.g. ' for <em>quote</em>)</li>
        <li>A pair of related functions (inverses, or
            near-inverses) are mapped to a pair of related
            symbols (e.g. / and \ for <em>take</em> and <em>drop</em>)</li>
        <li>Where several K primitives are mapped to one symbol,
            the primitives should form an easily remembered group
            based on some common property; e.g. both <em>upgrade</em>
            and <em>enum</em> return indices based on an
            ascending relation, so both are mapped to &lt;. </li>
    </ol>
</blockquote>

<h2>1. Datatypes</h2>

<p>The initial state of the interpreter consists of an
environment containing the F words of the prelude, an empty
result stack, and a string (character-vector) to be evaluated.
The input string is tokenized and parsed to obtain the initial
queue. </p>

<p>The input queue is a K list, possibly containing integers,
floats, symbols, <em>null</em>, functions, and lists
("quotations"). The result stack is initially empty.
The environment is a K dictionary. F processes the environment,
stack, and queue repeatedly until the queue is empty. </p>

<p>If the first item on the queue is an integer, float, <em>null</em>,
the prototype symbol `, or a list, the item is pushed onto the
stack.</p>

<p>If the first item is an undefined symbol, then if it's a <em>shuffle</em>
it's applied; otherwise, a variable is created (in the environment)
having the top of the stack as the value. </p>

<p>If the first item is a defined symbol, its value is
retrieved (from the environment) and pushed onto the stack.</p>

<p>If the first item is a function, then it is applied to the
environment, stack, and queue to produce a new environment,
stack, and queue.</p>

<p>Observe that the domain of the result stack is a proper subset
of the domain of the input queue. On the queue we may find
character-atoms, such as "r", and strings, such as
"blah". But character-atoms are executed away when they
are evaluated, and no F primitive ever produces one, and strings
are comments, which are not processed.</p>

<p>The <em>trace</em> command displays the stack and queue for
selected objects in the trace list T:</p>

<blockquote>
    <pre>F&gt;[fac] "t"

F&gt;3 fac!
                                       3 ♦ fac !
                                     3 2 ♦ fac ! *
                                   3 2 1 ♦ fac ! * *
6
F&gt;

F&gt;[fac cond] "t"

F&gt;3 fac!
                                       3 ♦ fac !
       3 [1 =] [] [dup ! pred ! fac ! *] ♦ cond !
                                     3 2 ♦ fac ! *
     3 2 [1 =] [] [dup ! pred ! fac ! *] ♦ cond ! *
                                   3 2 1 ♦ fac ! * *
   3 2 1 [1 =] [] [dup ! pred ! fac ! *] ♦ cond ! * *
6
F&gt;

F&gt;[] "t"

F&gt;3 fac!
6</pre>
</blockquote>

<h2>2. Primitives</h2>

<h3>Operators (O)</h3>

<blockquote>
    <pre>09*-		int		123 -&gt; 123
09*.09*-	float		123.45 -&gt; 123.45

az.AZ*		name		myName -&gt; value or null
az*-AZ*		shuffle		10 20 ab-ba -&gt; 20 10

[..]		list		[10 + [3 a]] -&gt; [10 + [3 a]]

+		add		1 2 + -&gt; 3
-		sub		2 3 - -&gt; 1
*		mul		3 4 * -&gt; 12
%		div		5 3 % -&gt; 1.666667
^		power		2 3 ^ -&gt; 8
_		floor		3.2 _ -&gt; 3

=		equal		2 2 = -&gt; 1
&gt;		more		4 6 &gt; -&gt; 0
&amp;		and/min		4 3 &amp; -&gt; 3

~		match		[1 2][1 2] ~ -&gt; 1

#		shape		[1 2 3] # -&gt; [3]

|		reverse		[1 2 3] | -&gt; [3 2 1]

@		where		[0 1 1 0 1] @ -&gt; [1 2 4]
@		flip		[[1 2 3][4 5 6]] @ -&gt; [[1 4][2 5][3 6]]

/		take		2[1 2 3] / -&gt; [1 2]
/		reshape		[3 2][1 2 3] / -&gt; [[1 2][3 1][2 3]]

\		drop		2[1 2 3] \ -&gt; [3]
\		cut		[0 2][1 2 3] \ -&gt; [[1 2][3]]
\		rotate		[1 2 3 4] 2 \ -&gt; [3 4 1 2]

?		find		[10 20 30] 20 ? -&gt; 1
?		mod		2 [3 4 5] ? -&gt; [1 0 1]

;		unique		[10 20 10 10 30] ; -&gt; [10 20 30]
:		group		[10 20 10 10 30] : -&gt; [[0 2 3][1][4]]

&lt;		enum		3 &lt; -&gt; [0 1 2]
&lt;		upgrade		[10 30 20] &lt; -&gt; [0 2 1]

.		infra		1 2 [[2 3 +]] . 3 4 -&gt; 1 2 [5] 3 4
.		index		[[1 2 3][[1 0]]] . -&gt; [2 1]
.		monad		[[1 2 3][[1 0]][-1*]] . -&gt; [-1 -2 3]
.		dyad		[[1 2 3][[1 0]]+[3 8]] . -&gt; [9 5 3]

!		unquote		2 [3 +] ! -&gt; 5
`		dip		2 3 4 [+] ` -&gt; 5 4
'		quote		'+ -&gt; [+]

,		join  		[1][2 3] , -&gt; [1 2 3]

$		state		1 2 3 '\ $ 4 5 6 -&gt; 4 5 6 1 2 3

)		s -&gt; s		stack-&gt;stack pattern
(		s -&gt; q		stack-&gt;queue pattern

}		q -&gt; s		queue-&gt;stack pattern
{		q -&gt; q		queue-&gt;queue pattern</pre>
</blockquote>

<h3>System Functions (K)</h3>

<p>The K system functions have reserved names:</p>

<blockquote>
    <pre>type (4::)
log exp abs sqr sqrt floor dot mul inv lsq
sin cos tan asin acos atan sinh cosh tanh
draw
in lin bin binl dv dvl di vs sv</pre>
</blockquote>

<h3>Literals (L)</h3>

<p>F has nine reserved names for literals:</p>

<blockquote>
    <pre>Nan		minint (0N)
Inf		maxint (0I)

nan		NaN (0n)
inf		infinity (0i)

null		null (_n)
sym		prototype sym (`)

ints		empty integer vector (!0)
floats		empty float vector (0#0.)
syms		empty sym vector (0#`)</pre>
</blockquote>

<h3>Commands (I)</h3>

<p>F has the following interactive commands:</p>

<blockquote>
    <pre>".."		comment		1 "skip" 2	comment not processed

"b"		break		'x "b"		signal error ('x)
"c"		clear		1 2 "c" 3 4	clear, load f, prelude
"d"		defined		'foo "d"	is foo defined?
"e"		error		0 "e"		set/unset error trap (\e)
"f"		F		"f" 2 unit!	set F semantics, clear
"j"		Joy		"j" 2 unit	set Joy semantics, clear
"k"		K		1 2 "k" 3 4	exit to K
"l"		load		'x "l"		load f/x.f|x.j
"m"		measure		[10&lt;] "m"	measure time in ms
"o"		words		'map "o"	show word form
"p"		precision	3 "p"		print precision (\p)
"r"		read		1 2 "r" 3 4	read, parse, eval
"s"		store		y 'x "s"	store f/x.f|x.j
"t"		trace		null "t" 3 4	set trace-list (T)
"u"		undefine	x "u"		undefine vars in x
"v"		variables	1 2 "v" 3 4	show vars (!environment)
"x"		exit		1 2 "x" 3 4	_exit 0
"w"		write		1 2 "w" 3 4	format, write
"z"		halt		1 2 "z" 3 4	: to continue
</pre></blockquote>

<h3>Names and numbers</h3>

<p>Spaces (<em>blank</em>, <em>tab</em>, <em>return</em>) are
necessary to separate names from names and numbers from numbers,
but not names from numbers.</p>

<p>A name must begin with a letter and may contain letters, .,
or a single -.  A name containing a - is a shuffle-symbol.</p>

<p>A numerical expression must begin with either a digit or - 
followed by a digit, and must end with a digit.  A floating-point 
numerical expression must contain exactly one . which
must be flanked by digits.</p>

<h3>Operators</h3>

<p>The math, logic, and relational operators are <em>atomic
functions</em>. For example,</p>

<blockquote>
    <pre>F&gt;[1 2 3][[4 5 6] 7 8]+
[[5 6 7] 9 11]</pre>
</blockquote>

<p>In several instances, distinct K operations have been mapped
to one symbol: </p>

<blockquote>
    <pre>int &lt;			enum			!x
~atom &lt;			upgrade			&lt;x
atom &lt;			nonce

int/ints @		where			&amp;x
list @			flip			+x
			nonce

atom y ?		mod			y!x
~atom y ?		find			x?y

list atom \		rotate			y!x
atom list \		drop			x _ y
atom atom \		drop			x _(),y
list list \		cut			x _ y

1=#x .			infra
x .			index/monad/dyad	. x</pre>
</blockquote>

<h3>Iterators</h3>

<p>The False combinators <em>if</em> and <em>while</em> have been
eliminated, and <em>cond</em>, <em>if</em>, and <em>while</em>
have been defined as words in the prelude. The truth-values of F
are more general than those of K: 0 is <em>false</em>, any other
value is <em>true</em>.</p>

<h3>Assignment</h3>

<p>Assignment has the form <em>value unassigned_name</em>. An
assigned name may not be re-assigned.</p>

<p>Reserved names cannot be assigned:</p>

<blockquote>
    <pre>F&gt;12 inf
12 inf</pre>
</blockquote>

<p>Use of an assigned name (a variable) places the value assigned
to it on the stack:</p>

<blockquote>
    <pre>F&gt;10 a

F&gt;a
10
F&gt;12 a
10 12 10
F&gt;a
10 12 10 10</pre>
</blockquote>

<p>A symbol can be produced indirectly:</p>

<blockquote>
    <pre>F&gt;10 foo

F&gt;foo
10
F&gt;[foo] first!
foo
F&gt;!
10</pre>
</blockquote>

<h3>Quotation</h3>

<p>The <em>quote</em> primitive ' takes the next item on the
queue and quotes it:</p>

<blockquote>
    <pre>F&gt;'+
[+]
F&gt;
F&gt;'[1 2 3]
[[1 2 3]]
F&gt;
F&gt;''
[']</pre>
</blockquote>

<p>The <em>unquote</em> combinator ! is Joy's <em>i</em>. ! takes
the top item <em>x</em> on the stack and prepends the elements of
<em>x</em> to the queue:</p>

<blockquote>
    <pre>F&gt;2 3 '+ !
5</pre>
</blockquote>

<p>The <em>dip</em> combinator is defined as it is in Joy. `
takes the top two items <em>x</em> <em>y</em> on the stack and</p></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="http://www.nsl.com/k/f/f.htm">http://www.nsl.com/k/f/f.htm</a></em></p>]]>
            </description>
            <link>http://www.nsl.com/k/f/f.htm</link>
            <guid isPermaLink="false">hacker-news-small-sites-24238846</guid>
            <pubDate>Fri, 21 Aug 2020 21:01:25 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Fast.ai releases new deep learning course]]>
            </title>
            <description>
<![CDATA[
Score 609 | Comments 67 (<a href="https://news.ycombinator.com/item?id=24237207">thread link</a>) | @amardeep
<br/>
August 21, 2020 | https://www.fast.ai/2020/08/21/fastai2-launch/ | <a href="https://web.archive.org/web/*/https://www.fast.ai/2020/08/21/fastai2-launch/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
      <div>
  
  <p><span>Written: 21 Aug 2020 by <i>Jeremy Howard</i></span></p><p>fast.ai is a self-funded research, software development, and teaching lab, focused on making deep learning more accessible. We make all of our software, research papers, and courses freely available with no ads. We pay all of our costs out of our own pockets, and take no grants or donations, so you can be sure we’re truly independent.</p>

<p>Today is fast.ai’s biggest day in our four year history. We are releasing:</p>

<ul>
  <li><a href="https://docs.fast.ai/">fastai v2</a>: A complete rewrite of fastai which is faster, easier, and more flexible, implementing new approaches to deep learning framework design, as discussed in the peer reviewed fastai <a href="https://www.mdpi.com/2078-2489/11/2/108/htm">academic paper</a></li>
  <li><a href="https://fastcore.fast.ai/">fastcore</a>, <a href="https://fastscript.fast.ai/">fastscript</a>, and <a href="https://fastgpu.fast.ai/">fastgpu</a>: Foundational libraries used in fastai v2, and useful for many programmers and data scientists</li>
  <li><a href="https://course.fast.ai/">Practical Deep Learning for Coders</a> (2020 course, part 1): Incorporating both an introduction to machine learning, and deep learning, and production and deployment of data products</li>
  <li><a href="https://www.amazon.com/Deep-Learning-Coders-fastai-PyTorch/dp/1492045527">Deep Learning for Coders with fastai and PyTorch: AI Applications Without a PhD</a>: A book from O’Reilly, which covers the same material as the course (including the content planned for part 2 of the course)</li>
</ul>

<p>Also, in case you missed it, earlier this week we released the <a href="https://ethics.fast.ai/">Practical Data Ethics</a> course, which focuses on topics that are both urgent and practical.</p>

<h3 id="contents">Contents</h3>

<ul id="markdown-toc">
  <li><a href="#fastai-v2" id="markdown-toc-fastai-v2">fastai v2</a></li>
  <li><a href="#practical-deep-learning-for-coders-the-course" id="markdown-toc-practical-deep-learning-for-coders-the-course">Practical Deep Learning for Coders, the course</a></li>
  <li><a href="#deep-learning-for-coders-with-fastai-and-pytorch-the-book" id="markdown-toc-deep-learning-for-coders-with-fastai-and-pytorch-the-book">Deep Learning for Coders with fastai and PyTorch, the book</a></li>
  <li><a href="#fastcore-fastscript-and-fastgpu" id="markdown-toc-fastcore-fastscript-and-fastgpu">fastcore, fastscript, and fastgpu</a>    <ul>
      <li><a href="#fastcore" id="markdown-toc-fastcore">fastcore</a></li>
      <li><a href="#fastscript" id="markdown-toc-fastscript">fastscript</a></li>
      <li><a href="#fastgpu" id="markdown-toc-fastgpu">fastgpu</a></li>
    </ul>
  </li>
  <li><a href="#acknowledgements" id="markdown-toc-acknowledgements">Acknowledgements</a></li>
</ul>

<h2 id="fastai-v2">fastai v2</h2>

<p>fastai is a deep learning library which provides practitioners with high-level components that can quickly and easily provide state-of-the-art results in standard deep learning domains, and provides researchers with low-level components that can be mixed and matched to build new approaches. It aims to do both things without substantial compromises in ease of use, flexibility, or performance. This is possible thanks to a carefully layered architecture, which expresses common underlying patterns of many deep learning and data processing techniques in terms of decoupled abstractions. These abstractions can be expressed concisely and clearly by leveraging the dynamism of the underlying Python language and the flexibility of the PyTorch library. fastai includes:</p>

<ul>
  <li>A new type dispatch system for Python along with a semantic type hierarchy for tensors</li>
  <li>A GPU-optimized computer vision library which can be extended in pure Python</li>
  <li>An optimizer which refactors out the common functionality of modern optimizers into two basic pieces, allowing optimization algorithms to be implemented in 45 lines of code</li>
  <li>A novel 2-way callback system that can access any part of the data, model, or optimizer and change it at any point during training</li>
  <li>A new data block API</li>
  <li>And much more…</li>
</ul>

<figure>
  <img srcset="https://www.fast.ai/images/layered.png 2w" sizes="1px" src="https://www.fast.ai/images/layered.png">
  
  <figcaption>fastai's layered architecture</figcaption>
  
</figure>

<p>fastai is organized around two main design goals: to be approachable and rapidly productive, while also being deeply hackable and configurable. It is built on top of a hierarchy of lower-level APIs which provide composable building blocks. This way, a user wanting to rewrite part of the high-level API or add particular behavior to suit their needs does not have to learn how to use the lowest level.</p>

<p>To see what’s possible with fastai, take a look at the <a href="https://docs.fast.ai/quick_start.html">Quick Start</a>, which shows how to use around 5 lines of code to build an image classifier, an image segmentation model, a text sentiment model, a recommendation system, and a tabular model. For each of the applications, the code is much the same.</p>

<figure>
  <img srcset="https://www.fast.ai/images/segmentation-fastai.png 2w" sizes="1px" src="https://www.fast.ai/images/segmentation-fastai.png">
  
  <figcaption>Example of using fastai for image segmentation</figcaption>
  
</figure>

<p>Read through the <a href="https://docs.fast.ai/tutorial">Tutorials</a> to learn how to train your own models on your own datasets. Use the navigation sidebar to look through the fastai documentation. Every class, function, and method is documented here. To learn about the design and motivation of the library, read the <a href="https://www.mdpi.com/2078-2489/11/2/108/htm">peer reviewed paper</a>, or watch <a href="https://youtu.be/bHVqO5YyNbU">this presentation</a> summarizing some of the key design points.</p>

<p>All fast.ai projects, including fastai, are built with <a href="https://nbdev.fast.ai/">nbdev</a>, which is a full <a href="https://www.fast.ai/2019/12/02/nbdev/">literate programming environment</a> built on Jupyter Notebooks. That means that every piece of documentation can be accessed as interactive Jupyter notebooks, and every documentation page includes a link to open it directly on Google Colab to allow for experimentation and customization.</p>

<p>It’s very easy to migrate from plain PyTorch, Ignite, or any other PyTorch-based library, or even to use fastai in conjunction with other libraries. Generally, you’ll be able to use all your existing data processing code, but will be able to reduce the amount of code you require for training, and more easily take advantage of modern best practices. Here are migration guides from some popular libraries to help you on your way: <a href="https://docs.fast.ai/migrating_pytorch">Plain PyTorch</a>; <a href="https://docs.fast.ai/migrating_ignite">Ignite</a>; <a href="https://docs.fast.ai/migrating_lightning">Lightning</a>; <a href="https://docs.fast.ai/migrating_catalyst">Catalyst</a>. And because it’s easy to combine and part of the fastai framework with your existing code and libraries, you can just pick the bits you want. For instance, you could use fastai’s GPU-accelerated computer vision library, along with your own training loop.</p>

<p>fastai includes many modules that add functionality, generally through callbacks. Thanks to the flexible infrastructure, these all work together, so you can pick and choose what you need (and add your own), including: <a href="https://arxiv.org/abs/1710.09412">mixup</a> and <a href="https://arxiv.org/abs/1708.04552">cutout</a> augmentation, a uniquely flexible <a href="https://docs.fast.ai/vision.gan.html">GAN training</a> framework, a range of schedulers (many of which aren’t available in any other framework) including support for fine tuning following the approach described in <a href="https://arxiv.org/abs/1801.06146">ULMFiT</a>, mixed precision, gradient accumulation, support for a range of logging frameworks like Tensorboard (with particularly strong support for Weights and Biases, as <a href="https://app.wandb.ai/borisd13/demo_config/reports/Visualize-track-compare-Fastai-models--Vmlldzo4MzAyNA">demonstrated here</a>), <a href="http://docs.fast.ai/medical.imaging">medical imaging</a>, and much more. Other functionality is added through the <a href="https://github.com/nestordemeure/fastai-extensions-repository">fastai ecosystem</a>, such as support for <a href="https://ohmeow.github.io/blurr/">HuggingFace Transformers</a> (which can also be done manually, as shown in <a href="http://docs.fast.ai/tutorial.transformers">this tutorial</a>), <a href="https://github.com/rbracco/fastai2_audio">audio</a>, <a href="https://muellerzr.github.io/fastinference/inference/">accelerated inference</a>, and so forth.</p>

<figure>
  <img srcset="https://www.fast.ai/images/medical-fastai.png 2w" sizes="1px" src="https://www.fast.ai/images/medical-fastai.png">
  
  <figcaption>Medical imaging in fastai</figcaption>
  
</figure>

<p>There’s already some great learning material made available for fastai v2 by the community, such as the “Zero to Hero” series by Zach Mueller: <a href="https://muellerzr.github.io/fastblog/2020/08/20/_08_21-beginner.html">part 1</a>; <a href="https://muellerzr.github.io/fastblog/2020/08/20/_08_21-intermediate.html">part 2</a>.</p>

<h2 id="practical-deep-learning-for-coders-the-course">Practical Deep Learning for Coders, the course</h2>

<p>Previous fast.ai courses have been studied by hundreds of thousands of students, from all walks of life, from all parts of the world. Many students have told us about how they’ve become <a href="https://forums.fast.ai/t/my-first-gold-medal/54237">multiple gold medal winners</a> of <a href="https://towardsdatascience.com/my-3-year-journey-from-zero-python-to-deep-learning-competition-master-6605c188eec7">international machine learning competitions</a>, <a href="https://forums.fast.ai/t/how-has-your-journey-been-so-far-learners/6480/2">received offers</a> from top companies, and <a href="https://icml-compbio.github.io/2020/papers/WCBICML2020_paper_67.pdf">having</a> <a href="https://ui.adsabs.harvard.edu/abs/2020EGUGA..2221465A/abstract">research</a> <a href="https://arxiv.org/pdf/2004.14356.pdf">papers</a> <a href="https://pubs.rsna.org/doi/abs/10.1148/ryai.2019190113?journalCode=ai">published</a>. For instance, Isaac Dimitrovsky <a href="https://forums.fast.ai/t/thanks-ra2-dream-challenge-win/76875">told us</a> that he had “<em>been playing around with ML for a couple of years without really grokking it… [then] went through the fast.ai part 1 course late last year, and it clicked for me</em>”. He went on to achieve first place in the prestigious international <a href="https://www.synapse.org/#!Synapse:syn20545111/wiki/594083">RA2-DREAM Challenge</a> competition! He developed a <a href="https://www.synapse.org/#!Synapse:syn21478998/wiki/604432">multistage deep learning method</a> for scoring radiographic hand and foot joint damage in rheumatoid arthritis, taking advantage of the fastai library.</p>

<p><a href="https://course.fast.ai/">This year’s course</a> takes things even further. It incorporates both machine learning and deep learning in a single course, covering topics like random forests, gradient boosting, test and validation sets, and p values, which previously were in a separate machine learning course. In addition, production and deployment are also covered, including material on developing a web-based GUI for our own deep learning powered apps. The only prerequisite is high-school math, and a year of coding experience (preferably in Python). The course was recorded live, in conjunction with the <a href="https://www.usfca.edu/data-institute">Data Institute</a> at the University of San Francisco.</p>

<p>After finishing this course you will know:</p>

<ul>
  <li>How to train models that achieve state-of-the-art results in:
    <ul>
      <li>Computer vision, including image classification (e.g.,classifying pet photos by breed), and image localization and detection (e.g.,finding where the animals in an image are)</li>
      <li>Natural language processing (NLP), including document classification (e.g.,movie review sentiment analysis) and language modeling</li>
      <li>Tabular data (e.g.,sales prediction) with categorical data, continuous data, and mixed data, including time series</li>
      <li>Collaborative filtering (e.g.,movie recommendation)</li>
    </ul>
  </li>
  <li>How to turn your models into web applications, and deploy them</li>
  <li>Why and how deep learning models work, and how to use that knowledge to improve the accuracy, speed, and reliability of your models</li>
  <li>The latest deep learning techniques that really matter in practice</li>
  <li>How to implement stochastic gradient descent and a complete training loop from scratch</li>
  <li>How to think about the ethical implications of your work, to help ensure that you’re making the world a better place and that your work isn’t misused for harm</li>
</ul>

<p>We care a lot about teaching, using a <a href="https://www.fast.ai/2016/10/08/teaching-philosophy/">whole game</a> approach. In this course, we start by showing how to use a complete, working, very usable, state-of-the-art deep learning network to solve real-world problems, using simple, expressive tools. And then we gradually dig deeper and deeper into understanding how those tools are made, and how the tools that make those tools are made, and so on. We always teach through examples. We ensure that there is a context and a purpose that you can understand intuitively, rather than starting with algebraic symbol manipulation. We also dive right into the details, showing you how to build all the components of a deep learning model from scratch, including discussing performance and optimization details.</p>

<p>The whole course can be completed for free without any installation, by taking advantage of the guides for the Colab and Gradient platforms, which provide free, GPU-powered Notebooks.</p>

<h2 id="deep-learning-for-coders-with-fastai-and-pytorch-the-book">Deep Learning for Coders with fastai and PyTorch, the book</h2>

<p>To understand what the new book is about, and who it’s for, let’s see what others have said about it… Soumith Chintala, the co-creator of PyTorch, said in <a href="https://www.fast.ai/2020/08/20/soumith-forward/">the foreword</a> to  <a href="https://www.amazon.com/Deep-Learning-Coders-fastai-PyTorch/dp/1492045527">Deep Learning for Coders with fastai and PyTorch</a>:</p>

<blockquote>
  <p>But unlike me, Jeremy and …</p></blockquote></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://www.fast.ai/2020/08/21/fastai2-launch/">https://www.fast.ai/2020/08/21/fastai2-launch/</a></em></p>]]>
            </description>
            <link>https://www.fast.ai/2020/08/21/fastai2-launch/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24237207</guid>
            <pubDate>Fri, 21 Aug 2020 17:51:36 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Efficiency is dangerous and slowing down makes life better]]>
            </title>
            <description>
<![CDATA[
Score 606 | Comments 268 (<a href="https://news.ycombinator.com/item?id=24236489">thread link</a>) | @joubert
<br/>
August 21, 2020 | https://psyche.co/ideas/why-efficiency-is-dangerous-and-slowing-down-makes-life-better | <a href="https://web.archive.org/web/*/https://psyche.co/ideas/why-efficiency-is-dangerous-and-slowing-down-makes-life-better">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><div><blockquote>â€˜Slow down, you move too fast <em>â€¦</em>â€™ <br>â€“ â€˜The 59th Street Bridge Song (Feelinâ€™ Groovy)â€™ (1966) by Paul Simon</blockquote>
<p><strong>We worship efficiency</strong>. Use less to get more. Same-day delivery. Multitask; text on one device while emailing on a second, and perhaps conversing on a third. Efficiency is seen as good. Inefficiency as wasteful.</p>
<p>Thereâ€™s a sound rationale for thinking this way. Economists teach us that increased efficiency is the major way to improve our standard of living. If your company gives you a pay rise without becoming more efficient, it will also have to raise its prices to make up the shortfall. If all companies do the same, everyone ends up running in place â€“ youâ€™ll need your higher wages to match the higher prices of the things you buy. So, if we want to make material progress, we must become more efficient. Streamlined supply chains, just-in-time deliveries and no slack in the workforce all serve to raise efficiency. Achieve this, and all our lives will get better and better, or so weâ€™re promised.</p>
<p>For automobile manufacturers, who wish to squeeze as many miles per gallon as possible out of their car designs, air resistance and the grab of the road are the enemies of efficiency. In the world of finance, it is at the point of exchange that most friction arises. Before money, the potato farmer had to use sacks of potatoes to trade for eggs and milk. As the British historian Niall Ferguson reminds us in his <a href="https://www.penguin.co.uk/books/178/178638/the-ascent-of-money/9780141990262.html">book</a> <em>The Ascent of Money</em> (2008), the invention of money went a long way toward reducing this inefficiency, and much that has happened in the financial world over the past 200 years can be seen as a continuation of that revolution.</p>
<p>Credit, for example, meant that you could go shopping for eggs and milk even without having the money right now. Financial markets have since taken this efficiency to another level. The creation of â€˜option marketsâ€™ means that you donâ€™t have to go to the trouble of buying a stock that youâ€™re going to be selling soon anyway. You can just promise to buy it, and then sell it at a price and date specified by the option contract. And then you can trade the option rather than the underlying stock.</p>
<p>Each of these developments and many others have made it easier to do oneâ€™s business without wasted time and energy â€“ without friction. Each has made economic transactions quicker and more efficient. Thatâ€™s obviously good in some ways. But the financial crisis of 2008 suggested that maybe there could be too much of a good thing. If mortgages and other loans hadnâ€™t been transformed into tradable assets (â€˜securitiesâ€™), then bankers might have taken the time to assess the credit-worthiness of each applicant. If people had to visit a bank to withdraw cash, they might spend less and save more. This is not mere speculation â€“ for instance, <a href="https://doi.org/10.1002/(SICI)1099-0771(199909)12:3%3c183::AID-BDM318%3e3.0.CO;2-F">research</a> <a href="https://doi.org/10.1016/0167-2681(80)90051-7">reviewed</a> by the Nobel Prize-winning economist Richard Thaler shows that people will pay more for an item with a credit card than with cash. Arguably, a little friction to slow us down would have enabled both institutions and individuals to make better financial decisions.</p>
<p>A decade ago, the American psychologist Adam Grant and I argued in a journal <a href="https://journals.sagepub.com/doi/full/10.1177/1745691610393523?url_ver=Z39.88-2003&amp;rfr_id=ori:rid:crossref.org&amp;rfr_dat=cr_pub%20%200pubmed">paper</a> that this â€˜too much of a good thingâ€™ phenomenon might be a general rule. Some motivation produces excellent performance; too much motivation produces choking. Some group collaboration produces cohesion and enhances productivity; too much of it leads to staleness. Some empathy enables you to understand what another person is going through; too much could prevent you from saying and doing hard things. Similarly, in my <a href="https://www.harpercollins.com/products/the-paradox-of-choice-barry-schwartz?variant=32207920234530">book</a> <em>The Paradox of Choice</em> (2004), I argued that, whereas a life with no freedom to choose is not worth living, a life with too much choice leads to paralysis, bad decisions and dissatisfaction. Finding the right amount â€“ what Aristotle called the â€˜meanâ€™ â€“ of motivation, collaboration, empathy, choice and many other aspects of life, including efficiency, is a key challenge we face, both as individuals and as a society.</p>
<p>To be better prepared next time, we need to learn to live less efficiently in the here and now</p>
<p>But finding the mean isnâ€™t easy. As the English poet William Blake observed in <em>The Marriage of Heaven and Hell</em> (1790-93): â€˜You never know what is enough unless you know what is more than enough.â€™</p>
<p><strong>If the financial crisis</strong> taught us that we had become too efficient with our transactions, what of the COVID-19 pandemic? Why hadnâ€™t we stockpiled key supplies and machines, built up hospital capacity, or ensured the robustness of our supply chains? The reason, of course, is that it would have been seen as inefficient and profit-robbing. Money spent on masks and gowns gathering dust in a warehouse could always be put to more â€˜productiveâ€™ use in the marketplace. Likewise, employing more people than needed under â€˜ordinaryâ€™ circumstances, or making products yourself rather than relying on international supply chains, would have been seen as inefficient. One lesson, then, is that to be better prepared next time, we need to learn to live less â€˜efficientlyâ€™ in the here and now.</p>
<p>Seen in this light, at least some inefficiency is like an insurance policy. Think about your own situation. Every year that you donâ€™t get into a car accident and your house doesnâ€™t burn down and you stay healthy, you could think to yourself that you have â€˜wastedâ€™ your money on various pointless insurance products, and that youâ€™d be financially better off without all those insurance premiums to pay.</p>
<p>Most of us donâ€™t like the sense that weâ€™re wasting money on insurance. We would rather be wearing that money, or eating it, or driving it. Some years ago, with a struggle, I convinced my ageing mother to supplement her basic health insurance policy with a more comprehensive insurance product. Her resources were modest and the policy wasnâ€™t cheap. The year went by and, happily, she had no serious medical conditions that required the use of the extra cover. When the time came to renew, my mother resisted, because, indeed, the money she spent the year before had been â€˜wastedâ€™. My reply, perhaps unduly snarky, was to suggest to her that maybe the next year she would get lucky, have a really serious illness, and get her moneyâ€™s worth out of her insurance.</p>
<p>Thankfully, in many domains, government regulations protect us from our desire for ever-greater personal financial efficiency by forcing us to have insurance. Laws require that our cars be insured, and mortgagers require the same for our homes. In the United States, â€˜Obamacareâ€™ (the Affordable Care Act enacted in 2010, designed to increase the number of US citizens covered by health insurance) essentially compelled people to have health insurance, until the Supreme Court challenged this aspect of the Act as unconstitutional. I suspect that many of us are underinsured in general, but the problem would be much worse without these various, state-imposed insurance requirements.</p>
<p>One way to think about insurance, however inefficient it might feel, is that it enables us to be resilient against shocks that could befall us from a world that is radically uncertain. And the world <em>is</em> radically uncertain. As the British economists John Kay and Mervyn King point out in their <a href="https://wwnorton.com/books/9781324004776">book</a> <em>Radical Uncertainty</em> (2020), efforts to quantify risk by attaching probabilities to various unlikely future states of the world are mostly science fiction. The world is much messier than a roulette wheel or a pair of dice.</p>
<p>A little bit of friction can forestall disaster when you encounter an icy road</p>
<p><strong>What should we do</strong> in the face of this radical uncertainty? When making decisions, instead of asking ourselves which option will give us the best results, we should be asking which option will give us good-enough results under the widest range of future states of the world. Instead of trying to maximise return on investment in our retirement account, we should be setting a financial goal and then choosing investments that will allow us to achieve that goal under the widest set of future financial circumstances. Instead of looking for the â€˜bestâ€™ job, we should be looking for a job that will be good enough â€“ satisfying enough â€“ as co-workers and managers come and go, and the future economy gyrates. Instead of choosing the best college to go to, we should be choosing a college that will be good enough, even with an obnoxious roommate and a boring Bio 1 teacher.</p>
<p>The term used to describe this approach to decision-making is <em>satisficing</em>. And satisficing with an eye toward a radically uncertain future might be called <em>robust satisficing</em>. Satisficing is a form of insurance â€“ insurance against financial meltdowns, global pandemics, nasty bosses, boring teachers and crappy roommates. Insurance can seem stodgy â€“ like the guy who wears a belt <em>and</em> suspenders. Perhaps we donâ€™t need both, but what happens if we have neither?</p>
<p>I think the real flaw in capitalism revealed by the 2008 financial crisis was its unbridled, single-minded pursuit of profit and efficiency. And perhaps the real flaw revealed in our lack of readiness for the 2019-20 pandemic was a manifestation of the same thing. Capitalism neednâ€™t be either unbridled or single-minded. It isnâ€™t in other societies with high standards of living, and it hasnâ€™t been at all points in history in the US. So perhaps itâ€™s time to rekindle certain social norms that serve to slow us down. For example, if people thought about their homes less as financial investments and more as places to live, full of the friction of kids, dogs, friends, neighbours and community, there might be less property speculation with an eye toward buying and selling houses merely for profit. If companies felt the friction of being caretakers of their communities, they might look differently at streamlining their operations by eliminating jobs.</p>
<p>Weâ€™d all like a car that gets 100 miles to a gallon. The forces of …</p></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://psyche.co/ideas/why-efficiency-is-dangerous-and-slowing-down-makes-life-better">https://psyche.co/ideas/why-efficiency-is-dangerous-and-slowing-down-makes-life-better</a></em></p>]]>
            </description>
            <link>https://psyche.co/ideas/why-efficiency-is-dangerous-and-slowing-down-makes-life-better</link>
            <guid isPermaLink="false">hacker-news-small-sites-24236489</guid>
            <pubDate>Fri, 21 Aug 2020 16:43:29 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[But I was helping the compiler]]>
            </title>
            <description>
<![CDATA[
Score 69 | Comments 38 (<a href="https://news.ycombinator.com/item?id=24235783">thread link</a>) | @aw1621107
<br/>
August 21, 2020 | https://pankajraghav.com/2020/08/16/RVO.html | <a href="https://web.archive.org/web/*/https://pankajraghav.com/2020/08/16/RVO.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <p>Compilers are getting better with each release. Sometimes a noticeable difference can be observed in the assembly output for the same piece code in a different version of the same compiler (can be easily done via <a href="https://godbolt.org/">compiler explore</a>).</p>

<p>I have gotten into the practice of checking the assembly output lately to analyze the overhead of various implementations. Beware, sometimes it can get addictive. But I think it is a nice way of learning to read assembly and also be amazed at how clever the compilers are these days.</p>

<p>In this article, I am going to cover one such incident that happened when I was looking at the assembly output of a function during my <a href="https://github.com/Panky-codes/CHIP8">CHIP8</a> implementation.</p>

<p>But the context of the problem first!</p>

<h2 id="the-magic-of-move-semantics">The magic of move semantics</h2>
<p>Move semantics was introduced in C++11. We can think of move semantics as a way of transferring ownership of an object. If you are really new to move semantics, consider the following example:</p>

<p>So your colleague has a document that you also want. We have two options here. The first option, you take that document to a copier, take a copy of the document for yourself, and return the original document to your colleague. The second option, assuming your colleague doesn’t need the document anymore, instead of throwing it away, your colleague can give it to you, thereby, saving paper.</p>

<p>Replace the document with a memory resource in a program, then the first option is doing a copy, and the second option is doing a move, where you transfer the ownership instead of wasting the resource.</p>
<h2 id="putting-what-i-learned-in-action">Putting what I learned in action</h2>
<p>While implementing my <a href="https://github.com/Panky-codes/CHIP8">CHIP8</a> emulator, I saw an opportunity to replace an expensive copy operation into a cheap move operation (at least that is what I thought).</p>

<p>To give a bit of context: In each frame cycle, I had to return an array containing 2048 integers that will be used to draw the graphics on the screen. The pseudo-C++ code is shown below:</p>

<div><div><pre><code><span>// chip8.cpp</span>
<span>static</span> <span>constexpr</span> <span>display_size</span> <span>=</span> <span>2048</span><span>;</span>
<span>class</span> <span>Chip8</span> <span>{</span>
    <span>...</span> 
    <span>public</span> <span>:</span> 
        <span>std</span><span>::</span><span>array</span><span>&lt;</span><span>uint8_t</span><span>,</span> <span>display_size</span><span>&gt;</span> <span>get_display_pixels</span><span>()</span> <span>{</span>
              <span>// Do some computation</span>
              <span>return</span> <span>gfx</span><span>;</span>
          <span>}</span>
    <span>...</span> 
    <span>private</span> <span>:</span> 
        <span>std</span><span>::</span><span>array</span><span>&lt;</span><span>uint8_t</span><span>,</span> <span>display_size</span><span>&gt;</span> <span>gfx</span><span>{};</span>
<span>};</span>

<span>// main.cpp</span>
<span>while</span> <span>(</span><span>displayOn</span><span>)</span> <span>{</span>
    <span>...</span> 
    <span>const</span> <span>auto</span> <span>disp_pixels</span> <span>=</span> <span>emulator</span><span>.</span><span>get_display_pixels</span><span>();</span>
    <span>...</span>
    <span>// Use disp_pixels to draw pixels on the screen</span>
<span>}</span>
</code></pre></div></div>

<p>This is what I assumed was going on when I did the call to <code>get_display_pixels()</code> member function:</p>
<ol>
  <li>The compiler <code>copies</code> the <code>gfx</code> private variable of the <code>Chip8</code> class to the return value of the <code>get_display_pixels()</code> member function.</li>
  <li>The compiler calls the <code>copy constructor</code> to copy the return value of the function call to the <code>disp_pixels</code> variable.</li>
</ol>

<p>So, I concluded that I could use a <code>move constructor</code> to transfer the contents to my local variable <code>disp_pixels</code> to avoid a copy in the second step as described above.</p>

<p>So I changed my code in the <code>main</code> function as follows:</p>
<div><div><pre><code><span>// main.cpp</span>
<span>while</span> <span>(</span><span>displayOn</span><span>)</span> <span>{</span>
    <span>...</span> 
    <span>const</span> <span>auto</span> <span>disp_pixels</span> <span>=</span> <span>std</span><span>::</span><span>move</span><span>(</span><span>emulator</span><span>.</span><span>get_display_pixels</span><span>());</span>
    <span>...</span>
    <span>// Use disp_pixels to draw pixels on the screen</span>
<span>}</span>
</code></pre></div></div>

<p>Before you get furious and stop reading the article further because what I assumed was completely wrong, I realized that too, and the rest of the article is about that.</p>

<p>As soon as I used a <code>std::move</code> as shown in my previous code snippet, I observed the compiler was generating more assembly code than my initial code without a <code>std::move</code>(with std::move: <a href="https://godbolt.org/z/WulpDX">link</a>, without std::move: <a href="https://godbolt.org/z/oU8Tq4">link</a>).</p>

<p>What went wrong? Hmm….</p>
<h2 id="nrvo-to-the-rescue">NRVO to the rescue</h2>
<p>NRVO stands for Named Return Value Optimization. It is a nice trick that the compiler uses to omit unnecessary copy or move if certain conditions are met. Compilers have been using this trick for a long time. If <code>NRVO</code> takes place in our function call, then effectively we just do one copy instead of two. Let’s see how it works.</p>

<p>Even though the function signature of <code>get_display_pixels</code> indicates that it does not take any parameters, the compiler will pass one extra parameter behind the scenes from the caller (initialization call of <code>disp_pixels</code> from <code>main.cpp</code>) to the callee (<code>get_display_pixels</code> function in <code>chip8.cpp</code>). The caller will allocate the memory for the return value and pass the address of that memory to the callee. The callee will use that memory to construct the object and copy the value of the private variable <code>gfx</code> (in this case). As the memory of the caller (<code>disp_pixels</code>) was used by the callee, there is no need to copy the return value again, thereby, saving one unnecessary copy/move operation.</p>

<p>We should see the assembly output to really understand how <code>NRVO</code> is happening under the hood. The assembly code from the caller side is as follows:</p>
<div><div><pre><code><span>1</span>   <span>lea</span>  <span>rax</span><span>,</span> <span>[</span><span>rbp</span><span>-</span><span>16384</span><span>]</span>
<span>2</span>   <span>lea</span>  <span>rdx</span><span>,</span> <span>[</span><span>rbp</span><span>-</span><span>8192</span><span>]</span>
<span>3</span>   <span>mov</span>  <span>rsi</span><span>,</span> <span>rdx</span>
<span>4</span>   <span>mov</span>  <span>rdi</span><span>,</span> <span>rax</span>
<span>5</span>   <span>call</span> <span>Chip8</span><span>::</span><span>get_display_pixels</span><span>()</span>
</code></pre></div></div>
<p>Before the function call, <code>rsi</code> and <code>rdi</code> registers are loaded with upper and lower bound of the memory address of the <code>disp_pixels</code> variable. And, the trimmed assembly output from the callee side is as follows:</p>

<div><div><pre><code><span>1</span>   <span>Chip8</span><span>::</span><span>get_display_pixels</span><span>()</span><span>:</span>
<span>2</span>   <span>push</span> <span>rbp</span>
<span>3</span>   <span>mov</span>  <span>rbp</span><span>,</span> <span>rsp</span>
<span>4</span>   <span>mov</span>  <span>QWORD</span> <span>PTR</span> <span>[</span><span>rbp</span><span>-</span><span>8</span><span>],</span> <span>rdi</span>
<span>5</span>   <span>mov</span>  <span>QWORD</span> <span>PTR</span> <span>[</span><span>rbp</span><span>-</span><span>16</span><span>],</span> <span>rsi</span>
<span>...</span>
</code></pre></div></div>
<p>As seen from the callee side, the <code>rdi</code> and <code>rsi</code> values are moved to the stack, and further operations are performed with that memory address. Pretty neat!</p>

<p>A <code>simple analogy</code> for <code>NRVO</code> I like to think of is when you are asking a friend to fill in water inside a water bottle, you would give your bottle to fill water from the tap directly. It would be inefficient to first fill the water in a temporary bottle and transfer the contents again to your bottle. In the C++ context, <code>bottle</code> is the <code>memory space</code> and the <code>water</code> it holds is the <code>return value</code>.</p>

<p>If we assume that the  <code>NRVO</code> will take place, then the most efficient way of writing my function call is:</p>
<div><div><pre><code><span>// main.cpp</span>
<span>while</span> <span>(</span><span>displayOn</span><span>)</span> <span>{</span>
    <span>...</span> 
    <span>const</span> <span>auto</span> <span>disp_pixels</span> <span>=</span> <span>emulator</span><span>.</span><span>get_display_pixels</span><span>();</span>
    <span>...</span>
    <span>// Use disp_pixels to draw pixels on the screen</span>
<span>}</span>
</code></pre></div></div>
<p>GCC and Clang even have an extra warning flag <code>-Wpessimizing-move</code> which detects when we are trying to use a <code>move</code> where compiler-generated NRVO is much more efficient.</p>

<p>Even though we can assume in many situations that a <code>NRVO</code> will take place, especially if optimizations are turned on, C++ standard does not guarantee <code>NRVO</code> in all situations<sup>1</sup>. But what if compiler does not perform a <code>NRVO</code>?</p>
<h2 id="lvalues-and-rvalues-and-all-other-value-categories-in-between">Lvalues and Rvalues (and all other value categories in between)</h2>
<p>Even though there are some <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2020/p2025r0.html">proposals</a> to guarantee <code>NRVO</code>, it is not yet guaranteed by the standard. As it is not guaranteed, should we explicitly indicate a move operation to save a copy just in case the compiler doesn’t do a <code>NRVO</code>? To answer that, I added the flag <code>-fno-elide-constructors</code> that disables copy elision (the super-set of NRVO) in our code, thereby, allowing to see what the compiler does otherwise.</p>

<p>I was surprised to see that compiler was still performing a <code>NRVO</code> for <code>C++17</code> standard with <code>-fno-elide-constructors</code> enabled. But this was not the case for <code>C++14</code>, the compiler generated different assembly with <code>-fno-elide-constructors</code> enabled. If someone knows the reason why this difference occurs between <code>C++17</code> and <code>C++14</code> even though <code>NRVO</code> is not guaranteed, please email me about it. Godbolt <a href="https://godbolt.org/z/hPW3rh">link</a>.</p>

<p>Let’s use <code>C++14</code> with <code>-fno-elide-constructors</code> flag to simulate the scenario where the compiler fails to apply <code>NRVO</code> so that we can check whether we needed to do something extra to avoid superfluous copies.</p>

<p>So I added <code>-fno-elide-constructors</code> to disable any <code>NRVO</code> to the final code of the previous section. The caller generated the following assembly code:</p>

<div><div><pre><code><span>1</span>   <span>lea</span>  <span>rdx</span><span>,</span> <span>[</span><span>rbp</span><span>-</span><span>8192</span><span>]</span>
<span>2</span>   <span>lea</span>  <span>rax</span><span>,</span> <span>[</span><span>rbp</span><span>-</span><span>16384</span><span>]</span>
<span>3</span>   <span>mov</span>  <span>rsi</span><span>,</span> <span>rdx</span>
<span>4</span>   <span>mov</span>  <span>rdi</span><span>,</span> <span>rax</span>
<span>5</span>   <span>call</span> <span>Chip8</span><span>::</span><span>get_display</span><span>()</span>
<span>6</span>   <span>lea</span>  <span>rdx</span><span>,</span> <span>[</span><span>rbp</span><span>-</span><span>8192</span><span>]</span>
<span>7</span>   <span>lea</span>  <span>rax</span><span>,</span> <span>[</span><span>rbp</span><span>-</span><span>16384</span><span>]</span>
<span>8</span>   <span>mov</span>  <span>rsi</span><span>,</span> <span>rdx</span>
<span>9</span>   <span>mov</span>  <span>rdi</span><span>,</span> <span>rax</span>
<span>10</span>  <span>call</span> <span>std</span><span>::</span><span>array</span><span>&lt;</span><span>unsigned</span> <span>char</span><span>,</span> <span>32ul</span><span>&gt;::</span><span>array</span><span>(</span><span>std</span><span>::</span><span>array</span><span>&lt;</span><span>unsigned</span> <span>char</span><span>,</span> <span>32ul</span><span>&gt;&amp;&amp;</span><span>)</span>
</code></pre></div></div>

<p>As we can notice, the first 5 assembly instructions are the same as the version with NRVO enabled, and there are 5 more assembly instructions in this version as we disabled NRVO. The most important instruction we need to focus on is line number 10 where a <code>move constructor</code>(notice <code>&amp;&amp;</code> in the function signature). Wait, a <code>move constructor</code> is invoked? I did not use a <code>std::move</code> but the compiler decided to do it anyway. To really comprehend the reason, we need to understand <code>value categories</code> in C++.</p>

<p>In these two articles: <a href="https://eli.thegreenplace.net/2011/12/15/understanding-lvalues-and-rvalues-in-c-and-c">Understanding lvalues and rvalues in C and C++ </a> and <a href="http://eel.is/c++draft/basic.lval#1">basic.lval#1</a>, value categories are explained in detail<sup>2</sup>. In brief, quoting from the first article: “An lvalue (locator value) represents an object that occupies some identifiable location in memory. Rvalue is an expression that does not represent an object occupying some identifiable location in memory.”. Of course, there are more categories than just a <code>lvalue</code> and a <code>rvalue</code>. I would highly recommend reading both articles. Though you don’t need a perfect grasp of them to understand what comes later in this article. Let’s get back to our original example and analyze why the move constructor was called.</p>

<div><div><pre><code><span>// main.cpp</span>
<span>while</span> <span>(</span><span>displayOn</span><span>)</span> <span>{</span>
    <span>...</span> 
    <span>const</span> <span>auto</span> <span>disp_pixels</span> <span>=</span> <span>emulator</span><span>.</span><span>get_display_pixels</span><span>();</span>
    <span>...</span>
    <span>// Use disp_pixels to draw pixels on the screen</span>
<span>}</span>
</code></pre></div></div>
<p>In the above code snippet, the function call to <code>get_display_pixels</code> belongs to the <code>rvalue</code> (more precisely a <code>prvalue</code>) category and it generates a temporary. The compiler can now safely <code>move</code> that temporary into the <code>disp_pixels</code> variable because that temporary will be destroyed anyway after this statement. If the type that is being returned does not have a move constructor (in our case <code>std::array</code> has a move constructor), then the compiler will call the <code>copy constructor</code>.</p>

<p>In principle, if any of the <code>moveable</code> types (standard or user-defined) is returned from a function by <code>value</code>, we can safely assume either <code>NRVO</code> or <code>move operation</code> will take place resulting in no superfluous copies for standard compilers that support <code>C++11</code> and above.</p></div></article></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://pankajraghav.com/2020/08/16/RVO.html">https://pankajraghav.com/2020/08/16/RVO.html</a></em></p>]]>
            </description>
            <link>https://pankajraghav.com/2020/08/16/RVO.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24235783</guid>
            <pubDate>Fri, 21 Aug 2020 15:41:19 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Splitgraph Data Delivery Network – query over 40k public datasets]]>
            </title>
            <description>
<![CDATA[
Score 281 | Comments 85 (<a href="https://news.ycombinator.com/item?id=24233948">thread link</a>) | @mildbyte
<br/>
August 21, 2020 | https://www.splitgraph.com/blog/data-delivery-network-launch | <a href="https://web.archive.org/web/*/https://www.splitgraph.com/blog/data-delivery-network-launch">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><section><article><div><nav><ol><li><a href="#usage" as="#usage">Usage</a><ol><li><a href="#connecting" as="#connecting">Connecting</a></li><li><a href="#workspaces" as="#workspaces">Workspaces</a></li><li><a href="#running-queries" as="#running-queries">Running queries</a></li></ol></li><li><a href="#behind-the-scenes" as="#behind-the-scenes">Behind the scenes</a></li><li><a href="#future-and-roadmap" as="#future-and-roadmap">Future and roadmap</a></li><li><a href="#conclusion" as="#conclusion">Conclusion</a></li></ol></nav><p>Today, we are announcing the next step for Splitgraph: the <a href="https://www.splitgraph.com/connect" as="https://www.splitgraph.com/connect"><strong>Splitgraph Data Delivery Network</strong></a>.</p><p>The Splitgraph DDN is a single SQL endpoint that lets you query over 40,000 public datasets hosted on or proxied by Splitgraph.</p><p>You can connect to it from most PostgreSQL clients and BI tools <strong>without having to install anything else</strong>. It supports all read-only SQL constructs, including filters and aggregations. It even lets you run joins across distinct datasets.</p><p>In this post, we will give you a quick introduction to the DDN as well as discuss how it works behind the scenes and our plan for its future.</p><section><h3 id="usage">Usage</h3><section><h4 id="connecting">Connecting</h4><p>The endpoint is at <code>postgresql://data.splitgraph.com:5432/ddn</code>. You will need a Splitgraph API key and secret to access it.</p><p>You don't need to install anything to use the endpoint. If you go to your Splitgraph <a href="https://www.splitgraph.com/connect" as="https://www.splitgraph.com/connect">account settings</a>, you can generate a pair of credentials. You can then plug them into your SQL client.</p><p>If you're already using the <a href="https://www.splitgraph.com/docs/architecture/sgr-client"><code>sgr</code> client</a> and had registered for Splitgraph before, you can check your <code>.sgconfig</code> file for the API keys. You can also upgrade your client to version 0.2.0 with <code>sgr upgrade</code> and run <code>sgr cloud sql</code> to get a libpq-compatible connection string.</p><p><a href="https://www.splitgraph.com/docs/getting-started/installation">Installing Splitgraph locally</a> will let you snapshot these datasets and use them in <a href="https://www.splitgraph.com/docs/concepts/splitfiles">Splitfiles</a>.</p><p>There are more setup methods available in <a href="https://www.splitgraph.com/docs/splitgraph-cloud/data-delivery-network">our documentation</a>. This includes connecting to Splitgraph with clients like DBeaver, BI tools like Metabase or Google Data Studio or even other databases through ODBC.</p></section><section><h4 id="workspaces">Workspaces</h4><p>When you connect to Splitgraph, your SQL client will show you some schemas. These are data repositories featured on our <a href="https://www.splitgraph.com/explore">explore page</a> as well as datasets that you upload to Splitgraph.</p><p>We call this feature "workspaces". It works by implementing the <a href="https://en.wikipedia.org/wiki/Information_schema" as="https://en.wikipedia.org/wiki/Information_schema">ANSI information schema</a> standard. We'll expand on workspaces more in the future. For example, we'll let you:</p><ul><li>bookmark repositories that you want to show up in your workspace</li><li>allow you to have multiple workspaces and manage access to them</li><li>search for Splitgraph repositories directly from your SQL client.</li></ul></section><section><h4 id="running-queries">Running queries</h4><p>You can run queries on Splitgraph images by referencing them as PostgreSQL schemata: <code>namespace/repository[:hash_or_tag]</code>. By default, we query the <code>latest</code> tag.</p><p>For example, if you want to query the <a href="https://www.splitgraph.com/cityofchicago/covid19-daily-cases-deaths-and-hospitalizations-naz8-j4nc" as="https://www.splitgraph.com/cityofchicago/covid19-daily-cases-deaths-and-hospitalizations-naz8-j4nc"><code>cityofchicago/covid19-daily-cases-deaths-and-hospitalizations-naz8-j4nc</code> repository</a>, proxied by Splitgraph to <a href="https://data.cityofchicago.org/Health-Human-Services/COVID-19-Daily-Cases-and-Deaths/naz8-j4nc" as="https://data.cityofchicago.org/Health-Human-Services/COVID-19-Daily-Cases-and-Deaths/naz8-j4nc">Socrata</a>, you can run:</p><pre><code metastring=""><span>SELECT</span> <span>*</span> <span>FROM</span>
    <span>"cityofchicago/covid19-daily-cases-deaths-and-hospitalizations-naz8-j4nc"</span><span>.</span>covid19_daily_cases_deaths_and_hospitalizations
</code></pre><p>We let you use SQL <code>SELECT</code> and <code>EXPLAIN</code> statements. You can use any SQL clauses, including group-bys, aggregations, filters and joins. Splitgraph pushes filters down to the origin data source.</p><p>This sample query that we used in our <a href="https://www.splitgraph.com/docs/ingesting-data/socrata#using-metabase-to-join-and-plot-data-from-multiple-data-portals" as="/docs/ingesting-data/socrata#using-metabase-to-join-and-plot-data-from-multiple-data-portals">Metabase demo</a> runs a JOIN between two datasets:</p><pre><code metastring=""><span>SELECT</span>
    cambridge_cases<span>.</span><span>date</span> <span>AS</span> <span>date</span><span>,</span>
    chicago_cases<span>.</span>cases_total <span>AS</span> chicago_daily_cases<span>,</span>
    cambridge_cases<span>.</span>new_positive_cases <span>AS</span> cambridge_daily_cases
<span>FROM</span>
    <span>"cityofchicago/covid19-daily-cases-deaths-and-hospitalizations-naz8-j4nc"</span><span>.</span>covid19_daily_cases_deaths_and_hospitalizations chicago_cases
<span>FULL</span> <span>OUTER</span> <span>JOIN</span>
    <span>"cambridgema-gov/covid19-cumulative-cases-by-date-tdt9-vq5y"</span><span>.</span>covid19_cumulative_cases_by_date cambridge_cases
<span>ON</span>
    date_trunc<span>(</span><span>'day'</span><span>,</span> chicago_cases<span>.</span>lab_report_date<span>)</span> <span>=</span> cambridge_cases<span>.</span><span>date</span>
<span>ORDER</span> <span>BY</span> <span>date</span> <span>ASC</span><span>;</span>
</code></pre><p>This will join the data between two distinct Socrata data portals (<a href="https://data.cityofchicago.org/Health-Human-Services/COVID-19-Daily-Cases-Deaths-and-Hospitalizations/naz8-j4nc" as="https://data.cityofchicago.org/Health-Human-Services/COVID-19-Daily-Cases-Deaths-and-Hospitalizations/naz8-j4nc">Chicago, IL</a> and <a href="https://data.cambridgema.gov/Public-Safety/COVID-19-Cumulative-Cases-by-Date/tdt9-vq5y" as="https://data.cambridgema.gov/Public-Safety/COVID-19-Cumulative-Cases-by-Date/tdt9-vq5y">Cambridge, MA</a>).</p><p><img src="https://raw.githubusercontent.com/splitgraph/splitgraph.com/master/content/docs/0900_splitgraph-cloud/images/sql-endpoint/2-dbeaver-join.png" alt="Splitgraph SQL endpoint JOIN query example"></p><p>We also support <a href="https://postgis.net/" as="https://postgis.net/">PostGIS</a>, letting you query and visualize geospatial data. For example, you can query the <a href="https://www.splitgraph.com/splitgraph/london_wards/" as="https://www.splitgraph.com/splitgraph/london_wards/">London ward boundary data</a> image as follows:</p><pre><code metastring=""><span>SELECT</span>
    name<span>,</span>
    gss_code<span>,</span>
    
    ST_Transform<span>(</span>ST_SetSRID<span>(</span>geom<span>,</span> <span>27700</span><span>)</span><span>,</span> <span>4326</span><span>)</span><span>,</span>
    
    ST_Area<span>(</span>ST_Transform<span>(</span>ST_SetSRID<span>(</span>geom<span>,</span> <span>27700</span><span>)</span><span>,</span> <span>3035</span><span>)</span><span>)</span> <span>/</span> <span>1000000</span> <span>AS</span> area_sqkm
<span>FROM</span>
    <span>"splitgraph/london_wards"</span><span>.</span>city_merged_2018
<span>ORDER</span> <span>BY</span> gss_code <span>ASC</span><span>;</span>
</code></pre><p><img src="https://raw.githubusercontent.com/splitgraph/splitgraph.com/master/content/docs/0900_splitgraph-cloud/images/sql-endpoint/3-dbeaver-geodata.png" alt="PostGIS data on Splitgraph DDN"></p><p>There are more sample queries on our <a href="https://www.splitgraph.com/connect" as="https://www.splitgraph.com/connect">Connect page</a>.</p></section></section><section><h3 id="behind-the-scenes">Behind the scenes</h3><p>The Splitgraph Data Delivery Network is the result of all the work we've put into the <a href="https://www.splitgraph.com/docs/architecture/sgr-client"><code>sgr</code> client</a> and the <a href="https://github.com/splitgraph/splitgraph" as="https://github.com/splitgraph/splitgraph">Splitgraph Core</a> code over the past two years.</p><p>It would also have not been possible without some other open source technologies.</p><p>We use PostgreSQL foreign data wrappers. They let us perform query execution and planning across federated data sources. We wrote about <a href="https://www.splitgraph.com/blog/foreign-data-wrappers">foreign data wrappers</a> before: they're powerful and underused!</p><p>We manage connections using a fork of <a href="https://www.pgbouncer.org/" as="https://www.pgbouncer.org">pgBouncer</a>, a PostgreSQL connection pooler. Our fork lets us perform authentication outside of PostgreSQL. We can issue and revoke API keys without having to manipulate database roles. Several inbound Splitgraph users can run queries as a single PostgreSQL user.</p><p>We also use pgBouncer to transform queries on the fly. We rewrite clients' introspection queries and let them reference Splitgraph images as PostgreSQL schemata.</p><p>Each client essentially operates within its own isolated virtual database. The obvious implementation of this would be spinning up one database per client. But our query transformations let us do this at a <strong>much lower infrastructure cost</strong>. We also use this feature to inspect and drop unwanted queries on the fly.</p><p>Finally, we use our own <code>sgr</code> client to orchestrate this. Splitgraph engines power the data delivery network. They manage foreign data wrapper instantiation and querying Splitgraph images via <a href="https://www.splitgraph.com/docs/large-datasets/layered-querying">layered querying</a>. In the future, we will use Splitgraph's <a href="https://www.splitgraph.com/docs/concepts/objects">storage format</a> to snapshot remote datasets or cache frequent queries.</p></section><section><h3 id="future-and-roadmap">Future and roadmap</h3><p>There are a lot of directions we would like to pursue with Splitgraph.</p><p>You will be able to use Splitgraph to <strong>replace some of your data lake or ETL pipelines</strong> and query the data at source. This is similar to the idea of "data virtualization". But, unlike other software in this space, Splitgraph uses an open PostgreSQL procotol. This makes it immediately compatible with most of your BI tools and dashboards. It won't lock you into a proprietary query language.</p><p>We will soon have the ability to add <a href="https://www.splitgraph.com/docs/splitgraph-cloud/external-repositories">external repositories</a> to public or on-premises Splitgraph data catalogs. You will be able to query any dataset indexed in this catalog over the single SQL endpoint or our <a href="https://www.splitgraph.com/docs/splitgraph-cloud/publish-rest-api">REST API</a>. You will be able to even use these datasets in <a href="https://www.splitgraph.com/concepts/splitfiles">Splitfiles</a>. This will let you define reproducible transformations on your data, enrich it with public datasets and track lineage.</p><p>You will be able to use Splitgraph as an <strong>SQL firewall and a rewrite layer</strong>. You won't need to use views to set up access policies for your data warehouse. Data consumers won't need to manage credentials to disjoint data silos. Splitgraph can inspect proxied queries and enforce granular access policies on individual columns. It will even be able to do PII masking and access auditing.</p><p>The single SQL endpoint is well suited for a <strong>data marketplace</strong>. Data vendors currently ship data in CSV files or other ad-hoc formats. They have to maintain pages of instructions on ingesting this data. With Splitgraph, data consumers will be able to acquire and interact with data directly from their applications and clients.</p></section><section><h3 id="conclusion">Conclusion</h3><p>Today, we launched the Splitgraph Data Delivery Network. It's a seamless experience of a single database with thousands of datasets at your fingertips, compatible with most existing clients and BI tools.</p><p>If you wish to try it out, you can get credentials to access it in less than a minute: just head on to the <a href="https://www.splitgraph.com/connect" as="https://www.splitgraph.com/connect">landing page</a>.</p><p>We're also building towards a <a href="https://www.splitgraph.com/about/company/private-cloud-beta">"Splitgraph Private Cloud" product</a> that will let setup your own private Splitgraph cluster, managed by us and deployed to the cloud region of your choice. <a href="mailto:support@splitgraph.com" as="mailto:support@splitgraph.com">Contact us</a> if you're interested!</p></section></div></article></section></div>]]>
            </description>
            <link>https://www.splitgraph.com/blog/data-delivery-network-launch</link>
            <guid isPermaLink="false">hacker-news-small-sites-24233948</guid>
            <pubDate>Fri, 21 Aug 2020 11:28:38 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[ReMarkable MicroSD (2019)]]>
            </title>
            <description>
<![CDATA[
Score 354 | Comments 120 (<a href="https://news.ycombinator.com/item?id=24232801">thread link</a>) | @devnonymous
<br/>
August 21, 2020 | http://www.davisr.me/projects/remarkable-microsd/ | <a href="https://web.archive.org/web/*/http://www.davisr.me/projects/remarkable-microsd/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
      
      <p>This page discusses how I added a microSD card to my <a href="https://arstechnica.com/gadgets/2017/12/remarkable-tablet-review-the-high-price-of-getting-that-paper-feeling/">reMarkable tablet</a>. I did this because I want to develop software for my rM without wearing out the internal eMMC. I chose an external card because I want to be able to swap them easily; it also makes backups faster.<br>
</p>
<img src="http://www.davisr.me/projects/remarkable-microsd/34.jpg" alt="Opened reMarkable tablet">




<h2><a name="opening">Opening the Case</a></h2>
<p>
The aluminum back panel is held to the plastic case with glue. I have 
not yet determined what melts this glue, or how to “properly” take the 
back off. I was able to lift it off, by starting slowly in a corner. 
Thereafter, I used a putty knife to slowly peel it away. The panel bent,
 but I was able to bend it mostly-flat again.
</p><p>
Next, there is a magnesium chassis screwed to the plastic case. 
Underneath the rubber feet are six silver screws. There are also XX 
black screws, that must be removed.
</p><p>
The epaper display is glued to the magnesium chassis; don’t try to pull 
it apart. There is also a white silicone-like substance around the edge 
of the epaper panel, which seems to disintegrate and flake off. I think 
it fills the gap, and perhaps offers a little waterproofing. This is 
non-replaceable. The screen can be pushed apart from the plastic 
chassis. It is held on the perimeter with plastic latches, so split it 
with a spudger and go slowly.
</p><p>
With the case off, the guts can be removed. There are five connectors to
 the logic board. In clockwise order starting at top-left: power button,
 touch panel, antenna, epaper display, USB daughterboard and buttons, 
and Wacom digitizer.
</p><p>
Finally, the logic board can be removed. It is held with six small 
screws and washers. Underneath the logic board is a plastic tape, a 
section of which must be removed around the SD pads.
</p>

<img src="http://www.davisr.me/projects/remarkable-microsd/mmc-pads.jpg" alt="MMC solder pads">

<h2>
<a name="positioning">Positioning the Card</a>
</h2>
<p>
The bottom-right seemed like an appropriate placement for the card 
socket, because the area is already spacious. The right side was easier 
to route the cables to, because of the channels cut in the white plastic
 case. I reassembled the reMarkable 
prior to soldering, to ensure no bulges or deformities appered.
</p>

<img src="http://www.davisr.me/projects/remarkable-microsd/placement.JPG" alt="Placing the microSD slot in the lower right corner">

<h2>
<a name="soldering">Soldering the Wires</a>
</h2>
<p>
Using ten 30 AWG wires and plenty of flux, I connected the board to the 
socket. The board indicates which pin is first. The board has a ninth 
pin, which is used for card-detect. This gets pulled low when a card is 
inserted.
</p>

<img src="http://www.davisr.me/projects/remarkable-microsd/flatcable.JPG" alt="Wires underneath logic board">
<p>
To keep things as flat as possible, I used cellophane tape to mate the 
wires to the board. They feed out beneath the digitizer’s FFC cable in 
one beautiful ribbon. This also prevents elecrical contact to the grounded chassis.<br>
</p>

<img src="http://www.davisr.me/projects/remarkable-microsd/wires.JPG" alt="Wires on back">

<h2>
<a name="cutting">Cutting the Case</a>
</h2>
<p>
I drilled the SD slot by-hand with a rotary tool. Starting with a carving bit
 on the inside, I first hollowed out the area to give me a thin veneer, 
measured with a flashlight. Once I felt it was thin enough, I drilled 
from the front with a pointy sanding bit, and cut longitudinally.</p><p>
The magnesium chassis had a small section removed, which was easy with a
 tiny wire cutter. While it sacrifices a little
 bit of strength, it makes up for it in storage capacity.
</p><p>
After testing the fit once again, I fillited epoxy around the edge 
of the socket, gluing it down. I was careful not to get any inside the 
socket.
</p>

<img src="http://www.davisr.me/projects/remarkable-microsd/externalshot.JPG" alt="microSD slot from the outside">

<h2>
<a name="loading">Loading the Kernel</a>
</h2>
<p>The stock rM kernel doesn't enable the SDHC1 slot, which is how these
 pins are designated in the device tree file. I recommend first being 
comforable with <a href="https://github.com/torwag/remarkableflash">this remarkable-flash guide</a>, the <a href="http://www.davisr.me/projects/remarkable-microsd/i.MX_BSP_Porting_Guide_Linux.pdf">NXP porting guide for the i.MX6 processor</a>, and the <a href="http://www.davisr.me/projects/remarkable-microsd/i.MX_Yocto_Project_User%27s_Guide_Linux.pdf">i.MX Yocto user guide</a>.<br>

</p>
  <p>The rM is a mostly-vanilla i.MX6 board (many share similaries, including the <a href="http://www.davisr.me/projects/remarkable-microsd/pico-imx6ul-emmc-hobbit-reva1-hardware-manual-20160328.pdf">Hobbitboard</a>).
 As such, it shares the same SDHC interface. What the microSD slot 
connects to, and what the stock kernel does not activate, is the SDHC1 
interface. This can be enabled in the device tree, and the kernel may be
 recompiled to include support for an SD card.<br>
  </p>
<p>
By default, the sdhc1 interface is disabled in the device tree. Enabling
 this is the first step. Copy the 
<code>arch/arm/boot/dts/zero-gravitas-factory.dts</code> over 
<code>arch/arm/boot/dts/zero-gravitas.dts</code>. Then, edit it to enable the sdhc1 
interface like shown in the diff below.
</p>
<pre> &amp;usdhc1 {<br>        pinctrl-names = "default", "state_100mhz", "state_200mhz";<br>        pinctrl-0 = &lt;&amp;pinctrl_usdhc1&gt;;<br>        pinctrl-1 = &lt;&amp;pinctrl_usdhc1_100mhz&gt;;<br>        pinctrl-2 = &lt;&amp;pinctrl_usdhc1_200mhz&gt;;<br>        bus-width = &lt;4&gt;;<br>        cd-gpios = &lt;&amp;gpio4 7 GPIO_ACTIVE_LOW&gt;;<br>        disable-wp;<br>        wp-controller;<br>        keep-power-in-suspend;<br>        enable-sdio-wakeup;<br>        no-1-8-v;<br>        /*disable-wp;*/<br>-       status = "disabled";<br>+       status = "okay";<br> };
</pre>


<p>Next, <code>make zero-gravitas_defconfig</code> and edit the <code>.config</code> file produced to include the following drivers.</p><pre>CONFIG_CFG80211=y
CONFIG_MAC80211=y
CONFIG_BRCMUTIL=y
CONFIG_BRCMFMAC=y
CONFIG_RTL_CARDS=y
CONFIG_BATTERY_BQ27XXX=y
CONFIG_BATTERY_BQ27XXX_I2C=y
CONFIG_USB_ACM=y
CONFIG_USB_F_ACM=y
CONFIG_USB_U_SERIAL=y
CONFIG_USB_CDC_COMPOSITE=y
CONFIG_CRYPTO_AEAD=y
CONFIG_CRYPTO_GF128MUL=y
CONFIG_CRYPTO_NULL=y
CONFIG_CRYPTO_CCM=y
CONFIG_CRYPTO_GCM=y
CONFIG_CRYPTO_SEQIV=y
CONFIG_CRYPTO_CTR=y
CONFIG_CRYPTO_GHASH=y
CONFIG_CRYPTO_ARC4=y
</pre>
<p>
Once done, rebuild the Linux kernel with <code>make</code>. Copy the artifacts to the rM's <code>/boot</code> directory: <code>arch/arm/boot/dts/zero-gravitas.dtb</code> and <code>arch/arm/boot/zImage</code>. I have included my artifacts <a href="http://www.davisr.me/projects/remarkable-microsd/boot.tar">here</a> for posterity, but it is foolish to install a kernel that someone else compiled.<br>
</p><p>
Reboot the rM, to make sure xochitl still runs. Then, check <code>dmesg | grep
 ‘mmc0’</code> to ensure the card was detected, and double-check it with <code>fdisk 
-l</code>. Partition your card as you like, then change the /etc/fstab option 
to mount that partition at /home.
</p>
<pre>root@reMarkable:~# dmesg | grep mmc0
[    2.091218] mmc0: SDHCI controller on 2190000.usdhc [2190000.usdhc] using DMA
[    2.377570] mmc0: new high speed SDXC card at address aaaa
[    2.391939] mmcblk0: mmc0:aaaa SC200 183 GiB 
</pre>
<pre>#/dev/mmcblk1p7 /home auto defaults,nofail 1 2
/dev/mmcblk0p7 /home auto defaults,nofail 1 2
</pre>
<p>
Reboot, and bask in the increased storage capacity.
</p>
<img src="http://www.davisr.me/projects/remarkable-microsd/storage-screen.png" alt="Storage screen showing 179 GB free">

<h2>
<a name="notes">Ending Notes</a>
</h2>
<ul>
<li>Now, the aluminum back is held on with gaffer tape. I am afraid to glue it shut, in case I want to access the guts again.
</li><li>Maybe the white stuff that came out around the bezel can be replaced with calk</li><li>I wish I had used multicolor wires, because it was difficult following them with my eyes.
</li><li>I didn’t cut close enough to the top of the plastic case, and 
so my SD slot is taller than it needs to be, but it isn't very 
noticable. I shimmed the extra vertical space with a folded up business 
card for a tighter fit.
</li><li>Before using solid-core wirewrap wire, I tried making my own 
ribbon cable with magenet wire and masking tape. This didn’t work well, 
because the enamel was hard to remove from just the ends, and the 
masking tape was too thick. The wirewrap wire turned out much nicer.
</li><li>Technically, I think the IMX needs to be changed too (and 
re-wrote over /dev/mmcblk1boot0) but I didn’t do this, and it seems to 
work alright. I'm fine using it just for the data partition so my OS updates work.
</li>
<li>I am glad this article has created encouragement from other people. I
 would like to extend an offer: if you would like a microSD card in your
 rM, and are willing to let me install one with the possibility of it 
not coming out exactly perfect (i.e. someone who finds ultimate use of 
rM in its utility, not pristine beauty) I would like to refine this 
process. One thing could be to install an internal card using quality 
flash media. I would like to know how many people could go for something
 like that, and if there could be a market doing that kind of thing. I 
will soon have installed my own CNC machine, and can practice doing this
 modification better, eventually charging for the service.<br>
</li>
</ul>

<h2><a name="images">More Images</a></h2>
<img src="http://www.davisr.me/projects/remarkable-microsd/backpanel.jpg" alt="Back panel">
<img src="http://www.davisr.me/projects/remarkable-microsd/connectors.jpg" alt="Connectors">
<img src="http://www.davisr.me/projects/remarkable-microsd/cracking-open.jpg" alt="Splitting the case open">
<img src="http://www.davisr.me/projects/remarkable-microsd/dontpullscreen.jpg" alt="Don't pull the screen like this">
<p>Don't peel the screen off!</p>
<img src="http://www.davisr.me/projects/remarkable-microsd/openback.jpg" alt="Open back">
<img src="http://www.davisr.me/projects/remarkable-microsd/split-chassis.jpg" alt="Split chassis">

</article></div>]]>
            </description>
            <link>http://www.davisr.me/projects/remarkable-microsd/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24232801</guid>
            <pubDate>Fri, 21 Aug 2020 07:20:06 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[How I got the French Tech Visa to start my company in France]]>
            </title>
            <description>
<![CDATA[
Score 147 | Comments 190 (<a href="https://news.ycombinator.com/item?id=24232025">thread link</a>) | @christpetron
<br/>
August 20, 2020 | https://christianpetroske.com/how-i-got-the-french-tech-visa-to-start-my-company-in-france/ | <a href="https://web.archive.org/web/*/https://christianpetroske.com/how-i-got-the-french-tech-visa-to-start-my-company-in-france/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>

		<div>

			
<p>Three years ago, things were different. I didn’t know any French, I didn’t have a business, and I didn’t have a job.</p>



<p>I had just quit a great job in Singapore to start my own company. My partner was starting her master’s in Paris and told me to come stay. So I packed up everything, shipped some of it to my mom in New York, and hopped on a flight to CDG.</p>



<figure><img src="http://christianpetroske.com/wp-content/uploads/2020/08/paris.png" alt="" srcset="https://christianpetroske.com/wp-content/uploads/2020/08/paris.png 878w, https://christianpetroske.com/wp-content/uploads/2020/08/paris-300x74.png 300w, https://christianpetroske.com/wp-content/uploads/2020/08/paris-768x191.png 768w" sizes="(max-width: 878px) 100vw, 878px"></figure>



<p>Around this time, French President Macron released an iconic video as part of the <a rel="noreferrer noopener" href="https://makeourplanetgreatagain.fr/en/business" target="_blank">Make Our Planet Great Again campaign</a>. He told scientists, researchers, and innovators from around the world to come to France. I was supposed to be an innovator now. My ears perked up.</p>



<p>“Your new homeland” it said. It continued: “Entrepreneurs and skilled employees from all over the world, France is made for you!”</p>



<p>Made for me, huh? Okay, I’ll bite.</p>



<p>I bit.</p>



<p>A few clicks later I found myself reading about <a rel="noreferrer noopener" href="https://lafrenchtech.com/en/how-france-helps-startups/french-tech-visa/" target="_blank">the French Tech Visa</a>, a visa scheme that awards founders of tech companies a visa for four years to live and start their business in France.</p>



<p>This seemed like the ultimate three-birds-one-stone: I would get to start my company, be with my partner, and live in effing Paris—learning French, discussing philosophy, eating croissants, whatever else people do in Paris. Life sorted for the next few years! Right?</p>



<p>In retrospect, I was right about the big stuff: starting the company, living with my partner, learning French, and the croissants (oh oui). </p>



<p>But it did not come easy. I learned a ton. I am incredibly grateful that it worked out. There were many moments when it almost didn’t. Through a combination of luck, hustle, privilege, and the kindness of others, I am where I am today: running my own business, living in France with my partner, speaking French, eating croissants, and looking back on it all muttering <em>putain</em> in happy disbelief.</p>



<p>Looking back too, I’m struck by how little information there was out there for people in my situation. I kept finding out critical information through chance conversations—and I’d done my research. I started thinking that the whole process should be a lot more transparent.</p>



<p>I’ve since had conversations with several people who were considering this path. So I decided to write down some of it to help others who are thinking about coming to France to start their company.</p>



<p>If that’s you, here are the basics of what you need to know. The challenge generally breaks down into 1) the visa, 2) the business, and 3) the language and culture.</p>



<p>(If you’re really serious about this, I’m writing a complete guide to the French Tech Visa which <a href="https://gum.co/SRUhE" target="_blank" rel="noreferrer noopener">you can preorder here</a>.)</p>



<h2>First: the visa</h2>



<p>There are three different French Tech visas: for <a rel="noreferrer noopener" href="https://lafrenchtech.com/en/how-france-helps-startups/french-tech-visa/visa-for-founders/" target="_blank">founders</a>, <a rel="noreferrer noopener" href="https://lafrenchtech.com/en/how-france-helps-startups/french-tech-visa/visa-for-employees/" target="_blank">employees</a>, and <a rel="noreferrer noopener" href="https://lafrenchtech.com/en/how-france-helps-startups/french-tech-visa/visa-for-les-investors/" target="_blank">investors</a>. I have the one for founders. That’s the one I know the most about, so it’s the one I focus on here.</p>



<p>The first step to getting the French Tech Visa for founders is to look at this list of incubators.</p>



<figure><a href="https://lafrenchtech.com/en/how-france-helps-startups/french-tech-visa/visa-for-founders/" target="_blank" rel="noopener noreferrer"><img src="http://christianpetroske.com/wp-content/uploads/2020/08/image-1024x707.png" alt="" srcset="https://christianpetroske.com/wp-content/uploads/2020/08/image-1024x707.png 1024w, https://christianpetroske.com/wp-content/uploads/2020/08/image-300x207.png 300w, https://christianpetroske.com/wp-content/uploads/2020/08/image-768x530.png 768w, https://christianpetroske.com/wp-content/uploads/2020/08/image-1536x1061.png 1536w, https://christianpetroske.com/wp-content/uploads/2020/08/image-2048x1414.png 2048w, https://christianpetroske.com/wp-content/uploads/2020/08/image-1200x829.png 1200w, https://christianpetroske.com/wp-content/uploads/2020/08/image-1980x1367.png 1980w" sizes="(max-width: 1024px) 100vw, 1024px"></a></figure>



<p>These incubators are all partnered with the French government to support foreign founders. The kind of support varies, but your goal is to find one that can offer you the visa.</p>



<p>One week, I decided I would do this. So I came up with a startup idea, made a pitch deck, website, and email address, and started sending emails. I reached out to probably 30 of these and had conversations with about 10 until it got down to 2-3 that seemed promising. </p>



<p>I just found the deck I made in Canva. It was an employee engagement app called Purpose, Go! (I know right?).</p>



<figure><img src="http://christianpetroske.com/wp-content/uploads/2020/08/image-2-1024x768.png" alt="" srcset="https://christianpetroske.com/wp-content/uploads/2020/08/image-2-1024x768.png 1024w, https://christianpetroske.com/wp-content/uploads/2020/08/image-2-300x225.png 300w, https://christianpetroske.com/wp-content/uploads/2020/08/image-2-768x576.png 768w, https://christianpetroske.com/wp-content/uploads/2020/08/image-2-1536x1152.png 1536w, https://christianpetroske.com/wp-content/uploads/2020/08/image-2-1200x900.png 1200w, https://christianpetroske.com/wp-content/uploads/2020/08/image-2.png 1754w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>Lol ok, not bad. How an app was supposed to accomplish that, lord knows.</figcaption></figure>



<p>I ended up on the phone with <a rel="noreferrer noopener" href="https://theschoolab.com/en/" target="_blank">Schoolab</a> in Paris, who said they liked my idea and told me to come in to meet the team. I met them, did a tour, and got offered a spot. It cost me €650 a month for their 6 month program, including the visa, access to the community of startups and mentors, and office space. I took the deal.</p>



<p>Fees vary by incubator, but overall you’ll need around €5,000 in the bank to pay for the incubator program plus taxes and fees in the application process.</p>



<p>Then, you’ll need to prove that you have money equal to the French minimum wage (€18,254.60 in 2019). I didn’t have this. Instead, you can find someone who does have this kind of money to be your “guarantor”. The visa office will accept it as long as that person signs a letter saying they will support you if needed while you’re in France.</p>



<p>Once you get into the incubator, they will help you apply to get your three-page business proposal approved by the relevant government agency. They even helped me translate mine into French. It takes a couple of months, but once you have that approval letter, you are on the fast track for a four year visa.</p>



<p>There are differences by country, but being a US citizen, I had to go back to my home consulate in New York to complete the visa process.</p>



<p>I arrived in France in August, started the incubator in September, and didn’t get my provisional visa until February… So that gives you an idea. </p>



<h2>Second: the business</h2>



<p>Once I was in the incubator, the next challenge arose: What the hell was I going to do with this business?</p>



<p>For about two solid months I worked on Purpose, Go! alongside various client projects to keep some money coming in. I networked hard in the HR tech world in Paris and got to know some interesting people. But it became clear that these relationships were not going anywhere—and without relationships, I had no hope of selling into businesses.</p>



<p>So I started spending more time with a friend I’d made in the program, <a rel="noreferrer noopener" href="https://plentyworks.io/outer-space-mindset/" target="_blank">Buddhika</a>, who was working on a VR fitness company. When it became clear my thing wasn’t going to work (and they were struggling a bit too), we started talking in earnest about partnering up. Becoming co-founders.</p>



<p>So I started to work with them on the VR fitness idea. It was clear it was going to take a while to mature into something that could make money, so we looked around for income sources. One of our friends in the program needed an app built, so we decided to go into software development. That’s what led to our real French company.</p>



<p>We started out as individual micro-entrepreneurs, since it’s super easy to get started and get paid legally through that status. Eventually, we opened up a SAS entity in what seemed like an extremely painful and expensive process. It didn’t need to be.</p>



<p>The perfect time to start a SAS (the equivalent of a US Corporation) is when you’re building something you want to raise money for at some point. We wanted to keep our options open, so we did that. </p>



<p>Many small businesses start as SARL entities (rough equivalent of a US LLC) instead, since taxes are lower but fundraising ability is null.</p>



<p>Whatever you choose, the most important (and most difficult) thing is to find a way to actually get paid in the first place. French business is highly networked, even more so than the US, which means that people like to only do business with people they have a relationship with. So investing in building relationships is the number one most important thing you can do for the success of your French business.</p>



<p>Speaking of which…</p>



<h2>Third: the language</h2>



<p>To build relationships with people, you will need some level of French. It’s certainly possible to only run in circles where you can speak English, don’t get me wrong. But you will miss opportunities if you’re constrained by language.</p>



<p>One of the first places you may run into this problem is when looking for an incubator. Schoolab, for instance, has since shrunk or canceled their English-language programming since I was there because it was too difficult to maintain programs in two languages (and they couldn’t get everyone to switch over to English). </p>



<p>So how do you learn French quickly, cheaply, and effectively?</p>



<p>This is exactly what I tried to do, being hyper-conscious that my runway was dwindling with each passing month. Here was my rough language-learning regimen that got me conversational in about 6 months:</p>



<ul><li>Start out with cheap private lessons through iTalki. You can spend $10-15 an hour for a junior teacher to talk with you and teach you core grammar principles and vocab.</li><li>Listen to French podcasts constantly. This is key to improving comprehension. Read the transcript along if you can. My favorites at the beginning were <a rel="noreferrer noopener" href="https://savoirs.rfi.fr/fr/apprendre-enseigner/langue-fran%C3%A7aise/journal-en-fran%C3%A7ais-facile" target="_blank">Le Journal en Français Facile from RFI</a>, <a rel="noreferrer noopener" href="https://podcasts.apple.com/gb/podcast/learn-french-by-podcast/id160256534" target="_blank">Learn French by Podcast</a>, and <a rel="noreferrer noopener" href="https://podcasts.apple.com/gb/podcast/coffee-break-french/id263170419" target="_blank">Coffee Break French</a>. Now I love <a rel="noreferrer noopener" href="https://www.lesechos.fr/podcasts/la-story" target="_blank">La Story by Les Echos</a>, <a rel="noreferrer noopener" href="https://www.binge.audio/podcast/a-bientot-de-te-revoir/" target="_blank">A bientôt de te revoir</a>, and many more.</li><li>Read French news and blogs. Focus on what you’re interested in. I’m interested in technology and startups so I would read <a rel="noreferrer noopener" href="https://www.maddyness.com/" target="_blank">Maddyness</a>.</li><li>Get grammar lessons from YouTube. My hands-down favorite here is <a rel="noreferrer noopener" href="https://learnfrenchwithalexa.com/" target="_blank">Learn French with Alexa</a>. She explains even the advanced concepts so clearly.</li><li>And of course, take every opportunity to talk to real people! Having friends who are willing to suffer through your awful French (and laugh at you a bit, yes) is one of the things that will accelerate your learning the most. Go to events you find on Facebook. Take a dance class. Get out there. The more uncomfortable you are with your language ability, the more motivated you will be to learn faster.</li></ul>



<p>There’s also the culture to get used to, but maybe we’ll save that one for another post. </p>



<p>It’s wild that I’m coming up on three years in France. It has been an adventure. Hopefully some of this will help others navigating this for the first time. </p>



<p>If you liked this story and you want to stay in touch, follow me on <a href="https://twitter.com/christpetron" target="_blank" rel="noreferrer noopener">Twitter</a>.</p>



<hr>



<p>I’m compiling all this info and more into <a rel="noreferrer noopener" href="https://gum.co/SRUhE" target="_blank">the Complete Guide to the French Tech Visa</a>, which <a rel="noreferrer noopener" href="https://gum.co/SRUhE" target="_blank">you can pre-order right here</a>. It includes:</p>



<ul><li>Step-by-step instructions on how to obtain your French Tech Visa</li><li>The full list of documents you’ll need</li><li>The full timeline of how long you can expect it to take</li><li>The full set of visa-related costs you’ll face</li><li>Step-by-step guidance on creating your French business entity (Micro-entrepreneur, SAS and SARL)</li><li>Important information on taxes, insurance, employment, and liability</li><li>Opening a personal …</li></ul></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://christianpetroske.com/how-i-got-the-french-tech-visa-to-start-my-company-in-france/">https://christianpetroske.com/how-i-got-the-french-tech-visa-to-start-my-company-in-france/</a></em></p>]]>
            </description>
            <link>https://christianpetroske.com/how-i-got-the-french-tech-visa-to-start-my-company-in-france/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24232025</guid>
            <pubDate>Fri, 21 Aug 2020 04:38:33 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Why Did Mozilla Remove XUL Add-Ons?]]>
            </title>
            <description>
<![CDATA[
Score 378 | Comments 302 (<a href="https://news.ycombinator.com/item?id=24231017">thread link</a>) | @est31
<br/>
August 20, 2020 | https://yoric.github.io/post/why-did-mozilla-remove-xul-addons/ | <a href="https://web.archive.org/web/*/https://yoric.github.io/post/why-did-mozilla-remove-xul-addons/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article><p>TL;DR: Firefox used to have a great extension mechanism based on the XUL and XPCOM. This mechanism served us well for a long time. However, it came at an ever-growing cost in terms of maintenance for both Firefox developers and add-on developers. On one side, this growing cost progressively killed any effort to make Firefox secure, fast or to try new things. On the other side, this growing cost progressively killed the community of add-on developers. Eventually, after spending years trying to protect this old add-on mechanism, Mozilla made the hard choice of removing this extension mechanism and replacing this with the less powerful but much more maintainable WebExtensions API. Thanks to this choice, Firefox developers can once again make the necessary changes to improve security, stability or speed.</p>

<p>During the past few days, I’ve been chatting with Firefox users, trying to separate fact from rumor regarding the consequences of the August 2020 Mozilla layoffs. One of the topics that came back a few times was the removal of XUL-based add-ons during the move to Firefox Quantum. I was very surprised to see that, years after it happened, some community members still felt hurt by this choice.</p>

<p>And then, as someone pointed out on reddit, I realized that we still haven’t taken the time to explain in-depth why we <em>had no choice</em> but to remove XUL-based add-ons.</p>

<p>So, if you’re ready for a dive into some of the internals of add-ons and Gecko, I’d like to take this opportunity to try and give you a bit more detail.</p>



<p>For a very long time, Firefox was composed of a very small core on top of which everything was implemented as extensions. Many of these extensions were written in C++, others in JavaScript and many involved the XUL interface language and the XBL binding language. C++ and JavaScript code were connected thanks to a technology called XPCOM. Whenever an extension developer wished to customize Firefox, it was simple and extremely powerful, as the exact same building blocks used to power Firefox could be used to customize it.</p>

<p>This is how Session Restore (the technology that lets you resume Firefox where you left it the last time, even in case of crash) or the Find Bar were first implemented in Firefox, among other features. This is the technology that powers Firefox and <a href="https://www.thunderbird.net/">Thunderbird</a>. This is how tools such as <a href="https://en.wikipedia.org/wiki/Songbird_(software)">Songbird</a> (an open-source iTunes competitor) or <a href="https://en.wikipedia.org/wiki/Instantbird">Instantbird</a> (a chat client) were developed. This is also how I customized Firefox to become an eBook reader a long time ago. And this is how thousands of Firefox add-ons were developed.</p>

<p>Many people call this extension mechanism “XUL-based Add-Ons”, or sometimes “XPCOM-based Add-Ons”, and I’ll use both terms in this blog entry, but I often think of this as the “Promiscuous Extension Mechanism”, for several reasons:</p>

<ul>
<li>very quickly, add-on developers realized that anything they did could break anything else in the system, including other add-ons and Firefox itself, and they often had no way to prevent this;</li>
<li>similarly, anything Firefox developers did could break add-ons, and they often had no way to prevent this;</li>
<li>also, some of the changes that Firefox needed to be as fast, as stable and as secure as possible were going to break most add-ons immediately, possibly all add-ons in the longer term;</li>
<li>oh, and by the way, since add-ons could do everything, they could very easily do anything to the operating system, from stealing passwords to pretending to be your bank.</li>
</ul>

<p>Note: Having read in comments that some users apparently do not care about security, let me add that being secure is a really, really important point for Mozilla and has been since the first day. Regardless of add-ons, <em>not</em> having security means that an exploit is eventually going to show up that will steal user’s passwords and use them to steal their bank accounts – and that exploit will get sold around and will soon show up everywhere. Firefox developers fight this threat daily by all sorts of means, including code reviews, defensive programming, crash scene investigations, several types of sandboxing, static analysis, memory-safe languages, … Consequently, for Mozilla, if a feature prevents us from achieving great security, we <em>always</em> pick security over features.</p>

<p>I’ll return to these points in more details later. For the moment, suffices to say that it had been clear to Firefox developers for a long time (at least since 2010) that this situation was untenable. So Mozilla came up with a backup plan called the <em>Firefox Jetpack</em>.</p>

<p>Firefox Jetpack was a very different manner of extending Firefox. It was much cleaner. It finally had a permissions mechanism (something that had been suggested even before Firefox was called Firefox and that was generally considered too hard to implement). Out of the box, add-ons could not break each other or Firefox (I seem to remember that it was still sometimes possible by exploiting the observer service, but you had to work hard at it), it made extensive use of async programming (which was great to achieve a feeling of high-performance) and thanks to the fact that it had a finite API, it could be tested, which meant that when Firefox developers broke add-ons, they knew about it immediately and could fix the breakages! That was several enormous steps forward. This came at the cost of a more limited API but in most cases, the tradeoff seemed worth it.</p>

<p>Unfortunately, it turned out that there was an unexpected incompatibility between the design of Jetpack and some of the major changes that were needed in Firefox. I’m not entirely clear about what this incompatibility was but this meant that we had to abandon Jetpack.
Instead, we introduced WebExtensions. Overall, WebExtensions had a similar objective as Jetpack-based add-ons, with a similarly restricted API and the added bonus that they could be made to work on both Chromium-based browsers and Firefox.</p>

<p>If you needed very advanced APIs, switching from the promiscuous extension mechanism to Jetpack or WebExtensions was not always possible, but for most extensions, the transition was simple – in my personal experience, it was even pleasant.</p>

<p>Firefox introduced WebExtensions in time for Firefox Quantum because this is when the promiscuous add-on model was scheduled to break.</p>

<p>At this stage, we’re done with the historical overview. I hope you’re ready for a more technical dive because that’s how I’m going to explain to you exactly which problems were solved as we switched from the promiscuous extension model to WebExtensions.</p>



<h2 id="how-it-started">How it started</h2>

<p>XPCOM, the Xross-Platform Component Object Model, is perhaps the feature of Firefox that can best be described as <em>the core</em> (for people who know Gecko in-depth, I’m counting XPConnect and the Cycle Collector as part of XPCOM), alongside SpiderMonkey, our JavaScript Virtual Machine.</p>

<p>XPCOM is a technology that lets you write code in two languages and have each other call the other. The code of Firefox is full of C++ calling JavaScript, JavaScript calling C++ and a long time ago, we had projects that added Python and .Net in the mix. This piece of machinery is extremely complicated because languages do not share the same definitions (what’s a 64-bit integer in JavaScript? what’s a JavaScript exception in C++?) or the same memory model (how do you handle a JavaScript object holding a reference to a C++ object that C++ might wish to <code>delete</code> from memory?) or the same concurrency model (JavaScript workers share nothing while C++ threads share everything).</p>

<p>Gecko itself was originally designed as thousands of XPCOM components that could each be implemented in C++ or in JavaScript, tested individually, plugged, unplugged or replaced dynamically and <em>it worked</em>. In addition, the XPCOM architecture made for much cleaner C++ programming than was available at the time, worked on dozens of platforms, and let us combine the convenience of writing code in JavaScript and the raw speed permitted by C++.</p>

<p>To write a XPCOM component, you typically define <a href="https://searchfox.org/mozilla-central/rev/6cc48251bb97600fdf11a5b4c5f621bfc8606d55/dom/interfaces/base/nsIFocusManager.idl">an interface</a>, then write the implementation in either C++ or JavaScript (or Rust, nowadays, and maybe soon Wasm). Some boilerplate is needed, but hey, it works.</p>

<p>When early Firefox developers decided to open the platform to extensions, XPCOM was immediately picked as the base technology for add-ons. Firefox just had to let add-on authors plug anywhere within the code and they would have tremendous power at their disposal.</p>

<p>And add-on developers (including myself) certainly did and had lots of fun with it!</p>

<h2 id="the-era-of-immutable-xpcom">…the era of immutable XPCOM</h2>

<p>Unfortunately, problems progressively started to creep up.</p>

<p>When you’re developing a large application, you need to change things, either to fix bugs or to add new features, or to improve performance. In the XPCOM world, this meant changing XPCOM components. Sometimes to add new features to a component. Sometimes to entirely remove one because this design has been replaced with a better design.</p>

<p>In the first era of the XPCOM-based extension mechanism, this was often forbiddden. If there was an XPCOM component used by add-ons, it simply <strong>could not</strong> be changed in incompatible ways. This was great for add-on developers but it quickly became a nightmare for Firefox developers. Because every single change had to be made in backwards-compatible way both externally (for web developers) and internally (for add-on developers). This meant that each XPCOM component <code>nsISomething</code> was quickly accompanied by a <code>nsISomething2</code>, which was the better component – and both needed to be made to work alongside each other - One case was even more complicated to handle by Firefox developers: XPCOM-based add-ons could replace <em>any existing XPCOM component</em>. Needless to say, this was a very good way to break Firefox in ways that puzzled Firefox crash investigators.</p>

<p>This meant that development became slower and slower as we needed to check each new feature or each improvement against not only current features, but also past/deprecated features or simply old ways to work …</p></article></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://yoric.github.io/post/why-did-mozilla-remove-xul-addons/">https://yoric.github.io/post/why-did-mozilla-remove-xul-addons/</a></em></p>]]>
            </description>
            <link>https://yoric.github.io/post/why-did-mozilla-remove-xul-addons/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24231017</guid>
            <pubDate>Fri, 21 Aug 2020 01:30:38 GMT</pubDate>
        </item>
    </channel>
</rss>
