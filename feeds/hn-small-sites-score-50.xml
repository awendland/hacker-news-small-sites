<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>
<![CDATA[Hacker News - Small Sites - Score >= 50]]>
        </title>
        <description>
<![CDATA[Hacker News stories from domains that aren't in the top 1M and that have a score of at least 50. Updated nightly via https://github.com/awendland/hacker-news-small-sites]]>
        </description>
        <link>https://news.ycombinator.com</link>
        <generator>RSS for Node</generator>
        <lastBuildDate>Thu, 06 Aug 2020 20:20:00 GMT</lastBuildDate>
        <atom:link href="https://raw.githubusercontent.com/awendland/hacker-news-small-sites/generated/feeds/hn-small-sites-score-50.xml" rel="self" type="application/rss+xml"></atom:link>
        <pubDate>Thu, 06 Aug 2020 20:20:00 GMT</pubDate>
        <language>
<![CDATA[en-US]]>
        </language>
        <managingEditor>
<![CDATA[me@alexwendland.com (Alex Wendland)]]>
        </managingEditor>
        <ttl>240</ttl>
        <item>
            <title>
<![CDATA[When Should You Not Use Rails?]]>
            </title>
            <description>
<![CDATA[
Score 52 | Comments 41 (<a href="https://news.ycombinator.com/item?id=24057715">thread link</a>) | @luu
<br/>
August 4, 2020 | http://codefol.io/posts/when-should-you-not-use-rails/ | <a href="https://web.archive.org/web/*/http://codefol.io/posts/when-should-you-not-use-rails/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
            <!-- .post-header -->
            <div>
                  
<figure>
    <p><img src="http://codefol.io/img/chimp_keyboard_aside_216_135.png" alt="A chimpanzee in a white coat types at a keyboard lit by glowing LEDs." width="216" height="135" title="He's gorgeous, yes. But is his talent natural&amp;hellip; or is it Ruby on Rails?">
    </p>

      <figcaption>
        He's gorgeous, yes. But is his talent natural… or is it Ruby on Rails?
        
        
      </figcaption>
</figure>

                <p>I was <a href="https://www.codewithjason.com/rails-with-jason-podcast/noah-gibbs-3/">recently on Jason Swett’s podcast again</a>. He’s a great interviewer and I always have fun with him.</p>

<p>By Twitter request we talked about… When would you <strong><em>not</em></strong> use Rails? It’s a great question.</p>

<p>For the entertaining version, <a href="https://www.codewithjason.com/rails-with-jason-podcast/noah-gibbs-3/">listen to the podcast</a>. For the just-the-facts extra-complete version, I’m writing this post.</p>

<h2>When Is Rails the Wrong Choice?</h2>

<p>I’ll start with a few simple, obvious times you wouldn’t use Rails, and then I’ll talk about some technically interesting times.</p>

<p>First, and most important, is team familiarity. If your team doesn’t already know Rails and isn’t especially interested in learning it then Rails is the wrong choice. This should be obvious, but it still deserves first billing.</p>

<p>Second, when you know some other framework fits better. I’ll talk more below about when that is. But sometimes you have a specific concern that trumps everything else. If you need to use a Java-language machine learning library and you don’t want to use JRuby for some reason, Rails isn’t your framework. If you’re writing a WordPress plugin, you’ll be doing it in PHP. Often there’s one specific compatibility concern that overrides everything else.</p>

<p>You can also think of it as: use it where Rails’ good points hold and its bad points don’t. So we’ll also talk about the good and bad points.</p>

<p>Separately: you’d normally only use Rails as an HTTP server, so some tasks just aren’t Rails-shaped.</p>

<h2>When is Rails Too Much?</h2>

<figure>
    <a href="https://rubymadscience.com/img/assistant_pirate_with_sphere_bigthumb.png">
      <img src="https://rubymadscience.com/img/assistant_pirate_with_sphere_bigthumb.png" alt="A pirate puppet with an eyepatch, safety goggles and a huge scraggly mustache watches over a purple crystal ball at his feet.'" title="He's too much lab assistant for your lab.">
    </a>
        <figcaption>He’s too much lab assistant for your lab.</figcaption> 
</figure>

<p>Some places not to use Rails can include:</p>

<p><strong>Really Small Tasks that Won’t Grow</strong>: if a server does very little, Rails is often too much. Not going to touch a database? Then the DB setup isn’t helping you, is it? Just a tiny low-traffic intermediate server with no caching? A lot of Rails is more trouble than it’s worth.</p>

<p>Be careful with tasks that grow, though — making a tiny server scale up to do a lot more can be ugly. If you’re already serving HTTP pages to a human with a web browser, consider that you may have to add features to it later. Something like <strong><em>that</em></strong> is already fairly large from the word “go”.</p>

<p><strong>When It’s ‘Just’ an API Server</strong>: Rails has less to offer an API server that speaks JSON over the wire. A lot of its HTTP security doesn’t matter for that case (e.g. SQL injection safeguards, XSS prevention.) While ActiveRecord can be nice for some database use cases, Rails really shines when you’re building an HTML site that talks to browsers. Very small projects that mostly speak a structured format read by machines will often get less from Rails.</p>

<p>Related to that is when you’re doing in-browser rendering and Rails is ‘just’ serving JSON. It’s a weird kind of in-between case. A lot of Rails security and convenience functions no longer help you, but you’re still doing things where internal libraries (ActiveRecord, ActiveJob, ActionMailer) can be highly useful. But if you’re never rendering HTML on the server and you’re very sure you never will, Rails will probably help you less.</p>

<h2>When Is Rails Not Enough?</h2>

<p>Rails is also designed for a small team and a medium-sized codebase. A huge team (lots of programmers) or a huge codebase (lots of controllers, models and/or lines of code) will tend to drag down the standard Rails-app structure.</p>

<p>Ruby allows for a <strong><em>lot</em></strong> of <a href="https://en.wikipedia.org/wiki/Side_effect_(computer_science)">non-local effects</a>. Whether that’s monkeypatching, writing to a database or creating new types at runtime, Ruby isn’t designed for a team of 200 programmers where you don’t trust some of them. There are too many ways for them to cause you trouble. You can use <a href="https://sorbet.org/">good tooling</a> to scale Ruby to larger teams, but even that will <a href="https://sorbet.org/docs/troubleshooting#escape-hatches">tend to have exceptions and difficulties</a>. That’s not really Ruby’s sweet spot.</p>

<p>In most cases you can cut up a large project into smaller projects. If one Rails app is too big, you can often separate it into multiple apps, or a thinner app with more back-end services, or an app and a separate microservice, or… One way or another there is usually a way to separate out smaller pieces. Ruby strongly encourages that, as do I.</p>

<p>There are also not-quite-Rails structures that can scale better. Avdi Grimm’s (now retired) <a href="https://www.goodreads.com/book/show/13481927-objects-on-rails">Objects on Rails</a> was an attempt in that direction, as is <a href="https://medium.com/@vsavkin/hexagonal-architecture-for-rails-developers-8b1fee64a613">the Hexagonal architecture for Rails</a>, which in turn has a lot in common with the older and more general <a href="https://en.wikipedia.org/wiki/Multitier_architecture">N-tier architecture</a>.</p>

<p>But at some point you might want to consider a different framework. <a href="https://hanamirb.org/">Hanami</a> is an obvious choice, designed to be less quick and nimble than Rails for getting a tiny app off the ground, but more scalable if you want to use the same code with a lot more contributors.</p>

<p>I’d still start out in Rails, personally. If you’re building something quickly to see if anybody cares, I know of no framework that comes close to its productivity. Wait to rewrite (in a more rigid framework) until you’re successful and you can afford the drag on your development speed.</p>

<p>The other worry here can be performance. If you’re rewriting a project that is already as large as the current Basecamp… then you’re <a href="https://m.signalvnoise.com/only-15-of-the-basecamp-operations-budget-is-spent-on-ruby/">actually fine for performance</a>. Rails still scales <strong><em>great</em></strong> for them. But if you’re looking at something a hundred times larger (which by definition means B2C, not B2B) then you might have a situation where your server costs are substantially greater than your engineering payroll. In that case it can make sense to slow down your engineers to pay lower server costs. To check this, see what your EC2-or-equivalent costs are <strong><em>just for your application servers</em></strong>, which are what run Rails. And check your payroll <strong><em>just for web engineers</em></strong>, which is who writes in Rails. Normally the engineering payroll is much larger and you should stick with trading cheap machine time for expensive engineering time. But at some point the balance may tip and you should consider raising your engineering payroll to cut your server costs.</p>

<h2>When Does Rails Have the Wrong Assumptions?</h2>

<figure>
    <a href="https://rubymadscience.com/img/dr_bear_microscope_bigthumb.png">
      <img src="https://rubymadscience.com/img/dr_bear_microscope_bigthumb.png" alt="A pirate, a bear and a chimp sit at a wicker table. The bear looks into a very old-fashioned microscope as the other two look on." title="They're checking the microscope for real-world use cases where Rails might be wrong.">
    </a>
        <figcaption>They’re checking the microscope for real-world use cases where Rails might be wrong.</figcaption> 
</figure>

<p>Before checking if Rails’ assumptions are right for you, we should see what those assumptions actually are.</p>

<p>Before you take my word for it, I recommend taking <a href="https://rubyonrails.org/doctrine/">David Heinemeier Hansson’s word for it</a> in the form of The Rails Doctrine. It’s a great document and it covers a lot of ground.</p>

<p>Indeed, if you want to better understand why Rails isn’t amazing for large, low-trust teams, you should read <a href="https://rubyonrails.org/doctrine/#provide-sharp-knives">“Provide Sharp Knives”</a> in the Rails Doctrine several times. A lot of Rails’ tradeoffs are entirely by design.</p>

<p>Rails also has some simpler assumptions: it assumes you’re writing an interactive app with server-rendered HTML. It assumes that security is vital (Rails trades a lot for security) but that you don’t want to build your own custom security system in most cases. And it assumes that you either have a small, excellent team doing prototyping work (“Provide Sharp Knives”) or that you have a possibly-mediocre team that needs powerful built-in guidelines (<a href="https://rubyonrails.org/doctrine/#omakase">“The Menu is Omakase.”</a>)</p>

<p>Rails also assumes you want high developer velocity at a cost of technical debt. In other words, it’s designed for building very quickly. That makes sense when <strong><em>technical execution is not your biggest risk</em></strong>. For instance: if you’re building a small startup, and you’re pretty sure you can build the site but people may not buy your product, you are dominated by market risk. That’s when Rails is perfect. You want to build very quickly. And even if you build perfectly, you’re probably going to have to throw away the result for nontechnical reasons, like “people don’t want to buy it.”</p>

<p>As part of “high dev velocity, technical debt is okay” Rails assumes things like, “you’ll want to use a lot of gems” and “dependencies that work are fine if they speed you up.”</p>

<p>Rails assumes you don’t mind scaling out application servers horizontally (by bringing more of them online.) It’s designed to scale well <strong><em>if</em></strong> you can do that. Rails assumes CPU is fairly cheap and it’s usually right about that. Relatedly, Rails assumes that the database is usually your most serious performance bottleneck, which is how web applications usually work.</p>

<p>Rails also assumes you’ll have some calculation or data transformation in your application. It assumes that it’s okay to use some CPU because you’ll be doing that anyway.</p>

<p>(When does that last assumption matter? Let’s talk about Evented Servers and see.)</p>

<h2>What Isn’t Rails Good At?</h2>

<figure>
    <a href="http://codefol.io/posts/when-should-you-not-use-rails/node_js_logo.png">
      <img src="http://codefol.io/posts/when-should-you-not-use-rails/node_js_logo.png" alt="The Node.js logo." title="Sometimes you need it, or something like it.">
    </a>
        <figcaption>Sometimes you need it, or something like it.</figcaption> 
</figure>

<p>While Rails is great at a lot of things, there’s one particular task that it’s not amazing for: shim servers.</p>

<p>By “shim servers” I mean servers that do very little calculation but integrate answers from a few other back-end services and relay the result. Imagine a server that queries two JSON services and combines the result with simple string-manipulation, for instance. It does very little calculation, but it juggles a lot of events.</p>

<p>And that’s the relevant word: “events.”</p>

<p>There is a specific kind of app architecture embodied by Node.js and its relatives called “Evented” programming. It can support many thousands, or even millions, of simultaneous connections with a tiny amount of server resources. It can be both high-throughput and low-latency. Its benchmark numbers are matchless… for the cases where it works.</p>

<p>Rails can’t match Evented programming at what Evented programming is good at. Basically no framework can. There are Evented frameworks for Ruby (e.g. <a href="https://github.com/eventmachine/eventmachine">EventMachine</a>, <a href="https://github.com/socketry/async">Async</a>.) Rails is built differently.</p>

<p>If Evented is so much better, why don’t we use it for everything? Because it doesn’t work for everything. I emphasise calculation per-request because an Evented server will fall down and die if you try to make it do very much calculation per-request. Having one server handle a million connections is no good if each connection …</p></div></article></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="http://codefol.io/posts/when-should-you-not-use-rails/">http://codefol.io/posts/when-should-you-not-use-rails/</a></em></p>]]>
            </description>
            <link>http://codefol.io/posts/when-should-you-not-use-rails/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24057715</guid>
            <pubDate>Wed, 05 Aug 2020 06:03:30 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Fundamental Axiom of Floating Point Arithmetic]]>
            </title>
            <description>
<![CDATA[
Score 85 | Comments 31 (<a href="https://news.ycombinator.com/item?id=24057293">thread link</a>) | @johnbcoughlin
<br/>
August 4, 2020 | http://www.johnbcoughlin.com/posts/floating-point-axiom/ | <a href="https://web.archive.org/web/*/http://www.johnbcoughlin.com/posts/floating-point-axiom/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="content">
            

            

<p>If you’ve been a software engineer for long enough, it is very likely that you’ve seen this example of floating point perfidy:</p>
<div><pre><code data-lang="python">&gt;&gt;&gt; <span>3.0</span> / <span>10</span>
<span>0.3</span>
&gt;&gt;&gt; <span>0.1</span> * <span>3</span>
<span>0.30000000000000004</span>
</code></pre></div><p>We understand that this is due to the fact that floating point numbers, stored
with only 64 bits of precision, cannot represent the entire real number line.
Moreover, when we perform operations with these floating point numbers, the
errors inherent in their representation can accumulate and multiply. The moral
of the story is, never use a floating point number to represent money.</p>
<p>At least, that is the moral for financial applications. At Square, we used a
<code>long amount_cents</code>, and we got along with our lives. However, for most
applications that have a good reason to use floating point, this can’t be the
end of the story. If floating point were the unpredictable, unreliable thing
that I once believed it to be, we wouldn’t be able to numerically solve
differential equations, or linear systems, or land on the moon. Rather, there is
a science of floating point error, forming part of a science of numerical errors
in general, which seeks to tame and understand what happens to errors as they
flow through our calculations. In general, numerical error is something that can
be rather precisely quantified, as we’ll see. Along the way we’ll look at the
Fundamental Axiom of Floating Point Arithmetic, which, at the very least, sounds
way cooler than “10 things every developer should know about floating point
numbers”.</p>
<h2 id="machine-epsilon">Machine Epsilon</h2>
<p>Fundamentally, error in floating point is due to the problem of “roundoff”. Just as in base 10, we cannot represent the
number \(1/3\) without rounding it off somewhere:</p>
<p>\begin{equation*}
\frac{1}{3} = 0.33333333333333 \dots \approx 0.33333333,
\end{equation*}</p>
<p>in base 2, we cannot represent many numbers without rounding. Of course, some numbers we <em>can</em> represent exactly. The
number 1, for example. Or any integer in the range \((-2^{53}, 2^{53})\). Also notably, many fractions can be exactly
represented:</p>
<p>\begin{align*}
\frac{1}{2} &amp;= 0.1_2 \\\<br>
\frac{3}{4} &amp;= 0.11_2 \\\<br>
\frac{17}{8} &amp;= 10.001_2 \\\<br>
&amp;\vdots
\end{align*}</p>
<p>However, a number like \(1/10\), just like \(1/3\) in base 10, must be truncated to fit in the 24 or 53 bits of the
<a href="https://en.wikipedia.org/wiki/Significand">mantissa</a>. When we enter <code>0.1</code> in a console or in source code, the value that is <em>actually stored</em> is very slightly
different than <code>0.1</code>. According to this excellent <a href="https://www.exploringbinary.com/floating-point-converter/">IEEE-754 Floating Point Converter</a>, the floating point number that is
actually stored (for 64-bit floating point) is</p>
<p>\begin{align*}
&amp;(0.0001100110011001100110011001100110011001100110011001101)_2 = \\\<br>
&amp;(0.1000000000000000055511151231257827021181583404541015625)_{10}
\end{align*}</p>
<p>So the initial input to our calculation was flawed! We weren’t calculating <code>0.1 * 3</code>, we were actually calculating</p>
<div><pre><code data-lang="python"><span>0.1000000000000000055511151231257827021181583404541015625</span> * <span>3</span>
</code></pre></div><p>How much of an error is this? We can get an idea by counting the zeros in between the significant
digits, \(0.100\dots 00055\). In this case, there are 16. So in simply entering a number which is not representable
exactly in floating point, we have incurred a relative error of roughly \(10^{-16}\).</p>
<p>Indeed, in <em>all</em> cases we can expect to incur a relative error of
roughly \(10^{-16}\). This magnitude is called machine epsilon, often
written \(\epsilon_{\text{machine}}\). It comes from the relative difference
between two successive floating point numbers. For every representable floating
point number \(x\), there is a <em>next</em> floating point number, and it is
approximately \(x + \epsilon_{\text{machine}} x\). So for an arbitrary real
number \(x_0\), it falls between two floating point values \(x\)
and \(x + \epsilon x\) (leaving off the subscript of \(\epsilon\) for conciseness). When we
represent \(x_0\) in floating point, we will get one of these two values. Let’s denote
the floating point representation of \(x_0\) by \(\text{fl}(x_0)\). The absolute
error incurred just by representing \(x_0\) in floating point is</p>
<p>\begin{equation*}
e_{\text{abs}} = |\text{fl}(x_0) - x_0| \leq \max(|x_0 - x|, |x_0 - (x + \epsilon x)|) \leq |\epsilon x|.
\end{equation*}</p>
<p>The relative error, then, i.e. the absolute error divided by the true value, is</p>
<p>\begin{equation*}
e_{\text{rel}} = \frac{e_{\text{abs}}}{x_0} \leq \frac{|\epsilon x|}{x_0} \approx \epsilon.
\end{equation*}</p>
<p>Cool! So we’ve seen that the worst we can do, in relative terms, when representing a floating point number, is
approximately \(10^{-16}\). This is, for almost all practical purposes, <em>very good</em>. Because remember, we’re speaking of
a relative error. That means we’re able to represent even very small values, very accurately. Here’s the nearest floating point
number to \(10^{-20}\):</p>
<p>\begin{equation*}
0.000000000000000000009999999999999999451532\dots
\end{equation*}</p>
<p>If you’re curious, I invite you to count the 9’s. There are 16 of them. Even when dealing with extremely small numbers,
we maintain the same relative precision.</p>
<h2 id="the-fundamental-axiom-of-floating-point-arithmetic">The Fundamental Axiom of Floating Point Arithmetic</h2>
<p>Now you might be thinking, wait! It’s all good and well that we can get excellent relative accuracy when <em>representing</em>
floating point numbers, but what about when we go to <em>do</em> something with them? Here we’ve got two floating point
numbers, both of which are inexact, and we’re about to multiply them! Who knows what might happen?</p>
<p>This concern is well-founded, because the algorithms of floating point arithmetic must be implemented with finite
precision. If we are asked to multiply two large numbers with pen and paper, the algorithm that most
of us will use is the one we learned in school, which involves lots of addition, carrying, sub-multiplications, and so
on. If all of those intermediate steps are using some kind of binary representation, then the intermediate products may
be losing precision as we go along! This seems like a recipe for disaster. Fortunately, there is a property that we can
require of a floating point implementation, one which is satisfied by IEEE-754 and most other popular floating point
standards, that will save us from total anarchy. This is what Trefethen and Bau, <em>Numerical Linear Algebra</em>, refer to
as the <strong>Fundamental Axiom of Floating Point Arithmetic</strong>:</p>
<blockquote>
<p>All floating point arithmetic operations are exact up to a relative error of \(\epsilon_{\text{machine}}\).</p>
</blockquote>
<p>This means that for any two floating point numbers, say \(x\) and \(y\), any operation involving them will give a floating
point result which is within a factor of \(1 + \epsilon_{\text{machine}}\) of the true result. This is easiest to
understand if we use a special notation to represent the floating point version of, say, \(+\). Let’s write \(\oplus\) to
denote floating point addition, and \(+\) to denote exact addition. Then the Fundamental Axiom tells us,</p>
<p>\begin{equation*}
\frac{|(x \bigoplus y) - (x + y)|}{x + y} \leq \epsilon_{\text{machine}}.
\end{equation*}</p>
<p>Remember, \(x\) and \(y\) are exactly representable as floating point numbers, but of course they are also, mathematically,
just real numbers. So \(x + y\) is a real number (point on the number line), which <em>may not be exactly representable in
floating point</em>. The Fundamental Axiom is telling us that the floating point operation \(\oplus\) can do no worse than
simply trying to represent the number \(x + y\) as a floating point value directly, assuming our computer had access to the
mathematical, infinite precision object \(x + y\).</p>
<p>Put another way, we incur no extra error by going through floating point
arithmetic than we would by using a magical computer to do exact arithmetic on
our floating point values and then casting back to floating point. In
mathematical terms,</p>
<p>\begin{equation*}
\frac{\left|(\text{fl}(a) \oplus \text{fl}(b)) - (a + b)\right|}{a + b} \approx \frac{\left|\text{fl}(\text{fl}(a) + \text{fl}(b)) - (a + b)\right|}{a + b} \approx \epsilon_{\text{machine}}.
\end{equation*}</p>
<p>Recall that \(\text{fl}(a)\) is the mathematical number we actually represent when
we try to represent \(a\) in floating point. So the first fraction gives the
relative error from performing \(\oplus\) on the floating point representations
of \(a\) and \(b\), and the second fraction gives the relative error from performing
the exact arithmetic operation, \(+\), on the floating point representations
of \(a\) and \(b\), then casting the result to floating point.</p>
<h2 id="error-analysis">Error Analysis</h2>
<p>The Fundamental Axiom of Floating Point Arithmetic allows us to analyze the numerical error that may be incurred by even
complex arithmetic operations. To see an idea of how this works, let’s consider the problem of computing the length of a
2D vector, \([x, y]\). Mathematically, this has the form</p>
<p>\begin{equation*}
d = \sqrt{x^2 + y^2}.
\end{equation*}</p>
<p>There are several stages to the computation, and at each one we will incur a little bit of numerical error:</p>
<ul>
<li>Enter the numbers \(x\) and \(y\) into the computer, incurring roundoff error.</li>
<li>Compute \(x^2\) and \(y^2\), using floating point multiplication.</li>
<li>Compute \(x^2 + y^2\), using floating point addition.</li>
<li>Compute \(\sqrt{x^2 + y^2}\), using the floating point square root operation.</li>
</ul>
<p>At each step, the result we get will be equal to the true result, times some error factor \((1 + \epsilon)\), where
each \(\epsilon\) is very small, on the order of \(\epsilon_\text{machine}\). Each operation may have a different
error \(\epsilon\), but we’ll use the same symbol for all of them. We don’t care so much about the exact value
of \(\epsilon\), only that it is very small.</p>
<p>We’re going to carry these \(\epsilon\) through the computation to see how they
affect the final result. To make that easier, we can use special rules of arithmetic to manipulate \(\epsilon\):</p>
<ul>
<li>\(\epsilon^2 = 0\). If \(\epsilon \approx 10^{-16}\), then \(\epsilon^2 \approx 10^{-32}\), which is so small that we just
decide to completely ignore it.</li>
<li>\((1 + \epsilon)^2 = 1 + 2\epsilon + \epsilon^2 = 1 + 2\epsilon\).</li>
<li>\(\sqrt{1 + \epsilon} = 1 + \frac{\epsilon}{2} - …</li></ul></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="http://www.johnbcoughlin.com/posts/floating-point-axiom/">http://www.johnbcoughlin.com/posts/floating-point-axiom/</a></em></p>]]>
            </description>
            <link>http://www.johnbcoughlin.com/posts/floating-point-axiom/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24057293</guid>
            <pubDate>Wed, 05 Aug 2020 04:41:08 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Magnasanti: The Largest and Most Terrifying SimCity (2010)]]>
            </title>
            <description>
<![CDATA[
Score 251 | Comments 91 (<a href="https://news.ycombinator.com/item?id=24052413">thread link</a>) | @riboflavin
<br/>
August 4, 2020 | https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/ | <a href="https://web.archive.org/web/*/https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>

					

					

					<p><a href="https://rumorsontheinternets.files.wordpress.com/2010/10/magna.jpg"><img data-attachment-id="2960" data-permalink="https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/magna/" data-orig-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna.jpg" data-orig-size="600,450" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="magna" data-image-description="" data-medium-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna.jpg?w=300" data-large-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna.jpg?w=600" title="magna" src="https://rumorsontheinternets.files.wordpress.com/2010/10/magna.jpg?w=630" alt="" srcset="https://rumorsontheinternets.files.wordpress.com/2010/10/magna.jpg 600w, https://rumorsontheinternets.files.wordpress.com/2010/10/magna.jpg?w=150 150w, https://rumorsontheinternets.files.wordpress.com/2010/10/magna.jpg?w=300 300w" sizes="(max-width: 600px) 100vw, 600px"></a></p>
<p>This picture  may appear to be a collection of color fields without meaning or  purpose, but there is a ton of math and evil genius behind this image.</p>
<p><strong>This is a view of Magnasanti, the metropolis that pushes SimCity to its population limits. </strong></p>
<p><strong><span id="more-2933"></span></strong>Here is a closer view:</p>
<p><a href="https://rumorsontheinternets.files.wordpress.com/2010/10/magna1.jpeg"><img data-attachment-id="2942" data-permalink="https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/magna1/" data-orig-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna1.jpeg" data-orig-size="600,450" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="magna1" data-image-description="" data-medium-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna1.jpeg?w=300" data-large-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna1.jpeg?w=600" title="magna1" src="https://rumorsontheinternets.files.wordpress.com/2010/10/magna1.jpeg?w=630" alt="" srcset="https://rumorsontheinternets.files.wordpress.com/2010/10/magna1.jpeg 600w, https://rumorsontheinternets.files.wordpress.com/2010/10/magna1.jpeg?w=150 150w, https://rumorsontheinternets.files.wordpress.com/2010/10/magna1.jpeg?w=300 300w" sizes="(max-width: 600px) 100vw, 600px"></a></p>
<p>Vincent Oscala, a 22-year old architecture student from the Philippines, spent years decoding the formula for success in Sim City 3000.</p>
<p>Sounds like lunacy…but his insane investment of effort into “beating” SimCity raises interesting questions about the urban landscapes we inhabit, and the ways in which they can go horribly wrong.</p>
<p><a href="https://rumorsontheinternets.files.wordpress.com/2010/10/magna21.jpg"><img data-attachment-id="2944" data-permalink="https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/magna2-2/" data-orig-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna21.jpg" data-orig-size="600,825" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="magna2" data-image-description="" data-medium-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna21.jpg?w=218" data-large-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna21.jpg?w=600" title="magna2" src="https://rumorsontheinternets.files.wordpress.com/2010/10/magna21.jpg?w=630" alt="" srcset="https://rumorsontheinternets.files.wordpress.com/2010/10/magna21.jpg 600w, https://rumorsontheinternets.files.wordpress.com/2010/10/magna21.jpg?w=109 109w, https://rumorsontheinternets.files.wordpress.com/2010/10/magna21.jpg?w=218 218w" sizes="(max-width: 600px) 100vw, 600px"></a></p>
<p>After a massive amount of planning and a great deal of trial and error, he was able to create a city with over six million inhabitants.</p>
<p>Moreover, the city he created was remarkably stable, with no abandoned buildings and no wasted space. There are no roads — all transit is mass transit. An omniscient police force has eliminated all crime in the city. Magnasanti’s water and power needs are supplied by neighboring cities, eliminating the need for much of the related infrastructure.</p>
<p><a href="https://rumorsontheinternets.files.wordpress.com/2010/10/magna3.jpg"><img data-attachment-id="2945" data-permalink="https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/magna3/" data-orig-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna3.jpg" data-orig-size="600,450" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="magna3" data-image-description="" data-medium-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna3.jpg?w=300" data-large-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magna3.jpg?w=600" title="magna3" src="https://rumorsontheinternets.files.wordpress.com/2010/10/magna3.jpg?w=630" alt="" srcset="https://rumorsontheinternets.files.wordpress.com/2010/10/magna3.jpg 600w, https://rumorsontheinternets.files.wordpress.com/2010/10/magna3.jpg?w=150 150w, https://rumorsontheinternets.files.wordpress.com/2010/10/magna3.jpg?w=300 300w" sizes="(max-width: 600px) 100vw, 600px"></a></p>
<p><strong>In SimCity </strong><strong>terms</strong><strong>, it is a masterpiece.</strong></p>
<p><strong>But at the “street level,” so to speak, it looks like a horrifying dystopia. </strong></p>
<p>Unemployment is high, air pollution is stifling, education is largely absent, medical care and fire response are non-existent. Citizens do not live to reach retirement age. The police state has essentially eliminated free will and allowed the city to maximize its size while reducing quality of life to a minimum — and still maintaining total control over the citizens.</p>
<p>Every person living in Magnasanti spends his life working and residing in one small, massively efficient block of space, until death around age 50.</p>
<p><a href="https://rumorsontheinternets.files.wordpress.com/2010/10/magnachart.jpg"><img data-attachment-id="2946" data-permalink="https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/magnachart/" data-orig-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magnachart.jpg" data-orig-size="422,438" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="magnachart" data-image-description="" data-medium-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magnachart.jpg?w=289" data-large-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magnachart.jpg?w=422" title="magnachart" src="https://rumorsontheinternets.files.wordpress.com/2010/10/magnachart.jpg?w=630" alt="" srcset="https://rumorsontheinternets.files.wordpress.com/2010/10/magnachart.jpg 422w, https://rumorsontheinternets.files.wordpress.com/2010/10/magnachart.jpg?w=145 145w, https://rumorsontheinternets.files.wordpress.com/2010/10/magnachart.jpg?w=289 289w" sizes="(max-width: 422px) 100vw, 422px"></a></p>
<p><a href="https://rumorsontheinternets.files.wordpress.com/2010/10/magnalife.jpg"><img data-attachment-id="2947" data-permalink="https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/magnalife/" data-orig-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magnalife.jpg" data-orig-size="424,440" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="magnalife" data-image-description="" data-medium-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magnalife.jpg?w=289" data-large-file="https://rumorsontheinternets.files.wordpress.com/2010/10/magnalife.jpg?w=424" title="magnalife" src="https://rumorsontheinternets.files.wordpress.com/2010/10/magnalife.jpg?w=630" alt="" srcset="https://rumorsontheinternets.files.wordpress.com/2010/10/magnalife.jpg 424w, https://rumorsontheinternets.files.wordpress.com/2010/10/magnalife.jpg?w=145 145w, https://rumorsontheinternets.files.wordpress.com/2010/10/magnalife.jpg?w=289 289w" sizes="(max-width: 424px) 100vw, 424px"></a></p>
<p>Here is a video that explains some of the development process for Magnasanti, including two smaller cities that served as development prototypes for Oscala’s final achievement:</p>
<p><span><iframe width="630" height="355" src="https://www.youtube.com/embed/NTJQTc-TqpU?version=3&amp;rel=1&amp;fs=1&amp;autohide=2&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;wmode=transparent" allowfullscreen="true"></iframe></span></p>
<p>As the soundtrack indicates, Oscala was highly influenced by the art film <a href="http://en.wikipedia.org/wiki/Koyaanisquatsi" target="_blank">Koyaanisquatsi</a>, or “Life out of Balance,” directed by Godfrey Reggio with music by Philip Glass.</p>
<p>Koyaanisquatsi is a non-narrative work that examines and explores the contrasts between the form and pace of nature and modern human life. Ultimately, the film confronts us with the fact that our species is living a life out of balance with nature, for better or for worse.</p>
<p>It’s a really cool movie that is highly recommended. Here’s a teaser:</p>
<p><span><iframe width="630" height="355" src="https://www.youtube.com/embed/LFBijDU8PpE?version=3&amp;rel=1&amp;fs=1&amp;autohide=2&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;wmode=transparent" allowfullscreen="true"></iframe></span></p>
<p>Now, you may be asking, what in the world does a game of SimCity — in an obsolete version, no less — have to teach us about a “life out of balance”?</p>
<p>Magnasanti is, first and foremost, a study in how to game SimCity to a maximum-population win condition.</p>
<p>However, I do think it raises some intriguing questions.</p>
<p>Oscala <a href="http://www.viceland.com/blogs/uk-games/2010/05/10/the-totalitarian-buddhist-who-beat-sim-city/" target="_blank">comments</a>:</p>
<blockquote>
<p><strong>The film presented the world in a way I never really looked at before  and that captivated me. Moments like these compel me to physically  express progressions in my thought, I have just happened to do that  through the form of creating these cities in <em>SimCity 3000.</em> I  could probably have done something similar – depicting the awesome  regimentation and brutality of our society – with a series of paintings  on a canvas, or through hideous architectural models.</strong></p>
<p><strong>But it wouldn’t be  the same as doing it in the game, for the reason that I wanted to  magnify the unbelievably sick ambitions of egotistical political  dictators, ruling elites and downright insane architects, urban planners  and social engineers.</strong></p>
</blockquote>
<p>Australian architecture blog <a href="http://supercolossal.ch/2010/10/07/pay-to-click-get-rich-quick-urbanism-and-the-ideal-simcity/" target="_blank">Super Colossal discusses</a> some of the issues provoked by Magnasanti (link <a href="http://m.ammoth.us/blog/2010/10/magnasanti/" target="_blank">via</a>):</p>
<blockquote>
<p>This is the kind of archiporn that I am a sucker for; gamespace urbanism  exploited to its extreme condition. Can you ‘win’ urbanism? Is this  even urbanism? If not, can we take anything from its construction? The  primary move that the city makes is to remove cars altogether and base  transport purely on subways. I suspect this is a method to exploit the  space otherwise taken up by roads for real estate allowing for an  increased population per tile, however, it is a strategy that many  cities—Sydney included—are seriously looking into. Remove motor  vehicles, increase public transport. Seems like a sound idea.</p>
</blockquote>
<p>It is interesting to see a world in which the lack of cars exists alongside a lack of freedom, and indeed may even be symptomatic of it. Oscala has created a system so “sustainable” that citizens are chained to their city blocks; they’re able to access the rest of the city through mass transit, but in effect have been relieved of the need to do so by the ruthless efficiency of their cookie-cutter “neighborhoods.”</p>
<p>Maybe — all right, probably — this is effective because the game engine is warped. Super Colossal concludes that “Ultimately, Magnasanti has little to do with urban design and everything to do with gaming systems for maximum&nbsp;reward.”</p>
<p>I can’t help but think that Magnasanti represents a semi-realistic dark side of centralized urban planning: the tools of modern construction and city planning as wielded by a despotic madman bent on maximizing population at any cost. Creativity, vibrancy and nature itself are cast away as a focus on efficiency and the bottom line are elevated to a religion and a science.</p>
<p>And of course, the police force are ever-present, just in case disorder begins to stir.</p>
<p>As Oscala <a href="http://www.viceland.com/blogs/uk-games/2010/05/10/the-totalitarian-buddhist-who-beat-sim-city/" target="_blank">explained in an interview with Viceland</a>, Magnasanti represents a “cage” in which he has imprisoned six million “economic slaves”. He <a href="http://images.shareapic.net/images7/022530174.jpg" target="_blank">utilized the geometry</a> of the Buddhist Wheel of Life and Death as further symbolic comment on the topic.</p>
<blockquote><p><strong>Technically, no one is leaving or coming into the  city. Population growth is stagnant. Sims don’t need to travel long  distances, because their workplace is just within walking distance. In  fact they do not even need to leave their own block. Wherever they go  it’s like going to the same place. </strong></p>
<p><strong>There are a lot of other problems in the city hidden under the  illusion of order and greatness: Suffocating air pollution, high  unemployment, no fire stations, schools, or hospitals, a regimented  lifestyle – this is the price that these sims pay for living in the city  with the highest population. It’s a sick and twisted goal to strive  towards. </strong></p>
<p><strong>The ironic thing about it is the sims in Magnasanti tolerate  it. They don’t rebel, or cause revolutions and social chaos. No one  considers challenging the system by physical means since a  hyper-efficient police state keeps them in line. They have all been  successfully dumbed down, sickened with poor health, enslaved and  mind-controlled just enough to keep this system going for thousands of  years. 50,000 years to be exact. They are all imprisoned in space and  time.</strong></p></blockquote>
<p>The <a href="http://m.ammoth.us/blog/2010/10/magnasanti/" target="_blank">Mammoth blog</a> calls Magnasanti “An intentionally hellish vision which exploits the game’s internal logic as commentary.”</p>
<p>Oscala <a href="http://www.viceland.com/blogs/uk-games/2010/05/10/the-totalitarian-buddhist-who-beat-sim-city/" target="_blank">adds </a>that “if we make maximizing profits the absolute objective, we fail to take  into consideration the social and environmental consequences.”</p>
<p><strong>At the very least, it’s delicious food for thought for would-be urban planners and simulation gamers.</strong></p>
<p>Further reading and sources:<strong><br>
</strong></p>
<p>Viceland: <a title="Permanent Link to The Totalitarian Buddhist Who Beat Sim City" rel="bookmark" href="http://www.viceland.com/blogs/uk-games/2010/05/10/the-totalitarian-buddhist-who-beat-sim-city/">The Totalitarian Buddhist Who Beat Sim City</a><br>
Mammoth: <a href="http://m.ammoth.us/blog/2010/10/magnasanti/#" target="_blank">Magnasanti</a><br>
Super Colossal: <a rel="bookmark" href="http://supercolossal.ch/2010/10/07/pay-to-click-get-rich-quick-urbanism-and-the-ideal-simcity/" target="_blank">Pay to Click Get Rich Quick: Urbanism and the Ideal SimCity<br>
</a>Imperar’s Millionaire Experiment: <a href="http://imperar.blogs.linkbucks.com/who-is-imperar/" target="_blank">Who is Imperar?</a></p>
<p>Mildly related: <a href="http://en.wikipedia.org/wiki/The_Power_Broker" target="_blank">The Power Broker</a> and <a href="http://en.wikipedia.org/wiki/The_Death_and_Life_of_Great_American_Cities" target="_blank">The Death and Life of Great American Cities</a></p>
			
			
			
					
					<!--
					<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/"
    dc:identifier="https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/"
    dc:title="Magnasanti: The Largest and Most Terrifying&nbsp;SimCity"
    trackback:ping="https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/trackback/" />
</rdf:RDF>					-->

				</div></div>]]>
            </description>
            <link>https://rumorsontheinternets.org/2010/10/14/magnasanti-the-largest-and-most-terrifying-simcity/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24052413</guid>
            <pubDate>Tue, 04 Aug 2020 17:34:18 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[You may finally use JSHint for evil]]>
            </title>
            <description>
<![CDATA[
Score 63 | Comments 74 (<a href="https://news.ycombinator.com/item?id=24051655">thread link</a>) | @catacombs
<br/>
August 4, 2020 | http://mikepennisi.com/blog/2020/jshint-watching-the-ship-sink/ | <a href="https://web.archive.org/web/*/http://mikepennisi.com/blog/2020/jshint-watching-the-ship-sink/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><section>

<p><strong>This is the first essay in <a href="http://mikepennisi.com/blog/2020/you-may-finally-use-jshint-for-evil/">a four-part series about relicensing the JSHint
software project</a>.</strong></p>

<p>The process of relicensing JSHint took seven years. That’s far longer than
anyone expected, but seeing this through wasn’t just a matter of endurance. As
I worked with people around the world to move to the MIT Expat license, I
regularly experienced how non-free licensing (even as seemingly trivial as
“Good, not Evil”) poisons the well of free software.</p>

<p>Some numbers might help here. The following graph shows how many times JSHint
has been downloaded from <a href="https://docs.npmjs.com/">npm</a> each week over the past
five years:</p>

<p><img src="http://mikepennisi.com/blog/jshint-watching-the-ship-sink-graph-1.png" alt="JSHint downloads over time"></p>

<p>We had a dip last year, but we’ve since recovered and then some. Over half a
million downloads per week sure sounds impressive, doesn’t it?</p>

<p>It <em>was</em> impressive in 2015. The fact is, npm’s usage has exploded over the
past half decade. Holding steady in this space is actually falling behind. Take
a look at the same statistic for <a href="https://eslint.org/">ESLint</a>, a truly open
source project with the same purpose and target audience as JSHint:</p>

<p><img src="http://mikepennisi.com/blog/jshint-watching-the-ship-sink-graph-2.png" alt="JSHint and ESLint downloads over time"></p>

<p>Suddenly that dip in 2019 doesn’t seem so important. How did JSHint go from
being the most popular tool in this space to one that most developers today
consider antiquated? There are many explanations, but in this essay, I’ll focus
on the effects of non-free licensing.</p>

<h3 id="for-license-sensitive-users">For license-sensitive users</h3>

<p>JSHint was partly licensed under <a href="https://www.gnu.org/licenses/license-list.html#JSON">the JSON
license</a>. It is nearly
identical to the widely-used MIT Expat license, but it includes one additional
clause:</p>

<blockquote>
<p>The Software shall be used for Good, not Evil.</p>
</blockquote>

<p>Because of this clause, folks who respect the practice of software licensing
simply could not use JSHint.</p>

<p>If you’re not versed in legal matters, that probably seems like an odd
restriction. By rejecting JSHint, are people admitting that they want to do
evil? And is that clause actually enforceable, anyway?</p>

<p>The answer to the second question is “no,” and that helps answer the first
question. Legally-conscious objectors aren’t betraying their own dastardly
motivations; they’re refusing to enter into an ambiguous contract. Put
differently: they’re not saying, “I’m an evildoer,” they’re saying, “I don’t
understand what you want.” This consideration disqualified JSHint from
inclusion in all sorts of contexts.</p>

<p>First, there were legally-conscious software repositories. Developers from the
<a href="https://www.debian.org/">Debian</a> and <a href="https://getfedora.org/">Fedora</a>
GNU/Linux distributions independently concluded that they could not include
JSHint due to licensing concerns. That’s why <a href="https://ubuntu.com/">Ubuntu</a>
users can’t download JSHint via <code>sudo apt-get install jshint</code>.</p>

<p>Even in less discerning package managers, folks built tools to empower
developers to make similar decisions on their own. For instance, JSHint has
been available on <a href="https://docs.npmjs.com/">npm</a> since its initial release, but
<a href="https://spdx.org/">SPDX</a> (along with tools like
<a href="https://github.com/ironSource/license-report"><code>license-report</code></a> and
<a href="https://classic.yarnpkg.com/en/docs/cli/licenses">Yarn</a>) has since been
designed to help folks understand the legal requirements of their dependencies.
This seemed like an encouraging trend toward conscientious code sharing, so <a href="https://github.com/jshint/jshint/pull/2420">we
did our part by adopting SPDX in
JSHint</a>.</p>

<p>More recently, an instructor at a US university wrote to the JSHint team asking
for permission to use JSHint in their course. I replied,</p>

<blockquote>
<p>By all means, you are welcome to use the project and its website in your
courses. Please note, however, that the source code is partially
published under the JSON license. The FSF does not recognize this as <a href="http://www.gnu.org/licenses/license-list.html">a
free software license</a> nor
does the Open Source Initiative recognize it as <a href="https://opensource.org/licenses/alphabetical">an open source
license</a>. This detail does not
effect most people in practice, but you may want to verify with your legal
team before relying on the code base.</p>
</blockquote>

<p>Honesty may be the best policy, but it also means fewer people are going to use
your bizarrely-encumbered JavaScript linter.</p>

<p>Finally, programming platforms that “repackaged” JSHint have reconsidered that
practice because of the license issue. There was a time when the popular
content management system <a href="https://wordpress.org/">WordPress</a> repackaged JSHint
in this way. Once they learned of the JSON license, <a href="https://core.trac.wordpress.org/ticket/42850">they replaced JSHint in a
matter of weeks</a>.</p>

<h3 id="for-feature-craving-users">For feature-craving users</h3>

<p>Plenty of people don’t give a fig about free software. Whatever their reason,
they couldn’t care less about the legal terms that are bundled with
publicly-available source code. The “Good, not Evil” clause also pushed them
away, even if they didn’t realize it.</p>

<p>It began with the decline in license-sensitive users. The word “user” is a bit
too passive in the context of open source tooling because folks who use the
software are particularly empowered to contribute back to it. The “user-base”
is directly correlated to the “contributor-base.” When a project like JSHint
loses users, it also loses contributors.</p>

<p>This slows the addition of new features and the correction of bugs. Timeliness
is important for these things, and people perceive delays very negatively. The
best example of this comes from JSHint’s delayed support for async functions.</p>

<p>(The async function is a JavaScript language feature which was <a href="https://tc39.es/ecma262/#sec-intro">introduced in
2017</a>. It’s very popular among developers
but also very difficult for parsers to implement correctly. <a href="https://jshint.com/blog/2019-02-05/release-2-10-0/">It took us over a
year to support it in
JSHint.</a>).</p>

<p>Some expressed their dissatisfaction with the delay in <a href="https://github.com/jshint/jshint/issues/2604#issuecomment-342173639">calm (though somewhat
impatient)
terms</a>:</p>

<blockquote>
<p>Async/await has been at stage 4 for over a month now (and baked into Node and
many mainstream browsers for longer), but jshint has yet to add support.</p>
</blockquote>

<p>…but others were more emotional:</p>

<ul>
<li><a href="https://github.com/jshint/jshint/issues/2604#issuecomment-329704124">“You just lost my interest in jshint. Sorry, to [sic]
slow.”</a></li>
<li><a href="https://github.com/jshint/jshint/issues/2604#issuecomment-331985362">“Thank you JSHint. It was good while it lasted. Switched to
ESLint.”</a></li>
<li><a href="https://github.com/jshint/jshint/issues/2604#issuecomment-340112372">“RIP
Jshint”</a></li>
<li><a href="https://github.com/jshint/jshint/issues/2604#issuecomment-455643712">“Seems like we waited enough. Bye JSHint. It was a good
time.”</a></li>
<li>“I know that you get a lot of complaints about this, but… if you can’t find
a way to include support for async/await, jshint is useless to me. I’m
switching to just using <code>node -c &lt;filename&gt;</code>” (via e-mail)</li>
</ul>

<p>The Internet has a way of surfacing the loudest and angriest perspectives, but
it seems safe to assume there was a substantial group of less vocal developers
who came to a similar conclusion.</p>

<p>A dwindling user/contributor-base is a vicious cycle. Though the movement may
have started with license-conscious folks, everyone felt the pain of the
release cycle equally, and their exodus exacerbated the problem.</p>

<p>This isn’t just a story of open-source “market” forces, though. My own
management decisions contributed to JSHint’s dissatisfying release cycle.</p>

<p>You see, many people express their dependency on software using a range of
versions. They don’t say, “give me Firefox at version 67.02.3” because they
don’t really care about that particular release. What they want is the software
to be familiar but also secure. They’re more likely to say, “give me the latest
version of Firefox 67.” With this statement, they’re trusting the maintainers
of Firefox to provide a program that looks and acts a certain way (i.e. not
exactly like version 65 or version 68) but that also has the latest bug fixes
(so 67.02.4 is preferable to 67.02.3).</p>

<p>This practice generally benefits users and developers alike. In my case,
though, I had a conflicting personal goal: I wanted the relicensed version of
JSHint to reach as many people as possible.</p>

<p>If we made drastic improvements to JSHint, we’d have to release a new major
version. The relicensing effort could continue with the new version, but many
people would continue to use the old version. For all the obsessing I’ve done
about JSHint over the years, I haven’t forgotten that most people aren’t
particularly concerned with the release schedule of their JavaScript linter.
When and if we succeeded, the users of the old version would be cut off from
our success (not to mention the improvements we made from that point forward).</p>

<p>This consideration made me averse to drastic changes in JSHint. Pretty
antithetical for a project maintainer.</p>

<h3 id="software-freedom-matters">Software freedom matters</h3>

<p>For many people, licensing is an esoteric part of software development. It’s a
relatable opinion: the legal frameworks are intimidating, and most
considerations can be addressed by simply defaulting to well-known
free/open-source licenses.</p>

<p>The trouble is that not all software is distributed under well-known
free/open-source licenses. My hope is that the particulars of JSHint’s decay
help folks understand why licensing matters.</p>

<p>After reading the drudgery of JSHint’s slow decline, you might be wondering why
we didn’t just give up. A sinking ship is only tragic if you value the ship. If
<a href="https://eslint.org/">a newer, faster, similarly-named ship</a> sails by, then
maybe it’s time to put down the bailer. It’ll take <a href="http://mikepennisi.com/blog/2020/jshint-dug-in/">another
essay</a> to address that fully.</p>
<ul>
  
</ul>

    </section></div>]]>
            </description>
            <link>http://mikepennisi.com/blog/2020/jshint-watching-the-ship-sink/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24051655</guid>
            <pubDate>Tue, 04 Aug 2020 16:35:53 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Let's build a full-text search engine]]>
            </title>
            <description>
<![CDATA[
Score 354 | Comments 65 (<a href="https://news.ycombinator.com/item?id=24051229">thread link</a>) | @elorant
<br/>
August 4, 2020 | https://artem.krylysov.com/blog/2020/07/28/lets-build-a-full-text-search-engine/ | <a href="https://web.archive.org/web/*/https://artem.krylysov.com/blog/2020/07/28/lets-build-a-full-text-search-engine/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
        

        


        <p>Full-Text Search is one of those tools people use every day without realizing it. If you ever googled "golang coverage report" or tried to find "indoor wireless camera" on an e-commerce website, you used some kind of full-text search.</p>
<p>Full-Text Search (FTS) is a technique for searching text in a collection of documents. A document can refer to a web page, a newspaper article, an email message, or any structured text.</p>
<p>Today we are going to build our own FTS engine. By the end of this post, we'll be able to search across millions of documents in less than a millisecond. We'll start with simple search queries like "give me all documents that contain the word <em>cat</em>" and we'll extend the engine to support more sophisticated boolean queries.</p>
<div>
<p>Note</p>
<p>Most well-known FTS engine is <a href="https://lucene.apache.org/" target="_blank">Lucene</a> (as well as <a href="https://github.com/elastic/elasticsearch" target="_blank">Elasticsearch</a> and Solr built on top of it).</p>
</div>
<div id="why-fts">
<h3>Why FTS<a href="#why-fts" title="Permalink to this headline"> #</a></h3>
<p>Before we start writing code, you may ask "can't we just use <em>grep</em> or have a loop that checks if every document contains the word I'm looking for?". Yes, we can. However, it's not always the best idea.</p>
</div>
<div id="corpus">
<h3>Corpus<a href="#corpus" title="Permalink to this headline"> #</a></h3>
<p>We are going to search a part of the abstract of English Wikipedia. The latest dump is available at <a href="https://dumps.wikimedia.org/enwiki/latest/enwiki-latest-abstract1.xml.gz" target="_blank">dumps.wikimedia.org</a>. As of today, the file size after decompression is 913 MB. The XML file contains over 600K documents.</p>
<p>Document example:</p>
<pre><code><span>&lt;title&gt;</span>Wikipedia: Kit-Cat Klock<span>&lt;/title&gt;</span>
<span>&lt;url&gt;</span>https://en.wikipedia.org/wiki/Kit-Cat_Klock<span>&lt;/url&gt;</span>
<span>&lt;abstract&gt;</span>The Kit-Cat Klock is an art deco novelty wall clock shaped like a grinning cat with cartoon eyes that swivel in time with its pendulum tail.<span>&lt;/abstract&gt;</span></code></pre>
</div>
<div id="loading-documents">
<h3>Loading documents<a href="#loading-documents" title="Permalink to this headline"> #</a></h3>
<p>First, we need to load all the documents from the dump. The built-in <span>encoding/xml</span> package comes very handy:</p>
<pre><code><span>import</span> <span>(</span>
    <span>"encoding/xml"</span>
    <span>"os"</span>
<span>)</span>

<span>type</span> <span>document</span> <span>struct</span> <span>{</span>
    <span>Title</span> <span>string</span> <span>`xml:"title"`</span>
    <span>URL</span>   <span>string</span> <span>`xml:"url"`</span>
    <span>Text</span>  <span>string</span> <span>`xml:"abstract"`</span>
    <span>ID</span>    <span>int</span>
<span>}</span>

<span>func</span> <span>loadDocuments</span><span>(</span><span>path</span> <span>string</span><span>)</span> <span>([]</span><span>document</span><span>,</span> <span>error</span><span>)</span> <span>{</span>
    <span>f</span><span>,</span> <span>err</span> <span>:=</span> <span>os</span><span>.</span><span>Open</span><span>(</span><span>path</span><span>)</span>
    <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> <span>{</span>
        <span>return</span> <span>nil</span><span>,</span> <span>err</span>
    <span>}</span>
    <span>defer</span> <span>f</span><span>.</span><span>Close</span><span>()</span>

    <span>dec</span> <span>:=</span> <span>xml</span><span>.</span><span>NewDecoder</span><span>(</span><span>f</span><span>)</span>
    <span>dump</span> <span>:=</span> <span>struct</span> <span>{</span>
        <span>Documents</span> <span>[]</span><span>document</span> <span>`xml:"doc"`</span>
    <span>}{}</span>
    <span>if</span> <span>err</span> <span>:=</span> <span>dec</span><span>.</span><span>Decode</span><span>(</span><span>&amp;</span><span>dump</span><span>);</span> <span>err</span> <span>!=</span> <span>nil</span> <span>{</span>
        <span>return</span> <span>nil</span><span>,</span> <span>err</span>
    <span>}</span>

    <span>docs</span> <span>:=</span> <span>dump</span><span>.</span><span>Documents</span>
    <span>for</span> <span>i</span> <span>:=</span> <span>range</span> <span>docs</span> <span>{</span>
        <span>docs</span><span>[</span><span>i</span><span>].</span><span>ID</span> <span>=</span> <span>i</span>
    <span>}</span>
    <span>return</span> <span>docs</span><span>,</span> <span>nil</span>
<span>}</span></code></pre>
<p>Every loaded document gets assigned a unique identifier.
To keep things simple, the first loaded document gets assigned ID=0, the second ID=1 and so on.</p>
</div>
<div id="first-attempt">
<h3>First attempt<a href="#first-attempt" title="Permalink to this headline"> #</a></h3>
<div id="searching-the-content">
<h4>Searching the content<a href="#searching-the-content" title="Permalink to this headline"> #</a></h4>
<p>Now that we have all documents loaded into memory, we can try to find the ones about cats. At first, let's loop through all documents and check if they contain the substring <em>cat</em>:</p>
<pre><code><span>func</span> <span>search</span><span>(</span><span>docs</span> <span>[]</span><span>document</span><span>,</span> <span>term</span> <span>string</span><span>)</span> <span>[]</span><span>document</span> <span>{</span>
    <span>var</span> <span>r</span> <span>[]</span><span>document</span>
    <span>for</span> <span>_</span><span>,</span> <span>doc</span> <span>:=</span> <span>range</span> <span>docs</span> <span>{</span>
        <span>if</span> <span>strings</span><span>.</span><span>Contains</span><span>(</span><span>doc</span><span>.</span><span>Text</span><span>,</span> <span>term</span><span>)</span> <span>{</span>
            <span>r</span> <span>=</span> <span>append</span><span>(</span><span>r</span><span>,</span> <span>doc</span><span>)</span>
        <span>}</span>
    <span>}</span>
    <span>return</span> <span>r</span>
<span>}</span></code></pre>
<p>On my laptop, the search phase takes 103ms - not too bad.
If you spot check a few documents from the output, you may notice that the function matches <em>caterpillar</em> and <em>category</em>, but doesn't match <em>Cat</em> with the capital <em>C</em>. That's not quite what I was looking for.</p>
<p>We need to fix two things before moving forward:</p>
<ul>
<li><p>Make the search case-insensitive (so <em>Cat</em> matches as well).</p></li>
<li><p>Match on a word boundary rather than on a substring (so <em>caterpillar</em> and <em>communication</em> don't match).</p></li>
</ul>
</div>
<div id="searching-with-regular-expressions">
<h4>Searching with regular expressions<a href="#searching-with-regular-expressions" title="Permalink to this headline"> #</a></h4>
<p>One solution that quickly comes to mind and allows implementing both requirements is <em>regular expressions</em>.</p>
<p>Here it is - <span><span>(?i)\bcat\b</span></span>:</p>
<ul>
<li><p><span><span>(?i)</span></span> makes the regex case-insensitive</p></li>
<li><p><span>\b</span> matches a word boundary (position where one side is a word character and another side is not a word character)</p></li>
</ul>
<pre><code><span>func</span> <span>search</span><span>(</span><span>docs</span> <span>[]</span><span>document</span><span>,</span> <span>term</span> <span>string</span><span>)</span> <span>[]</span><span>document</span> <span>{</span>
    <span>re</span> <span>:=</span> <span>regexp</span><span>.</span><span>MustCompile</span><span>(</span><span>`(?i)\b`</span> <span>+</span> <span>term</span> <span>+</span> <span>`\b`</span><span>)</span> <span>// Don't do this in production, it's a security risk. term needs to be sanitized.
</span>    <span>var</span> <span>r</span> <span>[]</span><span>document</span>
    <span>for</span> <span>_</span><span>,</span> <span>doc</span> <span>:=</span> <span>range</span> <span>docs</span> <span>{</span>
        <span>if</span> <span>re</span><span>.</span><span>MatchString</span><span>(</span><span>doc</span><span>.</span><span>Text</span><span>)</span> <span>{</span>
            <span>r</span> <span>=</span> <span>append</span><span>(</span><span>r</span><span>,</span> <span>doc</span><span>)</span>
        <span>}</span>
    <span>}</span>
    <span>return</span> <span>r</span>
<span>}</span></code></pre>
<p>Ugh, the search took more than 2 seconds. As you can see, things started getting slow even with 600K documents. While the approach is easy to implement, it doesn't scale well. As the dataset grows larger, we need to scan more and more documents. The time complexity of this algorithm is linear - the number of documents required to scan is equal to the total number of documents. If we had 6M documents instead of 600K, the search would take 20 seconds. We need to do better than that.</p>
</div>
</div>
<div id="inverted-index">
<h3>Inverted Index<a href="#inverted-index" title="Permalink to this headline"> #</a></h3>
<p>To make search queries faster, we'll preprocess the text and build an index in advance.</p>
<p>The core of FTS is a data structure called <em>Inverted Index</em>.
The Inverted Index associates every word in documents with documents that contain the word.</p>
<p>Example:</p>
<pre><code><span>documents</span> <span>=</span> <span>{</span>
    <span>1</span><span>:</span> <span>"a donut on a glass plate"</span><span>,</span>
    <span>2</span><span>:</span> <span>"only the donut"</span><span>,</span>
    <span>3</span><span>:</span> <span>"listen to the drum machine"</span><span>,</span>
<span>}</span>

<span>index</span> <span>=</span> <span>{</span>
    <span>"a"</span><span>:</span> <span>[</span><span>1</span><span>],</span>
    <span>"donut"</span><span>:</span> <span>[</span><span>1</span><span>,</span> <span>2</span><span>],</span>
    <span>"on"</span><span>:</span> <span>[</span><span>1</span><span>],</span>
    <span>"glass"</span><span>:</span> <span>[</span><span>1</span><span>],</span>
    <span>"plate"</span><span>:</span> <span>[</span><span>1</span><span>],</span>
    <span>"only"</span><span>:</span> <span>[</span><span>2</span><span>],</span>
    <span>"the"</span><span>:</span> <span>[</span><span>2</span><span>,</span> <span>3</span><span>],</span>
    <span>"listen"</span><span>:</span> <span>[</span><span>3</span><span>],</span>
    <span>"to"</span><span>:</span> <span>[</span><span>3</span><span>],</span>
    <span>"drum"</span><span>:</span> <span>[</span><span>3</span><span>],</span>
    <span>"machine"</span><span>:</span> <span>[</span><span>3</span><span>],</span>
<span>}</span></code></pre>
<p>Below is a real-world example of the Inverted Index. An index in a book where a term references a page number:</p>
<p><img alt="" src="https://artem.krylysov.com/images/2020-fts/book-index.png">
</p></div>
<div id="text-analysis">
<h3>Text analysis<a href="#text-analysis" title="Permalink to this headline"> #</a></h3>
<p>Before we start building the index, we need to break the raw text down into a list of words (tokens) suitable for indexing and searching.</p>
<p>The text analyzer consists of a tokenizer and multiple filters.</p>
<p><img alt="" src="https://artem.krylysov.com/images/2020-fts/text-analysis.png">
</p></div>
<div id="tokenizer">
<h3>Tokenizer<a href="#tokenizer" title="Permalink to this headline"> #</a></h3>
<p>The tokenizer is the first step of text analysis. Its job is to convert text into a list of tokens. Our implementation splits the text on a word boundary and removes punctuation marks:</p>
<pre><code><span>func</span> <span>tokenize</span><span>(</span><span>text</span> <span>string</span><span>)</span> <span>[]</span><span>string</span> <span>{</span>
    <span>return</span> <span>strings</span><span>.</span><span>FieldsFunc</span><span>(</span><span>text</span><span>,</span> <span>func</span><span>(</span><span>r</span> <span>rune</span><span>)</span> <span>bool</span> <span>{</span>
        <span>// Split on any character that is not a letter or a number.
</span>        <span>return</span> <span>!</span><span>unicode</span><span>.</span><span>IsLetter</span><span>(</span><span>r</span><span>)</span> <span>&amp;&amp;</span> <span>!</span><span>unicode</span><span>.</span><span>IsNumber</span><span>(</span><span>r</span><span>)</span>
    <span>})</span>
<span>}</span></code></pre>
<pre><code><span>&gt;</span> <span>tokenize</span><span>(</span><span>"A donut on a glass plate. Only the donuts."</span><span>)</span>

<span>[</span><span>"A"</span><span>,</span> <span>"donut"</span><span>,</span> <span>"on"</span><span>,</span> <span>"a"</span><span>,</span> <span>"glass"</span><span>,</span> <span>"plate"</span><span>,</span> <span>"Only"</span><span>,</span> <span>"the"</span><span>,</span> <span>"donuts"</span><span>]</span></code></pre>
</div>
<div id="filters">
<h3>Filters<a href="#filters" title="Permalink to this headline"> #</a></h3>
<p>In most cases, just converting text into a list of tokens is not enough. To make the text easier to index and search, we'll need to do additional normalization.</p>
<div id="lowercase">
<h4>Lowercase<a href="#lowercase" title="Permalink to this headline"> #</a></h4>
<p>In order to make the search case-insensitive, the lowercase filter converts tokens to lower case. <em>cAt</em>, <em>Cat</em> and <em>caT</em> are normalized to <em>cat</em>.
Later, when we query the index, we'll lower case the search terms as well. This will make the search term <em>cAt</em> match the text <em>Cat</em>.</p>
<pre><code><span>func</span> <span>lowercaseFilter</span><span>(</span><span>tokens</span> <span>[]</span><span>string</span><span>)</span> <span>[]</span><span>string</span> <span>{</span>
    <span>r</span> <span>:=</span> <span>make</span><span>([]</span><span>string</span><span>,</span> <span>len</span><span>(</span><span>tokens</span><span>))</span>
    <span>for</span> <span>i</span><span>,</span> <span>token</span> <span>:=</span> <span>range</span> <span>tokens</span> <span>{</span>
        <span>r</span><span>[</span><span>i</span><span>]</span> <span>=</span> <span>strings</span><span>.</span><span>ToLower</span><span>(</span><span>token</span><span>)</span>
    <span>}</span>
    <span>return</span> <span>r</span>
<span>}</span></code></pre>
<pre><code><span>&gt;</span> <span>lowercaseFilter</span><span>([]</span><span>string</span><span>{</span><span>"A"</span><span>,</span> <span>"donut"</span><span>,</span> <span>"on"</span><span>,</span> <span>"a"</span><span>,</span> <span>"glass"</span><span>,</span> <span>"plate"</span><span>,</span> <span>"Only"</span><span>,</span> <span>"the"</span><span>,</span> <span>"donuts"</span><span>})</span>

<span>[</span><span>"a"</span><span>,</span> <span>"donut"</span><span>,</span> <span>"on"</span><span>,</span> <span>"a"</span><span>,</span> <span>"glass"</span><span>,</span> <span>"plate"</span><span>,</span> <span>"only"</span><span>,</span> <span>"the"</span><span>,</span> <span>"donuts"</span><span>]</span></code></pre>
</div>
<div id="dropping-common-words">
<h4>Dropping common words<a href="#dropping-common-words" title="Permalink to this headline"> #</a></h4>
<p>Almost any English text contains commonly used words like <em>a</em>, <em>I</em>, <em>the</em> or <em>be</em>. Such words are called <em>stop words</em>. We are going to remove them since almost any document would match the stop words.</p>
<p>There is no "official" list of stop words. Let's exclude the top 10 by the <a href="https://en.wikipedia.org/wiki/Most_common_words_in_English" target="_blank">OEC rank</a>. Feel free to add more:</p>
<pre><code><span>var</span> <span>stopwords</span> <span>=</span> <span>map</span><span>[</span><span>string</span><span>]</span><span>struct</span><span>{}{</span> <span>// I wish Go had built-in sets.
</span>    <span>"a"</span><span>:</span> <span>{},</span> <span>"and"</span><span>:</span> <span>{},</span> <span>"be"</span><span>:</span> <span>{},</span> <span>"have"</span><span>:</span> <span>{},</span> <span>"i"</span><span>:</span> <span>{},</span>
    <span>"in"</span><span>:</span> <span>{},</span> <span>"of"</span><span>:</span> <span>{},</span> <span>"that"</span><span>:</span> <span>{},</span> <span>"the"</span><span>:</span> <span>{},</span> <span>"to"</span><span>:</span> <span>{},</span>
<span>}</span>

<span>func</span> <span>stopwordFilter</span><span>(</span><span>tokens</span> <span>[]</span><span>string</span><span>)</span> <span>[]</span><span>string</span> <span>{</span>
    <span>r</span> <span>:=</span> <span>make</span><span>([]</span><span>string</span><span>,</span> <span>0</span><span>,</span> <span>len</span><span>(</span><span>tokens</span><span>))</span>
    <span>for</span> <span>_</span><span>,</span> <span>token</span> <span>:=</span> <span>range</span> <span>tokens</span> <span>{</span>
        <span>if</span> <span>_</span><span>,</span> <span>ok</span> <span>:=</span> <span>stopwords</span><span>[</span><span>token</span><span>];</span> <span>!</span><span>ok</span> <span>{</span>
            <span>r</span> <span>=</span> <span>append</span><span>(</span><span>r</span><span>,</span> <span>token</span><span>)</span>
        <span>}</span>
    <span>}</span>
    <span>return</span> <span>r</span>
<span>}</span></code></pre>
<pre><code><span>&gt;</span> <span>stopwordFilter</span><span>([]</span><span>string</span><span>{</span><span>"a"</span><span>,</span> <span>"donut"</span><span>,</span> <span>"on"</span><span>,</span> <span>"a"</span><span>,</span> <span>"glass"</span><span>,</span> <span>"plate"</span><span>,</span> <span>"only"</span><span>,</span> <span>"the"</span><span>,</span> <span>"donuts"</span><span>})</span>

<span>[</span><span>"donut"</span><span>,</span> <span>"on"</span><span>,</span> <span>"glass"</span><span>,</span> <span>"plate"</span><span>,</span> <span>"only"</span><span>,</span> <span>"donuts"</span><span>]</span></code></pre>
</div>
<div id="stemming">
<h4>Stemming<a href="#stemming" title="Permalink to this headline"> #</a></h4>
<p>Because of the grammar rules, documents may include different forms of the same word.
Stemming reduces words into their base form. For example, <em>fishing</em>, <em>fished</em> and <em>fisher</em> may be reduced to the base form (stem) <em>fish</em>.</p>
<p>Implementing a stemmer is a non-trivial task, it's not covered in this post. We'll take one of the <a href="https://github.com/kljensen/snowball" target="_blank">existing</a> modules:</p>
<pre><code><span>import</span> <span>snowballeng</span> <span>"github.com/kljensen/snowball/english"</span>

<span>func</span> <span>stemmerFilter</span><span>(</span><span>tokens</span> <span>[]</span><span>string</span><span>)</span> <span>[]</span><span>string</span> <span>{</span>
    <span>r</span> <span>:=</span> <span>make</span><span>([]</span><span>string</span><span>,</span> <span>len</span><span>(</span><span>tokens</span><span>))</span>
    <span>for</span> <span>i</span><span>,</span> <span>token</span> <span>:=</span> <span>range</span> <span>tokens</span> <span>{</span>
        <span>r</span><span>[</span><span>i</span><span>]</span> <span>=</span> <span>snowballeng</span><span>.</span><span>Stem</span><span>(</span><span>token</span><span>,</span> <span>false</span><span>)</span>
    <span>}</span>
    <span>return</span> <span>r</span>
<span>}</span></code></pre>
<pre><code><span>&gt;</span> <span>stemmerFilter</span><span>([]</span><span>string</span><span>{</span><span>"donut"</span><span>,</span> <span>"on"</span><span>,</span> <span>"glass"</span><span>,</span> <span>"plate"</span><span>,</span> <span>"only"</span><span>,</span> <span>"donuts"</span><span>})</span>

<span>[</span><span>"donut"</span><span>,</span> <span>"on"</span><span>,</span> <span>"glass"</span><span>,</span> <span>"plate"</span><span>,</span> <span>"only"</span><span>,</span> <span>"donut"</span><span>]</span></code></pre>
<div>
<p>Note</p>
<p>A stem is not always a valid word. For example, some stemmers may reduce <em>airline</em> to <em>airlin</em>.</p>
</div>
</div>
</div>
<div id="putting-the-analyzer-together">
<h3>Putting the analyzer together<a href="#putting-the-analyzer-together" title="Permalink to this headline"> #</a></h3>
<pre><code><span>func</span> <span>analyze</span><span>(</span><span>text</span> <span>string</span><span>)</span> <span>[]</span><span>string</span> <span>{</span>
    <span>tokens</span> <span>:=</span> <span>tokenize</span><span>(</span><span>text</span><span>)</span>
    <span>tokens</span> <span>=</span> <span>lowercaseFilter</span><span>(</span><span>tokens</span><span>)</span>
    <span>tokens</span> <span>=</span> <span>stopwordFilter</span><span>(</span><span>tokens</span><span>)</span>
    <span>tokens</span> <span>=</span> <span>stemmerFilter</span><span>(</span><span>tokens</span><span>)</span>
    <span>return</span> <span>tokens</span>
<span>}</span></code></pre>
<p>The tokenizer and filters convert sentences into a list of tokens:</p>
<pre><code><span>&gt;</span> <span>analyze</span><span>(</span><span>"A donut on a glass plate. Only the donuts."</span><span>)</span>

<span>[</span><span>"donut"</span><span>,</span> <span>"on"</span><span>,</span> <span>"glass"</span><span>,</span> <span>"plate"</span><span>,</span> <span>"only"</span><span>,</span> <span>"donut"</span><span>]</span></code></pre>
<p>The tokens are ready for indexing.</p>
</div>
<div id="building-the-index">
<h3>Building the index<a href="#building-the-index" title="Permalink to this headline"> #</a></h3>
<p>Back to the inverted index. It maps every word in documents to document IDs.
The built-in <span>map</span> is a good candidate for storing the mapping.
The key in the map is a token (string) and the value is a list of document IDs:</p>
<pre><code><span>type</span> <span>index</span> <span>map</span><span>[</span><span>string</span><span>][]</span><span>int</span></code></pre>
<p>Building the index consists of analyzing the documents and adding their IDs to the map:</p>
<pre><code><span>func</span> <span>(</span><span>idx</span> <span>index</span><span>)</span> <span>add</span><span>(</span><span>docs</span> <span>[]</span><span>document</span><span>)</span> <span>{</span>
    <span>for</span> <span>_</span><span>,</span> <span>doc</span> <span>:=</span> <span>range</span> <span>docs</span> <span>{</span>
        <span>for</span> <span>_</span><span>,</span> <span>token</span> <span>:=</span> <span>range</span> <span>analyze</span><span>(</span><span>doc</span><span>.</span><span>Text</span><span>)</span> <span>{</span>
            <span>ids</span> <span>:=</span> <span>idx</span><span>[</span><span>token</span><span>]</span>
            <span>if</span> <span>ids</span> <span>!=</span> <span>nil</span> <span>&amp;&amp;</span> <span>ids</span><span>[</span><span>len</span><span>(</span><span>ids</span><span>)</span><span>-</span><span>1</span><span>]</span> <span>==</span> <span>doc</span><span>.</span><span>ID</span> <span>{</span>
                <span>// Don't add same ID twice.
</span>                <span>continue</span>
            <span>}</span>
            <span>idx</span><span>[</span><span>token</span><span>]</span> <span>=</span> <span>append</span><span>(</span><span>ids</span><span>,</span> <span>doc</span><span>.</span><span>ID</span><span>)</span>
        <span>}</span>
    <span>}</span>
<span>}</span>

<span>func</span> <span>main</span><span>()</span> <span>{</span>
    <span>idx</span> <span>:=</span> <span>make</span><span>(</span><span>index</span><span>)</span>
    <span>idx</span><span>.</span><span>add</span><span>([]</span><span>document</span><span>{{</span><span>ID</span><span>:</span> <span>1</span><span>,</span> <span>Text</span><span>:</span> <span>"A donut on a glass plate. Only the donuts."</span><span>}})</span>
    <span>idx</span><span>.</span><span>add</span><span>([]</span><span>document</span><span>{{</span><span>ID</span><span>:</span> <span>2</span><span>,</span> <span>Text</span><span>:</span> <span>"donut is a donut"</span><span>}})</span>
    <span>fmt</span><span>.</span><span>Println</span><span>(</span><span>idx</span><span>)</span>
<span>}</span></code></pre>
<p>It works! Each token in the map refers to IDs of the documents that contain the token:</p>
<pre><code>map[donut:[1 2] glass:[1] …</code></pre></div></article></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://artem.krylysov.com/blog/2020/07/28/lets-build-a-full-text-search-engine/">https://artem.krylysov.com/blog/2020/07/28/lets-build-a-full-text-search-engine/</a></em></p>]]>
            </description>
            <link>https://artem.krylysov.com/blog/2020/07/28/lets-build-a-full-text-search-engine/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24051229</guid>
            <pubDate>Tue, 04 Aug 2020 15:59:01 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Planning for My Kidnapping]]>
            </title>
            <description>
<![CDATA[
Score 100 | Comments 96 (<a href="https://news.ycombinator.com/item?id=24050837">thread link</a>) | @polote
<br/>
August 4, 2020 | https://blog.luap.info/planning-for-my-kidnapping.html | <a href="https://web.archive.org/web/*/https://blog.luap.info/planning-for-my-kidnapping.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>

		  <div role="main">
	<article>

		


		<p>Imagine tomorrow you go shopping and, for whatever reason, you never come back. Maybe be someone killed you, maybe someone kidnapped you, maybe you had an accident ... Now imagine you are travelling alone in Thailand and you die. How people who know you are going to find out what happen ? if you are being kidnaped how the police will do to find you, if you got lost how people will find you ? If you die how your family is going to find your papers ?</p>
<p>I wanted to find a way to answer all those questions, basically we can sum up the issues in 3 points :
- In case of being kidnaped or getting lost send as much information on your last location, and following locations, your last activity, all your digital information to someone who is going to help liberating you
- In case of dying, sending all your documents (passwords, friends list, legal documents, ...) to your family
- Not sending those documents by mistakes if you are not on the situations above</p>
<h2>First step : collect your position, your activity, your documents, ...</h2>
<p>The first step is to be sure that you have the data that you want to send, on my part, the data are:</p>
<ol>
<li>My current position and recent history</li>
<li>My last know activity and a recent history</li>
<li>The list of my credentials</li>
<li>The list of my legal documents (id, passport, health insurance, work papers, ...)</li>
</ol>
<p>I've written an <a href="https://blog.luap.info/how-i-track-my-life.html">article</a> explaining how I'm doing 1. and 2. (position in real time, and last activity), so this is fixed.</p>
<p>For my credentials, I use <a href="https://keepassxc.org/">keepassXC</a> with a keyfile + a master password, the keyfile and the password db is synced using <a href="https://syncthing.net/">syncthingd</a> with a server that I rent</p>
<p>My legal documents are all tied in one folder on my laptop which is also synced on the same server</p>
<p>So basically we have all the needed documents which are synced in real time on the same server</p>
<h2>Second step : Choose how to trigger the sharing of documents</h2>
<p>The biggest problem is you want the alert to react quickly but not fire because you have been sleeping for 8 hours. So I chose to rely on the time since I last changed of activity. Currently after 24h without changing activity a first notification is sent to my own email so that if this is a mistake I can stop the system before it is too late. And if 6 hours later I've still haven't changed of activity then a mail is sent to my parents.</p>
<p>So basically if something happens to me my parents will be notified maximum 30h after the event, this is not so great but this is a good beginning. In the future I should try to have an adaptive delay depending on the last activity, for example if my last activity is eating, then I won't eat for 24 hours, so I can trigger the alert after for example 4 hours.</p>
<h2>Last step : What to put inside the notification</h2>
<p>So my parents will receive an email after 30 hours of inactivity. In this email there is a link to a page which will allow them to retrieve all the documents.
<img alt="email" src="https://blog.luap.info/static/kidnap/email.png"></p>
<p>The link is random generated link available only 6 hours, this is important to be safe as you don't want anyone to be able to access all your passwords ...</p>
<p>And the page, there are explanations of that page is about, like, "maybe I was kidnaped, maybe I'm lost, check my last time active on whatsapp, contact xxxx to see if he knows anything"
You can also view the current position of my phone and a small location history, that way you can see if I'm still moving, or if the last point if 30 hours old, you can also see my last activity and when it started</p>
<p>And finally you can get the list of all my passwords, for that purpose I created a form, with 6 facts on my life, that only my parents can know all of them, like what was the color of my first car ..., then there you can submit your answer, there is a rate limit on the number of requests you can make to prevent a brute force. If the 6 answers are true, the backend will decode the keepassxc archive and return a json of the archive, containing all of my credentials, including the ssh password to connect on the server to get all the paper documents.</p>
<h2>Conclusion</h2>
<p>I know that all of that is far from being perfect. I check every few months that the alerting is working, by decreasing the delay to trigger the alert, but the server can go down, ton of things can happen to make the system not working, so that's why I tried to keep everything as simple as possible, postgresql + django + cron. Someone should create a service to manage that at a bigger scale, or maybe that's something that 1password or others could include in their offer</p>	

	</article>


		  </div>	

		  

	  </div></div>]]>
            </description>
            <link>https://blog.luap.info/planning-for-my-kidnapping.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24050837</guid>
            <pubDate>Tue, 04 Aug 2020 15:20:39 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Unlearn rotation matrices as rotations]]>
            </title>
            <description>
<![CDATA[
Score 247 | Comments 103 (<a href="https://news.ycombinator.com/item?id=24049593">thread link</a>) | @dosshell
<br/>
August 4, 2020 | https://kodkodgames.gitlab.io/rotation_matrices/ | <a href="https://web.archive.org/web/*/https://kodkodgames.gitlab.io/rotation_matrices/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
      <main id="main">
        




<i data-feather="calendar"></i> <time datetime="2020-06-12">2020-06-12</time>

<p>– Hey, Markus! What format is this head-rotation representation in?</p>
<p>– It is a rotation matrix, I answer. Right handed, z forward through the nose and x through the left ear. Our young newly graduated colleague nods his/her head.</p>
<p>After about 10 minutes I hear my name again.</p>
<p>– Markus…. Eh, what order is it?</p>
<p>– Oh no! You have opened Wikipedia? Haven’t you? I answer in despair from my desk.</p>
<p>It happens time to time that a newly graduated engineer (or summer intern) asks me exactly this question. Almost always with the Wikipedia page open at the screen, which I think is horrible (or even worse, some “Learn OpenGL” tutorial).</p>
<p>I <s>steal</s> take a chair to sit down beside the person. This will take a few minutes, we are going to do something that is harder than learning: we are going to unlearn.</p>
<p>It is interesting, I get no questions, or only very short questions, on Euler angels, Rodriguez rotations and actually only one recurrent question on quaternions. But very often I get questions on rotation matrices. I think it is a bit odd since rotation matrices are very simple in comparison to many other rotation representations. I think a big reason for this is the Wikipedia page. It looks something like this:</p>
<p>
\[
R_x(\theta) =
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; \cos \theta &amp;  -\sin \theta \\
0 &amp; \sin \theta  &amp;  \cos \theta
\end{bmatrix}
\]
\[
R_y(\theta) =
\begin{bmatrix}
\cos \theta &amp; 0 &amp; \sin \theta \\
0 &amp; 1 &amp; 0 \\
-\sin \theta &amp; 0 &amp; \cos \theta
\end{bmatrix}
\]
\[
R_z(\theta) =
\begin{bmatrix}
\cos \theta &amp;  -\sin \theta &amp; 0 \\
\sin \theta &amp;   \cos \theta &amp; 0\\
0 &amp; 0 &amp; 1\\
\end{bmatrix}
\]
\[
R =
\begin{bmatrix}
\cos\alpha\cos\beta &amp; \cos\alpha\sin\beta\sin\gamma - \sin\alpha\cos\gamma &amp; \cos\alpha\sin\beta\cos\gamma + \sin\alpha\sin\gamma \\
\sin\alpha\cos\beta &amp; \sin\alpha\sin\beta\sin\gamma + \cos\alpha\cos\gamma &amp; \sin\alpha\sin\beta\cos\gamma - \cos\alpha\sin\gamma \\
-\sin\beta &amp; \cos\beta\sin\gamma &amp; \cos\beta\cos\gamma \\
\end{bmatrix}
\]
</p>
<p>It talks about rotations. Rotation around different axes and their relation to Euler angles. This can be a bit confusing when working with for example a head pose. You can of course think about rotation matrices as if the head rotates around different axes in different order, but it becomes kind of hard to interpret:</p>
<p>
\[
\begin{bmatrix}
 -0.9987820 &amp; 0.0348782 &amp; -0.0348995 \\
  0.0283128 &amp; 0.9844193 &amp;  0.1735424 \\
  0.0404086 &amp; 0.1723429 &amp; -0.9842078
\end{bmatrix}
\]
</p>
<p>So to interpret this we need to solve the following equation system:</p>
<p>
\[
\begin{cases}
-\sin(\beta) &amp; = 0.0404086 \\
\cos(\beta)\sin(\gamma) &amp; = 0.1723429 \\
\cos(\alpha)\cos(\beta) &amp; = -0.9987820
\end{cases}
\]
</p>
<p>and then we get an <em>“intrinsic rotation whose Tait–Bryan angles are α, β, γ, about axes z, y, x”</em> to visualize in our head.</p>
<p>Its sad because I think rotation matrices are one of the easiest representation to interpret.</p>
<p>Don’t think of them as rotations, think of them as a unit vectors of a new coordinate systems.</p>
<p><img src="https://kodkodgames.gitlab.io/post/matrix_cs.png#center" alt="plot of the coordinate system"></p>
<p>We describe where the coordinate system is located related to another coordinate system (where we rotate from), for example from the camera’s coordinate system perspective (z forward, y upwards). The first column of the rotation matrix is the new x-axis expressed in the old coordinate system, the second column is the y-axis and so on. An identity matrix would yield in no rotation since all unit vectors would be the same as the previous coordinate system.</p>
<p>
\[
R =
\begin{bmatrix}
  X_x &amp; Y_x &amp; Z_x \\
  X_y &amp; Y_y &amp;  Z_y \\
  X_z &amp; Y_z &amp; Z_z
\end{bmatrix}
\]
</p> 
<p>Lets go back to the example with the head expressed in the camera coordinate system and assume the head position is atfront of the camera. So by interpret the previous matrix, we can look at the new z-axis:</p>
<p>
\[
Z_{axis} = 
\begin{bmatrix}
Z_x \\
Z_y \\
Z_z
\end{bmatrix}
=
\begin{bmatrix}
-0.0348995 \\
0.1735424 \\
-0.9842078
\end{bmatrix}
\]
</p>
<p>(Remember that z-axis is where the head’s nose is pointing)</p>
<p>We can quickly see that z-part of the z-axis is almost -1. This means the nose is pointing at the opposite direction as the camera, eg. towards the camera if the person is sitting at front of it.</p>
<p>We can also se that the persons head is rotated a little bit up (positive y component of the z-axis) and is pointing a little bit to the right of the camera (negative x component).</p>
<p>And that’s it! Rotation matrices just describe the unit vectors of a new coordinate system.</p>
<p>…</p>
<p>– Hey, Markus! How come this matrix is 4x4?</p>
<p>// Markus</p>
<p><a href="https://news.ycombinator.com/item?id=24049593">HN discussion</a></p>




      </main>
    </div></div>]]>
            </description>
            <link>https://kodkodgames.gitlab.io/rotation_matrices/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24049593</guid>
            <pubDate>Tue, 04 Aug 2020 13:12:55 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Crux SQL]]>
            </title>
            <description>
<![CDATA[
Score 169 | Comments 29 (<a href="https://news.ycombinator.com/item?id=24049349">thread link</a>) | @yogthos
<br/>
August 4, 2020 | https://juxt.pro/blog/crux-sql | <a href="https://web.archive.org/web/*/https://juxt.pro/blog/crux-sql">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><div id="preamble">
<div>
<p>We were pleased when <a href="https://opencrux.com/">Crux</a> was included in the
ThoughtWorks
<a href="https://www.thoughtworks.com/radar/platforms/crux">technology radar</a>
with a recommendation to <strong>assess</strong>:</p>
<div>
<blockquote>
<p>Crux is an open-source document database with bitemporal graph
queries…​ it’s currently in alpha and lacks SQL support, but you can
use a Datalog query interface for reading and traversing
relationships.</p>
</blockquote>
<p>
— ThoughtWorks Technology Radar
</p>
</div>
<p>We are fans of <a href="https://en.wikipedia.org/wiki/Datalog">Datalog</a> and the
power it gives. Although it’s not directly compatible and may drift
out further, we’ve based our Datalog query API on
<a href="https://docs.datomic.com/on-prem/query">Datomic’s</a>, where Datalog
is represented as a pattern-matching declarative data-structure.</p>
<p>Datalog is easy to construct and parse and it is natural to make use
of custom predicates and rules as part of the logical pattern
matching.</p>
<p>We love Datalog, but it’s also fair to say that a sizeable chunk of
potential users will want to use SQL. Be it for users who want to run
ad-hoc SQL queries without needing to know Datalog, or for integration
between systems where SQL is the lingua franca, it’s important that we
support it.</p>
</div>
</div>
<div>
<h2 id="_code_crux_sql_code"><a href="#_code_crux_sql_code"></a><code>crux-sql</code></h2>
<div>
<p>We have created a new <code>crux-sql</code> module in Crux which makes use of the
<a href="https://calcite.apache.org/">Apache Calcite</a> SQL query planning engine. Calcite
is a powerful library for exposing SQL queries against arbitrary data-sources
and has been integrated with a variety of DBMSs such as Cassandra, Mongo and
Elastic, as well as Big Data systems like Hive, Drill, Flink and Dremio.</p>
<p>Calcite has been around for a long while and is still very
active. We’re grateful for the work the Calcite team have put into
this tool and the power it gives, as well as the friendly community that
has built up around it.</p>
<p>We run Calcite in-process as part of a Crux node, so there’s no need
to set up any additional infrastructure. Rather you just need to add
the <code>crux-sql</code> module dependency:</p>
<div>
<div>
<pre><code data-lang="clojure">[juxt/crux-sql "RELEASE"]]</code></pre>
</div>
</div>
<p>We have integrated Calcite such that SQL queries are translated to
efficient Datalog queries, including sorts and inner joins.</p>
<p>You can avoid the relatively small overhead of preparing queries by
using PreparedStatements.</p>
<p>Please visit the
<a href="https://github.com/juxt/crux/blob/master/crux-sql/README.adoc">module
README</a> for how to get going with some simple steps, or please watch
this video:</p>
<div>
<p>
<iframe src="https://www.youtube.com/embed/HEBL_ue2wbw?rel=0" frameborder="0" allowfullscreen=""></iframe>
</p>
</div>
<p>The <code>crux-sql</code> module allows for both in-process SQL queries and for
remote JDBC queries using
<a href="https://calcite.apache.org/avatica/">Avatica</a>. This is covered in the
docs.</p>
</div>
</div>
<div>
<h2 id="_next_up"><a href="#_next_up"></a>Next Up</h2>
<div>
<p>See the <code>crux-sql</code>
<a href="https://github.com/juxt/crux/tree/master/crux-sql">README</a> for more
details.</p>
<p>Stay tuned for another blog and video on how to write Crux SQL
bitemporal queries.</p>
<p>As ever, if you have queries about Crux, please ping the team:</p>

<p><em>Image credit: Oliver Hine</em></p>
</div>
</div></div></div>]]>
            </description>
            <link>https://juxt.pro/blog/crux-sql</link>
            <guid isPermaLink="false">hacker-news-small-sites-24049349</guid>
            <pubDate>Tue, 04 Aug 2020 12:45:10 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[SIMD Everywhere: 0.5.0]]>
            </title>
            <description>
<![CDATA[
Score 155 | Comments 53 (<a href="https://news.ycombinator.com/item?id=24048562">thread link</a>) | @lelf
<br/>
August 4, 2020 | https://simd-everywhere.github.io/blog/announcements/release/2020/06/21/0.5.0-release.html | <a href="https://web.archive.org/web/*/https://simd-everywhere.github.io/blog/announcements/release/2020/06/21/0.5.0-release.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <p>I’m pleased to announce the availability of the first release of <a href="https://github.com/simd-everywhere/simde">SIMD
Everywhere</a> (SIMDe),
<a href="https://github.com/simd-everywhere/simde/releases">version 0.5.0</a>,
representing more than three years of work by over a dozen developers.</p>

<p>SIMDe is a permissively-licensed (MIT) header-only library which
provides fast, portable implementations of
<a href="https://en.wikipedia.org/wiki/SIMD">SIMD</a> intrinsics for platforms
which aren’t natively supported by the API in question.</p>

<p>For example, with SIMDe you can use
<a href="https://en.wikipedia.org/wiki/Streaming_SIMD_Extensions">SSE</a> on
<a href="https://en.wikipedia.org/wiki/ARM_architecture">ARM</a>,
<a href="https://en.wikipedia.org/wiki/IBM_POWER_instruction_set_architecture">POWER</a>,
<a href="https://webassembly.org/">WebAssembly</a>, or almost any platform with a
C compiler.  That includes, of course, x86 CPUs which don’t support
the ISA extension in question (<em>e.g.</em>, calling AVX-512F functions on a
CPU which doesn’t natively support them).</p>

<p>If the target natively supports the SIMD extension in question there
is no performance penalty for using SIMDe.  Otherwise, accelerated
implementations, such as NEON on ARM, AltiVec on POWER, WASM SIMD on
WebAssembly, etc., are used when available to provide good
performance.</p>

<p>SIMDe has already been used to port several packages to additional
architectures through either upstream support or distribution
packages, <a href="https://wiki.debian.org/SIMDEverywhere">particularly on
Debian</a>.</p>

<p>If you’d like to play with SIMDe online, you can do so <a href="https://simde.netlify.app/godbolt/demo">on Compiler
Explorer</a>.</p>

<h2 id="what-is-in-050">What is in 0.5.0</h2>

<p>The 0.5.0 release is SIMDe’s first release.  It includes complete
implementations of:</p>

<ul>
  <li>MMX</li>
  <li>SSE</li>
  <li>SSE2</li>
  <li>SSE3</li>
  <li>SSSE3</li>
  <li>SSE4.1</li>
  <li>AVX</li>
  <li>FMA</li>
  <li>GFNI</li>
</ul>

<p>We also have rapidly progressing implementations of many other
extensions including NEON, AVX2, SVML, and several AVX-512 extensions
(AVX-512F, AVX-512BW, AVX-512VL, etc.).</p>

<p>Additionally, we have an extensive test suite to verify our
implementations.</p>

<h2 id="what-is-coming-next">What is coming next</h2>

<p>Work on SIMDe is proceeding rapidly, but there are a lot of functions
to implement… x86 alone has about 6,000 SIMD functions, and we’ve
implemented about 2,000 of them.  We will keep adding more functions
and improving the implementations we already have.</p>

<p>Our NEON implementation is being worked on very actively right now
by Sean Maher and Christopher Moore, and is expected to continue
progressing rapidly.</p>

<p>We currently have two Google Summer of Code students working on the
project as well; <a href="https://masterchef2209.wordpress.com/2020/06/17/guide-to-intel-sse4-2-crc-intrinisics-implementation-for-simde/">Hidayat
Khan</a>
is working on finishing up AVX2, and <a href="https://medium.com/@himanshi18037">Himanshi
Mathur</a> is focused on SVML.</p>

<p>If you’re interested in using SIMDe but need some specific functions
to be implemented first, please <a href="https://github.com/simd-everywhere/simde/issues/new">file an
issue</a> and we may
be able to prioritize those functions.</p>

<h2 id="getting-involved">Getting Involved</h2>

<p>If you’re interested in helping out please get in touch.  We have <a href="https://gitter.im/simd-everywhere/community">a
chat room on Gitter</a>
which is fairly active if you have questions, or of course you can
just dive right in on <a href="https://github.com/simd-everywhere/simde/issues">the issue
tracker</a>.</p>

  </div>
</article>

      </div>
    </div></div>]]>
            </description>
            <link>https://simd-everywhere.github.io/blog/announcements/release/2020/06/21/0.5.0-release.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24048562</guid>
            <pubDate>Tue, 04 Aug 2020 10:36:29 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Show HN: Royalty-Free SVG Illustrations and Animations]]>
            </title>
            <description>
<![CDATA[
Score 205 | Comments 21 (<a href="https://news.ycombinator.com/item?id=24048508">thread link</a>) | @andyydao
<br/>
August 4, 2020 | https://www.pixeltrue.com/free-illustrations | <a href="https://web.archive.org/web/*/https://www.pixeltrue.com/free-illustrations">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page">
<!-- End Facebook Pixel Code -->


<!-- Global site tag (gtag.js) - Google Analytics -->










<div><div data-collapse="medium" data-animation="default" data-duration="400" role="banner"><div><p><a href="https://www.pixeltrue.com/illustrations"><img src="https://uploads-ssl.webflow.com/5dd3495558fd7f3d1fcb52bc/5e3aa42df0539d7ca0cc413e_Artboard.png" srcset="https://uploads-ssl.webflow.com/5dd3495558fd7f3d1fcb52bc/5e3aa42df0539d7ca0cc413e_Artboard-p-500.png 500w, https://uploads-ssl.webflow.com/5dd3495558fd7f3d1fcb52bc/5e3aa42df0539d7ca0cc413e_Artboard-p-800.png 800w, https://uploads-ssl.webflow.com/5dd3495558fd7f3d1fcb52bc/5e3aa42df0539d7ca0cc413e_Artboard.png 969w" sizes="(max-width: 991px) 120px, (max-width: 1919px) 130px, 200px" alt=""></a></p></div></div></div><div><div><div><p>To be the first to know about upcoming free illustrations consider signing up to our <a href="#newsletter">newsletter</a> <a target="_blank" href="http://bit.ly/popupcheck"><strong></strong></a>.</p><p>These <strong>Free SVG Illustrations</strong> AND <strong>Lottie Animations</strong> are available for free for personal and commercial use (MIT License). In other words: <strong>you can do whatever you want with them.</strong></p></div></div></div><div><div role="list"><div role="listitem"><p>robot error settings broken repair</p><a href="https://www.pixeltrue.com/free/error-monochrome" target="_blank"></a><p><a href="https://firebasestorage.googleapis.com/v0/b/illustrations-membership.appspot.com/o/Free%20Illustrations%2FError%20BW.zip?alt=media&amp;token=a45f1df1-2a6d-4197-8708-95a6881eb3ad" data-gatrack="free illustrations,download button,User clicked download button">DOWNLOAD</a></p></div><div role="listitem"><p>robot error settings broken repair</p><a href="https://www.pixeltrue.com/free/error-colour" target="_blank"></a><p><a href="https://firebasestorage.googleapis.com/v0/b/illustrations-membership.appspot.com/o/Free%20Illustrations%2FError%20-%20Colour.zip?alt=media&amp;token=ed6065b8-f5cd-4348-9f91-2da69a82f6e8" data-gatrack="free illustrations,download button,User clicked download button">DOWNLOAD</a></p></div><div role="listitem"><p>success health fitness celebration finish marathon</p><a href="https://www.pixeltrue.com/free/success-monochrome" target="_blank"></a><p><a href="https://firebasestorage.googleapis.com/v0/b/illustrations-membership.appspot.com/o/Free%20Illustrations%2FSuccess%20BW.zip?alt=media&amp;token=0a501d4a-66d4-4dda-8f7b-dbf32ee138f9" data-gatrack="free illustrations,download button,User clicked download button">DOWNLOAD</a></p></div><div role="listitem"><p>success health fitness celebration finish marathon</p><a href="https://www.pixeltrue.com/free/success-colour" target="_blank"></a><p><a href="https://firebasestorage.googleapis.com/v0/b/illustrations-membership.appspot.com/o/Free%20Illustrations%2FSuccess%20Colour.zip?alt=media&amp;token=95783604-14b8-40eb-b4a5-6fc36adefb95" data-gatrack="free illustrations,download button,User clicked download button">DOWNLOAD</a></p></div></div></div><div id="newsletter"><div><p>Get new free illustrations every week emailed to you<br></p><p>Plus nothing but quality pixels in your inbox every week!<br></p><div><div><p>Success! Stay tuned for some exciting content 🔥</p></div><div><p>Oops! Something went wrong while submitting the form.</p></div></div></div></div><!--[if lte IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]-->
 



















<!-- Start Infinite Scroll -->



<!-- End Infinite Scroll -->





</div>]]>
            </description>
            <link>https://www.pixeltrue.com/free-illustrations</link>
            <guid isPermaLink="false">hacker-news-small-sites-24048508</guid>
            <pubDate>Tue, 04 Aug 2020 10:25:46 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Shipshape RenderMan Art Challenge]]>
            </title>
            <description>
<![CDATA[
Score 54 | Comments 6 (<a href="https://news.ycombinator.com/item?id=24047731">thread link</a>) | @mariuz
<br/>
August 4, 2020 | https://blog.yiningkarlli.com/2020/07/shipshape-renderman-challenge.html | <a href="https://web.archive.org/web/*/https://blog.yiningkarlli.com/2020/07/shipshape-renderman-challenge.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div role="main">
    <article>

            
            <span>July 31, 2020 
                 | Tags: 
                     
                        Art
                      
                </span>

            <section>
                <div>

  <p>Last year, I <a href="https://blog.yiningkarlli.com/2019/11/woodville-renderman-challenge.html">participated in one of Pixar’s RenderMan Art Challenges</a> as a way to learn more about RenderMan <a href="https://dl.acm.org/citation.cfm?id=3182162">(Christensen et al. 2018)</a> and as a way to get some exposure to tools outside of my normal day-to-day toolset (Disney’s Hyperion Renderer professionally, Takua Render as a hobby and learning exercise).
I had a lot of fun, and wound up doing better in the “Woodville” art challenge contest than I expected to!
Recently, I entered another one of <a href="https://renderman.pixar.com/news/renderman-shipshape-art-challenge">Pixar’s RenderMan Art Challenges, “Shipshape”</a>.
This time around I entered just for fun; since I had so much fun last time, I figured why not give it another shot!
That being said though, I want to repeat the main point I made in my post about the previous “Woodville” art challenge: I believe that for rendering engineers, there is enormous value in learning to use tools and renderers that aren’t the ones we work on ourselves.
Our field is filled with brilliant people on every major rendering team, and I find both a lot of useful information/ideas and a lot of joy in seeing the work that friends and peers across the field have put into commercial renderers such as RenderMan, Arnold, Vray, Corona, and others.</p>

  <p>As usual for the RenderMan Art Challenges, Pixar <a href="https://renderman.pixar.com/shipshape-pup-asset">supplied some base models</a> without any uvs, texturing, shading, lighting or anything else, and challenge participants had to start with the base models and come up with a single compelling image for a final entry.
I had a lot of fun spending evenings and weekends throughout the duration of the contest to create my final image, which is below.
I got to explore and learn a lot of new things that I haven’t tried before, which this post will go through.
To my enormous surprise, this time around my entry <a href="https://renderman.pixar.com/news/renderman-shipshape-art-challenge-final-results">won first place in the contest</a>!</p>

  <p><a href="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/shipshape_full_4k.jpg"><img src="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/preview/shipshape_full.jpg" alt="Figure 1: My entry to Pixar's RenderMan Shipshape Art Challenge, titled &quot;Oh Good, The Bus is Here&quot;. Click for 4K version. Base ship, robot, and sextant models are from Pixar; all shading, lighting, additional modeling, and environments are mine. Ship concept by Ian McQue. Robot concept by Ruslan Safarov. Models by Cheyenne Chapel, Aliya Chen, Damian Kwiatkowski, Alyssa Minko, Anthony Muscarella, and Miguel Zozaya © Disney / Pixar - RenderMan &quot;Shipshape&quot; Art Challenge."></a></p>

  <p><strong>Initial Explorations</strong></p>

  <p>For this competition, Pixar provided five models: a futuristic scifi ship based on an Ian McQue concept, a robot based on a Ruslan Safarov concept, an old wooden boat, a butterfly, and a sextant.
The fact that one of the models was based on an Ian McQue concept was enough to draw me in; I’ve been a big fan of Ian McQue’s work for many years now!
I like to start these challenges by just rendering the provided assets as-is from a number of different angles, to try to get a sense of what I like about the assets and how I will want to showcase them in my final piece.
I settled pretty quickly on wanting to focus on the scifi ship and the robot, and leave the other three models aside.
I did find an opportunity to bring in the sextant in my final piece as well, but wound up dropping the old wooden boat and the butterfly altogether.
Here are some simple renders showing what was provided out of the box for the scifi ship and the robot:</p>

  <p><a href="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/scifiship_base.jpg"><img src="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/scifiship_base.jpg" alt="Figure 2: Scifi ship base model provided by Pixar, rendered against a white cyclorama background using a basic skydome."></a></p>

  <p><a href="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/robot_base.jpg"><img src="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/robot_base.jpg" alt="Figure 3: Robot base model provided by Pixar, rendered against a white cyclorama background using a basic skydome."></a></p>

  <p>I initially had a lot of trouble settling on a concept and idea for this project; I actually started blocking out an entirely different idea before pivoting to the idea that eventually became my final image.
My initial concept included the old wooden boat in addition the scifi ship and the robot; this initial concept was called “River Explorer”.
My initial instinct was to try to show the scifi ship from a top-down view, in order to get a better view of the deck-boards and the big VG engine and the crane arm.
I liked the idea of putting the camera at roughly forest canopy height, since forest canopy height is a bit of an unusual perspective for most photographs due to canopy height being this weird height that is too high off the ground for people to shoot from, but too low for helicopters or drones to be practical either.
My initial idea was about a robot-piloted flying patrol boat exploring an old forgotten river in a forest; the ship would be approaching the old sunken boat in the river water.
With this first concept, I got as far as initial compositional blocking and initial time-of-day lighting tests:</p>

  <p><a href="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/progress_012.jpg"><img src="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/preview/progress_012.jpg" alt="Figure 4: Initial &quot;River Explorer&quot; concept, daylight lighting test."></a></p>

  <p><a href="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/progress_013.jpg"><img src="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/preview/progress_013.jpg" alt="Figure 5: Initial &quot;River Explorer&quot; concept, dusk lighting test."></a></p>

  <p>If you’ve followed my blog for a while now, those pine trees might look familiar.
They’re actually the same trees from <a href="https://blog.yiningkarlli.com/2018/10/bidirectional-mipmap.html">the forest scene I used a while back</a>, ported from Takua’s shading system to RenderMan’s PxrSurface shader.</p>

  <p>I wasn’t ever super happy with the “River Explorer” concept; I think the overall layout was okay, but it lacked a sense of dynamism and overall just felt very static to me, and the robot on the flying scifi ship felt kind of lost in the overall composition.
Several other contestants wound up also going for similar top-down-ish views, which made me worry about getting lost in a crowd of similar-looking images.
After a week of trying to get the “River Explorer” concept to work better, I started to play with some completely different ideas; I figured that this early in the process, a better idea was worth more than a week’s worth of sunk time.</p>

  <p><strong>Layout and Framing</strong></p>

  <p>I had started UV unwrapping the ship already, and whilst tumbling around the ship unwrapping all of the components one-by-one, I got to see a lot more of the ship and a lot more interesting angles, and I suddenly came up with a completely different idea for my entry.
The idea that popped into my head was to have a bunch of the little robots waiting to board one of the flying ships at a quay or something of the sort.
I wanted to convey a sense of scale between the robots and the flying scifi ship, so I tried putting the camera far away and zooming in using a really long lens.
Since long lenses have the effect of flattening perspective a bit, using a long lens helped make the ships feel huge compared to the robots.
At this point I was just doing very rough, quick, AO render “sketches”.
This is the AO sketch where my eventual final idea started:</p>

  <p><a href="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/progress_015.jpg"><img src="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/progress_015.jpg" alt="Figure 6: Rough AO render &quot;sketch&quot; that eventually evolved into my final idea."></a></p>

  <p>I’ve always loved the idea of the mundane fantastical; the flying scifi ship model is fairly fantastical, which led me to want to do something more everyday with them.
I thought it would be fun to texture the scifi ship model as if it was just part of a regular metro system that the robots use to get around their world.
My wife, Harmony, suggested a fun idea: set the entire scene in drizzly weather and give two of the robots umbrellas, but give the third robot a briefcase instead and have the robot use the briefcase as a makeshift umbrella, as if it had forgotten its umbrella at home.
The umbrella-less robot’s reaction to seeing the ship arriving provided the title for my entry- “Oh Good, The Bus Is Here”.
Harmony also pointed out that the back of the ship has a lot more interesting geometric detail compared to the front of the ship, and suggested placing the focus of the composition more on the robots than on the ships.
To incorporate all of these ideas, I played more with the layout and framing until I arrived at the following image, which is broadly the final layout I used:</p>

  <p><a href="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/progress_019.jpg"><img src="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/progress_019.jpg" alt="Figure 7: Rough AO render &quot;sketch&quot; of my final layout."></a></p>

  <p>I chose to put an additional ship in the background flying away from the dock for two main reasons.
First, I wanted to be able to showcase more of the ship, since the front ship is mostly obscured by the foreground dock.
Second, the background ship helps fill out and balance the right side of the frame more, which would otherwise have been kind of empty.</p>

  <p>In both this project and in the previous Art Challenge, my workflow for assembling the final scene relies heavily on Maya’s referencing capabilities.
Each separate asset is kept in its own .ma file, and all of the .ma files are referenced into the main scene file.
The only the things the main scene file contains are references to assets, along with scene-level lighting, overrides, and global-scale effects such as volumes and, in the case of this challenge, the rain streaks.
So, even though the flying scifi ship appears in my scene twice, it is actually just the same .ma file referenced into the main scene twice instead of two separate ships.</p>

  <p>The idea of a rainy scene largely drove the later lighting direction of my entry; from this point I basically knew that the final scene was going to have to be overcast and drizzly, with a heavy reliance on volumes to add depth separation into the scene and to bring out practical lights on the ships.
I had a lot of fun modeling out the dock and gangway, and may have gotten slightly carried away.
I modeled every single bolt and rivet that you would expect to be there in real life, and I also added lampposts to use later as practical light sources for illuminating the dock and the robots.
Once I had finished modeling the dock and had made a few more layout tweaks, I arrived at a point where I was happy to start with shading and initial light blocking.
Zoom in if you want to see all of the rivets and bolts and stuff on the dock:</p>

  <p><a href="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/progress_032.jpg"><img src="https://blog.yiningkarlli.com/content/images/2020/Jul/shipshape/progress_032.jpg" alt="Figure 8: AO render of my layout going into shading and lighting. Check out all of the crazy detail on the dock that I modeled!"></a></p>

  <p><strong>UV Unwrapping</strong></p>

  <p>UV unwrapping the ship took a ton of time.
For the last challenge, I relied on a combination of manual UV unwrapping by hand in Maya and using <a href="https://www.sidefx.com/tutorials/houdini-game-dev-tools-auto-uvs/">Houdini’s Auto UV SOP</a>, but I found that the Auto UV SOP didn’t work as well on this challenge due to the ship and robot having a lot of strange geometry with really complex topology.
On the treehouse in the last challenge, everything was more or less some version of a cylinder or a rectangular prism, with some morphs and warps and extra bits and bobs applied.
Almost every piece of the ship aside from the floorboards are very complex shapes that aren’t easy to find good seams for, so the Auto UV SOP wound up making a lot of choices for UV cuts that I didn’t like.
As a result, I basically manually UV unwrapped this entire challenge in Maya.</p>

  <p>A lot of the complex undercarriage type stuff around the back thrusters on the ship was really insane to unwrap.
The muffler manifold and mechanical parts of the crane arm were difficult too.
Fortunately though, the models came with subdivision creases, and a lot of the subd crease tags wound up proving to be useful hints towards good places to place UV edge cuts.
I also found …</p></div></section></article></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://blog.yiningkarlli.com/2020/07/shipshape-renderman-challenge.html">https://blog.yiningkarlli.com/2020/07/shipshape-renderman-challenge.html</a></em></p>]]>
            </description>
            <link>https://blog.yiningkarlli.com/2020/07/shipshape-renderman-challenge.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24047731</guid>
            <pubDate>Tue, 04 Aug 2020 08:02:40 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The best Parts of Visual Studio Code are proprietary]]>
            </title>
            <description>
<![CDATA[
Score 418 | Comments 263 (<a href="https://news.ycombinator.com/item?id=24047638">thread link</a>) | @ingve
<br/>
August 4, 2020 | https://underjord.io/the-best-parts-of-visual-studio-code-are-proprietary.html | <a href="https://web.archive.org/web/*/https://underjord.io/the-best-parts-of-visual-studio-code-are-proprietary.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
<small>2020-08-03</small><!-- RSS:2020-08-03T07:25:00Z -->
<p>I've been very surprised and delighted over a number of years now by Microsoft's strong efforts in open
    source. I understand the skeptics, I was on Slashdot when they tried to sue Linux out of existence and I think only
    time will tell. I figure MS contributing is better than them hunting Linux distributions for sport. So I was mostly
    onboard for Microsofts efforts and I've especially found Visual Studio Code useful.</p>
<p>To settle a few things. When I tweeted on this subject I only got the response that I should use vim. Thanks. Great.
    I can and do on use vim. That misses a number of points. Visual Studio Code is an immensely popular editor and
    likely the most common recommendations to new developers. The primary reason I've used Visual Studio Code is
    that it has an incredibly compelling solution for remote pairing in the form of LiveShare. I've used that for a
    while with great success mentoring, coaching and generally working with other developers of varying experience and
    editor preferences. Most programmers can handle a "normal" editor like VS Code while something like Emacs
    or Vim depends a lot more on what they've learned.</p>
<p>I also ended up enjoying the Remote series of extensions for developing effectively inside remote servers or local
    containers.</p>
<h2>These things are proprietary</h2>
<p>At some point I read a piece of license that said that LiveShare could only be used with the Visual Studio family of
    products. "Huh, that sounds weird, VS Code is open source right?"</p>
<p>Sure enough. VS Code is fully MIT. The binary distribution has a separate license to allow telemetry and protect
    Microsoft trademarks and stuff. Nothing particularly weird, I can't really get worked up about telemetry, I know
    some can. But the extensions.. These extensions are in my book core differentiators that makes VS Code compelling.
    For me it is definitely part of what pushes it beyond the much leaner Sublime (paid, closed source) I was using
    before.</p>
<p>These extensions have a license limiting them and their online service parts to only be used with the Visual Studio
    family of products. This is the <a href="https://microsoftdocs.github.io/live-share/license/eula.html" title="License for LiveShare">license for LiveShare</a> and this is the <a href="https://code.visualstudio.com/preview-license" title="License for Remote">license for Remote</a>.</p>
<p>For me LiveShare is the most important thing. Google Docs style collaborative code editing, terminal sharing, port
    sharing and a bunch more features. I know Atom had an extension like this, I haven't checked the licensing there
    or tried it recently.</p>
<p>Remote is a very strong extension as well for anyone working on a server over SSH or in a container. It helps by
    installing extensions on the destination to allow language servers and such. I've seen it do terrible things to
    servers sometimes but it is very useful and generally works well.</p>
<p>It makes me uneasy to accept VS Code as an "open" project in any wider meaning of the word when compelling
    features are legally locked to only work inside the family of Visual Studio products. It makes me less certain that
    this isn't the Extend in Embrace, Extend, Extinguish. It also frustrates me that this prevents someone from
    building a compatible plugin for VIM or any other editor. This would be much more powerful if it could be in all the
    IntelliJs as well.</p>
<p>You'll find a repo for <a href="https://github.com/MicrosoftDocs/live-share" title="LiveShare on GitHub">LiveShare on GitHub</a> but it is only for documentation and issue tracking. There
    is no code. Same for <a href="https://github.com/microsoft/vscode-remote-release" title="Remote on GitHub">Remote</a>.</p>
<h2>The entire marketplace is proprietary</h2>
<p>Some additional salt in this particular wound is that the use of the Marketplace of VS Code extensions is also
    proprietarily licensed. So all these open source developers are shoving their extensions into a competitive
    advantage for one of the world's largest tech firms. And they disallow other uses of the marketplace. Even if
    the letter of open source is followed there is none of the openness, collaborative or community essence that I think
    exemplifies open source and free software projects.</p>
<p>What does this mean in practice? I guess it protects from the competition. Such as the <a href="https://github.com/VSCodium/vscodium" title="VS Codium">VS Codium</a> project which provides VS Code
    binaries without the proprietary parts. But also, as a consequence of this, without the Marketplace of extensions.
    There is an open source alternative called <a href="https://open-vsx.org/" title="Open VSX">Open VSX</a>, but since
    it isn't the canonical one it is missing a bunch of extensions and the big Liveshare and Remote ones are still
    not allowed.</p>
<p>This also blocks the <a href="https://github.com/cdr/code-server" title="code-server">code-server editor</a> that
    allows running VS Code in the browser from using it which otherwise would have been perfect for me to do development
    on an iPad Pro. I can still use that but a lot of packages are not in Open VSX.</p>
<h2>What about lock-in?</h2>
<p>Visual Studio Code is marketed with LiveShare and Remote as powerful extensions. VS Code is also marketed as open
    source. It is easy to use the editor, install the extensions and be under the impression that you are using an open
    source software suite where Microsoft simply hosts the peering service for identifying and connecting you and your
    collaborator.</p>
<p>But the peering service is not the only closed part. The extensions are not open source projects as far as I can find
    and they are licensed during distribution in a way that disallows using them with anything but Visual Studio
    products.</p>
<p>This leaves me with a sour taste in my mouth. I wasn't sold on having an Electron-based editor to begin with but
    VS Code was substantially leaner than Atom so I've been mostly accepting it.</p>
<p>If you have good suggestions for strong collaborative development tools that are open source, please let me know at
    <a href="mailto:lars@underjord.io">lars@underjord.io</a> or on Twitter <a href="https://twitter.com/lawik">@lawik</a>. If you want to follow my writing the RSS feed is
    right below. If you want more of my writing I have a tracking-free newsletter that I'd love for you to sign up for,
    also below.</p></div></div>]]>
            </description>
            <link>https://underjord.io/the-best-parts-of-visual-studio-code-are-proprietary.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24047638</guid>
            <pubDate>Tue, 04 Aug 2020 07:42:40 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Learn Functional Programming Design from Redux]]>
            </title>
            <description>
<![CDATA[
Score 55 | Comments 44 (<a href="https://news.ycombinator.com/item?id=24046631">thread link</a>) | @daiyanze
<br/>
August 3, 2020 | https://pitayan.com/posts/redux-fp-design/?ref=hackernews | <a href="https://web.archive.org/web/*/https://pitayan.com/posts/redux-fp-design/?ref=hackernews">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><p>Before I set my eyes on the Redux source code, I naively thought OOP is superior than FP(Functional Programming) as a programming paradigm. But this is not right. As we know that FP is dedicated to forming a easy to understand and clear workflow without those obscure abstracted objects and relations. It's much closer to human's procedural mode of thinking.</p><p>Now <code>React</code> has already got hooks which can handle the "states" properly event without <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a>. The demand for <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a> could be declining but its code base is still worth learning. Especially for those who wants to enlighten themselves in functional programming. So, I guess it's never a bad idea to learn from a good example even though it is "obsolete" (not at all).</p><p>When I started reading the <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a> source code, I immediately felt the power of this unfamiliar usage of my familiar programming language. It feels like exploring an acient cave with a torch lighting up the paintings and found the great secret.</p><p>In order to know more about what Redux benefits from FP, I researched the <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a> source code and created a mini version of it.</p><blockquote><p>Never be afraid of reinventing the wheel.</p></blockquote><p><strong>Contents:</strong></p><ul><li><a href="#recap-how-redux-works">Recap How Redux Works</a></li><li><a href="#redux-approach-comparison-fp-vs-oop">Redux Approach Comparison: FP vs OOP</a></li><li><a href="#wonderful-redux-fp-design">Wonderful Redux FP Design</a><ul><li><a href="#createstore">createStore</a></li><li><a href="#combinereducers">combineReducers</a></li><li><a href="#applymiddleware">applyMiddleware</a></li></ul></li><li><a href="#redux-middlewares">Redux Middlewares</a><ul><li><a href="#redux-thunk">Redux Thunk</a></li><li><a href="#redux-logger">Redux Logger</a></li></ul></li><li><a href="#a-demo-app">A demo app</a></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#references">References</a></li></ul><h2 id="recap-how-redux-works"><a href="#recap-how-redux-works">Recap How Redux Works</a></h2><p>There are 4 basic key points for <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a>:</p><ol><li>Create a store for data and let the view subscribe to it</li><li>The view dispatches an action to submit the changs</li><li>The reducer changes the state based on the action type</li><li>Finally return the new state and triggers the view to change</li></ol><p>This is the classic diagram explaining how <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a> works:</p><p><img src="https://d33wubrfki0l68.cloudfront.net/b1117a23634125a8e2195b0dfc8fc1a29c511fac/3f628/assets/static/redux.b474ba6.ff6f3365031ebcab6ddfefc3aadeb376.jpg" width="1088" alt="redux diagram" data-old-src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1088 573' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-7e552fcbb64e466973e8c4226e516330'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-7e552fcbb64e466973e8c4226e516330)' width='1088' height='573' xlink:href='data:image/jpeg%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAiCAYAAADvVd%2bPAAAACXBIWXMAAAsSAAALEgHS3X78AAAEqklEQVRo3tWZ2U7sMAyG%2b/5vgcQ1V4C4AIkbQCAh9n3f931fc/RFco8n0zZOGEBEstppUrv%2bYzu2p3h5eXFvb2/u4%2bPDRO/v7453Xl9fy2sVhWus/KEY7yo5ufwLlL%2b5uXGnp6fu/PzcnZ2dVRJzrLm6uvKAWT5QwH18fIzy13IsAOv55%2bfnKF9NT09P5fsFyi8sLLjd3V23vb3dSKxZWlryHwmSMQuQ%2bdXVVbexseF2dnai/FnL/efnpwkALBLeFv7Mb25uehliyQU7g2DrQHkYMSwuwO4j0Dp4j/UAwM5aLGxxcdGlDDZRrLhAIdBhgEqT7zOOj489YDzjA2Wn6%2bjh4cGtrKyYfJNxd3fnAbDwl3kUAhBAa%2bLPPHosLy//BwCfEABkUTh4Js9PTk7c0dFRy/o6koF5VvENZTDu7%2b%2b9mVr4C2jwRyHNp44/77RYQAgAg127vLx019fX/l7PHR4eusnJSX/FFbCGOmJ%2bcHDQjY%2bPlx8BH3gTe25vb/2O4yYykDcxMeEODg6i/Pf29tzIyIgbGhpqUxbLFhkaFBMACMdMMEXu9Y6i%2bMzMjI%2bm3GMNIfEcV%2bEDu7q63OjoaPlhmCB8Cbx8CP5LHNIAADDPmvhDrOnp6XG9vb1tloqMtbU1737iviYAYiYUukDMp7/iAk0xqckF6tzYDECTMAmCEqVjQRCFJAhq362SIQDkBEEUCuOD5i0EqG0ApByDev13HIMolXoMolD2MUhmNz8/73cWfxfCzDF3/Yw1vMzVkgjJlXeIB/it5hcSMjHn9fV1MwDsKBZGwAz5I5OrPOfKM%2bJOmQiBBCAgHMVYROTs7%2b933d3dPkpLUGPNxcVFciqMWQv/GAG6KG5NhUltq/hwmqAw93oOqyxTYUFR/EWCydzcnBsbG/P3uljKKYZSiq1OFUNYENYEmGFMaCmGdN4ugQUlQQp/5z4MRqHwWC0QC5RVlGIBdTxwDayvak1pAVVMQWx/f9%2bbj/i6dUd%2bm8IiDACaXLaoehkAJJD8JQDCHQ4BqNKhqKqtUVpSTXGBFL/8LeXlqvMDgnhVg6bWArgyOBkgCYJ/xQLk%2byVtl991G1iERxaIkRcQQTEhzuSULtBPBsG6I3Fra8t/O7kBgRAdqDEaLUAmWMgJAAjS/dGRNMckwzQ1VuLmuJt2YUl6KNokh9FtMJMLSOLTZD7WRAhQJbO0JEI5FhDmBIBJNYjiZheQKww4BiGd8uZYgERjCi6CahMhD3O19gRjOUGYB0QtQOcB4TGYG5A60RPMjT3JeUAIADtSlQmmkABg7QlKOfxVudoCsgBAeXzS0ptrIoRLdVfXs9NNDD5Yym1AyJXLIAZ8yQJmZ2fLElJigpWkFOVImpqaauvKSL%2bOXdZz/B4YGHDDw8NlSZsiX9ZyRa6u/MwAiO/qOjqHiPzs5vT0dIuSXDmjqTjhr%2beQ39fX55up0qPIkQ0IFHNhXIgCkPt/W12bCz6pLiB/vDT1BFP/x6yjIrXETM3mdBBs6tl9RxAMdTFbQCfz8u/sCXaCip%2bozviPgaCke/pVhM/TEpc2%2bp8GIOwJStPTEjh/svz%2bEQuQYsgSNHOLoVz6Bye%2b7fLOqLjeAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" data-src="https://d33wubrfki0l68.cloudfront.net/b1117a23634125a8e2195b0dfc8fc1a29c511fac/3f628/assets/static/redux.b474ba6.ff6f3365031ebcab6ddfefc3aadeb376.jpg" data-srcset="https://d33wubrfki0l68.cloudfront.net/d23ede7d66304da8179f8bd5b5cb30d1a54c39df/29340/assets/static/redux.82a2fbd.ff6f3365031ebcab6ddfefc3aadeb376.jpg 480w, https://d33wubrfki0l68.cloudfront.net/b1117a23634125a8e2195b0dfc8fc1a29c511fac/3f628/assets/static/redux.b474ba6.ff6f3365031ebcab6ddfefc3aadeb376.jpg 1088w"></p><p>From the diagram above, it's easy to find the keywords: <code>action</code><code>store</code><code>reducer</code><code>view</code><code>subscribe</code> and <code>dispatch</code>. And the next is to handle the relations among these keywords.</p><h2 id="redux-approach-comparison-fp-vs-oop"><a href="#redux-approach-comparison-fp-vs-oop">Redux Approach Comparison: FP vs OOP</a></h2><p>Example usage of <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a></p><pre><code><span>const</span> store <span>=</span> <span>createStore</span><span>(</span>
  <span>combineReducers</span><span>(</span><span>{</span>
    one<span>:</span> oneReducer<span>,</span>
    two<span>:</span> twoReducer
  <span>}</span><span>)</span><span>,</span>
  <span>applyMiddleware</span><span>(</span><span>ReduxThunk</span><span>,</span> <span>ReduxLogger</span><span>)</span>
<span>)</span><span>;</span></code></pre><p>Imagine if we do this in OOP, it may look like this:</p><p>(The following is just my imagination. Not how older <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a> behaves)</p><pre><code><span>const</span> store <span>=</span> <span>new</span> <span>Store</span><span>(</span><span>)</span>
store<span>.</span><span>setReducers</span><span>(</span><span>{</span>
  one<span>:</span> oneReducer<span>,</span>
  two<span>:</span> twoReducer
<span>}</span><span>)</span>
store<span>.</span><span>setMiddlewares</span><span>(</span><span>{</span>
  <span>ReduxThunk</span><span>,</span>
  <span>ReduxLogger</span>
<span>}</span><span>)</span></code></pre><p>So, what are the differences? Both are good approaches IMO.</p><p>FP does a good job on combining the functions together without side-effects. The return value is consistent which made the program returnings foreseeable during or after the execution.</p><p>OOP made a solid structure which defined all the attributes a data model should contain. It makes it easy to modify or configure the data model.</p><p>In <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a>, the <code>reduers</code> and <code>middlewares</code> are usually defined only once. It means, we don't need the ability to update these properties and we don't hope them to be altered during the runtime. As for FP approach, it utilizes the <code>closure</code> technique that kills the possbility of exposing the internal properties. With some fantastic FP techniques (curry, compose, pipe), it's even making the program much more human-readable than OOP.</p><p>I would say FP should be the best fit for such scenario. Of course, the FP I'm talking about here is far from the real functional programming like Haskell. But at least the idea of utilizing FP techniques in Javascript is something to follow.</p><p><img src="https://d33wubrfki0l68.cloudfront.net/66984ccd5661fa81bc4c1806c64e980181165a7d/88b43/assets/static/haskell.cbab2cf.82d9f5b0912290333a547a32e17d3642.jpg" width="1024" alt="haskell functional programming" data-old-src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1024 576' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-52e08e1070b234d120b65ac6e29a8487'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-52e08e1070b234d120b65ac6e29a8487)' width='1024' height='576' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAkAEADASIAAhEBAxEB/8QAGwAAAgMBAQEAAAAAAAAAAAAAAAQCAwUGAQj/xAAwEAABBAEDAQYCCwAAAAAAAAABAAIDEQQSITFRBRMiQWFxJKEGFBUyQlKCkrHB8P/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/EABkRAQEBAAMAAAAAAAAAAAAAAAABERIhQf/aAAwDAQACEQMRAD8A%2bqSQASdgEvj5uLki8fIilHVjgf8AcFMEWCFz0oyIJ5ceETuhvTqPeucQR%2ba6vc8enRBuwzxTAGJ7XAixSsWFJmZ0DmiKLVDVNLoJHPqq8Vedp77R0yujdj5biDVtgdp46%2baUPoN0aFlUwTiV8je7kZoNW9tA%2b3VXEAgggEHyQcl2J9O%2bzO04JXd3kxSQl3eMEZk00au2WCPboVt9mdt4Pac7ocN0zntbrOqF7BV1y4BOY%2bLj44Ax4IogBpGhgbQ5rZXLVs8Hj70Oq7ralh4WaYXPgnleckGu7kna43WwsNA6LdSpzCL%2bHm29Bv8ANZGXDLKdDpZpmt2IrJa675/D0NrQfJDHGwPy5ACDTjyfkifID2lrsfII33Ya49QVWC173fD5Zo1es1x5eLhXlaupsxe9Z4M7KIIq2uA/rlMwwGN5cZpX7VTyK9%2bEnqD374uYC3TvrIu/1b15qyGNkkztUWSw/etzzp59/RXesQ8hQjibGXab8Rs2bU1kCX%2bpYodqGPFq330jzQhDQMLFHGPF%2b0dK/jZWxRRwgiJjWAmyGirKEIJoQhAIQhB//9k=' /%3e%3c/svg%3e" data-src="https://d33wubrfki0l68.cloudfront.net/66984ccd5661fa81bc4c1806c64e980181165a7d/88b43/assets/static/haskell.cbab2cf.82d9f5b0912290333a547a32e17d3642.jpg" data-srcset="https://d33wubrfki0l68.cloudfront.net/2c16467debebdf254444700dab6213bb45ece8a2/b30b3/assets/static/haskell.82a2fbd.82d9f5b0912290333a547a32e17d3642.jpg 480w, https://d33wubrfki0l68.cloudfront.net/66984ccd5661fa81bc4c1806c64e980181165a7d/88b43/assets/static/haskell.cbab2cf.82d9f5b0912290333a547a32e17d3642.jpg 1024w"></p><h2 id="wonderful-redux-fp-design"><a href="#wonderful-redux-fp-design">Wonderful Redux FP Design</a></h2><p>In Redux, there is no class at all (In the earlier versions, it was once based on <code>Class</code>). All of its core APIs return either value or function (function factory). And this is exactly what FP expects a function to behave:</p><blockquote><p>Pure with no side effects.</p></blockquote><ul><li><strong>createStore</strong>: returns new <code>Object</code> { getState, dispatch, subscribe }</li><li><strong>combineReducers</strong>: returns new <code>Function</code></li><li><strong>applyMiddleware</strong>: returns new <code>Function</code></li></ul><p>To explain the <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a> design in an easy way, I implemented only the very core part of the APIs above. Since the latest version's core concept hasn't changed much, I wrote the source code based on very primitive version of <a href="https://github.com/reduxjs/redux/tree/v1.0.1/src" target="_blank" rel="nofollow noopener noreferrer">Redux v1.0.1</a>. Because I believe the very first related version would be the most comprehensive one to look at.</p><p>Let's have a look.</p><h4 id="createstore"><a href="#createstore">createStore</a></h4><p><code>createStore</code> defines those APIs that can be used within components. It's more like <code>setter</code> and <code>getter</code></p><ul><li>getState</li><li>dispatch</li><li>subscribe</li></ul><pre><code><span>export</span> <span>default</span> <span>function</span> <span>createStore</span> <span>(</span><span>reducer<span>,</span> enhancer</span><span>)</span> <span>{</span>
  <span>if</span> <span>(</span>enhancer<span>)</span> <span>{</span>
    <span>return</span> <span>enhancer</span><span>(</span>createStore<span>)</span><span>(</span>reducer<span>)</span><span>;</span>
  <span>}</span>

  <span>let</span> currentState<span>;</span>
  
  
  <span>let</span> currentListeners <span>=</span> <span>[</span><span>]</span><span>;</span>

  <span>function</span> <span>getState</span> <span>(</span><span>)</span> <span>{</span>
    <span>return</span> currentState<span>;</span>
  <span>}</span>

  
  <span>function</span> <span>subscribe</span> <span>(</span><span>listener</span><span>)</span> <span>{</span>
    currentListeners<span>.</span><span>push</span><span>(</span>listener<span>)</span><span>;</span>

    <span>return</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      
      <span>const</span> index <span>=</span> currentListeners<span>.</span><span>indexOf</span><span>(</span>listener<span>)</span><span>;</span>
      currentListeners<span>.</span><span>splice</span><span>(</span>index<span>,</span> <span>1</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>
  <span>}</span>

  <span>function</span> <span>dispatch</span> <span>(</span><span>action</span><span>)</span> <span>{</span>
    currentState <span>=</span> <span>reducer</span><span>(</span>currentState<span>,</span> action<span>)</span><span>;</span>
    
    currentListeners<span>.</span><span>forEach</span><span>(</span><span>listener</span> <span>=&gt;</span> <span>listener</span><span>(</span><span>)</span><span>)</span><span>;</span>
  <span>}</span>

  
  <span>dispatch</span><span>(</span><span>{</span> type<span>:</span> <span>"MY-MINI-REDUX"</span> <span>}</span><span>)</span><span>;</span>

  <span>return</span> <span>{</span>
    getState<span>,</span>
    dispatch<span>,</span>
    subscribe
  <span>}</span><span>;</span>
<span>}</span></code></pre><h4 id="combinereducers"><a href="#combinereducers">combineReducers</a></h4><p>Returns a new function that can return the new state. Can't be any purer.</p><pre><code>
<span>function</span> <span>mapValues</span><span>(</span><span>obj<span>,</span> fn</span><span>)</span> <span>{</span>
  <span>return</span> <span>Object</span><span>.</span><span>keys</span><span>(</span>obj<span>)</span><span>.</span><span>reduce</span><span>(</span><span>(</span><span>result<span>,</span> key</span><span>)</span> <span>=&gt;</span> <span>{</span>
    result<span>[</span>key<span>]</span> <span>=</span> <span>fn</span><span>(</span>obj<span>[</span>key<span>]</span><span>,</span> key<span>)</span><span>;</span>
    <span>return</span> result<span>;</span>
  <span>}</span><span>,</span> <span>{</span><span>}</span><span>)</span><span>;</span>
<span>}</span>

<span>export</span> <span>default</span> <span>function</span> <span>combineReducers</span> <span>(</span><span>reducers</span><span>)</span> <span>{</span>
  <span>return</span> <span>function</span> <span>combination</span> <span>(</span><span>state <span>=</span> <span>{</span><span>}</span><span>,</span> action</span><span>)</span> <span>{</span>
    
    
    <span>return</span> <span>mapValues</span><span>(</span>reducers<span>,</span> <span>(</span><span>reducer<span>,</span> key</span><span>)</span> <span>=&gt;</span> <span>reducer</span><span>(</span>state<span>[</span>key<span>]</span><span>,</span> action<span>)</span><span>)</span>
  <span>}</span><span>;</span>
<span>}</span></code></pre><h4 id="applymiddleware"><a href="#applymiddleware">applyMiddleware</a></h4><p>I personally think the <code>applyMiddleware</code> API is the most amazing part of Redux. It provides an optimal solution to apply 3rd party plugins.</p><p>The FP <code>compose</code> in the source code is corresponding to Math's <a href="https://en.wikipedia.org/wiki/Associative_property" target="_blank" rel="nofollow noopener noreferrer">associative law</a> in my understanding.</p><blockquote><p>( <em>x</em> ∗ ( <em>y</em> ∗ <em>z</em> ) ) = <em>x</em> ∗ <em>y</em> ∗ <em>z</em></p></blockquote><p>The usage of <code>applyMiddleware</code> is actually a form of a <code>pipe</code> that allows us to inject enhancement functions that returns the store Object. It's pretty similar to <code>Aspect Oriented Programming</code> which the most typical example is the annotation / decorator.</p><pre><code>

<span>function</span> <span>compose</span><span>(</span><span><span>...</span>funcs</span><span>)</span> <span>{</span>
  <span>return</span> funcs<span>.</span><span>reduceRight</span><span>(</span><span>(</span><span>composed<span>,</span> f</span><span>)</span> <span>=&gt;</span> <span>f</span><span>(</span>composed<span>)</span><span>)</span><span>;</span>
<span>}</span>

<span>export</span> <span>default</span> <span>function</span> <span>applyMiddleware</span><span>(</span><span><span>...</span>middlewares</span><span>)</span> <span>{</span>
  <span>return</span> <span>next</span> <span>=&gt;</span> <span>(</span><span>reducer<span>,</span> initialState</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> store <span>=</span> <span>next</span><span>(</span>reducer<span>,</span> initialState<span>)</span><span>;</span>
    <span>let</span> dispatch <span>=</span> store<span>.</span><span>dispatch</span><span>;</span>
    <span>const</span> middlewareAPI <span>=</span> <span>{</span>
      getState<span>:</span> store<span>.</span><span>getState</span><span>,</span>
      <span>dispatch</span><span>:</span> <span>action</span> <span>=&gt;</span> <span>dispatch</span><span>(</span>action<span>)</span>
    <span>}</span><span>;</span>
    <span>const</span> chain <span>=</span> middlewares<span>.</span><span>map</span><span>(</span><span>middleware</span> <span>=&gt;</span> <span>middleware</span><span>(</span>middlewareAPI<span>)</span><span>)</span><span>;</span>

    
    dispatch <span>=</span> <span>compose</span><span>(</span><span>...</span>chain<span>,</span> store<span>.</span><span>dispatch</span><span>)</span><span>;</span>

    <span>return</span> <span>{</span>
      <span>...</span>store<span>,</span>
      dispatch
    <span>}</span><span>;</span>
  <span>}</span><span>;</span>
<span>}</span></code></pre><h2 id="redux-middlewares"><a href="#redux-middlewares">Redux Middlewares</a></h2><p>There are some famous middlewares for <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux</a> like <a href="https://github.com/reduxjs/redux-thunk" target="_blank" rel="nofollow noopener noreferrer">redux-thunk</a> and [redux-logger(<a href="https://github.com/LogRocket/redux-logger" target="_blank" rel="nofollow noopener noreferrer">https://github.com/LogRocket/redux-logger</a>). These are the good examples using <code>applyMiddleware</code> API to enhance the functionalities. Furthermore, their code base is astonishingly small. The core part has only a few lines of code.</p><p>All of the middlewares are <code>curry</code> functions.</p><blockquote><p>funcA =&gt; funcB =&gt; funcC</p><p>funcB = funcA()</p><p>funcC = funcB()</p></blockquote><p> This is extremly helpful when I need other contexts to use within the code block. As of the examples, it's easy to find that <code>next</code> and <code>action</code> are passed in as context to help handle some complex cases.</p><h4 id="redux-thunk"><a href="#redux-thunk">Redux Thunk</a></h4><p><code>redux-thunk</code> allows to use function as <code>dispatch</code> parameter so that I could do something right before "dispatching".</p><pre><code>
<span>dispatch</span><span>(</span><span>{</span> type<span>:</span> <span>'action'</span><span>,</span> payload<span>:</span> <span>'value'</span> <span>}</span><span>)</span>



<span>dispatch</span><span>(</span><span>function</span> <span>(</span><span>dispatch<span>,</span> getState</span><span>)</span> <span>{</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span>'redux-thunk'</span><span>)</span>
  <span>dispatch</span><span>(</span><span>{</span> type<span>:</span> <span>'action'</span><span>,</span> payload<span>:</span> <span>'value'</span> <span>}</span><span>)</span>
<span>}</span><span>)</span></code></pre><p>Here is the core:</p><pre><code>
<span>export</span> <span>default</span> <span>function</span> <span>thunk</span><span>(</span><span><span>{</span> dispatch<span>,</span> getState <span>}</span></span><span>)</span> <span>{</span>
  <span>return</span> <span>next</span> <span>=&gt;</span> <span>action</span> <span>=&gt;</span> <span>{</span>
    <span>if</span> <span>(</span><span>typeof</span> action <span>===</span> <span>"function"</span><span>)</span> <span>{</span>
      <span>return</span> <span>action</span><span>(</span>dispatch<span>,</span> getState<span>)</span><span>;</span>
    <span>}</span>

    <span>return</span> <span>next</span><span>(</span>action<span>)</span><span>;</span>
  <span>}</span><span>;</span>
<span>}</span></code></pre><h4 id="redux-logger"><a href="#redux-logger">Redux Logger</a></h4><p>It's easy to guess what this middleware does. It simply outputs the state changes.</p><pre><code>
<span>export</span> <span>default</span> <span>function</span> <span>logger</span><span>(</span><span><span>{</span> getState <span>}</span></span><span>)</span> <span>{</span>
  <span>return</span> <span>next</span> <span>=&gt;</span> <span>action</span> <span>=&gt;</span> <span>{</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>"======== Redux Logger ========"</span><span>)</span><span>;</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>"Action Type: "</span><span>,</span> action<span>.</span><span>type</span><span>)</span><span>;</span>
    <span>const</span> prevState <span>=</span> <span>getState</span><span>(</span><span>)</span><span>;</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>"Prev: "</span><span>,</span> prevState<span>)</span><span>;</span>

    <span>const</span> returnValue <span>=</span> <span>next</span><span>(</span>action<span>)</span><span>;</span>

    <span>const</span> nextState <span>=</span> <span>getState</span><span>(</span><span>)</span><span>;</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>"Next: "</span><span>,</span> nextState<span>)</span><span>;</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>"=============================="</span><span>)</span><span>;</span>
    <span>return</span> returnValue<span>;</span>
  <span>}</span><span>;</span>
<span>}</span></code></pre><h2 id="a-demo-app"><a href="#a-demo-app">A demo app</a></h2><p>I implemented mini version of redux and a small counter application to demostrate the functions. The application will do four arithmetic operations: <strong>plus</strong>, <strong>minus</strong>, <strong>multiply</strong> and <strong>divide</strong>. The number will change after clicking the operation button. Meanwhile, <code>multiply</code> and <code>divide</code> will have 300ms' delay which is enabled by a custom middleware (a mini redux-thunk).</p><p><strong>Repository link of "mini-redux":</strong></p><p><a href="https://github.com/daiyanze/mini-redux" target="_blank" rel="nofollow noopener noreferrer">https://github.com/daiyanze/mini-redux</a></p><p><strong>Demo App link:</strong></p><p><a href="https://daiyanze.com/mini-redux/build/index.html" target="_blank" rel="nofollow noopener noreferrer">https://daiyanze.com/mini-redux/build/index.html</a></p><p><img src="https://d33wubrfki0l68.cloudfront.net/9dc95481270c7b145b30a963ce578c185d75a44c/06bfe/assets/static/app.28b8b81.42e70fdda76e9bc70c1818fe62939d86.png" width="1078" alt="app" data-old-src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1078 586' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-b8a33714e79343718b882b0853556166'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-b8a33714e79343718b882b0853556166)' width='1078' height='586' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAjCAYAAAAkCQwqAAAACXBIWXMAABYlAAAWJQFJUiTwAAACzElEQVRo3u1YSWsyQRD1v/oHAgoKinqQHDyIHrwIKl7MRYRcvAsJiBcPbkRcEpO4JcZdca2PV9BhvmGci84YRxuKnunu6aGqX79aTKRR2%2b/3v/12u%2bVeKrvd7lfkc9JvtW4mLTc/RgE9lNfUAEKBn58fSqfT1Ov1aD6fs%2bC5Wq1SoVDgfjKZ0HQ65bnX11caj8eXjwBAG61cLpPVaqV4PE6BQIAeHh7o%2bfmZYrEYeTwecjqdFIlEyO/385pcLkcvLy//7XHRCFiv18wBo9GIOp0OIwKy2Wz4xDEOBLTbbR6H0pi7cYBROEDO/FKWFzCXzxnGCygZRShVLBZ1vetnNYAcDWilUok9gBQFekJfdwQcUlBvyJ8dAUqKqxno4g0gJTa4w%2bVyyYEOXB3eF4sFB0GGNoDocdf7/T69vb1xfAAjwPcjMlRChaEQgIYTh9JCeem78ASGJ8G/EPxoYgAlV6cU2KjJRSFAfreVIjr5s9KctC5wKCpUiiZPZSyT1rDWau9T/ftoBMCt1Wo1ZnK4M4S3w%2bGQMzwwPtZ1u12O/N7f32m1WnFWCMFpfnx88PPn5yfV63X2Cs1mk/eGu/z6%2buJ9sB/WYy%2bQ59kRIFgbSrlcLrLb7eTz%2bcjhcJDFYqFgMEg2m40ymQw9PT2R1%2bul%2b/t7ikajvNZsNtPj4yOlUimWRCLBa7LZLH%2bfTCYpHA5zLcHtdtPd3R2FQiGuGcDoZzeA1LUhr8dJiaoPEp3v72%2bu%2bOBkkfNDcKJAh/D9oh4A5KAegG%2bwZjAY8BrMYQw95vP5PLVarZO6zD/LAXr9%2byRe4BBTH2JzafqrxvhqVeQ/gYBjokJAWZDdOZGkezYoTh88cRX1ALWrcihyNCwC1MbPdQ10zwYRCCGoERkgXOBV1QNAfpVK5TcNbjQaHCtcTT1AVICEAWazGY/d6gFk0KKoYesBRmk3A1y7Af4BkCyMSb7bRvcAAAAASUVORK5CYII=' /%3e%3c/svg%3e" data-src="https://d33wubrfki0l68.cloudfront.net/9dc95481270c7b145b30a963ce578c185d75a44c/06bfe/assets/static/app.28b8b81.42e70fdda76e9bc70c1818fe62939d86.png" data-srcset="https://d33wubrfki0l68.cloudfront.net/6cd10d41d4c5361482bb8734550719faaa7f13e9/0e513/assets/static/app.82a2fbd.42e70fdda76e9bc70c1818fe62939d86.png 480w, https://d33wubrfki0l68.cloudfront.net/9dc95481270c7b145b30a963ce578c185d75a44c/06bfe/assets/static/app.28b8b81.42e70fdda76e9bc70c1818fe62939d86.png 1078w"></p><p>The app has one child component: <code>MiniReduxComp</code>. In my mini-redux, I didn't create a context provider to trigger updates. Instead, I subscribe to the store changes within the component and  do <code>forceUpdate</code> to react to changes.</p><p>I also applied the custom middlewares <code>redux-thunk</code> and <code>redux-logger</code> to enrich the functions.</p><pre><code><span>import</span> <span>React</span><span>,</span> <span>{</span> <span>Component</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> store <span>from</span> <span>'../store'</span>

<span>export</span> <span>default</span> <span>class</span> <span>MiniReduxComp</span> <span>extends</span> <span>Component</span> <span>{</span>

  <span>componentDidMount</span><span>(</span><span>)</span> <span>{</span>
    <span>this</span><span>.</span><span>unsubscribe</span> <span>=</span> store<span>.</span><span>subscribe</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>this</span><span>.</span><span>forceUpdate</span><span>(</span><span>)</span><span>)</span><span>;</span>
  <span>}</span>

  <span>componentWillUnmount</span><span>(</span><span>)</span> <span>{</span>
    <span>this</span><span>.</span><span>unsubscribe</span> <span>&amp;&amp;</span> <span>this</span><span>.</span><span>unsubscribe</span><span>(</span><span>)</span><span>;</span>
  <span>}</span>

  <span>plus</span> <span>=</span> <span>(</span><span>)</span> <span>=&gt;</span> store<span>.</span><span>dispatch</span><span>(</span><span>{</span> type<span>:</span> <span>"PLUS"</span> <span>}</span><span>)</span>

  <span>minus</span> <span>=</span> <span>(</span><span>)</span> <span>=&gt;</span> store<span>.</span><span>dispatch</span><span>(</span><span>{</span> type<span>:</span> <span>'MINUS'</span> <span>}</span><span>)</span>

  <span>multiply</span> <span>=</span> <span>(</span><span>)</span> <span>=&gt;</span> store<span>.</span><span>dispatch</span><span>(</span><span>(</span><span>dispatch<span>,</span> getState</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setTimeout</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>dispatch</span><span>(</span><span>{</span> type<span>:</span> <span>'MULTIPLY'</span> <span>}</span><span>)</span>
    <span>}</span><span>,</span> <span>300</span><span>)</span>
  <span>}</span><span>)</span>

  <span>divide</span> <span>=</span> <span>(</span><span>)</span> <span>=&gt;</span> store<span>.</span><span>dispatch</span><span>(</span><span>(</span><span>dispatch<span>,</span> getState</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setTimeout</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>dispatch</span><span>(</span><span>{</span> type<span>:</span> <span>'DIVIDE'</span> <span>}</span><span>)</span>
    <span>}</span><span>,</span> <span>300</span><span>)</span>
  <span>}</span><span>)</span>

  <span>render</span><span>(</span><span>)</span> <span>{</span>
    <span>return</span> <span>(</span>
      <span><span><span>&lt;</span>div</span><span>&gt;</span></span><span>
        </span><span><span><span>&lt;</span>h4</span><span>&gt;</span></span><span>Plus / Minus 1</span><span><span><span>&lt;/</span>h4</span><span>&gt;</span></span><span>

        </span><span><span><span>&lt;</span>p</span><span>&gt;</span></span><span>{</span>store<span>.</span><span>getState</span><span>(</span><span>)</span><span>.</span><span>count</span><span>}</span><span><span><span>&lt;/</span>p</span><span>&gt;</span></span><span>

        </span><span><span><span>&lt;</span>button</span> <span>onClick</span><span><span>=</span><span>{</span><span>this</span><span>.</span><span>plus</span><span>}</span></span><span>&gt;</span></span><span>+1</span><span><span><span>&lt;/</span>button</span><span>&gt;</span></span><span>
        </span><span><span><span>&lt;</span>button</span> <span>onClick</span><span><span>=</span><span>{</span><span>this</span><span>.</span><span>minus</span><span>}</span></span><span>&gt;</span></span><span>-1</span><span><span><span>&lt;/</span>button</span><span>&gt;</span></span><span>

        </span><span><span><span>&lt;</span>br</span> <span>/&gt;</span></span><span>
        </span><span><span><span>&lt;</span>br</span> <span>/&gt;</span></span><span>

        </span><span><span><span>&lt;</span>h4</span><span>&gt;</span></span><span>Multiply / Divide 2 (0.3s delay)</span><span><span><span>&lt;/</span>h4</span><span>&gt;</span></span><span>
        </span><span><span><span>&lt;</span>p</span><span>&gt;</span></span><span>{</span>store<span>.</span><span>getState</span><span>(</span><span>)</span><span>.</span><span>double</span><span>}</span><span><span><span>&lt;/</span>p</span><span>&gt;</span></span><span>

        </span><span><span><span>&lt;</span>button</span> <span>onClick</span><span><span>=</span><span>{</span><span>this</span><span>.</span><span>mult…</span></span></span></code></pre></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://pitayan.com/posts/redux-fp-design/?ref=hackernews">https://pitayan.com/posts/redux-fp-design/?ref=hackernews</a></em></p>]]>
            </description>
            <link>https://pitayan.com/posts/redux-fp-design/?ref=hackernews</link>
            <guid isPermaLink="false">hacker-news-small-sites-24046631</guid>
            <pubDate>Tue, 04 Aug 2020 04:33:23 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Harry Potter and the Mnemonic Major System]]>
            </title>
            <description>
<![CDATA[
Score 54 | Comments 17 (<a href="https://news.ycombinator.com/item?id=24045475">thread link</a>) | @krisfris
<br/>
August 3, 2020 | https://darkshadow.io/2020/07/09/harry-potter-and-the-mnemonic-major-system.html | <a href="https://web.archive.org/web/*/https://darkshadow.io/2020/07/09/harry-potter-and-the-mnemonic-major-system.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  <div itemprop="articleBody">
    <p>As most reasonable people are familiar with the Harry Potter books,
their content serves as ideal material for building a mnemonic system.
The mnemonic major system, in particular, is used to memorize number sequences.</p>

<p>In order to implement the steps outlined in this post you need the content of the Harry Potter books (or other book(s) if you prefer).
In a previous post I showed you how to
<a href="https://darkshadow.io/2020/06/29/building-a-fantasy-book-db.html">download fantasy books and extract their text</a>.
Among the downloaded data were the Harry Potter books which I will use in this post.</p>

<h3 id="step-1-learn-the-sound-number-mapping">Step 1: Learn the sound-number mapping</h3>

<p>In the mnemonic major system each number from 0 to 9 is associated with one or more
consonant sounds. Use the following table as a reference.</p>

<table>
  <thead>
    <tr>
      <th>Number</th>
      <th>Sounds (IPA)</th>
      <th>Letters with example words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>s, z</td>
      <td>s (see), c (city), z (zero), x (xylophone)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>t, d, ð, θ</td>
      <td>t (tee), d (dad), th (though), th (think)</td>
    </tr>
    <tr>
      <td>2</td>
      <td>n, ŋ</td>
      <td>n (nail)</td>
    </tr>
    <tr>
      <td>3</td>
      <td>m</td>
      <td>m (monster)</td>
    </tr>
    <tr>
      <td>4</td>
      <td>r</td>
      <td>r (right), l (colonel)</td>
    </tr>
    <tr>
      <td>5</td>
      <td>l</td>
      <td>l (left)</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ʤ, ʧ, ʃ, ʒ</td>
      <td>ch (cheese), j (juice), g (ginger), sh (shell), c (cello, special),<br> cz (czech), s (tissue, vision), sc (fascist), sch (eschew),<br>t (ration), tsch (putsch), z (seizure)</td>
    </tr>
    <tr>
      <td>7</td>
      <td>k, ɡ</td>
      <td>k (kid), c (cake), q (quarter), g (good), ch (loch)</td>
    </tr>
    <tr>
      <td>8</td>
      <td>f, v</td>
      <td>f (face), ph (phone), v (alive), gh (laugh)</td>
    </tr>
    <tr>
      <td>9</td>
      <td>p, b</td>
      <td>p (power), b (baby)</td>
    </tr>
  </tbody>
</table>

<p>In English, letters are pronounced in different ways depending on the context,
that’s why some letters are repeated in different rows. But in the end,
only the sound matters, not the spelling.</p>

<p>Here are a few examples for words, their IPA representation and the number they encode.</p>

<table>
  <thead>
    <tr>
      <th>Word</th>
      <th>IPA</th>
      <th>Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>action</td>
      <td>ækʃən</td>
      <td>762</td>
    </tr>
    <tr>
      <td>muddy</td>
      <td>mədi</td>
      <td>31</td>
    </tr>
    <tr>
      <td>midday</td>
      <td>mɪddeɪ</td>
      <td>311</td>
    </tr>
    <tr>
      <td>accept</td>
      <td>æksɛpt</td>
      <td>7091</td>
    </tr>
    <tr>
      <td>fax</td>
      <td>fæks</td>
      <td>870</td>
    </tr>
    <tr>
      <td>exam</td>
      <td>ɪgzæm</td>
      <td>703</td>
    </tr>
    <tr>
      <td>anxious</td>
      <td>æŋkʃəs</td>
      <td>2760</td>
    </tr>
    <tr>
      <td>luxury</td>
      <td>ləgʒəri</td>
      <td>5764</td>
    </tr>
    <tr>
      <td>pizza</td>
      <td>pitsə</td>
      <td>910</td>
    </tr>
    <tr>
      <td>ghost</td>
      <td>goʊst</td>
      <td>701</td>
    </tr>
    <tr>
      <td>enough</td>
      <td>inəf</td>
      <td>28</td>
    </tr>
    <tr>
      <td>fear</td>
      <td>fɪr</td>
      <td>84</td>
    </tr>
  </tbody>
</table>

<p>To familiarize yourself with the IPA notation, try to read the following excerpt.</p>

<figure><pre><code data-lang="html">Sorting Hat: həm, dɪfəkəlt. vɛri dɪfəkəlt. plɛnti əv kərɪʤ, aɪ si.
             nɑt ə bæd maɪnd, iðər. ðɛrz tælənt, oʊ jɛs. ənd ə θərst tɪ pruv jʊrsɛlf.
             bət wɛr tɪ pʊt ju?
Harry:       nɑt slɪðərɪn. nɑt slɪðərɪn.
Sorting Hat: nɑt slɪðərɪn, ɛ? ər ju ʃʊr? ju kʊd bi greɪt, ju noʊ. ɪts ɔl hir ɪn jʊr hɛd.
             ənd slɪðərɪn wɪl hɛlp ju ɔn ðə weɪ tɪ greɪtnəs, ðɛrz noʊ daʊt əbaʊt ðət. noʊ?
Harry:       pliz, pliz. ɛniθɪŋ bət slɪðərɪn, ɛniθɪŋ bət slɪðərɪn.
Sorting Hat: wɛl ɪf jʊr ʃʊr, bɛtər bi... grɪfɪndɔː!</code></pre></figure>

<p>Consider the same lines converted to number sequences.</p>

<figure><pre><code data-lang="html">Sorting Hat: 3 18751 84 18751 9521 8 746 0 21 91 321 14 140 1521 0 21 8401 1 948 4058 91 4 1 91
Harry:       21 05142 21 05142
Sorting Hat: 21 05142 4 64 71 9 741 2 10 5 4 2 4 1 21 05142 5 59 2 1 1 74120 140 2 11 91 11 2
Harry:       950 950 282 91 05142 282 91 05142
Sorting Hat: 5 8 4 64 914 9 74821</code></pre></figure>

<p>I’m going to show you how to write a training program to internalize
the concept of mapping sounds to numbers in Step 4. But first, you need the ability
to convert text automatically to numbers. This happens in 2 steps. First, the text is converted
to IPA. Then, the IPA is converted to numbers.</p>

<h3 id="step-2-converting-ipa-to-numbers">Step 2: Converting IPA to numbers</h3>

<p>The process of converting IPA to numbers is very simple. I iterate through the IPA chars
and if there is a number associated with the char I append the number to the result.</p>

<figure><pre><code data-lang="python"><span># Mapping from number to sounds
</span><span>num_to_phones</span> <span>=</span> <span>{</span><span>0</span><span>:</span> <span>[</span><span>'s'</span><span>,</span> <span>'z'</span><span>],</span> <span>1</span><span>:</span> <span>[</span><span>'t'</span><span>,</span> <span>'d'</span><span>,</span> <span>'ð'</span><span>,</span> <span>'θ'</span><span>],</span> <span>2</span><span>:</span> <span>[</span><span>'n'</span><span>,</span> <span>'ŋ'</span><span>],</span> <span>3</span><span>:</span> <span>[</span><span>'m'</span><span>],</span> <span>4</span><span>:</span> <span>[</span><span>'r'</span><span>],</span>
                 <span>5</span><span>:</span> <span>[</span><span>'l'</span><span>],</span> <span>6</span><span>:</span> <span>[</span><span>'ʤ'</span><span>,</span> <span>'ʧ'</span><span>,</span> <span>'ʃ'</span><span>,</span> <span>'ʒ'</span><span>],</span> <span>7</span><span>:</span> <span>[</span><span>'k'</span><span>,</span> <span>'g'</span><span>],</span> <span>8</span><span>:</span> <span>[</span><span>'f'</span><span>,</span> <span>'v'</span><span>],</span>
                 <span>9</span><span>:</span> <span>[</span><span>'p'</span><span>,</span> <span>'b'</span><span>]}</span>

<span># Reverse mapping from sound to number
</span><span>phone_to_num</span> <span>=</span> <span>{</span><span>x</span><span>:</span> <span>k</span> <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>num_to_phones</span><span>.</span><span>items</span><span>()</span> <span>for</span> <span>x</span> <span>in</span> <span>v</span><span>}</span>

<span>def</span> <span>major_decode_from_ipa</span><span>(</span><span>ipa</span><span>):</span>
    <span>"""Convert IPA to number sequence."""</span>
    <span>result</span> <span>=</span> <span>[]</span>
    <span>for</span> <span>char</span> <span>in</span> <span>ipa</span><span>:</span>
        <span>if</span> <span>(</span><span>num</span> <span>:</span><span>=</span> <span>phone_to_num</span><span>.</span><span>get</span><span>(</span><span>char</span><span>))</span> <span>is</span> <span>not</span> <span>None</span><span>:</span>
            <span>result</span><span>.</span><span>append</span><span>(</span><span>num</span><span>)</span>
    <span>return</span> <span>result</span></code></pre></figure>

<p>For example, <code>major_decode_from_ipa('dɪfəkəlt')</code> yields <code>[1, 8, 7, 5, 1]</code>.</p>

<p>Additionally, I define a couple functions for converting number sequences to and from strings.</p>

<figure><pre><code data-lang="python"><span>def</span> <span>numseq_to_str</span><span>(</span><span>numseq</span><span>):</span>
    <span>"""Convert number sequence to string."""</span>
    <span>return</span> <span>''</span><span>.</span><span>join</span><span>(</span><span>str</span><span>(</span><span>x</span><span>)</span> <span>for</span> <span>x</span> <span>in</span> <span>numseq</span><span>)</span>

<span>def</span> <span>str_to_numseq</span><span>(</span><span>s</span><span>):</span>
    <span>"""Convert string to number sequence."""</span>
    <span>return</span> <span>[</span><span>int</span><span>(</span><span>x</span><span>)</span> <span>for</span> <span>x</span> <span>in</span> <span>s</span> <span>if</span> <span>x</span><span>.</span><span>isdigit</span><span>()]</span></code></pre></figure>

<p>For example, <code>numseq_to_str([1, 8, 7, 5, 1])</code> yields <code>'18751'</code>.</p>

<h3 id="step-3-converting-text-to-ipa">Step 3: Converting text to IPA</h3>

<p>In order to automatically convert text to IPA (and then to numbers) you need to use an IPA
dictionary.</p>

<p>Python’s <a href="https://pypi.org/project/eng-to-ipa/">eng-to-ipa</a> package is able to convert text to
IPA using the <em>Carnegie-Mellon University Pronouncing Dictionary</em>.</p>

<figure><pre><code data-lang="python"><span>import</span> <span>eng_to_ipa</span>

<span>s</span> <span>=</span> <span>'“I’ll bring up some sandwiches.”'</span>  <span># Sentence from the HP books
</span><span>ipa</span> <span>=</span> <span>eng_to_ipa</span><span>.</span><span>convert</span><span>(</span><span>s</span><span>,</span> <span>retrieve_all</span><span>=</span><span>True</span><span>,</span> <span>keep_punct</span><span>=</span><span>False</span><span>,</span> <span>stress_marks</span><span>=</span><span>False</span><span>)</span>
<span>print</span><span>(</span><span>ipa</span><span>)</span></code></pre></figure>

<p>This yields:</p>

<figure><pre><code data-lang="html">['“i’ll* brɪŋ əp səm sandwiches.”*']</code></pre></figure>

<p>According to the docs, eng-to-ipa will reprint words that cannot be found in the CMU dictionary
with an asterisk. Thus, <code>“i’ll</code> and <code>sandwiches.”</code> have not been found. Clearly, the punctuation is the issue.
I preprocess the text in order to ease the conversion to IPA.</p>

<figure><pre><code data-lang="python"><span># Punctuation including unicode chars
</span><span>punctuation</span> <span>=</span> <span>''</span><span>.</span><span>join</span><span>(</span><span>chr</span><span>(</span><span>i</span><span>)</span> <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>sys</span><span>.</span><span>maxunicode</span><span>)</span>
                      <span>if</span> <span>unicodedata</span><span>.</span><span>category</span><span>(</span><span>chr</span><span>(</span><span>i</span><span>)).</span><span>startswith</span><span>(</span><span>'P'</span><span>))</span>

<span>def</span> <span>preprocess</span><span>(</span><span>text</span><span>):</span>
    <span>"""Strip punctuation between words, normalize space, lowercase, replace unicode apostrophe."""</span>
    <span>return</span> <span>' '</span><span>.</span><span>join</span><span>(</span><span>x</span><span>.</span><span>strip</span><span>(</span><span>punctuation</span><span>).</span><span>lower</span><span>().</span><span>replace</span><span>(</span><span>'’'</span><span>,</span> <span>'</span><span>\'</span><span>'</span><span>)</span>
                    <span>for</span> <span>x</span> <span>in</span> <span>text</span><span>.</span><span>split</span><span>())</span>
                    
<span>print</span><span>(</span><span>eng_to_ipa</span><span>.</span><span>convert</span><span>(</span><span>preprocess</span><span>(</span><span>s</span><span>),</span> <span>retrieve_all</span><span>=</span><span>True</span><span>,</span> <span>keep_punct</span><span>=</span><span>False</span><span>,</span> <span>stress_marks</span><span>=</span><span>False</span><span>))</span></code></pre></figure>

<p>And…</p>

<figure><pre><code data-lang="html">['aɪl brɪŋ əp səm sæmwɪʧɪz', 'aɪl brɪŋ əp səm sændwɪʧɪz', 'aɪl brɪŋ əp səm sænwɪʧɪz']</code></pre></figure>

<p>As you can see, there are 3 ways to pronounce this sentence depending on whether you like
to pronounce <code>sandwich</code> with <code>m</code>, <code>n</code> or <code>nd</code>. In order to use the major system effectively,
you should use the version that sounds most natural to you.</p>

<p>Let’s look at another example.</p>

<figure><pre><code data-lang="python"><span>print</span><span>(</span><span>eng_to_ipa</span><span>(</span><span>preprocess</span><span>(</span><span>'Well, if you’re sure — better be GRYFFINDOR!'</span><span>),</span> <span>retrieve_all</span><span>=</span><span>True</span><span>,</span>
                 <span>keep_punct</span><span>=</span><span>False</span><span>,</span> <span>stress_marks</span><span>=</span><span>False</span><span>))</span></code></pre></figure>

<figure><pre><code data-lang="html">['wɛl ɪf jur ʃʊr bɛtər bi gryffindor*', 'wɛl ɪf jʊr ʃʊr bɛtər bi gryffindor*']</code></pre></figure>

<p>The word <code>gryffindor</code> was not found in the CMU dictionary, which can be expected.
After a quick search for the word’s pronunciation I found <a href="https://youglish.com/pronounce/gryffindor/english">YouGlish</a>
which uses YouTube videos to find IPAs. While their API is not free, a limited number of IPA’s can be scraped
for our purpose.</p>

<figure><pre><code data-lang="python"><span>import</span> <span>time</span><span>,</span> <span>random</span><span>,</span> <span>requests</span><span>,</span> <span>lxml</span><span>.</span><span>html</span><span>.</span><span>soupparser</span>

<span>def</span> <span>ipa_from_youglish</span><span>(</span><span>word</span><span>):</span>
    <span>"""Scrape IPA for word from youglish.com."""</span>
    <span>url</span> <span>=</span> <span>f'https://youglish.com/pronounce/</span><span>{</span><span>word</span><span>}</span><span>/english?'</span>
    <span>while</span> <span>True</span><span>:</span>
        <span>print</span><span>(</span><span>f'Scraping word "</span><span>{</span><span>word</span><span>}</span><span>" from youglish...'</span><span>,</span> <span>end</span><span>=</span><span>''</span><span>,</span> <span>flush</span><span>=</span><span>True</span><span>)</span>
        <span>response</span> <span>=</span> <span>requests</span><span>.</span><span>get</span><span>(</span><span>url</span><span>)</span>
        <span>if</span> <span>'Usage limit exceeded'</span> <span>in</span> <span>response</span><span>.</span><span>text</span><span>:</span>
            <span>raise</span> <span>Exception</span><span>(</span><span>'YouGlish usage limit exceeded'</span><span>)</span>
        <span>root</span> <span>=</span> <span>lxml</span><span>.</span><span>html</span><span>.</span><span>soupparser</span><span>.</span><span>fromstring</span><span>(</span><span>response</span><span>.</span><span>text</span><span>)</span>
        <span>if</span> <span>root</span><span>.</span><span>xpath</span><span>(</span><span>'//div[@class="g-recaptcha"]'</span><span>):</span>
            <span>print</span><span>(</span><span>'RECAPTCHA'</span><span>)</span>
            <span>input</span><span>(</span><span>f'Open </span><span>{</span><span>url</span><span>}</span><span>, submit CAPTCHA challenge, press enter to continue.'</span><span>)</span>
        <span>else</span><span>:</span>
            <span>break</span>
    <span>time</span><span>.</span><span>sleep</span><span>(</span><span>random</span><span>.</span><span>random</span><span>()</span> <span>*</span> <span>3</span><span>)</span>
    <span>d</span> <span>=</span> <span>root</span><span>.</span><span>xpath</span><span>(</span><span>'//div[@id="phoneticPanel"]/div/ul[@class="transcript"]'</span>
                  <span>'/li/span[contains(text(), "Traditional IPA")]'</span>
                  <span>'/following-sibling::text()'</span><span>)</span>
    <span>if</span> <span>d</span><span>:</span>
        <span>print</span><span>(</span><span>'SUCCESS'</span><span>)</span>
        <span>return</span> <span>d</span><span>[</span><span>0</span><span>].</span><span>strip</span><span>(</span><span>' ˈ'</span><span>)</span>
    <span>print</span><span>(</span><span>'FAILED'</span><span>)</span></code></pre></figure>

<p>As you can see, this function is semi-interactive. Without user intervention it will
get stuck on a CAPTCHA. Even then, you’ll eventually reach their daily usage limit
and won’t be able to continue. For our purpose this shall be good enough though.</p>

<figure><pre><code data-lang="python"><span>&gt;</span> <span>ipa_from_youglish</span><span>(</span><span>'gryffindor'</span><span>)</span>
<span>Scraping</span> <span>word</span> <span>"gryffindor"</span> <span>from</span> <span>youglish</span><span>...</span><span>SUCCESS</span>
<span>grɪfɪndɔː</span></code></pre></figure>

<p>I have shown that for many words there are several possible pronunciations, from which you need to choose
your preferred one, and that some words are not in the CMU dictionary and
require scraping the IPA from another source or are not available at all.
For these 2 reasons, you will need to build your own personal IPA dictionary.</p>

<p>I’m going to build my IPA dictionary by iterating through the words of the Harry Potter books
and adding each word and the corresponding IPA to my dictionary.</p>

<p>First, I define
some functions for managing my dictionary (a simple JSON file in this case).</p>

<figure><pre><code data-lang="python"><span>import</span> <span>os</span><span>,</span> <span>glob</span><span>,</span> <span>json</span>

<span>ipa_dict_path</span> <span>=</span> <span>'data/ipa-dict.json'</span>

<span>def</span> <span>load_json_file_or_dict</span><span>(</span><span>filename</span><span>):</span>
    <span>"""Load data from json file if exists otherwise return empty dict."""</span>
    <span>if</span> <span>os</span><span>.</span><span>path</span><span>.</span><span>isfile</span><span>(</span><span>filename</span><span>):</span>
        <span>with</span> <span>open</span><span>(</span><span>filename</span><span>)</span> <span>as</span> <span>f</span><span>:</span>
            <span>return</span> <span>json</span><span>.</span><span>load</span><span>(</span><span>f</span><span>)</span>
    <span>return</span> <span>dict</span><span>()</span>

<span>def</span> <span>save_to_json_file</span><span>(</span><span>data</span><span>,</span> <span>filename</span><span>):</span>
    <span>"""Save data to json file."""</span>
    <span>with</span> <span>open</span><span>(</span><span>filename</span><span>,</span> <span>'w'</span><span>)</span> <span>as</span> <span>f</span><span>:</span>
        <span>json</span><span>.</span><span>dump</span><span>(</span><span>data</span><span>,</span> <span>f</span><span>)</span>

<span>def</span> <span>load_ipa_dict</span><span>():</span>
    <span>"""Load IPA dict from json file."""</span>
    <span>return</span> <span>load_json_file_or_dict</span><span>(</span><span>ipa_dict_path</span><span>)</span>

<span>def</span> <span>save_ipa_dict</span><span>(</span><span>ipa_dict</span><span>):</span>
    <span>"""Save IPA dict to json file."""</span>
    <span>save_to_json_file</span><span>(</span><span>ipa_dict</span><span>,</span> <span>ipa_dict_path</span><span>)</span></code></pre></figure>

<p>Next, I iterate through the words of the books and enter
each word and whatever is returned by <em>eng-to-ipa</em> into my dictionary.</p>

<figure><pre><code data-lang="python"><span>def</span> <span>harry_potter_text</span><span>():</span>
    <span>"""Return entire content of the Harry Potter books in a single string."""</span>
    <span>data</span> <span>=</span> <span>[]</span>
    <span>for</span> <span>filename</span> <span>in</span> <span>glob</span><span>.</span><span>glob</span><span>(</span><span>'data/json/Harry Potter*'</span><span>):</span>
        <span>with</span> <span>open</span><span>(</span><span>filename</span><span>)</span> <span>as</span> <span>f</span><span>:</span>
            <span>data</span><span>.</span><span>append</span><span>(</span><span>json</span><span>.</span><span>load</span><span>(</span><span>f</span><span>)[</span><span>'text'</span><span>])</span>
    <span>return</span> <span>' '</span><span>.</span><span>join</span><span>(</span><span>data</span><span>)</span>
    
<span>def</span> <span>populate_ipa_dict_from_text</span><span>(</span><span>text</span><span>):</span>
    <span>"""Get all IPA information from eng_to_ipa and save to ipa_dict."""</span>
    <span>ipa_dict</span> <span>=</span> <span>load_ipa_dict</span><span>()</span>
    <span>words</span> <span>=</span> <span>preprocess</span><span>(</span><span>text</span><span>).</span><span>split</span><span>()</span>
    <span>for</span> <span>word</span> <span>in</span> <span>set</span><span>(</span><span>words</span><span>)</span> <span>-</span> <span>set</span><span>(</span><span>ipa_dict</span><span>.</span><span>keys</span><span>()):</span>
        <span>ipa</span> <span>=</span> <span>eng_to_ipa</span><span>.</span><span>convert</span><span>(</span><span>word</span><span>,</span> <span>retrieve_all</span><span>=</span><span>True</span><span>,</span> <span>keep_punct</span><span>=</span><span>False</span><span>,</span>
                                 <span>stress_marks</span><span>=</span><span>False</span><span>)</span>
        <span>ipa_dict</span><span>[</span><span>word</span><span>]</span> <span>=</span> <span>ipa</span>
    <span>save_ipa_dict</span><span>(</span><span>ipa_dict</span><span>)</span>
    
<span>populate_ipa_dict_from_text</span><span>(</span><span>harry_potter_text</span><span>())</span></code></pre></figure>

<p>Each value in the dictionary is now a list of possible IPAs as that is what
<em>eng-to-ipa</em> returned. Before the dictionary can be used, we need to ensure
that each word …</p></div></article></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://darkshadow.io/2020/07/09/harry-potter-and-the-mnemonic-major-system.html">https://darkshadow.io/2020/07/09/harry-potter-and-the-mnemonic-major-system.html</a></em></p>]]>
            </description>
            <link>https://darkshadow.io/2020/07/09/harry-potter-and-the-mnemonic-major-system.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24045475</guid>
            <pubDate>Tue, 04 Aug 2020 01:14:31 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Physical attractiveness bias in the legal system (2017)]]>
            </title>
            <description>
<![CDATA[
Score 392 | Comments 377 (<a href="https://news.ycombinator.com/item?id=24044409">thread link</a>) | @simonebrunozzi
<br/>
August 3, 2020 | https://www.thelawproject.com.au/insights/attractiveness-bias-in-the-legal-system | <a href="https://web.archive.org/web/*/https://www.thelawproject.com.au/insights/attractiveness-bias-in-the-legal-system">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="siteWrapper">

      

      

      
        
          
            
              
                
              
            
          
        
      


      
      
      

      <main id="page" role="main">
        
        <!--
        --><!--
        --><div id="content" data-content-field="main-content" data-collection-id="5817e1ff3e00be2eafd0dec4" data-edit-main-image="">
         <div>

  
  <article id="article-58c757b5e4fcb5bd2d9613d5" data-item-id="58c757b5e4fcb5bd2d9613d5">

    

    <div>
      
        <div data-layout-label="Post Body" data-type="item" data-updated-on="1489459192059" id="item-58c757b5e4fcb5bd2d9613d5"><div><div><div data-block-type="2" id="block-yui_3_17_2_3_1489466160916_36894"><div><blockquote><p><a href="http://bit.ly/2m8beq4" target="_blank">[Download for PDF/printable version of this article]</a><br></p></blockquote><p>When I started looking into this subject, I predicted a person’s physical attractiveness would only have minor advantages. I was wrong.</p><p>In fact, I was so wrong, that in one study, the effects of physical attractiveness on judges were so influential, they fined unattractive criminals 304.88% higher than attractive criminals.</p><p>Surprising, I know.</p><p>Before we proceed, I want to address a few concerns of mine. Firstly, the information that you will read may cause some readers to feel unsettled. This is not my intention. Yes, it is disheartening. But the purpose of this article is to inform lawyers and other decision makers so that they can use the attractiveness bias to their advantage or to counter it.</p><p>A second concern of mine is that I don’t want to over-emphasise the attractiveness bias. Judges and jurors are affected by all kinds of cognitive distortions, such as emotive evidence, time of day, remorse of the defendant, socioeconomic status, race, gender, anchoring effect, and the contrast bias.</p><p>In the first section of this article, I give a ‘straight-to-the-point’ summary of the research conducted by 27 studies. Next, I enter into greater depth on the attractiveness bias and its effects on judges, jurors, and lawyers. Lastly, I provide research on the attractiveness bias in everyday life. Arguably, the last section is the most interesting.</p><p>Enjoy!</p><p>* * *</p><ol data-rte-list="default"><li><p>Physical Attractiveness had a significant influence on judges sentencing. The more unattractive the criminal, the higher the sentence. Or conversely, the more attractive the criminal, the lower the sentence. The results of three studies show a minimum increase of 119.25% and a maximum increase of 304.88%.<br></p></li><li><p>Attractiveness had little to no effect on a judge’s verdict of guilt. Attractive and unattractive criminals were convicted equally.<br></p></li><li><p>Mock jurors generally sentenced unattractive criminals significantly higher than attractive criminals. However, as jurors do not determine sentencing in real court cases, these results are not directly applicable.<br></p></li><li><p>Attractiveness had minor effects on mock juror’s verdicts. Some studies reported minor effects and some studies reported no effects.<br></p></li><li><p>Generally, attractive people are perceived as more intelligent, more socially skilled, more appealing personalities, more moral, more altruistic, more likely to succeed, more hirable as managers, and more competent. Attractive people tend to have better physical health, better mental health, better dating experiences, earn more money, obtain higher career positions, chosen for jobs more often, promoted more often, receive better job evaluations, and chosen as business partners more often, than unattractive people.<br></p></li><li><p>I believe that the attractiveness bias is rarely conscious. I do not think people are consciously disfavouring unattractive people. I also do not place moral blame on the typical person for their unconscious bias.</p></li></ol><p>* * *</p><h2><strong>REAL JUDGES: SENTENCING</strong></h2><p><strong>THE MISDEMEANOUR STUDY </strong><em>[1]</em></p><p>The first study we will observe is the research conducted by Downs and Lyons.</p><p>The purpose of this study was to find a link between a criminal’s attractiveness and sentencing outcomes.</p><p>They gathered a group of police officers and students to rate the attractiveness of over 2000 criminals. A scale of 1 - 5 was used and their ratings were mostly similar.</p><p>Then, the judges sentencing decisions were divided into two main categories: misdemeanors and felonies. Misdemeanors were separated into to 3 classes, related to the severity of the crime.</p><p><em>The Results &amp; Key Takeaways</em></p><p>For misdemeanours, the judges fined unattractive criminals significantly more than attractive criminals. The fine incrementally increased as the attractiveness decreased.</p><p>1.&nbsp;&nbsp;&nbsp;&nbsp; Minor Misdemeanours = +224.87%</p><p>2.&nbsp;&nbsp;&nbsp;&nbsp; Moderate Misdemeanours = +304.88%</p><p>3.&nbsp;&nbsp;&nbsp;&nbsp; Serious Misdemeanours = + 174.78%</p><p>The results are graphed below.</p></div></div><div data-block-type="5" id="block-yui_3_17_2_6_1489459079955_48500"><div>








  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <p><img data-src="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489539944610-FD8SUJ05P7WIZRNN1AYU/ke17ZwdGBToddI8pDm48kJTwxz64trr3drbHr6lHJk8UqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcrARKSnFMgvt0aSzcObof0G5Q2td9bvxksMtgDYlbDbROWDvDtu6PEW58QOEcShy6/Image+test+1.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489539944610-FD8SUJ05P7WIZRNN1AYU/ke17ZwdGBToddI8pDm48kJTwxz64trr3drbHr6lHJk8UqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcrARKSnFMgvt0aSzcObof0G5Q2td9bvxksMtgDYlbDbROWDvDtu6PEW58QOEcShy6/Image+test+1.jpg" data-image-dimensions="1047x619" data-image-focal-point="0.5,0.5" alt="Image test 1.jpg" data-load="false" data-image-id="58c89366f7e0ab29642796d9" data-type="image" src="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489539944610-FD8SUJ05P7WIZRNN1AYU/ke17ZwdGBToddI8pDm48kJTwxz64trr3drbHr6lHJk8UqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcrARKSnFMgvt0aSzcObof0G5Q2td9bvxksMtgDYlbDbROWDvDtu6PEW58QOEcShy6/Image+test+1.jpg">
          </p>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_6_1489459079955_48699"><div><p>Curiously, felony fines had no correlation with the attractiveness of the criminal. The study does not make it clear why this is the case.</p><p><em>Answers to Possible Objections</em></p><ul data-rte-list="default"><li><p>The judges varied in gender and race.</p></li><li><p>There was no correlation between sentencing outcomes and age, gender, and race.</p></li></ul><p><em>Weaknesses</em></p><p>For privacy reasons, the specific crime was not documented.</p><p>The direction of causation is not known. I enter into more depth in the section entitled ‘causation’.</p><p><strong>THE PENNSYLVANIAN STUDY<em> </em></strong><em>[2]</em></p><p>In Pennsylvanian and Philadelphian courts, the researcher’s gathered data on 67 defendants. The defendants were a mix of black, Hispanic, and white and there were 15 real judges in total.</p><p><em>Results &amp; Key Takeaways</em></p><p>On average (mean), criminals of low attractiveness were sentenced to 4.10 years in prison and criminals of high attractiveness were sentenced to 1.87 years in prison. This equals a 119.25% increase.</p></div></div><div data-block-type="5" id="block-yui_3_17_2_6_1489459079955_71526"><div>








  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <p><img data-src="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489459602430-G7OV3RYZPYB7CFDC7Y1E/ke17ZwdGBToddI8pDm48kB9PP1roaCoWCcB5PDMLLBcUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcJDPzuPFQMkDrmP7vOugYmF8e3iX03QqVmRfNUMP65OVoNHPxvCYY7HSGytwWF1ph/image-asset.png" data-image="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489459602430-G7OV3RYZPYB7CFDC7Y1E/ke17ZwdGBToddI8pDm48kB9PP1roaCoWCcB5PDMLLBcUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcJDPzuPFQMkDrmP7vOugYmF8e3iX03QqVmRfNUMP65OVoNHPxvCYY7HSGytwWF1ph/image-asset.png" data-image-dimensions="1095x642" data-image-focal-point="0.5,0.5" alt="" data-load="false" data-image-id="58c75991e6f2e16d0cb71613" data-type="image" src="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489459602430-G7OV3RYZPYB7CFDC7Y1E/ke17ZwdGBToddI8pDm48kB9PP1roaCoWCcB5PDMLLBcUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcJDPzuPFQMkDrmP7vOugYmF8e3iX03QqVmRfNUMP65OVoNHPxvCYY7HSGytwWF1ph/image-asset.png">
          </p>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_6_1489459079955_71724"><div><p><em>Weaknesses</em></p><p>All observers were white.</p><p><strong>THE SECOND PENNSYLVANIAN STUDY</strong> <em>[3]</em></p><p>This study was similar to the previous study. The researchers recorded data from real court cases in Pennsylvania. They detailed the physical attractiveness of 60 defendants and their neatness, cleanliness, and quality of clothing. Then, they recorded the judge’s decisions.</p><p>The criminals were charged with a range of felonies, including ‘murder; manslaughter; rape; kidnapping; armed robbery; aggravated assault; indecent assault; arson; burglary; conspiracy to sell/delver heroin, cocaine, hashish, and other elicit drugs; extortion; fraud; theft; and firearms violation.’</p><p>They were also a mix of white, Hispanic and black.&nbsp;</p><p><em>Results &amp; Key Takeaways</em></p><p>The unattractive defendants were punished higher than the attractive defendants.</p><p><em>Weaknesses</em></p><p>The study did not give specific results. This is a major disappointment.</p><p><strong>CONCLUSIONS</strong></p><p>Unattractive criminals were punished higher than attractive criminals in three studies. The lowest increase was at 119.25% and the highest increase was at 304.88%.</p><h2><strong>REAL JUDGES: VERDICT, GUILTY OR NOT-GUILTY</strong></h2><p>There was no association between the defendant’s physical attractiveness and the judge’s verdict. Attractive and unattractive criminals were found guilty at equal rates. Zebrowitz and McDonald [4]&nbsp;also found that the plaintiff’s attractiveness had little to no effects on a judge’s verdict.</p><p><strong>THE BABY-FACED STUDY </strong><em>[5]</em></p><p>The following study is not directly related to physical attractiveness but it is related to physical appearance.</p><p>Zebrowitz and McDonald measured the effects of defendants with a ‘baby-face’ and the judge’s verdict decisions. This is a strange characteristic to measure, however, the results were significant enough to warrant attention.</p><p>‘Baby-faced adults tend to have larger eyes, thinner, higher eyebrows, a large forehead and a small chin, and a curved rather than an angular face.’<em>[6]</em>&nbsp;A team of participants sat in 421 cases in ‘6 branches of the Commonwealth of Massachusetts small claims courts. 3 judges heard 51% of the cases and the remaining 49% of the cases were presided over by 22 additional judges.’ ‘62% of the plaintiffs and 78% of the defendants were male. 96% of both plaintiffs and defendants were white, and 81% were between the ages of 21 and 50.’</p><p><em>Results &amp; Key Takeaways</em></p><p>The more baby-faced an adult was, the less likely he/she was found to be guilty for ‘intentional actions’ in civil claims. Observe the graph below.</p></div></div><div data-block-type="5" id="block-yui_3_17_2_6_1489459079955_91414"><div>








  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <p><img data-src="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489459840849-7GP7F5ASMZM4ZYP8VK7K/ke17ZwdGBToddI8pDm48kND1NDuHF9nqrgeclEdLoeR7gQa3H78H3Y0txjaiv_0fDoOvxcdMmMKkDsyUqMSsMWxHk725yiiHCCLfrh8O1z4YTzHvnKhyp6Da-NYroOW3ZGjoBKy3azqku80C789l0qN_-Z3B7EvygvPOPmeOryWYMQ3pkjXJ5SX4aMqPMuK4PimCRlyu3R6yKl-KltrlZA/image-asset.jpeg" data-image="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489459840849-7GP7F5ASMZM4ZYP8VK7K/ke17ZwdGBToddI8pDm48kND1NDuHF9nqrgeclEdLoeR7gQa3H78H3Y0txjaiv_0fDoOvxcdMmMKkDsyUqMSsMWxHk725yiiHCCLfrh8O1z4YTzHvnKhyp6Da-NYroOW3ZGjoBKy3azqku80C789l0qN_-Z3B7EvygvPOPmeOryWYMQ3pkjXJ5SX4aMqPMuK4PimCRlyu3R6yKl-KltrlZA/image-asset.jpeg" data-image-dimensions="2500x2137" data-image-focal-point="0.5,0.5" alt="" data-load="false" data-image-id="58c75a7ed482e9a66b47537e" data-type="image" src="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489459840849-7GP7F5ASMZM4ZYP8VK7K/ke17ZwdGBToddI8pDm48kND1NDuHF9nqrgeclEdLoeR7gQa3H78H3Y0txjaiv_0fDoOvxcdMmMKkDsyUqMSsMWxHk725yiiHCCLfrh8O1z4YTzHvnKhyp6Da-NYroOW3ZGjoBKy3azqku80C789l0qN_-Z3B7EvygvPOPmeOryWYMQ3pkjXJ5SX4aMqPMuK4PimCRlyu3R6yKl-KltrlZA/image-asset.jpeg">
          </p>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_6_1489459079955_91612"><div><p>Interestingly, baby-faced adults had no effects in claims of negligent actions.</p><h2><strong>MOCK JURY: SENTENCING</strong></h2><p>Before I present the following research, I need to address a major limitation. Jurors do not decide upon sentencing, thus, the following results may not have direct application.</p><p><strong>THE META-ANALYSIS STUDY </strong><em>[7]</em></p><p>A meta-analysis examined 25 studies on the effects of physical attractiveness on mock jurors. They found that mock jurors gave higher sentences to unattractive criminals than attractive criminals. This was only for crimes of rape, robbery, and negligent homicide. For swindle, the punishment was equal. The physical attractiveness of the victim also had no effects on the jurors.</p><p><strong>THE BURGLARY STUDY </strong><em>[8]</em></p><p>In this study, the participants were given a burglary scenario along with an image of the criminal. Some received the unattractive criminal and others received the attractive criminal. 10 psychology students rated the attractiveness of the criminals prior to the study to determine attractiveness.</p><p>Then, they were asked to suggest a 1, 5, 10, 15, or 20 years imprisonment.</p><p>‘[The] participants consisted of 40 Euro-American men, 40 Euro-American women, 40 African- American men, and 40 African-American women.’ A strength of this study is the participants ranged in race, gender, and age.</p><p><em>Results &amp; Key Takeaways</em></p><p>The attractive criminal was given an average sentence of 9.7 years, and the unattractive criminal was given 14.7 years. That’s an increase of 51.55%.</p></div></div><div data-block-type="5" id="block-yui_3_17_2_8_1489459079955_11521"><div>








  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <p><img data-src="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489460099397-DVHCYTA21L18OEBFO2Z5/ke17ZwdGBToddI8pDm48kAd5GqBagiRmFFXdPSaeu6AUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcxXf4uRSJSWTC3Ffy6OHbvGAonPHpqoLXAI0RDTapQcSqK99-n2msqdbGF6fjDgYG/image-asset.png" data-image="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489460099397-DVHCYTA21L18OEBFO2Z5/ke17ZwdGBToddI8pDm48kAd5GqBagiRmFFXdPSaeu6AUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcxXf4uRSJSWTC3Ffy6OHbvGAonPHpqoLXAI0RDTapQcSqK99-n2msqdbGF6fjDgYG/image-asset.png" data-image-dimensions="1098x643" data-image-focal-point="0.5,0.5" alt="" data-load="false" data-image-id="58c75b829de4bb5cb740f698" data-type="image" src="https://images.squarespace-cdn.com/content/v1/5817bb2746c3c4a605334446/1489460099397-DVHCYTA21L18OEBFO2Z5/ke17ZwdGBToddI8pDm48kAd5GqBagiRmFFXdPSaeu6AUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcxXf4uRSJSWTC3Ffy6OHbvGAonPHpqoLXAI0RDTapQcSqK99-n2msqdbGF6fjDgYG/image-asset.png">
          </p>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_8_1489459079955_11721"><div><p><em>Weaknesses</em></p><p>The researchers measured more items than simply attractiveness. This means that the 160 participants were not all measured on attractiveness. As they measured 8 different items and only two of them on attractiveness, I infer …</p></div></div></div></div></div></div></article></div></div></main></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://www.thelawproject.com.au/insights/attractiveness-bias-in-the-legal-system">https://www.thelawproject.com.au/insights/attractiveness-bias-in-the-legal-system</a></em></p>]]>
            </description>
            <link>https://www.thelawproject.com.au/insights/attractiveness-bias-in-the-legal-system</link>
            <guid isPermaLink="false">hacker-news-small-sites-24044409</guid>
            <pubDate>Mon, 03 Aug 2020 22:50:09 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Go vs. Rust: Writing a CLI Tool]]>
            </title>
            <description>
<![CDATA[
Score 90 | Comments 83 (<a href="https://news.ycombinator.com/item?id=24044043">thread link</a>) | @JeremyMorgan
<br/>
August 3, 2020 | https://cuchi.me/posts/go-vs-rust | <a href="https://web.archive.org/web/*/https://cuchi.me/posts/go-vs-rust">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
<p><img src="https://gist.githubusercontent.com/cuchi/59255d61717e2d469263eb86cf083067/raw/6ef1a42f335022adf481fb84cabc32ac47f18679/go-vs-rust.png" alt="Go vs. Rust"></p>
<p>This text is about my adventure writing a small CLI application (twice) using
two languages I had little experience with.</p>
<p>If you are eager to jump right into the code and compare it yourself, check it
out the <a href="https://github.com/cuchi/hashtrack/tree/master/cli-go">Go source</a> and
the <a href="https://github.com/cuchi/hashtrack/tree/master/cli-rust">Rust source</a>.</p>
<hr>
<h2>About the Project</h2>
<p>I have a <em>pet project</em> called Hashtrack, which is a full-stack web application I
wrote for a technical interview. This project is rather small and it is simple
to use:</p>
<ol>
<li>You authenticate - considering you already created your account</li>
<li>You input hashtags you want to track</li>
<li>You wait for the <em>captured</em> tweets to show on your screen</li>
</ol>
<p><a href="https://hashtrack.herokuapp.com/">Check it out here.</a></p>
<p>After my interview, I kept improving this project just for fun, and I noticed
that it could be a perfect place to test my skills by implementing a CLI tool. I
already had the server, so I just needed to pick a language to implement a small
set of features under my project's API.</p>
<h2>Features</h2>
<ul>
<li><code>hashtrack login</code> - Creates a session token and store it in the local
filesystem in a config file.</li>
<li><code>hashtrack logout</code> - Remove the locally stored session token.</li>
<li><code>hashtrack track &lt;hashtag&gt; [...]</code> - Tracks one or more hashtags.</li>
<li><code>hashtrack untrack &lt;hashtag&gt; [...]</code> - Untracks one or more previously tracked
hashtags.</li>
<li><code>hashtrack tracks</code> - Displays the hashtags you are tracking.</li>
<li><code>hashtrack list</code> - Displays the latest 50 captured tweets.</li>
<li><code>hashtrack watch</code> - Stream and display the captured tweets in real-time.</li>
<li><code>hashtrack status</code> - Displays who you are, if logged in.</li>
<li>Should have an <code>--endpoint</code> option to point the CLI to another server.</li>
<li>Should have a <code>--config</code> option to load a custom config file.</li>
<li>This config file could also share the <code>endpoint</code> property.</li>
</ul>
<p>What we have to know beforehand:</p>
<ul>
<li>The CLI should use the project's API, which is GraphQL under HTTP +
WebSockets.</li>
<li>The CLI should use the filesystem to store a config file.</li>
<li>The CLI should parse positional arguments and flags.</li>
</ul>
<h2>How did I end up using Go and Rust?</h2>
<p>There is a large set of languages you can use to write CLI tools.</p>
<p>In this case, I wanted a language I had little or no prior experience with, I
also wanted one that could easily compile to a native executable, which is a
nice perk to have on a CLI tool.</p>
<p>My first obvious choice was Go, maybe because a lot of CLI tools I use are
implemented using it. But I also had little experience with Rust, and I saw it
could also be a good fit for this project.</p>
<p>So... why not both? Since my main objective here is to learn, could be a great
opportunity to implement this project twice and find what are the <em>pros and
cons</em> of each one from my point of view.</p>
<blockquote>
<p>Honorable mentions to <a href="https://crystal-lang.org/">Crystal</a> and
<a href="https://nim-lang.org/">Nim</a>, those were very promising options too. I'm looking
forward to learn about them in another pet project.</p>
</blockquote>
<h2>Local environment</h2>
<p>The first thing I look when using a new toolset is whether it has an easy way to
make it available for my user, without using the distribution package manager to
install it system-wide. We are talking about version managers, they make our
life easier by installing the tools in a user-wide manner instead of
system-wide. <a href="https://github.com/nvm-sh/nvm">NVM</a> for Node.js does it very well.</p>
<p>When using Go, there is the <a href="https://github.com/moovweb/gvm">GVM</a> project which
handles the local install &amp; version management, and it is easy to setup:</p>
<pre><code>gvm install go1.14 -B
gvm use go1.14
</code></pre>
<p>There are also two environment variables we need to know, they are <code>GOROOT</code> and
<code>GOPATH</code> -- You can read more about them
<a href="https://www.jetbrains.com/help/go/configuring-goroot-and-gopath.html">here</a>.</p>
<p>The first <em>problem</em> I found using Go, was when I was figuring out how the module
resolution worked along with the <code>GOPATH</code>, it became quite frustrating to
set up a project structure with a functional local development environment.</p>
<p>In the end, I just used <code>GOPATH=$(pwd)</code> in my project's directory, the main perk
was to have a per-project dependency setup, like a <code>node_modules</code>. It worked
well.</p>
<blockquote>
<p>After finishing my project, I found out that
<a href="https://github.com/GetStream/vg">virtualgo</a> existed and would solve my problems
with <code>GOPATH</code>.</p>
</blockquote>
<p>Rust has an official project called <a href="https://rustup.rs/">rustup</a>, which manages
the Rust installation, also known as <em>toolchain</em>. It can be easily set up with a
one-liner. Also, there is a set of optional components using <code>rustup</code>,
such as the <a href="https://github.com/rust-lang/rls">rls</a> and
<a href="https://github.com/rust-lang/rustfmt">rustfmt</a>.
Many projects require a <em>nightly</em> version of the Rust toolchain, with <code>rustup</code>
there was no problem switching between the versions.</p>
<h3>Editor Support</h3>
<p>For both of the languages, editor tooling was flawless, as a VSCode user, I can
find extensions for both Go and Rust in the marketplace.</p>
<p>When debugging with Rust, I had to install the
<a href="https://marketplace.visualstudio.com/items?itemName=vadimcn.vscode-lldb">CodeLLDB</a>
extension after following
<a href="https://www.forrestthewoods.com/blog/how-to-debug-rust-with-visual-studio-code/">this tutorial</a>.</p>
<h2>Package management</h2>
<p>Go doesn't have a package manager or even an official registry. Instead, its
module resolution works in a way you can import them from external URLs.</p>
<p>For dependency management, Rust uses the Cargo, which downloads and compiles
dependencies from <a href="https://crates.io/">crates.io</a>, which is the official
registry for Rust packages. Packages inside the Crates ecosystem can also have
their documentation available in <a href="https://docs.rs/">docs.rs</a></p>
<h2>Libraries</h2>
<p>My first objective was to see how easy could be to implement a simple GraphQL
query/mutation over HTTP.</p>
<p>For the Go language, I found some libraries, like
<a href="https://github.com/machinebox/graphql">machinebox/graphql</a> and
<a href="https://github.com/shurcooL/graphql">shurcooL/graphql</a>, the second one uses
structs for (un) marshaling the data, that is what made me stick to it.</p>
<blockquote>
<p>I used a fork of shurcooL/graphql, because I needed to set the
<code>Authorization</code> header in the client, the changes are in
<a href="https://github.com/shurcooL/graphql/pull/48">this pull request</a>.</p>
</blockquote>
<p>This is the Go example of an GraphQL mutation call:</p>
<pre><code><span>type</span> creationMutation <span>struct</span> {
    CreateSession <span>struct</span> {
        Token graphql.String
    } <span>`graphql:"createSession(email: $email, password: $password)"`</span>
}

<span>type</span> CreationPayload <span>struct</span> {
    Email    <span>string</span>
    Password <span>string</span>
}

<span><span>func</span> <span>Create</span><span>(client *graphql.Client, payload CreationPayload)</span> <span>(<span>string</span>, error)</span></span> {
    <span>var</span> mutation creationMutation
    variables := <span>map</span>[<span>string</span>]<span>interface</span>{}{
        <span>"email"</span>:    graphql.String(payload.Email),
        <span>"password"</span>: graphql.String(payload.Password),
    }
    err := client.Mutate(context.Background(), &amp;mutation, variables)

    <span>return</span> <span>string</span>(mutation.CreateSession.Token), err
}

</code></pre>
<p>In Rust, I had to use two libraries to make GraphQL calls. That is because
<code>graphql_client</code> is protocol-agnostic, it only focuses on code generation for
serializing and deserializing data. So I needed a second library (<code>reqwest</code>) to
take care of the HTTP requests.</p>
<pre><code><span>#[derive(GraphQLQuery)]</span>
<span>#[graphql(
    schema_path = <span>"graphql/schema.graphql"</span>,
    query_path = <span>"graphql/createSession.graphql"</span>
)]</span>
<span><span>struct</span> <span>CreateSession</span></span>;

<span>pub</span> <span><span>struct</span> <span>Session</span></span> {
    <span>pub</span> token: <span>String</span>,
}

<span>pub</span> <span><span>type</span> <span>Creation</span></span> = create_session::Variables;

<span>pub</span> <span>async</span> <span><span>fn</span> <span>create</span></span>(context: &amp;Context, creation: Creation) -&gt; <span>Result</span>&lt;Session, api::Error&gt; {
    <span>let</span> res = api::build_base_request(context)
        .json(&amp;CreateSession::build_query(creation))
        .send()
        .<span>await</span>?
        .json::&lt;Response&lt;create_session::ResponseData&gt;&gt;()
        .<span>await</span>?;
    <span>match</span> res.data {
        <span>Some</span>(data) =&gt; <span>Ok</span>(Session {
            token: data.create_session.token,
        }),
        _ =&gt; <span>Err</span>(api::Error(api::get_error_message(res).to_string())),
    }
}
</code></pre>
<p>Neither of the libraries for Go and Rust had any implementation for GraphQL via
WebSocket protocol.</p>
<p>In fact, <code>graphql_client</code> for Rust supports <em>Subscriptions</em>, but since it is
protocol-agnostic, I had to implement the whole GraphQL WebSocket communication
on my own,
<a href="https://github.com/cuchi/hashtrack/blob/b5a75f4368837cd51c621b6560a03e1835ec4e5b/cli-rust/src/tweet.rs#L90">check it out</a>.</p>
<p>To use WebSockets in the Go version, the library should be modified to support
the protocol. Since I was already using a fork of the library, I didn't feel
like doing it. Instead, I used a poor man's way of "watching" the new tweets,
which was to request the API every 5 seconds to retrieve them,
<a href="https://github.com/cuchi/hashtrack/blob/b5a75f4368837cd51c621b6560a03e1835ec4e5b/cli-go/src/hashtrack/tweets/tweets.go#L65">I'm not proud of it</a>.</p>
<p>Using Go, there is the <code>go</code> keyword to spawn a lightweight thread, also called
<em>goroutine</em>. In contrast, Rust uses operating system threads by calling a
<code>Thread::spawn</code>. Besides that, both implementations use channels to transfer
objects between their threads.</p>
<h2>Error handling</h2>
<p>In Go, errors are treated just like any other value. The common way to handle
errors in Go is to just check if they are present.</p>
<pre><code><span><span>func</span> <span>(config *Config)</span> <span>Save</span><span>()</span> <span>error</span></span> {
	contents, err := json.MarshalIndent(config, <span>""</span>, <span>"    "</span>)
	<span>if</span> err != <span>nil</span> {
		<span>return</span> err
	}

	err = ioutil.WriteFile(config.path, contents, <span>0</span>o644)
	<span>if</span> err != <span>nil</span> {
		<span>return</span> err
	}

	<span>return</span> <span>nil</span>
}
</code></pre>
<p>Rust has the <code>Result&lt;T, E&gt;</code> enum, which can encapsulate an <code>Ok(T)</code> for success,
or an <code>Err(E)</code> for errors. It also has the <code>Option&lt;T&gt;</code> enum, with <code>Some(T)</code> or
<code>None</code>. If you are familiar with Haskell, you may recognize
those as the <code>Either</code> and the <code>Maybe</code> monads.</p>
<p>There is also a syntactic sugar for error propagation (the <code>?</code> operator) that
resolves the value from the <code>Result</code> or <code>Option</code> structure, automatically
returning <code>Err(...)</code> or <code>None</code> when something goes bad.</p>
<pre><code><span>pub</span> <span><span>fn</span> <span>save</span></span>(&amp;<span>mut</span> <span>self</span>) -&gt; io::<span>Result</span>&lt;()&gt; {
    <span>let</span> json = serde_json::to_string(&amp;<span>self</span>.contents)?;
    <span>let</span> <span>mut</span> file = File::create(&amp;<span>self</span>.path)?;
    file.write_all(json.as_bytes())
}
</code></pre>
<p>The code above is the equivalent of</p>
<pre><code><span>pub</span> <span><span>fn</span> <span>save</span></span>(&amp;<span>mut</span> <span>self</span>) -&gt; io::<span>Result</span>&lt;()&gt; {
    <span>let</span> json = <span>match</span> serde_json::to_string(&amp;<span>self</span>.contents) {
        <span>Ok</span>(json) =&gt; json,
        <span>Err</span>(e) =&gt; <span>return</span> <span>Err</span>(e.into())
    };
    <span>let</span> <span>mut</span> file = <span>match</span> File::create(&amp;<span>self</span>.path) {
        <span>Ok</span>(file) =&gt; file,
        <span>Err</span>(e) =&gt; <span>return</span> <span>Err</span>(e.into())
    };
    file.write_all(json.as_bytes())
}
</code></pre>
<p>Rust has:</p>
<ul>
<li>monadic constructs (<code>Option</code> &amp; <code>Result</code>)</li>
<li>the error propagation operator</li>
<li>the <code>From</code> trait, to automatically convert errors on propagation</li>
</ul>
<p>The combination of the three features above makes up the best error handling
solution I saw in a language, being simple, sound, and maintainable at the same
time.</p>
<h2>Compilation time</h2>
<p>Go is built with fast compilation time as a critical requirement, let's see:</p>
<pre><code>&gt; time go get hashtrack 
go get hashtrack  1,39s user 0,41s system 43% cpu 4,122 total

&gt; time go build -o hashtrack hashtrack 
go build -o hashtrack hashtrack  0,80s user 0,12s system 152% cpu 0,603 total

&gt; time go build -o hashtrack hashtrack 
go build -o hashtrack hashtrack  0,19s user 0,07s system 400% cpu 0,065 total

&gt; time go build -o hashtrack hashtrack 
go build -o hashtrack hashtrack  0,94s user 0,13s …</code></pre></article></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://cuchi.me/posts/go-vs-rust">https://cuchi.me/posts/go-vs-rust</a></em></p>]]>
            </description>
            <link>https://cuchi.me/posts/go-vs-rust</link>
            <guid isPermaLink="false">hacker-news-small-sites-24044043</guid>
            <pubDate>Mon, 03 Aug 2020 22:08:33 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[PP-YOLO Surpasses YOLOv4 – State-of-the-art object detection techniques]]>
            </title>
            <description>
<![CDATA[
Score 120 | Comments 47 (<a href="https://news.ycombinator.com/item?id=24043812">thread link</a>) | @rocauc
<br/>
August 3, 2020 | https://blog.roboflow.ai/pp-yolo-beats-yolov4-object-detection/ | <a href="https://web.archive.org/web/*/https://blog.roboflow.ai/pp-yolo-beats-yolov4-object-detection/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
            <div>
              <div><p>Baidu publishes PP-YOLO and pushes the state of the art in object detection research by building on top of YOLOv3, the PaddlePaddle deep learning framework, and cutting edge computer vision research.</p><figure><img src="https://blog.roboflow.ai/content/images/2020/08/image-1.png" alt="" srcset="https://blog.roboflow.ai/content/images/size/w600/2020/08/image-1.png 600w, https://blog.roboflow.ai/content/images/2020/08/image-1.png 692w"><figcaption><a href="https://arxiv.org/pdf/2007.12099.pdf">PP-YOLO</a> evaluation shows faster inference (x-axis) with better accuracy (y-axis)</figcaption></figure><p>PP-YOLO evaluation metrics show improved performance over <a href="https://blog.roboflow.ai/a-thorough-breakdown-of-yolov4/">YOLOv4</a>, the incumbent state of the art object detection model. Yet, the Baidu authors write:</p><figure><pre><code>This paper is not intended to introduce a novel object detecotor. 
It is more like a recipe, which tell you how to build a better detector step by step.</code></pre><figcaption>Mysterious introduction in the <a href="https://arxiv.org/pdf/2007.12099.pdf">PP-YOLO paper</a></figcaption></figure><p>Let's unpack that.</p><h2 id="yolo-development-history">YOLO Development History</h2><p>YOLO was originally authored by Joseph Redmon to detect objects. Object detection is a computer vision technique that localizes and tags objects by drawing a bounding box around them and identifying the class label that a given box belongs too. Unlike massive NLP transformers, YOLO is designed to be tiny, enabling realtime inference speeds for deployment on device. &nbsp;</p><p>YOLO-9000 was the second "YOLOv2" object detector published by Joseph Redmon, improving the detector and emphasizing the detectors ability to generalize to any object in the world.</p><figure><img src="https://blog.roboflow.ai/content/images/2020/08/image-2.png" alt="" srcset="https://blog.roboflow.ai/content/images/size/w600/2020/08/image-2.png 600w, https://blog.roboflow.ai/content/images/size/w1000/2020/08/image-2.png 1000w, https://blog.roboflow.ai/content/images/size/w1600/2020/08/image-2.png 1600w, https://blog.roboflow.ai/content/images/2020/08/image-2.png 1810w" sizes="(min-width: 720px) 720px"><figcaption><a href="https://github.com/PaddlePaddle/PaddleDetection/blob/release/0.4/docs/tutorials/Custom_DataSet.md">PP-YOLO</a> is being trained to identify different fruit flies in this photo.</figcaption></figure><p>YOLOv3 made further improvements to the detection network and began to mainstream the object detection process. We began to publish tutorials on <a href="https://blog.roboflow.ai/releasing-a-new-yolov3-implementation/">how to train YOLOv3 in PyTorch</a>, <a href="https://blog.roboflow.ai/training-a-yolov3-object-detection-model-with-a-custom-dataset/">how to train YOLOv3 in Keras</a>, and <a href="https://blog.roboflow.ai/yolov3-versus-efficientdet-for-state-of-the-art-object-detection/">compared YOLOv3 performance to EfficientDet </a>(another state of the art detector).</p><p>Then Joseph Redmon stepped out of the object detection game due to ethical concerns. </p><p>Naturally, the open source community picked up the baton and continues to move YOLO technology forward. </p><p>YOLOv4 was published recently this spring by Alexey AB in his for of the YOLO Darknet repository. YOLOv4 was primarily an ensemble of other known computer vision technologies, combined and validated through the research process. See here for a <a href="https://blog.roboflow.ai/a-thorough-breakdown-of-yolov4/">deep dive on YOLOv4</a>. The YOLOv4 paper reads similarly to the PP-YOLO paper, as we will see below. We put together some great training tutorials on <a href="https://blog.roboflow.ai/training-yolov4-on-a-custom-dataset/">how to train YOLOv4 in Darknet</a>.</p><p>Then, just a few months ago <a href="https://blog.roboflow.ai/yolov5-is-here/">YOLOv5 was released</a>. YOLOv5 took the Darknet (C based) training environment and converted the network to PyTorch. Improved training techniques pushed performance of the model even further and created a great, easy to use, out of the box object detection model. Ever since, we have been encouraging developers using Roboflow to direct their attention to YOLOv5 for the formation of their custom object detectors via this <a href="https://blog.roboflow.ai/how-to-train-yolov5-on-a-custom-dataset/">YOLOv5 training tutorial</a>.</p><p>Enter PP-YOLO.</p><h2 id="what-does-pp-stand-for">What Does PP Stand For?</h2><p>PP is short for PaddlePaddle, a deep learning framework written by Baidu. </p><figure><img src="https://blog.roboflow.ai/content/images/2020/08/image-9.png" alt="" srcset="https://blog.roboflow.ai/content/images/size/w600/2020/08/image-9.png 600w, https://blog.roboflow.ai/content/images/size/w1000/2020/08/image-9.png 1000w, https://blog.roboflow.ai/content/images/size/w1600/2020/08/image-9.png 1600w, https://blog.roboflow.ai/content/images/2020/08/image-9.png 1634w" sizes="(min-width: 720px) 720px"><figcaption><a href="https://www.paddlepaddle.org.cn/">PaddlePaddle</a> distributions provided on their website.</figcaption></figure><p>If PaddlePaddle is new to you, then we are in the same boat. Primarily written in Python, PaddlePaddle seems akin to PyTorch and TensorFlow. A deep dive into the PaddlePaddle framework is intriguing, but beyond the scope of this article. </p><h2 id="pp-yolo-contributions">PP-YOLO Contributions</h2><p>The PP-YOLO paper reads much like the YOLOv4 paper in that it is a compilation of techniques that are known to work in computer vision. The novel contribution is to prove that the ensemble of these technologies improves performance, and to provide an ablation study of how much each step helps the model along the way.</p><p>Before we dive into the contributions of PP-YOLO, it will be useful to review the YOLO detector architecture.</p><h3 id="anatomy-of-the-yolo-detector">Anatomy of the YOLO Detector</h3><figure><img src="https://blog.roboflow.ai/content/images/2020/08/image.png" alt="" srcset="https://blog.roboflow.ai/content/images/size/w600/2020/08/image.png 600w, https://blog.roboflow.ai/content/images/size/w1000/2020/08/image.png 1000w, https://blog.roboflow.ai/content/images/2020/08/image.png 1376w" sizes="(min-width: 720px) 720px"><figcaption>A graphical depiction of the <a href="https://arxiv.org/pdf/2007.12099.pdf">PP-YOLO</a> object detection network</figcaption></figure><p>The YOLO detector is broken into three main pieces.</p><p><strong>YOLO Backbone</strong> - The YOLO backbone is a convolutional neural network that pools image pixels to form features at different granularities. The Backbone is typically pretrained on a classification dataset, typically ImageNet.</p><p><strong>YOLO Neck - </strong>The YOLO neck (FPN is chosen above) combines and mixes the ConvNet layer representations before passing on to the prediction head.</p><p><strong>YOLO Head</strong> - This is the part of the network that makes the bounding box and class prediction. It is guided by the three YOLO loss functions for class, box, and objectness. </p><h2 id="now-let-s-dive-into-the-pp-yolo-contributions-">Now let's dive into the PP YOLO Contributions.</h2><figure><img src="https://blog.roboflow.ai/content/images/2020/08/image-10.png" alt="" srcset="https://blog.roboflow.ai/content/images/size/w600/2020/08/image-10.png 600w, https://blog.roboflow.ai/content/images/size/w1000/2020/08/image-10.png 1000w, https://blog.roboflow.ai/content/images/2020/08/image-10.png 1136w" sizes="(min-width: 720px) 720px"><figcaption>Marginal mAP accuracy performance increase from each technique in PP-YOLO</figcaption></figure><h3 id="replace-backbone">Replace Backbone</h3><p>The first PP YOLO technique is to replace the YOLOv3 Darknet53 backbone with the Resnet50-vd-dcn ConvNet backbone. Resnet is a more popular backbone, more frameworks are optimized for its execution, and it has fewer parameters than Darknet53. Seeing a mAP improvement by swapping this backbone is a huge win for PP YOLO. </p><figure><img src="https://blog.roboflow.ai/content/images/2020/08/image-12.png" alt="" srcset="https://blog.roboflow.ai/content/images/size/w600/2020/08/image-12.png 600w, https://blog.roboflow.ai/content/images/size/w1000/2020/08/image-12.png 1000w, https://blog.roboflow.ai/content/images/2020/08/image-12.png 1422w" sizes="(min-width: 720px) 720px"><figcaption>Graphical depiction in <a href="https://arxiv.org/pdf/1603.05027.pdf">ResNet</a></figcaption></figure><h3 id="ema-of-model-parameters">EMA of Model Parameters</h3><p>PP YOLO tracks the Exponential Moving Average of network parameters to maintain a shadow of the models weights for prediction time. This has been shown to improve inference accuracy.</p><h3 id="larger-batch-size">Larger Batch Size</h3><p>PP-YOLO bumps the batch size up from 64 to 192. Of course, this is hard to implement if you have GPU memory constraints.</p><h3 id="dropblock-regularization">DropBlock Regularization</h3><p>PP YOLO implements DropBlock regularization in the FPN neck (in the past, this has usually occurred in the backbone). DropBlock randomly removes a block of the training features at a given step in the network to teach the model to not rely on key features for detection.</p><figure><img src="https://blog.roboflow.ai/content/images/2020/08/image-16.png" alt="" srcset="https://blog.roboflow.ai/content/images/size/w600/2020/08/image-16.png 600w, https://blog.roboflow.ai/content/images/size/w1000/2020/08/image-16.png 1000w, https://blog.roboflow.ai/content/images/2020/08/image-16.png 1050w" sizes="(min-width: 720px) 720px"><figcaption><a href="https://arxiv.org/pdf/1810.12890.pdf">Drop Block</a> regularization technique - features are hidden in blocks (c) not randomly (b)</figcaption></figure><h3 id="iou-loss">IoU Loss</h3><p>The YOLO loss function does not translate well to the <a href="https://blog.roboflow.ai/what-is-mean-average-precision-object-detection/">mAP metric</a>, which uses the Intersection over Union heavily in its calculation. Therefore, it is useful to edit the training loss function with this end prediction in mind. This edit was also present in YOLOv4.</p><h3 id="iou-aware">IoU Aware</h3><p>The PP-YOLO network adds a prediction branch to predict the model's estimated IOU with a given object. Including this IoU awareness when making the decision to predict an object or not improves performance.</p><h3 id="grid-sensitivity">Grid Sensitivity</h3><p>The old YOLO models do not do a good job of making predictions right around the boundaries of anchor box regions. It is useful to define box coordinates slightly differently to avoid this problem. This technique is also present in YOLOv4.</p><h3 id="matrix-nms">Matrix NMS </h3><p>Non-Maximum Suppression is a technique to remove over proposals of candidate objects for classification. Matrix NMS is a technique to sort through these candidate predictions in parallel, speeding up the calculation. </p><h3 id="coordconv">CoordConv</h3><p>CoordConv was motivated by the problems ConvNets were having with simply mapping (x,y) coordinates to a one-hot pixel space. The CoordConv solution gives the convolution network access to its own input coordinates. CoordConv interventions are marked with yellow diamonds above. More details are available in <a href="https://arxiv.org/pdf/1807.03247.pdf">the CordConv paper</a>.</p><h3 id="spp">SPP</h3><p>Spatial Pyramid Pooling is an extra block after the backbone layer to mix and pool spatial features. Also implemented in YOLOv4 and YOLOv5.</p><h3 id="better-pretrained-backbone">Better Pretrained Backbone</h3><p>The PP YOLO authors distilled down a larger ResNet model to serve as the backbone. A better pretrained model shows to improve downstream transfer learning as well. </p><h2 id="is-pp-yolo-state-of-the-art"><br>Is PP-YOLO State of the Art?</h2><p>PP-YOLO outperforms the results <a href="https://arxiv.org/pdf/2004.10934.pdf">YOLOv4 published</a> on April 23, 2020.</p><p>In fairness, the authors note this may be the wrong question to be asking. The authors' intent appears to not simply "introduce a new novel detector," rather to show the process of carefully tuning an object detector to maximize performance. Quoting the paper's introduction here:</p><blockquote>The focus of this paper is how to stack some effective tricks that hardly affect efficiency to get better performance... This paper is not intended to introduce a novel object detector. It is more like a recipe, which tell you how to build a better detector step by step. We have found some tricks that are effective for the YOLOv3 detector, which can save developers’ time of trial and error. <strong>The final PP-YOLO model improves the mAP on COCO from 43.5% to 45.2% at a speed faster than YOLOv4</strong></blockquote><p><em>(emphasis ours)</em></p><p>The PP-YOLO contributions reference above took the YOLOv3 model from 38.9 to 44.6 mAP on the COCO object detection task and increased inference FPS from 58 to 73. These metrics are shown in the paper to beat the currently published results for YOLOv4 and EfficientDet. </p><p>In benchmarking PP-YOLO against <a href="https://blog.roboflow.ai/yolov5-improvements-and-evaluation/">YOLOv5</a>, it appears <a href="https://blog.roboflow.ai/yolov5-improvements-and-evaluation/">YOLOv5</a> still has the fastest inference time-to-accuracy performance (AP vs FPS) tradeoff on a V100. However, a YOLOv5 paper still remains to be released. Furthermore, it has been shown that training the YOLOv4 architecture on the YOLOv5 Ultralytics repository outperforms YOLOv5 and, transitively, YOLOv4 trained using YOLOv5 contributions would outperform the PP-YOLO results posted here. These results are still to be formally published but can be traced to <a href="https://github.com/ultralytics/yolov5/issues/6">this GitHub discussion</a>.</p><figure><img src="https://blog.roboflow.ai/content/images/2020/08/image-14.png" alt="" srcset="https://blog.roboflow.ai/content/images/size/w600/2020/08/image-14.png 600w, https://blog.roboflow.ai/content/images/size/w1000/2020/08/image-14.png 1000w, https://blog.roboflow.ai/content/images/2020/08/image-14.png 1354w" sizes="(min-width: 720px) 720px"><figcaption><a href="https://arxiv.org/pdf/2007.12099.pdf">PP-YOLO evaluation</a> on COCO dataset on V100 GPU (note AP_50 column)</figcaption></figure><figure><img src="https://blog.roboflow.ai/content/images/2020/08/image-15.png" alt="" srcset="https://blog.roboflow.ai/content/images/size/w600/2020/08/image-15.png 600w, https://blog.roboflow.ai/content/images/size/w1000/2020/08/image-15.png 1000w, https://blog.roboflow.ai/content/images/2020/08/image-15.png 1304w" sizes="(min-width: 720px) 720px"><figcaption><a href="https://blog.roboflow.ai/yolov5-improvements-and-evaluation/">YOLOv5 evaluation</a> on COCO dataset on V100 GPU (note AP_50 column)</figcaption></figure><p>It is worth noting that many of the techniques (such as architecture search and data augmentation) that were used in YOLOv4 were not used in PP YOLO. This means that there is still room for the state of the art in object detection to grow as more of these techniques are combined and integrated together. </p><p>Needless to say, is an exciting time to be implementing computer vision technologies.</p><h2 id="should-i-switch-from-yolov4-or-yolov5-to-pp-yolo">Should I Switch from YOLOv4 or YOLOv5 to PP-YOLO?</h2><p>The PP-YOLO model shows the promise of state of the art object detection, but the improvements are incremental over other object detectors and it is written in a new framework. At this stage, the best thing to do is to develop your own empirical result by training PP-YOLO on your own dataset. (To be notified when you can easily use PP-YOLO on your dataset, <a href="https://roboflow.us5.list-manage.com/subscribe?u=26126ade12b1dd890dbd7b07e&amp;id=3e926cf19a">subscribe to our newsletter</a>.)</p><p>In the meantime, I recommend checking out the following YOLO tutorials to get your object detector off the ground:</p><ul><li><a href="https://blog.roboflow.ai/training-yolov4-on-a-custom-dataset/">How to Train YOLOv4 in Darknet</a></li><li><a href="https://blog.roboflow.ai/how-to-train-yolov5-on-a-custom-dataset/">How to Train YOLOv5 in PyTorch</a></li></ul><p>As always - happy training! </p></div>
              
            </div>
          </div></div>]]>
            </description>
            <link>https://blog.roboflow.ai/pp-yolo-beats-yolov4-object-detection/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24043812</guid>
            <pubDate>Mon, 03 Aug 2020 21:43:20 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[RISC-V OS using Rust: Graphics]]>
            </title>
            <description>
<![CDATA[
Score 98 | Comments 33 (<a href="https://news.ycombinator.com/item?id=24041869">thread link</a>) | @azhenley
<br/>
August 3, 2020 | https://blog.stephenmarz.com/2020/07/24/risc-v-os-using-rust-graphics/ | <a href="https://web.archive.org/web/*/https://blog.stephenmarz.com/2020/07/24/risc-v-os-using-rust-graphics/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
								
								<div>
									
<p>An operating system is used to make our job easier when using graphics. In our instance, in addition to everything else. In this post, we will be writing a GPU (graphics processing unit) driver using the VirtIO specification. In here, we will allow user applications to have a portion of the screen as RAM–with what is commonly known as a <em>framebuffer</em>.</p>



<hr>



<h2>Contents</h2>



<ol><li><a href="#overview">Overview</a></li><li><a href="#pixels">Pixels and Resolution</a></li><li><a href="#virtio">The GPU VirtIO Device</a></li><li><a href="#init">Initialization</a></li><li><a href="#invalid">Invalidation and Transfer</a></li><li><a href="#response">Device Responses</a></li><li><a href="#user">User Space</a></li><li><a href="#api">Simple Graphics API</a></li><li><a href="#conclusion">Conclusions and Further Reading</a></li></ol>



<hr>



<h2 id="overview">Overview</h2>



<p>We command the virtual GPU (virtio-gpu) by sending certain commands to the host (the device). The guest (the OS driver) has an allocation of RAM that becomes the framebuffer. The driver then tells the device, “hey, here’s the RAM that we’re going to use to store pixel information.”</p>



<p>The RAM is contiguous in our OS, but according to the specification, this isn’t strictly required. We will give the driver a rectangle. Everything that falls within that rectangle will be copied to the host. We don’t want to keep copying the entire buffer over and over again.</p>



<p>We will be using the virtio protocol that we used for the block driver here, so I won’t rehash the general virtio protocol. However, the device-specific structures are a bit different, so we’ll cover that part more in depth.</p>



<hr>



<h2 id="pixels">Pixels and Resolution</h2>



<p>A framebuffer must be large enough to store \(\text{width}\times\text{height}\times\text{pixel size}\) number of bytes. There are \(\text{width}\times\text{height}\) number of pixels. Each pixel has a 1-byte red, green, blue, and alpha channels. So, each pixel is exactly 4 bytes with the configuration we’re going to specify.</p>



<p>The framebuffer for our junior GPU driver is going to support a fixed resolution of \(640\times 480\). If you’re a child of the 90s, you saw this resolution a lot. In fact, my first computer, a Laser Pal 386, had a 16-color monitor with a resolution of 640 pixels wide with 480 pixels tall.</p>



<div><figure><a href="https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-13.png"><img src="https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-13.png" alt="" width="458" height="281" srcset="https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-13.png 611w, https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-13-300x184.png 300w" sizes="(max-width: 458px) 100vw, 458px"></a></figure></div>



<p>There are red, green, and blue pixels so close together that by varying the intensity of these three channels, we can change the color. The closer we get to our monitors, the easier a pixel is to see.</p>



<div><figure><a href="https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-14.png"><img src="https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-14.png" alt="" width="285" height="288" srcset="https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-14.png 380w, https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-14-297x300.png 297w" sizes="(max-width: 285px) 100vw, 285px"></a><figcaption>Pixels on a Viewsonic VX2770SMH-LED monitor.</figcaption></figure></div>



<p>You can see these little squares. If you squint enough, you can see that they aren’t pure white. Instead, you can see bits of red, blue, and green. That’s because each one of these little squares is subdivided into three colors: yep, red, green, and blue! To make white, these pixels are turned up to 11 (get the joke?). To make black, we turn off all three channels of that pixel.</p>



<p>The resolution refers to how many of these squares are on our monitor. This is a 1920×1080 monitor. That means that there are 1920 of these squares going left to right, and there are 1080 of these squares from top to bottom. All in all, we have \(1920\times 1080=2,073,600\) number of pixels. Each one of these pixels is expressed using 4 bytes in the framebuffer, meaning we need \(2,073,600\times 4=8,294,400\) bytes in RAM to store the pixel information.</p>



<p>You can see why I limited our resolution to 640×480, which only requires \(640\times 480\times 4=1,228,800\) bytes–a bit over a megabyte.</p>



<hr>



<h2 id="virtio">The GPU VirtIO Device</h2>



<p>The GPU device requires us to read a more up-to-date VirtIO specification. I’ll be reading from version 1.1, which you can get a copy here: <a href="https://docs.oasis-open.org/virtio/virtio/v1.1/virtio-v1.1.html">https://docs.oasis-open.org/virtio/virtio/v1.1/virtio-v1.1.html</a>. Specifically, chapter 5.7 “GPU Device”. This is an <em>unaccelerated</em> 2D device, meaning that we must use the CPU to actually form the framebuffer, then we transfer our CPU formulated memory location to the host GPU, which is then responsible for drawing it to the screen.</p>



<p>The device uses a request/response system, where we the driver make a command to request something from the host (the GPU).  We add a bit of extra memory into our request so that the host can formulate its response. When the GPU interrupts us, we can take a look at this response memory location to see what the GPU told us. This is much like the <em>status</em> field on the block driver, where the block device tells us the status of our last request.</p>



<p>Each request starts with a <em>Command Header</em>, which in Rust looks as follows:</p>



<pre data-enlighter-language="rust" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#[repr(C)]
struct CtrlHeader {
	ctrl_type: CtrlType,
	flags: u32,
	fence_id: u64,
	ctx_id: u32,
	padding: u32
}</pre>



<p>The header is common for all requests and all responses. We can differentiate by the CtrlType enumeration, which is:</p>



<pre data-enlighter-language="rust" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#[repr(u32)]
enum CtrlType {
	/* 2d commands */
	CmdGetDisplayInfo = 0x0100,
	CmdResourceCreate2d,
	CmdResourceUref,
	CmdSetScanout,
	CmdResourceFlush,
	CmdTransferToHost2d,
	CmdResourceAttachBacking,
	CmdResourceDetachBacking,
	CmdGetCapsetInfo,
	CmdGetCapset,
	CmdGetEdid,
	/* cursor commands */
	CmdUpdateCursor = 0x0300,
	CmdMoveCursor,
	/* success responses */
	RespOkNoData = 0x1100,
	RespOkDisplayInfo,
	RespOkCapsetInfo,
	RespOkCapset,
	RespOkEdid,
	/* error responses */
	RespErrUnspec = 0x1200,
	RespErrOutOfMemory,
	RespErrInvalidScanoutId,
	RespErrInvalidResourceId,
	RespErrInvalidContextId,
	RespErrInvalidParameter,
}</pre>



<p>I took this directly from the specification, but Rust-ified the names to avoid getting yelled at by the linter.</p>



<h3>Pixel Formats</h3>



<p>Recall that the framebuffer is just a bunch of bytes in memory. We need to put a structure behind the framebuffer so the host (the GPU) knows how to interpret your sequence of bytes. There are several formats, but all-in-all, they just re-arrange the red, green, blue, and alpha channels. All are exactly 4 bytes, which makes the <em>stride</em> the same. The stride is the spacing from one pixel to another–4 bytes.</p>



<pre data-enlighter-language="rust" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#[repr(u32)]
enum Formats {
	B8G8R8A8Unorm = 1,
	B8G8R8X8Unorm = 2,
	A8R8G8B8Unorm = 3,
	X8R8G8B8Unorm = 4,
	R8G8B8A8Unorm = 67,
	X8B8G8R8Unorm = 68,
	A8B8G8R8Unorm = 121,
	R8G8B8X8Unorm = 134,
}</pre>



<p>The type, <em>unorm</em>, is an 8-bit (1-byte) unsigned value from 0 through 255, where 0 represents no intensity and 255 represents full intensity, and a number in between is a linear-interpolation between no and full intensity. Since there are three color (and one alpha), that gives us \(256\times 256\times 256=16,776,216\) different colors or levels of colors.</p>



<p>For this tutorial, I selected <code>R8G8B8A8Unorm = 67</code>, which has red first, green second, blue third, and alpha fourth. This is a common ordering, so I’ll select it to make it easy to follow along.</p>



<p>Our selected format makes the pixel structure look as follows:</p>



<div><figure><a href="https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-21.png"><img src="https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-21-1024x614.png" alt="" width="512" height="307" srcset="https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-21-1024x614.png 1024w, https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-21-300x180.png 300w, https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-21-768x461.png 768w, https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-21-1536x921.png 1536w, https://blog.stephenmarz.com/wp-content/uploads/2020/05/image-21-2048x1228.png 2048w" sizes="(max-width: 512px) 100vw, 512px"></a></figure></div>



<p>Recall that each individual component R, G, B, and A are each one byte a piece, so each Pixel referred to by (x, y) is 4 bytes. This is why our memory pointer is a Pixel structure instead of a byte.</p>



<hr>



<h2 id="init">Initialization</h2>



<p>Just like all other virtio devices, we set up the virtqueues first and then we work on device-specific initialization. In my code, I just directly copied-and-pasted from the block driver into the gpu driver. The only thing I added to the Device structure was the framebuffer and dimensions of the framebuffer.</p>



<pre data-enlighter-language="rust" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">pub struct Device {
	queue:        *mut Queue,
	dev:          *mut u32,
	idx:          u16,
	ack_used_idx: u16,
	framebuffer:  *mut Pixel,
	width:        u32,
	height:       u32,
}</pre>



<p>The specification tells us to do the following in order to initialize the device and get things ready to draw. I Rust-ified some of the content to match our enumerations.</p>



<h4>Create a framebuffer and configure scanout</h4>



<ol><li>Create a host resource using <code>CmdResourceCreate2d</code>.</li><li>Allocate a framebuffer from guest ram, and attach it as backing storage to the resource just created, using <code>CmdResourceAttachBacking</code>.</li><li>Use <code>CmdSetScanout</code> to link the framebuffer to a display scanout.</li></ol>



<h3>A Request Structure</h3>



<p>Recall that our request and response come packaged together. We will put them in separate descriptors, but whenever we get a response back from the device, it is going to be easier if we free just once to free both the request and response. So, in Rust, I created the Request structure to support doing this.</p>



<pre data-enlighter-language="rust" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">struct Request&lt;RqT, RpT&gt; {
	request: RqT,
	response: RpT,
}
impl&lt;RqT, RpT&gt; Request&lt;RqT, RpT&gt; {
	pub fn new(request: RqT) -&gt; *mut Self {
		let sz = size_of::&lt;RqT&gt;() + size_of::&lt;RpT&gt;();
		let ptr = kmalloc(sz) as *mut Self;
		unsafe {
			(*ptr).request = request;
		}
		ptr
	}
}</pre>



<h4>Step 1: Create host resource</h4>



<pre data-enlighter-language="rust" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">let rq = Request::new(ResourceCreate2d {
	hdr: CtrlHeader {
		ctrl_type: CtrlType::CmdResourceCreate2d,
		flags: 0,
		fence_id: 0,
		ctx_id: 0,
		padding: 0,
	},
	resource_id: 1,
	format: Formats::R8G8B8A8Unorm,
	width: dev.width,
	height: dev.height,
});
let desc_c2d = Descriptor {
	addr: unsafe { &amp;(*rq).request as *const ResourceCreate2d as u64 },
	len: size_of::&lt;ResourceCreate2d&gt;() as u32,
	flags: VIRTIO_DESC_F_NEXT,
	next: (dev.idx + 1) % VIRTIO_RING_SIZE as u16,
};
let desc_c2d_resp = Descriptor {
	addr: unsafe { &amp;(*rq).response as *const CtrlHeader as u64 },
	len: size_of::&lt;CtrlHeader&gt;() as u32,
	flags: VIRTIO_DESC_F_WRITE,
	next: 0,
};
unsafe {
	let head = dev.idx;
	(*dev.queue).desc[dev.idx as usize] = desc_c2d;
	dev.idx = (dev.idx + 1) % VIRTIO_RING_SIZE as u16;
	(*dev.queue).desc[dev.idx as usize] = desc_c2d_resp;
	dev.idx = (dev.idx + 1) % VIRTIO_RING_SIZE as u16;
	(*dev.queue).avail.ring[(*dev.queue).avail.idx as usize % VIRTIO_RING_SIZE] = head;
	(*dev.queue).avail.idx = (*dev.queue).avail.idx.wrapping_add(1);
}</pre>



<p>All we’re really telling the GPU here is our resolution and the format of the framebuffer. When we create this, the host gets to configure itself, such as allocating an identical buffer to make transfers from our OS.</p>



<h4>Step 2: Attach framebuffer backing.</h4>



<pre data-enlighter-language="rust" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">let rq = Request3::new(AttachBacking {
	hdr: CtrlHeader {
		ctrl_type: CtrlType::CmdResourceAttachBacking,
		flags: 0,
		fence_id: 0,
		ctx_id: 0,
		padding: 0,
	},
	resource_id: 1,
	nr_entries: 1,
},
MemEntry {
	addr: dev.framebuffer as u64,
	length: dev.width * dev.height * size_of::&lt;Pixel&gt;() as u32,
	…</pre></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://blog.stephenmarz.com/2020/07/24/risc-v-os-using-rust-graphics/">https://blog.stephenmarz.com/2020/07/24/risc-v-os-using-rust-graphics/</a></em></p>]]>
            </description>
            <link>https://blog.stephenmarz.com/2020/07/24/risc-v-os-using-rust-graphics/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24041869</guid>
            <pubDate>Mon, 03 Aug 2020 18:58:01 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[A gentle intro to assembly with Rust]]>
            </title>
            <description>
<![CDATA[
Score 134 | Comments 16 (<a href="https://news.ycombinator.com/item?id=24041675">thread link</a>) | @lfn3
<br/>
August 3, 2020 | https://lfn3.net/2020/08/03/a-gentle-intro-to-assembly-with-rust/ | <a href="https://web.archive.org/web/*/https://lfn3.net/2020/08/03/a-gentle-intro-to-assembly-with-rust/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>


<div>
  
  <p><span>Aug 3 2020</span></p><p>One of the things I’ve wanted to do for a while is really dig into
assembly and get into the weeds of how programs actually run.
A rework of the <code>asm</code> macro has <a href="https://blog.rust-lang.org/inside-rust/2020/06/08/new-inline-asm.html">recently landed</a> in nightly rust
so it seemed like a good time.</p>

<p>And compared to some other ways I’ve tried to approach this there’s a lot less
setup we need to do if we just use the <a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018">rust playground</a> to
do all the heavy lifting.</p>

<p>My process for figuring things out has been pretty simple.
I write a tiny bit of rust code, look at the assembly output
and try to figure out what’s going on (with lots of googling).
I’m going to walk you through what I did, and what I figured
out.</p>

<p>Let’s start with the simplest possible thing I can think of:</p>

<pre><code>fn main() {
    1 + 2;
}
</code></pre>

<p><a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=9500bb2bc3f638a4dd89e81fecafac0e">playground link</a></p>

<p>You can get the assembly output for this by clicking the three dots next to
<code>run</code> and selecting <code>asm</code> from the dropdown. You will probably also want
to change the flavour (often referred to as syntax elsewhere) of assembly to intel (rather than at&amp;t) <sup id="fnref:1"><a href="#fn:1">1</a></sup>
if it isn’t already, by clicking the toggle under the <code>config</code> menu.</p>

<p>The assembly output from this in debug mode is far more massive than you’d expect -
I get 157 lines. And most of it isn’t our program. The code we’ve written should
be fairly easy to find though, as the compiler helpfully labels all of the functions
with their crate and function names. In this case since we’re in the playground,
the create is implicitly <code>playground</code>, so we can find our code by searching with
<code>ctrl-f</code> for <code>playground::main</code>. Doing this gets me to:</p>

<pre><code>playground::main: # @playground::main
# %bb.0:
    ret
                                        # -- End function
</code></pre>

<p>So even though this is a debug build, evidently there’s still some optimization going on,
since there’s no numbers or anything that looks like it’s adding them together.
All that’s happening here is we’re returning (<code>ret</code>) back to the function that called <code>playground::main</code>.
Everything prefixed with <code>#</code> is a comment, and therefore ignored when we run this code.</p>

<p>The only other point of interest is the label <code>playground::main:</code> - anything suffixed with <code>:</code>
is a label we can jump to with various commands, and indeed if we continue searching for <code>playground::main</code>
we can find a rather indirected call to it in <code>main</code>. Hopefully by the end of this we’ll be understand that!</p>

<h3 id="avoiding-optimizations">Avoiding optimizations</h3>

<p>For now, let’s try and evade whatever’s doing the optimization:</p>

<pre><code>fn add() -&gt; usize {
    1 + 2
}

fn main() {
    add();
}
</code></pre>

<p><a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=e06e9c1a6771d850be5e06abc6f70243">playground link</a></p>

<p>Again, searching for <code>playground::main</code> get us to:</p>

<pre><code>playground::add: # @playground::add
# %bb.0:
    mov eax, 3
    ret
                                        # -- End function

playground::main: # @playground::main
# %bb.0:
    push    rax
    call    playground::add
# %bb.1:
    pop rax
    ret
                                        # -- End function
</code></pre>

<p>So we’ve got a bit more progress here. Still some optimization going on, since we don’t see 1 or 2 in the code,
just 3. We can see that being moved (<code>mov</code>) into the <code>eax</code> register in <code>playground::add</code>.
This must be how we’re returning the value back up to <code>main</code>.</p>

<p>And indeed, inside <code>main</code> we can see <code>push rax</code> - saving the value in the register <code>rax</code> to the stack, then a
call to our <code>add</code> function, then we <code>pop rax</code> off the stack. The <code>push call pop</code> sequence is to preserve
whatever values are in the registers used in <code>add</code>. It also just throws away the value we saved in <code>eax</code> in <code>add</code>,
because <code>eax</code> and <code>rax</code> are the same register. The table <a href="https://en.wikibooks.org/wiki/X86_Assembly/X86_Architecture#General-Purpose_Registers_(GPR)_-_16-bit_naming_conventions">here</a>
shows how ‘skinnier’ registers overlap with their ‘wider’ counterparts.</p>

<h3 id="avoiding-optimizations-take-2">Avoiding optimizations, take 2</h3>

<p>So how can we make this actually do some math? Let’s try again:</p>

<pre><code>fn add(i: usize) -&gt; usize {
    1 + i
}

fn main() {
    add(2);
}
</code></pre>

<p><a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=0d821a33f2375ecaf3671c825a415c83">playground link</a></p>

<p>So we’ve got a lot more going on this time:</p>

<pre><code>playground::add: # @playground::add
# %bb.0:
    sub rsp, 24
    mov qword ptr [rsp + 16], rdi
    add rdi, 1
    setb al
    test al, 1
    mov qword ptr [rsp + 8], rdi # 8-byte Spill
    jne .LBB8_2
# %bb.1:
    mov rax, qword ptr [rsp + 8] # 8-byte Reload
    add rsp, 24
    ret

.LBB8_2:
    lea rdi, [rip + str.0]
    lea rdx, [rip + .L__unnamed_2]
    mov rax, qword ptr [rip + core::panicking::panic@GOTPCREL]
    mov esi, 28
    call rax
    ud2
                                        # -- End function

playground::main: # @playground::main
# %bb.0:
    push rax
    mov edi, 2
    call playground::add
# %bb.1:
    pop rax
    ret
                                        # -- End function
</code></pre>

<p>The thing we were actually trying to produce is finally in there!
We can see <code>add rdi, 1</code> in the output, surrounded by a pile of other
stuff. So what is all this other code?</p>

<p>Let’s start from the top of the call stack in <code>main</code>.
First we can see <code>2</code> is stored in the <code>edi</code> register
before we call <code>playground::add</code>, so we know our argument must be in
the <code>edi</code> register. Again, we can see the <code>push</code>, <code>pop</code> on <code>rax</code>, so that
must be the return value.</p>

<h3 id="looking-inside-the-function">Looking inside the function</h3>

<p>Now, looking into <code>playground::add</code> we first see <code>sub rsp, 24</code>. <code>rsp</code> is
the register that holds the stack pointer, so this is growing the stack
(since the stack grows downwards in x86<sup id="fnref:2"><a href="#fn:2">2</a></sup>). Further down we can see
we shrink the stack by the corresponding amount with <code>add rsp, 24</code>.</p>

<p>Then we have <code>mov qword ptr [rsp + 16], rdi</code>. This is copying the
value from <code>rdi</code> onto the stack at <code>rsp + 16</code> - the top of the region we just grew the stack by.
The <code>qword ptr</code> (quadword (i.e. 64bit) pointer) bit is a hint to disambiguate the argument.
Why is that pushed that onto the stack? I <em>think</em> this is just to make it easier to debug,
since we don’t ever access that value again.</p>

<p>In any case, we then proceed on to actually adding 1 to <code>rdi</code>.
The value is stored back in <code>rdi</code>, and importantly for what comes next,
we may set some of the <a href="https://en.wikibooks.org/wiki/X86_Assembly/X86_Architecture#EFLAGS_Register">flags</a>.</p>

<p>Then it gets complicated again - we’ve got <code>setb al</code>. All of the <code>set*</code>
<a href="https://github.com/HJLebbink/asm-dude/wiki/SETcc">instructions</a>
deal with the flag register. The flag register is possibly the most magical
of registers, since it’s manipulated by a bunch of instructions as a side effect.</p>

<p>The last instruction we ran was <code>add</code>, which sets 6 of the the flags:
<a href="https://en.wikipedia.org/wiki/Carry_flag">carry</a>, <a href="https://en.wikipedia.org/wiki/Parity_flag">parity</a>,
<a href="https://en.wikipedia.org/wiki/Adjust_flag">adjust (aka auxiliary carry)</a>, <a href="https://en.wikipedia.org/wiki/Zero_flag">zero</a>,
<a href="https://en.wikipedia.org/wiki/Sign_flag">sign</a> and <a href="https://en.wikipedia.org/wiki/Overflow_flag">overflow</a></p>

<p>In this case we’re checking if the carry bit is set, and then setting the <code>al</code>
register to 1 if that’s the case. What is this actually doing though?
The carry bit gets set to 1 if there is a <code>carry</code> from the two numbers we add,
meaning the resulting number is too big to be stored in the register.
What should we do in that case? Let’s read on to find out.</p>

<p>Then in the next line (<code>test al, 1</code>) we’re checking if the value in <code>al</code> is equal to one.
(<code>test</code> does a a bitwise and operation on the two arguments - like <code>&amp;</code> in rust.)
This sets some more flags, notably the <code>zero</code> flag, which is then read by the following <code>jne</code> instruction.</p>

<p><code>jne</code> stands for jump if not equal (and again there’s a series of
<a href="https://en.wikibooks.org/wiki/X86_Assembly/Control_Flow#Jump_Instructions">other</a>
<code>j*</code> instructions). Since it uses flags, it just takes a single argument: where to jump to.</p>

<p>Looking at where that jumps to gives us a big hint about the intent of the
logic above: <code>core::panicking::panic@GOTPCREL</code> really gives it away.
Basically all of this chunk of assembly from <code>setb</code> to <code>jne</code> is checking if we’ve overflowed
the register and panicking if we have.</p>

<p>The one bit we didn’t discuss is <code>mov qword ptr [rsp + 8], rdi # 8-byte Spill</code>.
As the comment implies this is “spilling” the value from the <code>rdi</code> register
onto the stack, since the code we’re possibly about to jump to might
overwrite that register - immediately after the <code>jne</code> we load the value back off
the stack.</p>

<p>Finally we shuffle the stack pointer back to it’s starting point, and <code>ret</code>
back to the caller. <code>ret</code> uses the last value on the stack (which is pushed by <code>call</code>)
to figure out where to jump back to, so moving the stack pointer back is <em>very</em> important.</p>

<p>So maybe at this point we’ve seen enough to take a stab at replacing the guts of the <code>add</code>
function with the <code>asm!</code> macro. Since we’re interested in performance,
we’ll ignore those pesky overflow checks, and just assume that we’re within the bounds of <code>u64</code>.</p>

<p>The biggest new thing we’ll have to deal with here is specifying the <code>in</code> and <code>out</code> registers.
The <a href="https://github.com/Amanieu/rfcs/blob/inline-asm/text/0000-inline-asm.md#guide-level-explanation">rfc</a>
has a very approachable explaination of these, so I’d recommend reading that.
There’s a skeleton you can start with <a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=d511cf5e95ba5cdfbcffaebaf5f72300">here</a>,
if you want to have a go yourself.</p>

<p>The version I’ve cooked up looks like <a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=669b4155a1d818cc5c73b117b9454d48">this</a>.
This is probably the “fanciest” possible version of this, since we’re using as many features of the asm macro as possible:</p>

<ul>
<li>we’re letting the rust compiler pick the register we use, and then writing it in using the
<a href="https://github.com/Amanieu/rfcs/blob/inline-asm/text/0000-inline-asm.md#inputs-and-outputs"><code>format</code> string behaviour</a> of the <code>asm</code> macro.</li>
<li>we’re also using <a href="https://github.com/Amanieu/rfcs/blob/inline-asm/text/0000-inline-asm.md#late-output-operands"><code>inlateout</code></a> to
hint that we can just use a single register.</li>
</ul>

<p>This seems like a reasonable point at which to break. We’ve covered a reasonable chunk of the instruction set in x64 assembly,
and seen examples of most of the classes of instructions. There’s tons more we can explore, like:</p>

<ul>
<li>How do loops work?</li>
<li>What happens when we use values that don’t just fit in registers?</li>
<li>How do we make a syscall?</li>
</ul>

<p>Hopefully the resources I’ve linked to from here are sufficent for you to continue digging in if you want,
and maybe I’ll manage to follow this up.</p>

</div>

      </div></div>]]>
            </description>
            <link>https://lfn3.net/2020/08/03/a-gentle-intro-to-assembly-with-rust/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24041675</guid>
            <pubDate>Mon, 03 Aug 2020 18:44:19 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Art of Not Thinking]]>
            </title>
            <description>
<![CDATA[
Score 511 | Comments 152 (<a href="https://news.ycombinator.com/item?id=24039887">thread link</a>) | @tmatthe
<br/>
August 3, 2020 | http://tiffanymatthe.com/not-thinking | <a href="https://web.archive.org/web/*/http://tiffanymatthe.com/not-thinking">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="skip-nav"><p><time>03.08.2020</time> — <a href="http://tiffanymatthe.com/tags/productivity">Productivity</a> — <span>5<!-- --> min read</span></p><section><img src="http://tiffanymatthe.com/static/d758a9afd33cefb9ce3dc7bb83cc213d/a6c62/not-thinking.jpg"><p><em>After years of feeling guilty about not wanting to do everything, I realized I don't need motivation to get things done. Below, I describe how I use the concept of not thinking instead.</em></p><hr><p>It took me five years to get in the habit of exercising. I just didn't want to do it. I followed Youtube workouts, hopeful that the energetic trainer on the screen would help me get fitter. I swam laps in my pool. I followed my brother on 3K runs. And afterwards, I felt great! On top of the world. And then the next day came, and I remembered I had to do it all over again. I had to be sweaty, push through the pain, and breathe like I had an asthma attack.</p><p>So every morning, I woke up and inevitably started dreading my exercise. It would slink around in my thoughts, casting a dark mood until I got it done. At one point, I would dread exercising enough to stop, and a wave of relief would wash over me. This feeling of calm usually lasted a few months, and then my disappointment in my poor levels of fitness would take over. And the cycle would restart.</p><p><strong>Everyone has things they don't want to do.</strong> It's not limited to exercising. It can be anything from studying everyday for the entire school year to vacuuming the floor. Unless you can avoid that activity with no guilt or regrets, you usually have to do it. You know it will help in the long run, to study to prepare for finals and to have clean floors, but even with that in mind, it can still be incredibly hard to do those activities.</p><p>I realized that the hardest part of doing things I don't want to do is usually not the activity itself, but getting started. Once I get started, I get into a flow and rationalize that since I'm already doing it, I might as well finish.</p><h3>How much motivation do we need?</h3><p>I like to describe the amount of energy I need for a task I don't want to do as an exothermic reaction. In this reaction, the reactants (me) need a minimum activation energy (motivation) for the reaction (task) to occur. After the reaction is complete, the products then settle down into a lower energy state (since no more energy is needed to do the task or worry about it).</p><p><span>
      <span></span>
  <img alt="Motivation Energy Reaction" title="Motivation Energy Reaction" src="http://tiffanymatthe.com/static/45c003a7d8906347afa290a5d3bc064d/18e3b/exothermic.jpg" srcset="http://tiffanymatthe.com/static/45c003a7d8906347afa290a5d3bc064d/46946/exothermic.jpg 240w,http://tiffanymatthe.com/static/45c003a7d8906347afa290a5d3bc064d/55489/exothermic.jpg 480w,http://tiffanymatthe.com/static/45c003a7d8906347afa290a5d3bc064d/18e3b/exothermic.jpg 960w,http://tiffanymatthe.com/static/45c003a7d8906347afa290a5d3bc064d/60e21/exothermic.jpg 1440w,http://tiffanymatthe.com/static/45c003a7d8906347afa290a5d3bc064d/69b48/exothermic.jpg 1920w,http://tiffanymatthe.com/static/45c003a7d8906347afa290a5d3bc064d/e1761/exothermic.jpg 3273w" sizes="(max-width: 960px) 100vw, 960px" loading="lazy">
    </span></p><p>So how can we get this minimum activation energy? Well, if we don't want to do the activity, it is nearly impossible to gain enough motivation to do it. The good news is that we can avoid the need for such a high activation energy.</p><p>How is this possible? A simple answer: <strong>don't try to find motivation</strong>.</p><p>When you look for motivation, you usually start by reminding yourself about the advantages of getting the task done. But your brain is a stubborn toddler. If you strongly drag it towards one direction, it will fiercely pull you to the other side. The brain thinks there's a choice, and thus a possibility to argue. It will start pointing out all the disadvantages and instant gratification alternatives.</p><p>Since humans instinctively reach for easier things, now you have not only dredged up all the negative points about your task, but also discovered easier alternatives that require an additional amount of energy to resist. In short, you have increased the minimum activation energy required to start the task.</p><p>You will also remember this awful internal debate, and associate these negative feelings with the task itself. Naturally, this does not bode well in the long run.</p><p>On the other hand, if you don't think about the task, you can avoid the entire process of arguing with yourself and making decisions that you will feel guilty about. Instead, just do it. <strong>Become a mindless robot</strong> and don't think twice<sup id="fnref-1"><a href="#fn-1">1</a></sup>.</p><p>This is, of course, easy to say and a bit more difficult to do. It's hard to think about not thinking, because you'll inadvertently wonder what it is you were trying to not think about, and bam, you've failed. Not thinking is a process, and just like any other skill you learn, it improves with time and practice. Here are a few tips.</p><h3>Make the decision in advance</h3><p>If you are temporally removed from the thing you don't want to do, it's easier to make a rational decision. By making the decision beforehand, you remove the effort needed to choose before doing your task. This reduces friction and removes one factor that could have led you to think about your task when you start it.</p><p>There are a few ways of making decisions in advance. There's the two-minute rule, where you decide that for anything that takes less than two minutes, you do it. No thinking, no arguing, just swift action. For example, you see a pile of clothes on your bed. It takes less than two minutes to organize then in your drawer, so you do it. Here, you just avoided the trap of thinking about your clothes, feeling unmotivated to put them in order, and giving yourself the terrible alternative of doing it later.</p><p>Another method is planning out your days in advance. This does not always work, but it's a good idea to try it out. The night before, you plan out all of your activities to the minute. And, of course, as you're temporally distanced from these activities, you make rational decisions. Then when the morning comes, you can mindlessly follow the schedule you have made for yourself.</p><h3>Do a small part first</h3><p>Quickly pick a random small part of the activity you were dreading. And commit to only doing that one part. This helps you avoid overthinking by giving your brain a smaller task to easily execute<sup id="fnref-2"><a href="#fn-2">2</a></sup>.</p><p>For example, if you need to complete a scholarship application and hate writing about yourself, tell yourself to just write bullet points of topics you might include in the application. Most of the time, after you have invested those first five minutes into the activity, you enter a flow and continue working.</p><p>After implementing these strategies, where I tell myself that I have to exercise every other day for a mere 5 minutes, I now consistently exercise for at least 15 minutes without overthinking it.</p><p>So next time you find yourself not wanting to do something, make yourself a clear rule of when to do it and do the easiest part first. That way, you can avoid making too many decisions and associating the internal turmoil that stems from that process to the activity itself.</p><p>Note, not thinking works wonderfully if your sole purpose is doing an activity you don't want to do. However, unless you don't have any goals to pursue, this is not the best way to go about everything in life. Make sure to take the time to reflect on the overall purpose of the activity and if it brings you closer to where you want to be. If the answer is yes, then feel free to become a mindless robot for any activities that have passed the reflection stage.</p><p>At the small risk of being sued by Nike, just do it.</p></section></div></div>]]>
            </description>
            <link>http://tiffanymatthe.com/not-thinking</link>
            <guid isPermaLink="false">hacker-news-small-sites-24039887</guid>
            <pubDate>Mon, 03 Aug 2020 16:34:06 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[An Email got us $5k in AWS Credits]]>
            </title>
            <description>
<![CDATA[
Score 101 | Comments 59 (<a href="https://news.ycombinator.com/item?id=24037963">thread link</a>) | @CoreSet
<br/>
August 3, 2020 | https://formcake.com/blog/how-an-email-got-us-five-thousand-aws-credits | <a href="https://web.archive.org/web/*/https://formcake.com/blog/how-an-email-got-us-five-thousand-aws-credits">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><p>We recently went through the <a href="https://stripe.com/atlas">Stripe Atlas</a> program and <a href="https://formcake.com/blog/our-experience-with-stripe-atlas">loved it</a>.</p>
<p>But the one sour note was that we only got $1,000 AWS credits when <a href="https://formcake.com/blog/stripe-atlas-includes-five-thousand-credits-this-is-what-we-got">the copy seemed to promise $5,000</a>. Our <a href="https://formcake.com/blog/why-we-chose-a-marketing-and-app-monorepo">entire application infrastructure is on AWS</a> so those credits are pretty much straight-up cash to us. We don't have much of a digital footprint either, so $5,000 goes a long way.</p>
<p>That's why this weekend was such a surprise.</p>
<h3 id="the-email">The Email</h3>
<p>Here's how the timeline went.</p>
<ol>
<li><p>First <a href="https://formcake.com/blog/stripe-atlas-includes-five-thousand-credits-this-is-what-we-got">we posted an article</a> politely noticing that we hadn't been able to secure the full $5,000 and kinda wondering out loud why.</p>
</li>
<li><p><a href="https://formcake.com/blog/the-founders-guide-to-stripe-atlas">Stripe contacted us</a> and explained that the credit amount was more of a lifetime cap and that it was ultimately up to AWS what we got.</p>
</li>
<li><p>We send <em>one more</em> email just 'cause, even though it seems clear AWS only offers $1,000 for bootstrapped startups. The email is simple and amounts to: "Is there any way we could get the full five thousand in credits?"</p>
</li>
</ol>
<p>Stripe responds to this chain of events with yet another email, this one even kinder and more politely worded.</p>
<section>
Hey David,

<p>Thank you for sharing the details here. It sounds like we should be able to get this sorted out so that you receive the $5K in AWS credits for Stripe Atlas users.  </p>
<p>I believe it may be the case that you applied for AWS credits with a different link than the one shared for Stripe Atlas users to activate. We do not typically see users needing to answer the question regarding funding sources. I did check in with AWS on this and it sounds like they're currently processing your most recent application that you submitted through the Stripe Atlas link. They've let me know that they will email you directly with next steps, which may take up to 4 weeks. </p>
<p>Hopefully this will all soon be sorted! If you do have any questions on this or anything else, please feel free to reach out! I'll check back in a couple weeks on the AWS front, or feel free to share any updates as well!</p>
<p>Warm regards,
Taylor</p>
</section> 

<p>It looks like the funded/bootstrapped question indicated the process had gotten miffed somewhere and <em>Stripe reached out to AWS on our behalf</em> to make sure things got cleared up.</p>
<p>This weekend we saw $5,000 in credits enter our AWS account. Keep in mind that's actually <strong>in addition</strong> to the $1,000 we've already received, bringing out total up to $6,000 in AWS credits through the Stripe Atlas program.</p>
<p>For us this is a big injection. It basically funds our full application operations and lets us play around with putting money elsewhere - or just continuing to build features and mature without any kind of pressure.</p>
<h3 id="conclusion">Conclusion</h3>
<p>A couple of takeaways from the entire affair.</p>
<h4 id="1-send-that-one-last-email">1. Send that one last email</h4>
<p>Even if it seems like a bit much, or things are settled, just be sure you ask and give the other person a chance to help you in ways you can't predict. A hail mary "Is there anything I'm missing?" can sometimes land.</p>
<h4 id="2-stripe-is-truly-wonderful">2. Stripe is truly wonderful</h4>
<p>Stripe monitored the developer community enough to see our initial posts, proactively reached out to us, and then worked with AWS to ultimately get us a greater-than-even-promised payout. When people say Stripe is a company for developers, they often mean its great API or clear documentation, but this is I think one of the greatest testaments to their dev-first culture.</p>
</div></div>]]>
            </description>
            <link>https://formcake.com/blog/how-an-email-got-us-five-thousand-aws-credits</link>
            <guid isPermaLink="false">hacker-news-small-sites-24037963</guid>
            <pubDate>Mon, 03 Aug 2020 14:10:13 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Show HN: Add video subtitles on the fly from plain text]]>
            </title>
            <description>
<![CDATA[
Score 52 | Comments 16 (<a href="https://news.ycombinator.com/item?id=24037288">thread link</a>) | @011-video
<br/>
August 3, 2020 | https://011.video/2020/08/03/burn-video-subtitles-on-the-fly-from-a-plain-text-file/ | <a href="https://web.archive.org/web/*/https://011.video/2020/08/03/burn-video-subtitles-on-the-fly-from-a-plain-text-file/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article id="post-2182">
	
	

	

	<div>
		<p><iframe title="How to Burn video subtitles on the fly from a plain text file" width="576" height="324" src="https://www.youtube.com/embed/voruErQe4JA?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p>
<p><em><strong>How to add permanent subtitles into video without using SRT file ?</strong></em></p>
<ol>
<li>
<h6>If you opt for a big font size make sure&nbsp; to choose a larger screen&nbsp; <img src="https://011.video/wp-content/uploads/2020/01/pixel.png" alt="">&nbsp; to display the whole phrase every time you turn the mouse wheel</h6>
</li>
<li>
<h6>Upload a video&nbsp; <img src="https://011.video/images/uploadV2.png" alt="">&nbsp; from your device</h6>
</li>
<li>
<h6>Copy subtitles from any text editor.</h6>
</li>
<li><span><em>Notice that to be processed as subtitles the text must start with&nbsp; a star&nbsp; ‘&nbsp; *&nbsp; ‘&nbsp; and each phrase must end with a punctuation character&nbsp; &nbsp;:&nbsp; &nbsp;‘&nbsp; !&nbsp; ‘&nbsp; &nbsp;or&nbsp; &nbsp;‘ ?&nbsp; ‘&nbsp; or&nbsp; ‘&nbsp; . ‘</em></span></li>
<li>
<h6>Double click inside the canvas. As you can only move the subtitles vertically make sure to click on the left far if your text got long phrases</h6>
</li>
<li>
<h6>paste the subtitles text&nbsp; <img src="https://011.video/images/text.gif"> inside the input text field</h6>
</li>
<li>
<h6>Change the text color&nbsp; <img src="https://011.video/wp-content/uploads/2019/10/color.png" alt="" width="207" height="22"></h6>
</li>
<li>
<h6>Click few times on&nbsp; <img src="https://011.video/wp-content/uploads/2019/09/effet.png" alt="" width="35" height="35">&nbsp; to make the text size bigger.</h6>
</li>
<li>
<h6>Start to record&nbsp; <img src="https://011.video/images/on2.png" alt="">&nbsp; &nbsp; your video</h6>
</li>
<li>
<h6>As soon as the video begin turn the mouse wheel&nbsp; <img src="https://011.video/images/mouse.png"> &nbsp;before the speech start and you should see the message “Ready to display… Turn wheel again “</h6>
</li>
<li>
<h6>Turn the mouse wheel and you should see&nbsp; “let’s Add subtitles” message displayed.</h6>
</li>
<li>
<h6>Continue to turn the mouse wheel to display each phrase on the fly, one by one.</h6>
</li>
<li>
<h6>To make the subtitles easier to read try to move the cursor vertically close to the video character who speak</h6>
</li>
<li>
<h6>When the speech is over pause&nbsp; <img src="https://011.video/images/pause.png" alt=""> and download <img src="https://011.video/images/d2.png" alt=""> your video</h6>
</li>
</ol>
<p><em>Here is a “French video clip song subtitled with English lyrics translation”</em></p>
<p><iframe title="French video clip song subtitled with English lyrics translation" width="576" height="324" src="https://www.youtube.com/embed/hDV0GrTlYSA?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p>
<!-- Rate my Post Plugin -->			</div><!-- .entry-content -->
</article></div>]]>
            </description>
            <link>https://011.video/2020/08/03/burn-video-subtitles-on-the-fly-from-a-plain-text-file/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24037288</guid>
            <pubDate>Mon, 03 Aug 2020 13:11:01 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Dan Ariely and Irrational Comparison]]>
            </title>
            <description>
<![CDATA[
Score 91 | Comments 40 (<a href="https://news.ycombinator.com/item?id=24036403">thread link</a>) | @brendancahill
<br/>
August 3, 2020 | https://brendancahill.io/brensblog/danariely | <a href="https://web.archive.org/web/*/https://brendancahill.io/brensblog/danariely">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div data-block-type="2" id="block-124866fbd20ff6e682de"><div><h4>Who is Dan Ariely?</h4><p>Dan Ariely is a Professor of Psychology and Behavioral Economics at Duke University whose writing merges psychology with economics. His book <a href="https://amzn.to/33pw3lh"><em>Predictably Irrational</em></a> explores why most of the smart decisions we think we make are actually quite irrational. Modern economics is based on the theory that the average person makes logical decisions. Ariely happily points out how wrong that notion is. </p><h4>Why Now?</h4><p>Comparison has always fascinated me. I grew up in Airmont, NY two minutes over the state line with Upper Saddle River, NJ. Since I didn’t like paying .50 more cents for gas, nor pumping it, I always got gas in NJ. Upper Saddle River is one of the wealthiest towns not only in America, but on the planet. The second you crossed the NY/NJ line it was like you were transported into an alternate reality where the worst car anyone drove was a BMW, every home a mansion and even the air smelled better (just kidding but I did wonder, if any town had the money to endlessly pump fabreeze into the air, they did). </p><p>When I crossed the NY/NJ state line back to my neighborhood of 3 bedroom raised ranches I felt poor by comparison. Then as a US Peace Corps Volunteer living in Ukraine in an ex-Soviet country, ridden with corruption, and the average salary being less than $100/mo I suddenly felt rich. Ukrainians were shocked that we owned two cars. That we had roads that worked. And that everyone was rich <em>to them. </em></p><h4>Why Comparison?</h4></div></div><div data-block-type="2" id="block-yui_3_17_2_1_1596450590223_8104"><div><p>Ariely uses this illustration to make his point about comparison. Which orange circle <em>appears</em> bigger? You’d likely say the one on the right, at least at first. But, both circles are the same size. The only thing that’s changed is what you’re comparing them to. Comparison depends on context. </p><blockquote><p>“…we are always looking at the things around us in relation to others…We always compare jobs with jobs, vacations with vacations, lovers with lovers and wines with wines.”</p></blockquote><p>Comparison is a survival skill that’s served us well our first 50 million years as a species: You need to know your status in the tribe compared to others’ to ensure your own safety. You need to compare how deadly a particular tiger looks compared to other live tigers you’ve seen in wild to assess your threat level. You need to compare how someone looks to other angry people you’ve seen to avoid a bar fight. You need to compare a date to other people you’ve dated in the past to evaluate how they might be as a future spouse for you. You need to know how to compare how fast your car is going relative to all the other cars on the street to stay within the speed limit. </p><p><strong>Comparison does hijack our rationality, however. </strong></p><h4>The Economist</h4><p>Ariely was trying to figure out what decision people made when given these three options for a subscription to <em>The Economist</em>: </p><ul data-rte-list="default"><li><p>59/yr online only</p></li><li><p>125/yr print only</p></li><li><p>125/yr print and online together</p></li></ul><p>Out of 100 people here is how many chose which options:</p><ul data-rte-list="default"><li><p>59/yr online only (16)</p></li><li><p>125/yr print only (0)</p></li><li><p>125/yr print and online together (84)</p></li></ul><p>But, when Ariely removed the print only option, here is what people chose:</p><ul data-rte-list="default"><li><p>59/yr online only (68)</p></li><li><p>125/yr print and online together (32)</p></li></ul><p><em>As a business, you want to nudge as many people to the high-end of your sales as possible. So why were people opting for the online only? </em></p><p>It turns out it is easier to compare things that are alike than are not alike. By presenting people with not one but <em>two</em> print options, you’ve now made it easier for them to compare two options that you, as a business, want them to focus on. The mind has now written-off the online only option because that is the hardest option to compare to the other two. </p><p>Inside the mind of your potential customer is now a simple question: What’s better? Print only or print AND an online subscription? Everyone in the first experiment opted for the “print + online” because isn’t print plus a little something extra better? </p><p><strong>We Can’t Make Decisions In A Vacuum</strong></p><p>The second case study Ariely looks at is <a href="https://journals.sagepub.com/doi/pdf/10.2307/41166755">Williams-Sonoma’s inability to sell a $275.00 bread baker</a>. Their marketing team finally figured out that if they created a second, bigger and even more expensive bread baker placed <em>next to</em> the $275.00 dollar one, their sales would take off. And they did. </p><blockquote><p>“…people didn’t have to make their decision in a vacuum. They could say: “Well, I don’t know much about bread makers, but I do know that if I were to buy one, I’d rather have the smaller one for less money.”</p></blockquote><p>Ariely then goes on to joke that if you want to have better luck socially finding someone to date you, you should find a decoy friend of similar physical characteristics but who is slightly less attractive than you. Although the morality of this is questionable. </p><p>If you are a business, the takeaway is simple: to make more profit, create a favorable context for the product you want your customer to buy. Create an ultra-premium ridiculously high-priced product that when placed next to the product you really want to sell, makes its price not seem so bad. </p><p>Tesla knows not everyone is paying $100K + for their Cyber Truck, but they do know that by having their ridiculous premium products, it makes the $60K price tag for their “lower models” not seem so crazy. </p><p><strong>Place vs. Person</strong></p><p>I have some of the best friendships I’ve had from my former football teammates. We go through experiences, games, high and lows like few others friend groups might. But would we all have been friends were it not for football? How about military veterans who are bonded together in combat - were it not for that experience, would they have chosen to be friends? </p><p>Ariely uses the example of meeting a fellow American in a foreign place and finding an uncanny connection in an airport. He met one fellow American overseas:</p><blockquote><p>…as cultural outsiders we were each other’s best alternative for companionships. But once we returned home to our beloved American families and friends, thebasis for comparison switched back to “normal” mode. </p></blockquote><p>Would that foreign exchange student you dates in high school have been as “cool” or “exotic” had they been from Germantown, PA instead of Germany? Was that experience teaching overseas in Peace Corps really <em>that</em> cool or am I just assigning extra romanticism to it because I was an “outsider” in a foreign land?</p><h4>Takeaways</h4><p>We’re very smart, but we’re also very irrational as people. We’d like to think logic and rationality governs most of our lives but Ariely has a knack for showing us just how reliant we are upon split second and irrational comparisons to the available yet limited information we have around us. </p><p>Morally speaking, as a business owner or person you have a duty to make decisions now with this comparison fallability in mind. While yes, you can structure your products in a way to extract <em>more</em> profit than normal from your customers, you need to do this only when you truly feel like that high-end product you’re directing them to is actually giving them more value. </p><p>Personally, don’t find the most repulsive personality to take out on a double date hoping that it makes you look good. This might even back fire since your double date might end up <em>comparing you</em> to the company you hang out with and irrationally judge you just as repulsive. </p><p>Comparison is a force of nature that can’t always be controlled, but it can be guided. Ariely shows us how. </p><p>Bren</p><p>P.S. Here is a fun video by Dan at a Ted Talk</p></div></div></div>]]>
            </description>
            <link>https://brendancahill.io/brensblog/danariely</link>
            <guid isPermaLink="false">hacker-news-small-sites-24036403</guid>
            <pubDate>Mon, 03 Aug 2020 11:29:33 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[PostgreSQL beginner guide]]>
            </title>
            <description>
<![CDATA[
Score 236 | Comments 65 (<a href="https://news.ycombinator.com/item?id=24036132">thread link</a>) | @lukasbar
<br/>
August 3, 2020 | https://knowledgepill.it/posts/postgresql-basics-guide/ | <a href="https://web.archive.org/web/*/https://knowledgepill.it/posts/postgresql-basics-guide/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
  <h2 id="configure-remote-access---listen-address">Configure remote access - listen address</h2>
<p>By default after installation and creating database cluster PostgreSQL will listen only on localhost. No remote access will be allowed.</p>
<hr>
<p><a href="https://knowledgepill.it/posts/postgresql_installation/">PostgreSQL installation on Linux - with database creation</a></p>
<hr>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab ~<span>]</span>$ netstat -lptnu | grep post
<span>(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span>)</span>
tcp        <span>0</span>      <span>0</span> 127.0.0.1:5432          0.0.0.0:*               LISTEN      1977/postmaster     
tcp6       <span>0</span>      <span>0</span> ::1:5432                :::*                    LISTEN      1977/postmaster     
</code></pre></div><p>To change listen address we have to configure parameter in <code>postgresql.conf</code></p>
<p>Check <code>PGDATA</code> - after <code>-D</code> parameter:</p>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab ~<span>]</span>$ ps aux | grep postgres
postgres  <span>1977</span>  0.0  2.5 <span>286388</span> <span>14864</span> ?        Ss   Jun28   0:02 /usr/pgsql-12/bin/postmaster -D /postgresql/data
postgres  <span>1979</span>  0.0  0.2 <span>140768</span>  <span>1360</span> ?        Ss   Jun28   0:00 postgres: logger   
postgres  <span>1981</span>  0.0  0.5 <span>286504</span>  <span>3028</span> ?        Ss   Jun28   0:00 postgres: checkpointer   
postgres  <span>1982</span>  0.0  0.2 <span>286388</span>  <span>1696</span> ?        Ss   Jun28   0:03 postgres: background writer   
postgres  <span>1983</span>  0.0  0.9 <span>286388</span>  <span>5676</span> ?        Ss   Jun28   0:03 postgres: walwriter   
postgres  <span>1984</span>  0.0  0.4 <span>286924</span>  <span>2688</span> ?        Ss   Jun28   0:02 postgres: autovacuum launcher  
</code></pre></div><p>Locate the file:</p>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab ~<span>]</span>$ cd /postgresql/data/
<span>[</span>postgres@postgres-lab data<span>]</span>$ ls -lah postgresql.conf
-rw-------. <span>1</span> postgres postgres 26K Jun <span>28</span> 21:44 postgresql.conf
</code></pre></div><p>Change in <code>postgresql.conf</code> parameter <code>listen_addresses</code> to your server IP or <code>*</code> to listen on all IP’s available on server:</p>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab data<span>]</span>$ vi postgresql.conf

<span>##------------------------------------------------------------------------------</span>
<span>## CONNECTIONS AND AUTHENTICATION</span>
<span>##------------------------------------------------------------------------------</span>

<span>## - Connection Settings -</span>

listen_addresses <span>=</span> <span>'*'</span>          <span>## what IP address(es) to listen on;</span>
                                        <span>## comma-separated list of addresses;</span>
                                        <span>## defaults to 'localhost'; use '*' for all</span>
</code></pre></div><p>Restart PostgreSQL to apply changes - you can do that with <code>systemctl</code> from <code>root</code> os user  service or with <code>pg_ctl -D PGDATA restart</code> from <code>postgres</code> os user:</p>
<div><pre><code data-lang="bash"><span>[</span>root@postgres-lab ~<span>]</span><span>## systemctl restart postgresql-12.service</span>
</code></pre></div><p>Check whre PostgreSQL is listening now:</p>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab ~<span>]</span>$ netstat -lptnu | grep post
<span>(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span>)</span>
tcp        <span>0</span>      <span>0</span> 0.0.0.0:5432            0.0.0.0:*               LISTEN      30161/postmaster    
tcp6       <span>0</span>      <span>0</span> :::5432                 :::*                    LISTEN      30161/postmaster  
</code></pre></div><h2 id="configure-remote-access---pg_hbaconf">Configure remote access - pg_hba.conf</h2>
<p>PostgreSQL instance has got restricted access by <code>pg_hba.conf</code> file(host based authentication file).</p>
<p>We can provide in it information from which <code>ADDRESS</code> to which <code>DATABASE</code> on which <code>USER</code> by what <code>METHOD</code> we allow connecting. Additionaly we have to provide <code>TYPE</code> of connection.</p>
<p>This file resides in same place where <code>postgresql.conf</code>(we can alter this behavior by setting <code>pg_hba</code> parameter in <code>postgresql.conf</code>):</p>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab ~<span>]</span>$ cd /postgresql/data/

<span>[</span>postgres@postgres-lab data<span>]</span>$ vi pg_hba.conf
<span>## TYPE  DATABASE        USER            ADDRESS                 METHOD</span>

<span>## "local" is for Unix domain socket connections only</span>
local   all             all                                     trust
<span>## IPv4 local connections:</span>
host    all             all             127.0.0.1/32            trust
<span>## IPv6 local connections:</span>
host    all             all             ::1/128                 trust
</code></pre></div><p>Allowed <code>TYPE</code>'s:</p>
<ul>
<li><code>local</code> - socket connection - needed to connect from shell on database server</li>
<li><code>host</code> - standard TCP/IP connection over the network - bnost SSL and no SSL</li>
<li><code>hostssl</code> - TCP/IP connection but only with SSL</li>
<li><code>hostnossl</code> - TCP/IP only without SSL</li>
<li><code>hostgssenc</code> - TCP/IP only GSSAPI</li>
<li><code>hostnogssenc</code> - TCP/IP only without GSSAPI</li>
</ul>
<p>With <code>DATABASE</code> we can specify database name or use special value <code>sameuser</code> if database name should be same as name of user that is connecting.</p>
<p>With <code>USER</code> we can specify user or role - role name should be preceded by <code>+</code> sign.</p>
<p><code>ADDRESS</code> field could be - hostname, IP range in CIDR format or special words:</p>
<ul>
<li><code>samehost</code> - which correspond to all IP adresses of database server</li>
<li><code>samenet</code> - which correspond to all IP in database server subnet</li>
</ul>
<p>With <code>METHOD</code> field we can set one of authentication methods - most important ones are:</p>
<ul>
<li><code>trust</code> - allow connection without password - moslty set for local connections from database server itself</li>
<li><code>reject</code> - reject connections</li>
<li><code>md5</code> - allow connections after getting from user password - encrypted</li>
<li><code>password</code> - allow connection after getting plain password - DO NOT USE in untrusted networks - better -&gt; never use this option</li>
<li><code>ldap</code> - getting account authorization data from LDAP server</li>
</ul>
<p>In <code>DATABASE</code> and <code>USER</code> fields you can specify special word <code>all</code> if you don’t want to create any restrictions here.</p>
<p>There can be situation when we must use additional field named <code>auth-options</code> for specyfying details for example for <code>hostssl</code> connection type. This topic will be covered in another post.</p>
<h3 id="sample-pg_hba-record---allow-all-users-connect-to-any-db-from-all-ip-addresses---only-with-password">Sample pg_hba record - allow all users connect to any DB from all IP addresses - only with password</h3>
<p>Add in <code>pg_hba.conf</code>:</p>
<div><pre><code data-lang="bash"><span>## Network access</span>
host    all             all             0.0.0.0/0               md5
</code></pre></div><p>Reload(online operation) PostgreSQL that it can use <code>pg_hba.conf</code> changes:</p>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab data<span>]</span>$ /usr/pgsql-12/bin/pg_ctl -D /postgresql/data reload
server signaled
</code></pre></div><h2 id="connecting-to-postgresql">Connecting to PostgreSQL</h2>
<h3 id="local-from-server">Local from server</h3>
<p>It will work without password because we have <code>trust</code> in <code>pg_hba.conf</code> for <code>local</code> connections:</p>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab ~<span>]</span>$ psql
psql <span>(</span>12.3<span>)</span>
Type <span>"help"</span> <span>for</span> help.
</code></pre></div><h3 id="remote-machine">Remote machine</h3>
<p>Default URI syntax - you can connect like this:<br>
<code>psql postgresql://user:passwd@host:5432/dbame</code><br>
or by more common method:<br>
Connect to remote database from <code>psql</code> with connections details provided in parameters(it will ask for password because of <code>md5</code> method in <code>pg_hba.conf</code> for connections from <code>0.0.0.0/0</code>):</p>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab data<span>]</span>$ psql -h 10.128.0.2 -p <span>5432</span>
Password <span>for</span> user postgres:
psql <span>(</span>12.3<span>)</span>
Type <span>"help"</span> <span>for</span> help.

postgres<span>=</span><span>##</span>
</code></pre></div><p>We can also use parameter <code>-U</code> to specify username different than OS username we currently are using.</p>
<p>Also all this parameters can be taken from shell variables which names are self descriptive - if we set all of them we can just use plain <code>psql</code> command to connect:</p>
<ul>
<li><code>PGHOST</code></li>
<li><code>PGPORT</code></li>
<li><code>PGDATABASE</code></li>
<li><code>PGUSER</code></li>
<li><code>PGPASSWORD</code></li>
</ul>
<h3 id="check-connected-database">Check connected database</h3>
<div><pre><code data-lang="bash">postgres<span>=</span><span>## select current_database();</span>
 current_database
------------------
 postgres
<span>(</span><span>1</span> row<span>)</span>
</code></pre></div><h3 id="check-current-user">Check current user</h3>
<div><pre><code data-lang="bash">postgres<span>=</span><span>## select current_user;</span>
 current_user
--------------
 postgres
<span>(</span><span>1</span> row<span>)</span>
</code></pre></div><h3 id="check-ip-and-port-used-for-connection">Check IP and port used for connection</h3>
<div><pre><code data-lang="bash">postgres<span>=</span><span>## select inet_server_addr(), inet_server_port();</span>
 inet_server_addr | inet_server_port
------------------+------------------
 10.128.0.2       |             <span>5432</span>
<span>(</span><span>1</span> row<span>)</span>
</code></pre></div><h3 id="check-postgresql-version">Check PostgreSQL version</h3>
<div><pre><code data-lang="bash">postgres<span>=</span><span>## select version();</span>
                                                version                                                 
--------------------------------------------------------------------------------------------------------
 PostgreSQL 12.3 on x86_64-pc-linux-gnu, compiled by gcc <span>(</span>GCC<span>)</span> 8.3.1 <span>20191121</span> <span>(</span>Red Hat 8.3.1-5<span>)</span>, 64-bit
<span>(</span><span>1</span> row<span>)</span>
</code></pre></div><h3 id="check-connection-info">Check connection info</h3>
<div><pre><code data-lang="bash">postgres<span>=</span><span>## \conninfo</span>
You are connected to database <span>"postgres"</span> as user <span>"postgres"</span> on host <span>"10.128.0.2"</span> at port <span>"5432"</span>.
</code></pre></div><h2 id="executing-commands-from-shell">Executing commands from shell</h2>
<h3 id="execute-single-command-from-shell">Execute single command from shell</h3>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab ~<span>]</span>$ psql -c <span>"select current_time"</span>
    current_time    
--------------------
 14:09:19.854598+00
<span>(</span><span>1</span> row<span>)</span>
</code></pre></div><h3 id="exacute-sql-script-from-shell">Exacute sql script from shell</h3>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab ~<span>]</span>$ psql -f create_user.sql
CREATE ROLE
CREATE ROLE
CREATE ROLE
</code></pre></div><h3 id="combine-single-command-with-sql-script-from-shell">Combine single command with sql script from shell</h3>
<div><pre><code data-lang="bash"><span>[</span>postgres@postgres-lab ~<span>]</span>$ psql -c <span>"select current_time"</span> -f create_user.sql -c <span>"select current_time"</span>
    current_time    
--------------------
 14:14:26.922453+00
<span>(</span><span>1</span> row<span>)</span>

CREATE ROLE
CREATE ROLE
CREATE ROLE
    current_time    
--------------------
 14:14:26.926545+00
<span>(</span><span>1</span> row<span>)</span>
</code></pre></div>
<h3 id="check-all-available-metacommands">Check all available metacommands</h3>
<p>Do it yourself to see all available commands - output trimmed to important ones!</p>
<div><pre><code data-lang="bash">postgres<span>=</span><span>## \?</span>
General
  <span>\c</span>opyright             show PostgreSQL usage and distribution terms
  <span>\c</span>rosstabview <span>[</span>COLUMNS<span>]</span> execute query and display results in crosstab
  <span>\e</span>rrverbose            show most recent error message at maximum verbosity
  <span>\g</span> <span>[</span>FILE<span>]</span> or ;         execute query <span>(</span>and send results to file or |pipe<span>)</span>
  <span>\g</span>desc                 describe result of query, without executing it
  <span>\g</span>exec                 execute query, <span>then</span> execute each value in its result
  <span>\g</span>set <span>[</span>PREFIX<span>]</span>         execute query and store results in psql variables
  <span>\g</span>x <span>[</span>FILE<span>]</span>             as <span>\g</span>, but forces expanded output mode
  <span>\q</span>                     quit psql
  <span>\w</span>atch <span>[</span>SEC<span>]</span>           execute query every SEC seconds

  Query Buffer
    <span>\e</span> <span>[</span>FILE<span>]</span> <span>[</span>LINE<span>]</span>       edit the query buffer <span>(</span>or file<span>)</span> with external editor
    <span>\e</span>f <span>[</span>FUNCNAME <span>[</span>LINE<span>]</span><span>]</span>  edit <span>function</span> definition with external editor
    <span>\e</span>v <span>[</span>VIEWNAME <span>[</span>LINE<span>]</span><span>]</span>  edit view definition with external editor
    <span>\p</span>                     show the contents of the query buffer
    <span>\r</span>                     reset <span>(</span>clear<span>)</span> the query buffer
    <span>\s</span> <span>[</span>FILE<span>]</span>              display history or save it to file
    <span>\w</span> FILE                write query buffer to file

</code></pre></div><h3 id="list-objects-in-psql">List objects in psql</h3>
<ul>
<li>\d[S+]          -       list tables, views, and sequences</li>
<li>\d[S+]  NAME     -      describe table, view, sequence, or index</li>
<li>\da[S]  [PATTERN] -     list aggregates</li>
<li>\dA[+]  [PATTERN]  -    list access methods</li>
<li>\db[+]  [PATTERN]   -   list tablespaces</li>
<li>\dc[S+] [PATTERN]    -  list conversions</li>
<li>\dC[+]  [PATTERN]     - list casts</li>
<li>\dd[S]  [PATTERN]     - show object descriptions not displayed elsewhere</li>
<li>\dD[S+] [PATTERN]     - list domains</li>
<li>\ddp    [PATTERN]     - list default privileges</li>
<li>\dE[S+] [PATTERN]     - list foreign tables</li>
<li>\det[+] [PATTERN]     - list …</li></ul></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://knowledgepill.it/posts/postgresql-basics-guide/">https://knowledgepill.it/posts/postgresql-basics-guide/</a></em></p>]]>
            </description>
            <link>https://knowledgepill.it/posts/postgresql-basics-guide/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24036132</guid>
            <pubDate>Mon, 03 Aug 2020 10:40:47 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The UX of Lego Interface Panels]]>
            </title>
            <description>
<![CDATA[
Score 396 | Comments 38 (<a href="https://news.ycombinator.com/item?id=24035866">thread link</a>) | @george_cave
<br/>
August 3, 2020 | https://www.designedbycave.co.uk/2020/LEGO-Interface-UX/ | <a href="https://web.archive.org/web/*/https://www.designedbycave.co.uk/2020/LEGO-Interface-UX/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>

   
   <time>August 2020</time>

   

   

   <p>Piloting an <a href="https://www.lego.com/en-de/product/ocean-exploration-ship-60266">ocean exploration ship</a> or <a href="https://www.lego.com/en-de/product/mars-research-shuttle-60226">Martian research shuttle</a> is serious business. Let’s hope the control panel is up to scratch. Two studs wide and angled at 45°, the ubiquitous “2x2 decorated slope” is a LEGO minifigure’s interface to the world.</p>

<p>These iconic, low-resolution designs are the perfect tool to learn the basics of physical interface design. Armed with 52 different bricks, let’s see what they can teach us about the design, layout and organisation of complex interfaces.</p>

<p>Welcome to the world of LEGO UX design.</p>

<p><img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/interfaces.jpg" alt="LEGO interfaces"></p>

<h2 id="organised-chaos">Organised chaos</h2>

<p>At a glance, the variety of these designs can be overwhelming, but it’s clear that some of these interfaces look far more chaotic than others. Most interfaces in our world contain a blend of digital screens and analog inputs like switches and dials. These LEGO panels are no different.</p>

<p>Plotting the panels across these two axes reveals a few different clusters. Screens with an accompanying row of buttons sit in the top left. A small cluster of very organised switch panels lies to the far right. The centre bottom is occupied by some wild concepts that are hard to understand, even after several glances.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/positioning.jpg" alt="Design positioning with LEGO, in LEGO">
    <figcaption>Design positioning with LEGO, in LEGO</figcaption>
  </figure>

<p>Designing a complex machine interface is a juggling act of many different factors from ergonomics to engineering. But we can break down the problem into two key questions:</p>

<ol>
  <li>How can we <em>differentiate</em> between the function of different inputs?</li>
  <li>How can we <em>organise</em> the many inputs and outputs so that we understand how they relate to each other?</li>
</ol>

<p>Let’s take a deeper look at tackling these two challenges in LEGO.</p>

<h2 id="differentiating-inputs">Differentiating inputs</h2>

<p>What could cause 400 WWII pilots to raise the landing gear on their B-17 bomber just before touchdown? Catastrophic pilot error, or something more fundamental?</p>

<p>It was the psychologist Alphonsis Chapanis who first suggested that the high rate of crash landings might be the fault of poor interface design. The adjacent landing gear and flap control knobs were identically shaped. The pilots never stood a chance.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/landing.jpg" alt="B-17 belly landing, and the shape coding that helped to irradiate the problem. Source: Wikipedia">
    <figcaption>B-17 belly landing, and the shape coding that helped to irradiate the problem. Source: Wikipedia</figcaption>
  </figure>

<p>His temporary solution was to glue differently shaped strips of rubber to each switch, enabling blind operation by touch alone. This gave rise to the idea of shape coding and a system of differentiation still being followed in aircraft cockpits today.</p>

<p>We can compare the three interfaces below to see this in action. Ignore the overall layout, it’s the differences between individual switches that matter here. Imagine trying to feel for one of these buttons without looking. The left panel (“Slope 45 2 x 2 with 12 Buttons”) would require careful hand-eye co-ordination. The right panel (“Aircraft Multiple Flight Controls”) clearly distinguishes between the throttle (large, linear vertical movement), toggle switches (round vertical flick) and the push buttons (square push-in).</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/differentiation.jpg" alt="Left to right: terrible, poor and better input differentiation">
    <figcaption>Left to right: terrible, poor and better input differentiation</figcaption>
  </figure>

<p>Differentiation like this is a still a very real problem today. In 2015, <a href="https://money.cnn.com/2015/01/06/autos/ford-push-button-ignition-recall/index.html">Ford recalled 13,500 Lincoln SUVs</a> because drivers speeding down the motorway were mistakenly shutting off the engine when they tried to activate sport mode. See if you can spot why:</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/ford-lincoln.jpg" alt="Ford Lincoln MKC before the Engine start/stop button was moved. Source: CNN">
    <figcaption>Ford Lincoln MKC before the Engine start/stop button was moved. Source: CNN</figcaption>
  </figure>

<p>Shape coding is one approach to differentiation, but there are many others. Colour coding is perhaps the only one to break into our everyday vocabulary, but we can add four more: size, texture, position and operation coding. Together these six are our allies in the design of error-proof interfaces.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/codings.jpg" alt="The 6 basic codings. Notice that many of these examples actually combine multiple codings in one.">
    <figcaption>The 6 basic codings. Notice that many of these examples actually combine multiple codings in one.</figcaption>
  </figure>

<p>Size, shape and colour-coding are the fundamentals: quick-wins that can fix a lot of interface problems. Texture is also a great differentiator for blind operation, particularly on small dials requiring precise control.</p>

<p>Position-coding is seemingly straightforward but is often under used. Products with a clear default ergonomic position (like binoculars or a gaming console) can exploit the natural position of the hand to differentiate between primary and secondary actions.</p>

<p>Finally, operation-coding ascribes different types of movements (like a twist or vertical slide) to different inputs. This can be immensely powerful when the switch motion reinforces the operation behind it, e.g. a crane lever which raises the crane when the lever is raised.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/lego-codings.jpg" alt="The six different codings in use in the LEGO interfaces: size, shape, colour, texture, position, operation">
    <figcaption>The six different codings in use in the LEGO interfaces: size, shape, colour, texture, position, operation</figcaption>
  </figure>

<p>Differentiation is a good first step that will avoid confusion between adjacent switches. But its only with organisation that we can create a clear and accurate mental model of the interface for the user.</p>

<h2 id="organising-inputs">Organising inputs</h2>

<p>Compare the three panels below. Identical layouts, but the blue one is much clearer than the white. This is the <a href="https://www.usertesting.com/blog/gestalt-principles">gestalt principles</a> at work, identifying related items with a common region.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/gestalt.jpg" alt="Basic differentiation by clustering">
    <figcaption>Basic differentiation by clustering</figcaption>
  </figure>

<p>Easy. But how are you going to decide which inputs to cluster together?</p>

<p>I like to use <a href="http://blog.presentandcorrect.com/27986-2">Soviet control panels</a> as a starting point. These beautiful walls of nonsensical dials and levers are brought to life when arranged in a giant factory schematic.  It would be hard to find a more literal organisation of the information.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/soviet-control-panels.jpg" alt="Soviet control panels in action. Source: Present and Correct">
    <figcaption>Soviet control panels in action. Source: Present and Correct</figcaption>
  </figure>

<p>These panels are what I’d called a consolidated interface. Every piece of input and feedback has been moved onto the same panel. This is the approach that <a href="https://www.thedrive.com/news/33847/the-defunct-dyson-evs-steering-wheel-looks-like-it-was-made-by-vacuum-cleaner-people">Dyson took with their car</a>. Now imagine the opposite, moving each of those lights and switches to the actual location of that valve in the factory. Sounds ludicrous, but these <a href="https://deeptread.com/blog/2016/11/21/audi-tt-air-vent-design">air vents in the Audi TT</a> show that this distributed approach can also be a great win for user experience. I wrote a lot more about these <a href="https://www.designedbycave.co.uk/2018/Interfaces/">distributed interfaces last year</a>.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/distributed.jpg" alt="Lego vehicle dashboard: distributed (left) vs. consolidated (right)">
    <figcaption>Lego vehicle dashboard: distributed (left) vs. consolidated (right)</figcaption>
  </figure>

<p>Back to the Soviet factories. Those interface panels were great for answering the question “does this valve let water into tank Б?”. But they’re very poor for answering “are all water valves closed?” or “where are all the switches I need to prepare for the shift changeover?”.</p>

<p>LEGO use the Soviet schematic approach for their <a href="https://www.bricklink.com/catalogItemIn.asp?P=3298pb005&amp;in=S">fantasy</a> <a href="https://www.bricklink.com/catalogItemIn.asp?P=3298px10&amp;in=S">orientated</a> designs, because schematics are superb at providing a mental model of the inner workings of an alien system. However for everyday use, there are some other approaches that work better.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/alien-interfaces.jpg" alt="LEGO Insectoid and UFO interfaces. I wonder what these buttons actually do?">
    <figcaption>LEGO Insectoid and UFO interfaces. I wonder what these buttons actually do?</figcaption>
  </figure>

<p><strong>Feature</strong> based organisation is the most common, perhaps even the “default” design philosophy. Group together all the inputs and outputs for each product feature. This <a href="https://www.cambridgeconsultants.com/press-releases/building-life-saving-ventilator-lightning-speed">COVID-19 ventilator from Cambridge Consultants</a> is a wonderful example but we also see this a lot in cars, with a cluster of switches for the airflow control and all of the lights on one control stick.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/covid-ventilator.jpg" alt="COVID-19 ventilator by Cambridge Consultants with clear feature-based organisation. Source: Cambridge Consultants">
    <figcaption>COVID-19 ventilator by Cambridge Consultants with clear feature-based organisation. Source: Cambridge Consultants</figcaption>
  </figure>

<p>Organising by <strong>operation</strong> means putting all the switches that function in a certain way in the same place. I’ve no idea what all the valves in the picture below do, but I bet they don’t all open things that relate to each other. Anytime you see a row of switches that look and function the same, but control disparate parts of the system, you’ve come across organisation by operation.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/valves.jpg" alt="Source: Twitter @aglushko">
    <figcaption>Source: Twitter @aglushko</figcaption>
  </figure>

<p>Today most interfaces are effectively <a href="https://en.wikipedia.org/wiki/Fly-by-wire">fly-by-wire</a>, but historically the levers that you pulled in, say, a tractor cabin would literally move the hydraulic pistons beneath the seat to a new position. Routing all these different electrical, mechanical and hydraulic systems efficiently can severely compromise your interface clustering, leading to organisation by <strong>technology</strong>.</p>

<p>The modern equivalent of this is surprisingly common. Any touchscreen with buttons by the side exhibits this technology-based split. In a <a href="https://www.chrisharrison.net/index.php/Research/PneumaticDisplays">future</a> <a href="https://vimeo.com/343640141">world</a>, SpaceX might embed <a href="https://www.space.com/spacex-crew-dragon-touchscreen-astronaut-thoughts.html">these physical controls</a> right inside the screen next to the information they affect, but for now they sit awkwardly by the side as if nothing is wrong.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/spacex-dragon.jpg" alt="Bob and Doug in the SpaceX Dragon capsule. Source: SpaceX">
    <figcaption>Bob and Doug in the SpaceX Dragon capsule. Source: SpaceX</figcaption>
  </figure>

<p>In LEGO we find the feature based organisation in the “Monitor with -19° pattern”. Two clear clusters, perhaps one for temperature control and another for vital signs monitoring. In the second panel below, I don’t know what all those switches do, but they seem to be clustered based on their operation, not because of what they will operate.</p>

<p>There are many LEGO panels with a technology split like the SpaceX Dragon capsule, but I like to imagine that this early 90s police control unit was forced to divide the audio and video playback because the newer tape reel technology was incompatible with the older analog phone line system. This is organisation by technology in action.</p>

<figure>
    <img src="https://www.designedbycave.co.uk/images/posts/2020-08-LEGO-Interface-UX/organisation.jpg" alt="L-to-R: organisation by feature, operation, technology and use case">
    <figcaption>L-to-R: organisation by feature, operation, technology and use case</figcaption>
  </figure>

<p>All of our approaches so far: organisation by features, operation or technology, have been grounded in properties of the system, not of the user. Organisation by <strong>use-case</strong> is the antidote to this, a clustering based on the daily routines and tasks of the user.</p>

<p>Imagine arriving for work each day at the LEGO body scanner factory. Grouping the switches by task (prepare machine, load body, process scan…) would mean splitting up the radiation and scanner buttons into many different regions. More complex for the computer, but more streamlined for the operator. As the designer, only you and your users will be the judge of what works best.</p>

<h2 id="but-george-which-is-the-best-interface">But George, which is the best interface?</h2>

<p>I often say there’s no such thing as the best interface, but …</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://www.designedbycave.co.uk/2020/LEGO-Interface-UX/">https://www.designedbycave.co.uk/2020/LEGO-Interface-UX/</a></em></p>]]>
            </description>
            <link>https://www.designedbycave.co.uk/2020/LEGO-Interface-UX/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24035866</guid>
            <pubDate>Mon, 03 Aug 2020 09:59:59 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[KLM to Lay Off 5k Employees Due to Covid-19]]>
            </title>
            <description>
<![CDATA[
Score 88 | Comments 77 (<a href="https://news.ycombinator.com/item?id=24035132">thread link</a>) | @cockpitherald
<br/>
August 3, 2020 | https://kokpitherald.com/klm-to-lay-off-5000-employees-due-to-covid-19-crisis/ | <a href="https://web.archive.org/web/*/https://kokpitherald.com/klm-to-lay-off-5000-employees-due-to-covid-19-crisis/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
            <!-- image --><div><figure><a href="https://kokpitherald.com/wp-content/uploads/2020/08/51225945-56BB-4A94-A791-264925C3315B.jpeg" data-caption="A total of 4,500 to 5,000 positions in the entire KLM Group will cease to exist.

Photo: KLM
"><img width="500" height="375" src="https://kokpitherald.com/wp-content/uploads/2020/08/51225945-56BB-4A94-A791-264925C3315B.jpeg" srcset="https://kokpitherald.com/wp-content/uploads/2020/08/51225945-56BB-4A94-A791-264925C3315B.jpeg 500w, https://kokpitherald.com/wp-content/uploads/2020/08/51225945-56BB-4A94-A791-264925C3315B-300x225.jpeg 300w, https://kokpitherald.com/wp-content/uploads/2020/08/51225945-56BB-4A94-A791-264925C3315B-80x60.jpeg 80w, https://kokpitherald.com/wp-content/uploads/2020/08/51225945-56BB-4A94-A791-264925C3315B-265x198.jpeg 265w" sizes="(max-width: 500px) 100vw, 500px" alt="" title="KLM pliots and cabin crew"></a><figcaption>A total of 4,500 to 5,000 positions in the entire KLM Group will cease to exist.

Photo: KLM
</figcaption></figure></div>
            <!-- content -->
 <!-- A generated by theme --> 



 <!-- end A --> 


<p><strong>KLM is in the throes of a crisis of unprecedented magnitude. Since the outbreak of the COVID-19 virus at the start of 2020, numerous measures have already been taken to deal with the current circumstances. Expectations are that the road to recovery will be long and fraught with uncertainty. This means that KLM’s structure and size must be rigorously adjusted even further in the years ahead. Consequently, a total of 4,500 to 5,000 positions in the entire KLM Group (expressed in FTEs) will cease to exist.</strong></p>



<p>In the wake of the coronavirus outbreak, KLM gradually began reducing the size of its network in February to operate less than 10% of its original number of <a href="https://kokpitherald.com/united-airlines-plans-to-resume-service-on-more-than-25-international-routes-in-september/">flights</a> by the start of April. In the second quarter, only 15% of the original number of flights were operated. In July, 30% of the original flights were operated and load factors are lagging behind. As a result, while the network is again being gradually and carefully expanded, revenues are lagging far behind.</p>
 <!-- A generated by theme --> 



 <!-- end A --> 





<p>Prospects for the airline industry – and KLM in particular – are uncertain. Different countries are now beginning to tighten their more relaxed travel restrictions. This is making customers more cautious when it comes to booking a ticket. In all scenarios, demand is only expected to recover by 2023 or 2024 at the earliest. The degree and speed of recovery will depend on a number of factors including the development of the virus, economic recovery and customer travel behaviour.</p>



<h2>KLM Adjusting to the New Reality</h2>



<p>Government support in the form of a direct state loan and guaranteed bank credit facilities amounting to a maximum of €3.4 billion will enable KLM to navigate the crisis in the forthcoming period. <a href="https://news.klm.com/klm-adapts-organisation-further-due-to-covid-19-crisis/" target="_blank" aria-label="KLM (opens in a new tab)" rel="noreferrer noopener">KLM</a> is extremely grateful for this support provided by means of the loan. In order to guarantee KLM’s existence in the longer term, the airline must adapt its size to the new reality. KLM therefore finds itself compelled to reduce its workforce down to the number needed for the planned operation in 2021/2022. Of the current total of 33,000 FTEs in the entire KLM Group, the workforce must be reduced by 4,500 to 5,000 FTEs to 28,000 FTEs in the course of 2021.</p>



<p>KLM’s size is already becoming smaller – and will continue to be reduced – based on the current measures, which include the non-renewal of temporary contracts (1,500 FTEs) and the Voluntarily Departure Scheme (2,000 FTEs). Additionally, natural attrition (500 FTEs) through retirement and the like in 2020 and 2021 will also contribute to the reduction needed.</p>



<p>Hence, despite the measures already taken, even fewer people will be needed at KLM in the years ahead. Additionally, for positions on the ground we also need to deal with some mismatch in functional skills and capabilities.</p>



<p>Unfortunately, for this reason and taking into account the mismatch, alternative solutions will have to be found for ca. 1,500 positions. This relates to up to 500 ground positions, 300 cabin crew positions and 300 cockpit positions and approximately 400 positions at KLM subsidiaries and Air France-KLM group functions.</p>



<p>Given the high level of uncertainty, KLM keeps open the possibility of further reductions in case the production levels will be revised further down for 2021/2022 than the -20% planned now.</p>



<figure><img src="https://kokpitherald.com/wp-content/uploads/2020/08/klm_crew.jpg" alt="KLM" srcset="https://kokpitherald.com/wp-content/uploads/2020/08/klm_crew.jpg 500w, https://kokpitherald.com/wp-content/uploads/2020/08/klm_crew-300x169.jpg 300w" sizes="(max-width: 500px) 100vw, 500px"><figcaption>KLM crew in Sydney Photo: KLM</figcaption></figure>



<h3>KLM to Cooperate with Trade unions and Works Council</h3>



<p>KLM’s reorganisation plans tie in with organisation-wide changes at Air France KLM. In the forthcoming period, KLM will be cooperating closely with the trade unions to draft a social plan for each collective labour agreement domain and subsidiary, as well as maintaining close consultation with the Works Council about further defining the reorganisation. This will include a more detailed specification of the conditions set by the Dutch government on issuing the financing package. Expectations are that this will be finished in its entirety in the course of October.“</p>



<blockquote><p><em>A great deal has already been done in recent months with respect to adjusting the size of our company in the face of a new reality. Unfortunately, more measures are needed in the short term to guarantee KLM’s continued existence in the future. For this reason, we are elaborating the reorganisation plan to emerge from this crisis in a stronger position, while retaining as many jobs as we can in a responsible manner and repaying the loans as quickly as possible.</em></p><p><em>KLM employees are loyal, professional and hard working. They are always ready to serve our customers, one another, the company and society at large. Recent developments have again served to prove that this is true. It is incredibly difficult and sad for KLM to now have to bid farewell to valuable, committed colleagues. Certainly in view of how much we have succeeded in achieving together in recent years. The forthcoming period will be devoted to saying goodbye to colleagues who have to leave with due care and to reconstructing KLM.</em></p></blockquote>



<p>KLM President-directeur &amp; CEO Pieter Elbers</p>

 <!-- A generated by theme --> 



 <!-- end A --> 

        </div></div>]]>
            </description>
            <link>https://kokpitherald.com/klm-to-lay-off-5000-employees-due-to-covid-19-crisis/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24035132</guid>
            <pubDate>Mon, 03 Aug 2020 07:51:41 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[MNT Reform open source laptop with trackball]]>
            </title>
            <description>
<![CDATA[
Score 94 | Comments 31 (<a href="https://news.ycombinator.com/item?id=24034502">thread link</a>) | @brian_herman
<br/>
August 2, 2020 | https://mntre.com/media/reform_md/2020-05-08-the-much-more-personal-computer.html | <a href="https://web.archive.org/web/*/https://mntre.com/media/reform_md/2020-05-08-the-much-more-personal-computer.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><section>
        <date>Published: 2020-05-08 Updated: 2020-05-22 21:36:37 +0200</date>
        

<p><a href="https://mntre.com/media/reform_v2_images/product-mnt-reform.jpg"><img src="https://mntre.com/media/reform_v2_images/product-mnt-reform.jpg" alt="MNT Reform in 2020"></a></p>

<p>This page serves as a link index to all Reform content, both historical and recent.</p>

<p>On 2020-05-08, MNT Research launched the MNT Reform open source mobile computer:</p>

<p><strong><a href="https://www.crowdsupply.com/mnt/reform">→ Go to the Crowd Supply Campaign</a></strong></p>

<h2 id="mnt-reform-final-version">MNT Reform Final Version</h2>

<p>Internally called MNT Reform 2.0, this is a version with many improvements, full aluminum enclosure, HD display and NXP i.MX8MQ module.</p>

<ul>
<li>2020-05-22: <a href="https://mntre.com/reform2-handbook/system.html">MNT Reform Interactive System Diagram and Interactive PCBs</a>, first version, published.</li>
<li>2020-05-08: <a href="https://www.crowdsupply.com/mnt/reform">Crowd supply campaign is launched</a>, running until 2020-06-18.</li>
<li>2020-05-08: <a href="https://www.crowdsupply.com/mnt/reform/updates/the-campaign-is-live">Launch Announcement</a> of the campaign.</li>
<li>8 Beta versions (D-3 / D-4) were sold in late 2019/early 2020 and are shipped in May 2020.</li>
<li>2020-01-18: <a href="https://mntre.com/media/reform_md/2020-01-18-finishing-reform.html">Finishing Reform</a></li>
<li>2019-05-20: <a href="https://mntre.com/media/reform_md/2019-05-20-reintroducing-reform.html">Re-Introducing Reform</a></li>
<li>Handbook not yet available</li>
<li><a href="https://source.mntmn.com/MNT/reform">Sources of Reform 2.0 (KiCAD, various)</a></li>
</ul>

<h2 id="mnt-reform-prototype-version-s-internally-called-mnt-reform-0-1-1-0">MNT Reform Prototype Version(s) (internally called MNT Reform 0.1 - 1.0)</h2>

<p>This was the original version of Reform, based on NXP i.MX6QP.</p>

<ul>
<li>2019-01-14: <a href="https://mntre.com/media/reform_md/2019-01-14-status_update_on_reform.html">Status Update on MNT Reform</a></li>
<li><a href="https://mntre.com/media/reform_md/reform-1-handbook.pdf">Handbook for Reform 1.0 (PDF, historical)</a></li>
<li><a href="https://source.mntmn.com/MNT/reform/src/branch/master/historic-reform1">Sources of Reform 1.0 (KiCAD, various, historical)</a></li>
<li>10 prototype versions were shipped to early supporters in late 2018. 13 exist in total.</li>
<li><a href="https://mntre.com/media/reform_md/reform-historic/reform-beta-1.html">MNT Reform: The Original Story</a></li>
</ul>

<h2 id="talks-appearances">Talks / Appearances</h2>

<ul>
<li><a href="https://media.ccc.de/v/34c3-9257-lightning_talks_day_3#t=3512">Reform Lightning Talk from 34c3</a></li>
<li><a href="https://media.ccc.de/v/dg-90">Longer Reform talk in German from CCCB Datengarten 90</a></li>
</ul>

<h2 id="irc-channel">IRC Channel</h2>

<ul>
<li>Chat in #reform on irc.freenode.net</li>
</ul>



<ul>
<li><a href="https://mastodon.social/@mntmn">Mastodon</a></li>
<li><a href="https://twitter.com/mntmn">Twitter</a></li>
</ul>

<h2 id="crowdfunding-campaign">Crowdfunding Campaign</h2>

<p><strong><a href="https://www.crowdsupply.com/mnt/reform">→ Go to the Crowd Supply Campaign</a></strong></p>

      </section></div>]]>
            </description>
            <link>https://mntre.com/media/reform_md/2020-05-08-the-much-more-personal-computer.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-24034502</guid>
            <pubDate>Mon, 03 Aug 2020 05:34:28 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Autodesk criticised by architects]]>
            </title>
            <description>
<![CDATA[
Score 298 | Comments 375 (<a href="https://news.ycombinator.com/item?id=24034211">thread link</a>) | @nsoonhui
<br/>
August 2, 2020 | http://extranetevolution.com/2020/07/autodesk-criticism-extends/ | <a href="https://web.archive.org/web/*/http://extranetevolution.com/2020/07/autodesk-criticism-extends/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="content">
                
                    
                                        
                    <div id="content-main">
                    
	
		
		        
<div id="post-14835">
		
	<div>
    	
                    	<p>
            	<span>Jul</span>
                <span>31</span>
                	                <span>2020</span>
                            </p>
            
		        
		
			    <ul>
	    		        <li>
	        	By  in <span><a href="http://extranetevolution.com/category/aec/">AEC</a>, <a href="http://extranetevolution.com/category/bim/">BIM</a>, <a href="http://extranetevolution.com/category/businessfinancial/">Business/Financial</a>, <a href="http://extranetevolution.com/category/collaboration/">Collaboration</a>, <a href="http://extranetevolution.com/category/digital-transformation/">Digital transformation</a>, <a href="http://extranetevolution.com/category/functionality/">Functionality</a>, <a href="http://extranetevolution.com/category/future/">Future</a>, <a href="http://extranetevolution.com/category/vendors/">Vendors</a></span>	        </li>
	        	        <li>
	        	<p><em>31 July 2020</em></p>	        </li>
	        	        <li>
	        	        <span>
            <i></i>
        </span>
    	        </li>
	        	    </ul>
    		
				<div>
							
										
						<div itemscope="" itemtype="http://schema.org/BlogPosting"><p><em><strong>Architectural unrest about Autodesk and its support for the industry’s design businesses is growing. Discontent has been simmering for a decade or more, and has led to calls for EU action.</strong></em></p>
<p><a href="https://www.autodesk.co.uk/"><img src="http://extranetevolution.com/files/2013/11/autodesk.logo2013.jpg" alt="autodesk logo" width="181" height="31"></a>The recent <a href="https://letters-to-autodesk.com/" target="_blank" rel="noopener noreferrer">open letter to Autodesk</a> from 17 named members of a 25-strong group of leading architects (28 July 2020: <a href="http://extranetevolution.com/2020/07/design-firms-demand-change-at-autodesk/"><em>Design firms demand change at Autodesk</em></a>) has been supported by more firms. They extend the geographical reach of those prepared to publicly criticise the US AEC software vendor over its support for architectural design businesses – many of them heavily reliant upon Autodesk’s Revit design software. An additional 18 practices now stand alongside the original letter’s signatories, bringing the total to 35. A further 10 practices are supportive, but have not gone public. In total, more than 50 firms have therefore backed the group’s grievances.</p>
<p><img src="http://extranetevolution.com/files/2020/07/Revit_2014_branding-150x150.png" alt="Autodesk Revit_2014_branding" width="150" height="150" srcset="http://extranetevolution.com/files/2020/07/Revit_2014_branding-150x150.png 150w, http://extranetevolution.com/files/2020/07/Revit_2014_branding-300x300.png 300w, http://extranetevolution.com/files/2020/07/Revit_2014_branding-160x160.png 160w, http://extranetevolution.com/files/2020/07/Revit_2014_branding.png 316w" sizes="(max-width: 150px) 100vw, 150px">The new signatories are: BC Architects and SAOTA (both from South Africa); Cooper Carry, Portman Architects, Idesign-solutions, Studio 3 Architecture, Goody Clancy, SGA, Bohlin, Cywinski, Jackson, and Workshop Collaborative (all from the US), Atelier Tisso (France),&nbsp;CGL,&nbsp;Shepheard Epstein Hunter, and PDPLondon (all from the UK); Vibes (Netherlands); MIZA (Canada); Oslo works (Norway); and Mochly-Eldar Architects (Israel).</p>
<p>It is clear that Iain Godwin has tapped into a growing sense of unease, though, to be fair, rumblings of discontent have been heard many times over the past decade or so from a variety of software commentators and end-users. For example:</p>
<ul>
<li><a href="https://www.worldcadaccess.com/blog/2009/12/solidworks-accuses-autodesk-of-attempting-to-monopolize-use-of-dwg-as-file-extension.html" target="_blank" rel="noopener noreferrer"><em><strong>SolidWorks accuses Autodesk of attempting to monopolize use of .dwg as file extension</strong></em></a> (Ralph Grabowski – WorldCADAccess, December 2009)</li>
<li><a href="https://gfxspeak.com/2011/04/28/is-the-european-commission-investigating-autodesk/" target="_blank" rel="noopener noreferrer"><em><strong>Is the European Commission investigating Autodesk?</strong></em></a> (Randall Newton – GraphicSpeak, April 2011)</li>
<li><a href="https://www.cadnauseam.com/2017/07/26/autodesk-confirms-its-own-unconscionable-conduct/" target="_blank" rel="noopener noreferrer"><em><strong>Autodesk confirms its own unconscionable conduct</strong></em></a> (Steve Johnson – CAD Nauseum, July 2017)</li>
<li><a href="http://debunkthebim.blogspot.com/2018/04/here-is-why-autodesks-monopoly-over.html" target="_blank" rel="noopener noreferrer"><em><strong>Here is why Autodesk’s monopoly over the Global AEC is not good, not even for Autodesk</strong></em></a> (Zolna Murray – Debunk the BIM, February 2018)</li>
<li><a href="https://www.linkedin.com/pulse/avoiding-carillions-mistakes-joining-autodesks-monopoly-john-ford/" target="_blank" rel="noopener noreferrer"><em><strong>Avoiding Carillion`s Mistakes of Joining Autodesk’s Monopoly Unnecessarily</strong></em></a> (John Ford – LinkedIn Pulse, May 2018)</li>
<li><a href="http://mes100.com/blog/the-state-of-bim-software-and-autodesk/" target="_blank" rel="noopener noreferrer"><em><strong>The state of BIM software and Autodesk</strong></em></a> (MES – MES blog, July 2018)</li>
<li><a href="https://thinkmoult.com/why-revit-is-shit.html" target="_blank" rel="noopener noreferrer"><em><strong>Why Revit is shit</strong></em></a> (Dion Moult – ThinkMoult, December 2018)</li>
</ul>
<p>Concerns about some software vendors’ monopolistic positions have also been raised internationally by industry organisations, including the <a href="http://www.fiec.eu/" target="_blank" rel="noopener noreferrer">European Construction Industry Federation (FIEC</a>).</p>
<h3>FIEC position paper</h3>
<p><a href="http://www.fiec.eu/"><img src="http://extranetevolution.com/files/2020/07/FIEC-logo-300x117.jpg" alt="FIEC logo" width="300" height="117" srcset="http://extranetevolution.com/files/2020/07/FIEC-logo-300x117.jpg 300w, http://extranetevolution.com/files/2020/07/FIEC-logo-160x62.jpg 160w, http://extranetevolution.com/files/2020/07/FIEC-logo.jpg 443w" sizes="(max-width: 300px) 100vw, 300px"></a>On 24 February 2020, the FIEC published a position paper on the relationship between users and software companies/ editors/ service providers (<em><a href="http://extranetevolution.com/files/2020/07/2020-02-24-FIEC_position_on_software_companies-Final.pdf" target="_blank" rel="noopener noreferrer">download</a></em>). No vendors are named, but, from the similarity of the claims, Autodesk is clearly one of the software providers that FIEC is sufficiently concerned about to urge the European Commission to review competition and data management regulations. Its paper discusses challenges and makes recommendations under four headings:</p>
<ol>
<li><strong>The dominant position of a few software companies/editors/providers raises major concerns.</strong> – The FIEC urges the European Commission to target competition issues relating to software user contracts</li>
<li><strong>The non-EU origin of these suppliers and their infrastructure is exacerbating the lack of autonomy in software capability in the EU.</strong> – The FIEC says EU software users should be allowed to decide where their data is stored (“EU companies should be able to have their data hosted on EU territory, by EU servers/companies, under EU legislation”), calls for the creation of a secure European Cloud, and says software services “should be required to meet EU standards for interoperability and open access”.</li>
<li><strong>Contracting authorities must remain software-neutral and promote open standards</strong>. – The FIEC calls for enforcement of EU public procurement rules, and urges promotion of open standards for data, protocols and file formats in public procurement.</li>
<li><strong>Rules need to be established for multiple-user-access platforms such as BIM models.</strong> – Similarly, the FIEC urges EU measures aimed at protecting the data owner while ensuring appropriate data access rights for other users.</li>
</ol>
<h3>Autodesk not alone in hosting, US dominance, interoperability issues</h3>
<p>Some of these issues are already familiar. Where project data is hosted has been a concern ever since Software-as-a-Service applications began to be deployed in the 1990s, and as use of construction collaboration platforms expanded in the early 2000s, most leading vendors have responded by creating localised hosting centres to serve different operational regions. Hosting&nbsp; project data in the United States, for example, has been resisted by most clients based in Europe and other parts of the world (eg: the Middle East, southeast Asia, etc; read <em>EE</em> August 2014 post <a href="http://extranetevolution.com/2014/08/no-saas-safe-harbor/"><em>No SaaS ‘Safe Harbor’</em></a>).</p>
<p>Concentration of large portions of the construction software industry through merger and acquisition activity has resulted in an increasingly dominant position for US software giants. By gobbling up strong players in Europe, Australasia and elsewhere, Autodesk, Bentley, Oracle and Trimble have assembled strong AEC software portfolios, while some of the more generic US software providers such as Microsoft and IBM have also developed applications, services and relationships that give them an increasingly strong foothold in the AEC space.</p>
<p>And software interoperability has been a perennial issue that <em>EE</em> has covered since it started in 2005 (eg: <a href="http://extranetevolution.com/2005/09/new_roi_return_/"><em>New ROI: Return on Interoperability</em></a>, September 2005). BuildingSmart (formerly the International Alliance for Interoperability) started out as an Autodesk initiative in the mid-1990s, but, over 25 years later, global shifts towards open standards are still proceeding almost glacially slowly, with Autodesk’s leading BIM authoring product “widely ridiculed” for its IFC import/export capabilities.</p>
<h3>Autodesk responds on key themes</h3>
<p><strong><a href="https://adsknews.autodesk.com/views/reply-to-open-letter-on-revit"><img src="http://extranetevolution.com/files/2020/07/Autodesk-reply-300x205.jpg" alt="Autodesk reply" width="400" height="273" srcset="http://extranetevolution.com/files/2020/07/Autodesk-reply-300x205.jpg 300w, http://extranetevolution.com/files/2020/07/Autodesk-reply-590x403.jpg 590w, http://extranetevolution.com/files/2020/07/Autodesk-reply-768x524.jpg 768w, http://extranetevolution.com/files/2020/07/Autodesk-reply-160x109.jpg 160w, http://extranetevolution.com/files/2020/07/Autodesk-reply.jpg 1157w" sizes="(max-width: 400px) 100vw, 400px"></a>Autodesk’s initial response</strong> (<a href="http://extranetevolution.com/2020/07/design-firms-demand-change-at-autodesk/"><em>see update to earlier EE post</em></a>) to the Godwin group’s open letter <strong>did not mention interoperability</strong> at all. However, a <a href="https://adsknews.autodesk.com/views/reply-to-open-letter-on-revit" target="_blank" rel="noopener noreferrer">follow-up blog post by Amy Bunzsel</a> published today (31 July 2020) addresses the main themes, and on openness and interoperability says: “<strong>We continue to invest in supporting IFC</strong> and based on customer feedback we’ve <strong>recently increased development for new industry requirements, focusing on IFCv4 certification</strong>.”</p>
<p>Bunzsel continues:</p>
<p>“Looking to the future, we believe that ways of working will evolve, from the direct modeling of today to outcome-based design driven by analysis…, to the convergence of manufacturing and construction, and that <strong>data needs to be unlocked from native formats and flow more readily throughout Autodesk and non-Autodesk products</strong>.”</p>
<h3>No more software silos</h3>
<p><a href="https://3drepo.com/"><img src="http://extranetevolution.com/files/2017/03/3DRepo-300x102.png" alt="" width="150" height="51" srcset="http://extranetevolution.com/files/2017/03/3DRepo-300x102.png 300w, http://extranetevolution.com/files/2017/03/3DRepo.png 385w" sizes="(max-width: 150px) 100vw, 150px"></a>Jozef Dobos is CEO and founder of London, UK-based technology vendor, <a href="https://3drepo.com/" target="_blank" rel="noopener noreferrer"><strong>3DRepo</strong></a>&nbsp;(which has been <a href="https://3drepo.com/4670-2/" target="_blank" rel="noopener noreferrer">a supporter of Open BIM since 2017</a>), and recently argued&nbsp;<a href="https://www.bimplus.co.uk/analysis/making-case-fair-competition-software-use/" target="_blank" rel="noopener noreferrer"><em>The case for fair competition in software use</em></a>, in a <em>BIM+</em> article. He writes:</p>
<p><img src="http://extranetevolution.com/files/2020/07/Jozef-Dobos-271x300.png" alt="Jozef Dobos" width="271" height="300" srcset="http://extranetevolution.com/files/2020/07/Jozef-Dobos-271x300.png 271w, http://extranetevolution.com/files/2020/07/Jozef-Dobos-145x160.png 145w, http://extranetevolution.com/files/2020/07/Jozef-Dobos-363x400.png 363w, http://extranetevolution.com/files/2020/07/Jozef-Dobos.png 502w" sizes="(max-width: 271px) 100vw, 271px">“<strong>All the issues raised by the FIEC must be addressed to enable the genuine digitisation of the construction industry</strong>.</p>
<p>3D Repo was created to enable the construction industry to work better together and to create better buildings. This is why projects like the&nbsp;<strong><a href="https://www.bimplus.co.uk/news/project-explores-faster-bim-data-transfer-between-/" target="_blank" rel="noopener noreferrer">AEC Delta Mobility</a></strong> [open-source] initiative in collaboration with BuroHappold Engineering and Speckle Systems are so important, creating a new standard for designers, integrators and fabricators to improve the flow of data.</p>
<p>The current method of sharing information as files of entire 3D models can hinder collaboration. Tracking changes can also be problematic and inefficient for design communication. AEC Delta Mobility breaks down the file barriers to enable small design changes, known as ‘Deltas’, to be shared faster, more openly and more efficiently.</p>
<p><strong>This is how the software industry should be working with the construction industry. Real solutions that involve working with customers and providing them with tools they will not want to walk away from, based on commercial terms that actually promote the collaborative behaviours we want to see, not divide us into software silos</strong>.”</p>
</div>								</div>
		
			    
    	</div>

</div>


<p><span><strong>Permanent link to this article: </strong><span>http://extranetevolution.com/2020/07/autodesk-criticism-extends/</span></span></p>











	
    

            
  

                </div><!-- #content-main -->
        
            
<!-- #sidebar1 -->        
        
    </div></div>]]>
            </description>
            <link>http://extranetevolution.com/2020/07/autodesk-criticism-extends/</link>
            <guid isPermaLink="false">hacker-news-small-sites-24034211</guid>
            <pubDate>Mon, 03 Aug 2020 04:20:27 GMT</pubDate>
        </item>
    </channel>
</rss>
